(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("jquery"));else if(typeof define==="function"&&define.amd)define(["jquery"],factory);else{var a=typeof exports==="object"?factory(require("jquery")):factory(root["$"]);for(var i in a)(typeof exports==="object"?exports:root)[i]=a[i]}})(typeof self!=="undefined"?self:this,function(__WEBPACK_EXTERNAL_MODULE_59__){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId]){return installedModules[moduleId].exports}var module=installedModules[moduleId]={i:moduleId,l:false,exports:{}};modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.l=true;return module.exports}__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.d=function(exports,name,getter){if(!__webpack_require__.o(exports,name)){Object.defineProperty(exports,name,{configurable:false,enumerable:true,get:getter})}};__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module["default"]}:function getModuleExports(){return module};__webpack_require__.d(getter,"a",getter);return getter};__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)};__webpack_require__.p="";return __webpack_require__(__webpack_require__.s=99)}([function(module,exports,__webpack_require__){"use strict";function __export(m){for(var p in m)if(!exports.hasOwnProperty(p))exports[p]=m[p]}Object.defineProperty(exports,"__esModule",{value:true});__export(__webpack_require__(61));__export(__webpack_require__(62));__export(__webpack_require__(43));__export(__webpack_require__(132));__export(__webpack_require__(133));__export(__webpack_require__(134));__export(__webpack_require__(135));__export(__webpack_require__(63));__export(__webpack_require__(136));__export(__webpack_require__(64));__export(__webpack_require__(137));__export(__webpack_require__(138));__export(__webpack_require__(140));__export(__webpack_require__(141));__export(__webpack_require__(142))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var util_3=__webpack_require__(0);var util_4=__webpack_require__(0);var util_5=__webpack_require__(0);var util_6=__webpack_require__(0);var storage_1=__webpack_require__(26);var util_7=__webpack_require__(0);exports.LUIDGenerator=function(){var id=1;return function(){return id++}}();exports.sha1=function(str){var utf8Bytes=util_5.stringToByteArray(str);var sha1=new util_4.Sha1;sha1.update(utf8Bytes);var sha1Bytes=sha1.digest();return util_3.base64.encodeByteArray(sha1Bytes)};var buildLogMessage_=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}var message="";for(var i=0;i<var_args.length;i++){if(Array.isArray(var_args[i])||var_args[i]&&typeof var_args[i]==="object"&&typeof var_args[i].length==="number"){message+=buildLogMessage_.apply(null,var_args[i])}else if(typeof var_args[i]==="object"){message+=util_6.stringify(var_args[i])}else{message+=var_args[i]}message+=" "}return message};exports.logger=null;var firstLog_=true;exports.enableLogging=function(logger_,persistent){util_1.assert(!persistent||(logger_===true||logger_===false),"Can't turn on custom loggers persistently.");if(logger_===true){if(typeof console!=="undefined"){if(typeof console.log==="function"){exports.logger=console.log.bind(console)}else if(typeof console.log==="object"){exports.logger=function(message){console.log(message)}}}if(persistent)storage_1.SessionStorage.set("logging_enabled",true)}else if(typeof logger_==="function"){exports.logger=logger_}else{exports.logger=null;storage_1.SessionStorage.remove("logging_enabled")}};exports.log=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}if(firstLog_===true){firstLog_=false;if(exports.logger===null&&storage_1.SessionStorage.get("logging_enabled")===true)exports.enableLogging(true)}if(exports.logger){var message=buildLogMessage_.apply(null,var_args);exports.logger(message)}};exports.logWrapper=function(prefix){return function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}exports.log.apply(void 0,[prefix].concat(var_args))}};exports.error=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}if(typeof console!=="undefined"){var message="FIREBASE INTERNAL ERROR: "+buildLogMessage_.apply(void 0,var_args);if(typeof console.error!=="undefined"){console.error(message)}else{console.log(message)}}};exports.fatal=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}var message=buildLogMessage_.apply(void 0,var_args);throw new Error("FIREBASE FATAL ERROR: "+message)};exports.warn=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}if(typeof console!=="undefined"){var message="FIREBASE WARNING: "+buildLogMessage_.apply(void 0,var_args);if(typeof console.warn!=="undefined"){console.warn(message)}else{console.log(message)}}};exports.warnIfPageIsSecure=function(){if(typeof window!=="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1){exports.warn("Insecure Firebase access from a secure page. "+"Please use https in calls to new Firebase().")}};exports.warnAboutUnsupportedMethod=function(methodName){exports.warn(methodName+" is unsupported and will likely change soon.  "+"Please do not use.")};exports.isInvalidJSONNumber=function(data){return typeof data==="number"&&(data!=data||data==Number.POSITIVE_INFINITY||data==Number.NEGATIVE_INFINITY)};exports.executeWhenDOMReady=function(fn){if(util_7.isNodeSdk()||document.readyState==="complete"){fn()}else{var called_1=false;var wrappedFn_1=function(){if(!document.body){setTimeout(wrappedFn_1,Math.floor(10));return}if(!called_1){called_1=true;fn()}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",wrappedFn_1,false);window.addEventListener("load",wrappedFn_1,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",function(){if(document.readyState==="complete")wrappedFn_1()});window.attachEvent("onload",wrappedFn_1)}}};exports.MIN_NAME="[MIN_NAME]";exports.MAX_NAME="[MAX_NAME]";exports.nameCompare=function(a,b){if(a===b){return 0}else if(a===exports.MIN_NAME||b===exports.MAX_NAME){return-1}else if(b===exports.MIN_NAME||a===exports.MAX_NAME){return 1}else{var aAsInt=exports.tryParseInt(a),bAsInt=exports.tryParseInt(b);if(aAsInt!==null){if(bAsInt!==null){return aAsInt-bAsInt==0?a.length-b.length:aAsInt-bAsInt}else{return-1}}else if(bAsInt!==null){return 1}else{return a<b?-1:1}}};exports.stringCompare=function(a,b){if(a===b){return 0}else if(a<b){return-1}else{return 1}};exports.requireKey=function(key,obj){if(obj&&key in obj){return obj[key]}else{throw new Error("Missing required key ("+key+") in object: "+util_6.stringify(obj))}};exports.ObjectToUniqueKey=function(obj){if(typeof obj!=="object"||obj===null)return util_6.stringify(obj);var keys=[];for(var k in obj){keys.push(k)}keys.sort();var key="{";for(var i=0;i<keys.length;i++){if(i!==0)key+=",";key+=util_6.stringify(keys[i]);key+=":";key+=exports.ObjectToUniqueKey(obj[keys[i]])}key+="}";return key};exports.splitStringBySize=function(str,segsize){var len=str.length;if(len<=segsize){return[str]}var dataSegs=[];for(var c=0;c<len;c+=segsize){if(c+segsize>len){dataSegs.push(str.substring(c,len))}else{dataSegs.push(str.substring(c,c+segsize))}}return dataSegs};exports.each=function(obj,fn){if(Array.isArray(obj)){for(var i=0;i<obj.length;++i){fn(i,obj[i])}}else{util_2.forEach(obj,function(key,val){return fn(val,key)})}};exports.bindCallback=function(callback,context){return context?callback.bind(context):callback};exports.doubleToIEEE754String=function(v){util_1.assert(!exports.isInvalidJSONNumber(v),"Invalid JSON number");var ebits=11,fbits=52;var bias=(1<<ebits-1)-1,s,e,f,ln,i,bits,str;if(v===0){e=0;f=0;s=1/v===-Infinity?1:0}else{s=v<0;v=Math.abs(v);if(v>=Math.pow(2,1-bias)){ln=Math.min(Math.floor(Math.log(v)/Math.LN2),bias);e=ln+bias;f=Math.round(v*Math.pow(2,fbits-ln)-Math.pow(2,fbits))}else{e=0;f=Math.round(v/Math.pow(2,1-bias-fbits))}}bits=[];for(i=fbits;i;i-=1){bits.push(f%2?1:0);f=Math.floor(f/2)}for(i=ebits;i;i-=1){bits.push(e%2?1:0);e=Math.floor(e/2)}bits.push(s?1:0);bits.reverse();str=bits.join("");var hexByteString="";for(i=0;i<64;i+=8){var hexByte=parseInt(str.substr(i,8),2).toString(16);if(hexByte.length===1)hexByte="0"+hexByte;hexByteString=hexByteString+hexByte}return hexByteString.toLowerCase()};exports.isChromeExtensionContentScript=function(){return!!(typeof window==="object"&&window["chrome"]&&window["chrome"]["extension"]&&!/^chrome/.test(window.location.href))};exports.isWindowsStoreApp=function(){return typeof Windows==="object"&&typeof Windows.UI==="object"};exports.errorForServerCode=function(code,query){var reason="Unknown Error";if(code==="too_big"){reason="The data requested exceeds the maximum size "+"that can be accessed with a single request."}else if(code=="permission_denied"){reason="Client doesn't have permission to access the desired data."}else if(code=="unavailable"){reason="The service is unavailable"}var error=new Error(code+" at "+query.path.toString()+": "+reason);error.code=code.toUpperCase();return error};exports.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$");exports.tryParseInt=function(str){if(exports.INTEGER_REGEXP_.test(str)){var intVal=Number(str);if(intVal>=-2147483648&&intVal<=2147483647){return intVal}}return null};exports.exceptionGuard=function(fn){try{fn()}catch(e){setTimeout(function(){var stack=e.stack||"";exports.warn("Exception was thrown by user callback.",stack);throw e},Math.floor(0))}};exports.callUserCallback=function(callback){var var_args=[];for(var _i=1;_i<arguments.length;_i++){var_args[_i-1]=arguments[_i]}if(typeof callback==="function"){exports.exceptionGuard(function(){callback.apply(void 0,var_args)})}};exports.beingCrawled=function(){var userAgent=typeof window==="object"&&window["navigator"]&&window["navigator"]["userAgent"]||"";return userAgent.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0};exports.exportPropGetter=function(object,name,fnGet){Object.defineProperty(object,name,{get:fnGet})};exports.setTimeoutNonBlocking=function(fn,time){var timeout=setTimeout(fn,time);if(typeof timeout==="object"&&timeout["unref"]){timeout["unref"]()}return timeout}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var util_2=__webpack_require__(0);var Path=function(){function Path(pathOrString,pieceNum){if(pieceNum===void 0){this.pieces_=pathOrString.split("/");var copyTo=0;for(var i=0;i<this.pieces_.length;i++){if(this.pieces_[i].length>0){this.pieces_[copyTo]=this.pieces_[i];copyTo++}}this.pieces_.length=copyTo;this.pieceNum_=0}else{this.pieces_=pathOrString;this.pieceNum_=pieceNum}}Object.defineProperty(Path,"Empty",{get:function(){return new Path("")},enumerable:true,configurable:true});Path.prototype.getFront=function(){if(this.pieceNum_>=this.pieces_.length)return null;return this.pieces_[this.pieceNum_]};Path.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_};Path.prototype.popFront=function(){var pieceNum=this.pieceNum_;if(pieceNum<this.pieces_.length){pieceNum++}return new Path(this.pieces_,pieceNum)};Path.prototype.getBack=function(){if(this.pieceNum_<this.pieces_.length)return this.pieces_[this.pieces_.length-1];return null};Path.prototype.toString=function(){var pathString="";for(var i=this.pieceNum_;i<this.pieces_.length;i++){if(this.pieces_[i]!=="")pathString+="/"+this.pieces_[i]}return pathString||"/"};Path.prototype.toUrlEncodedString=function(){var pathString="";for(var i=this.pieceNum_;i<this.pieces_.length;i++){if(this.pieces_[i]!=="")pathString+="/"+encodeURIComponent(String(this.pieces_[i]))}return pathString||"/"};Path.prototype.slice=function(begin){if(begin===void 0){begin=0}return this.pieces_.slice(this.pieceNum_+begin)};Path.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;var pieces=[];for(var i=this.pieceNum_;i<this.pieces_.length-1;i++)pieces.push(this.pieces_[i]);return new Path(pieces,0)};Path.prototype.child=function(childPathObj){var pieces=[];for(var i=this.pieceNum_;i<this.pieces_.length;i++)pieces.push(this.pieces_[i]);if(childPathObj instanceof Path){for(var i=childPathObj.pieceNum_;i<childPathObj.pieces_.length;i++){pieces.push(childPathObj.pieces_[i])}}else{var childPieces=childPathObj.split("/");for(var i=0;i<childPieces.length;i++){if(childPieces[i].length>0)pieces.push(childPieces[i])}}return new Path(pieces,0)};Path.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length};Path.relativePath=function(outerPath,innerPath){var outer=outerPath.getFront(),inner=innerPath.getFront();if(outer===null){return innerPath}else if(outer===inner){return Path.relativePath(outerPath.popFront(),innerPath.popFront())}else{throw new Error("INTERNAL ERROR: innerPath ("+innerPath+") is not within "+"outerPath ("+outerPath+")")}};Path.comparePaths=function(left,right){var leftKeys=left.slice();var rightKeys=right.slice();for(var i=0;i<leftKeys.length&&i<rightKeys.length;i++){var cmp=util_1.nameCompare(leftKeys[i],rightKeys[i]);if(cmp!==0)return cmp}if(leftKeys.length===rightKeys.length)return 0;return leftKeys.length<rightKeys.length?-1:1};Path.prototype.equals=function(other){if(this.getLength()!==other.getLength()){return false}for(var i=this.pieceNum_,j=other.pieceNum_;i<=this.pieces_.length;i++,j++){if(this.pieces_[i]!==other.pieces_[j]){return false}}return true};Path.prototype.contains=function(other){var i=this.pieceNum_;var j=other.pieceNum_;if(this.getLength()>other.getLength()){return false}while(i<this.pieces_.length){if(this.pieces_[i]!==other.pieces_[j]){return false}++i;++j}return true};return Path}();exports.Path=Path;var ValidationPath=function(){function ValidationPath(path,errorPrefix_){this.errorPrefix_=errorPrefix_;this.parts_=path.slice();this.byteLength_=Math.max(1,this.parts_.length);for(var i=0;i<this.parts_.length;i++){this.byteLength_+=util_2.stringLength(this.parts_[i])}this.checkValid_()}Object.defineProperty(ValidationPath,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:true,configurable:true});Object.defineProperty(ValidationPath,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:true,configurable:true});ValidationPath.prototype.push=function(child){if(this.parts_.length>0){this.byteLength_+=1}this.parts_.push(child);this.byteLength_+=util_2.stringLength(child);this.checkValid_()};ValidationPath.prototype.pop=function(){var last=this.parts_.pop();this.byteLength_-=util_2.stringLength(last);if(this.parts_.length>0){this.byteLength_-=1}};ValidationPath.prototype.checkValid_=function(){if(this.byteLength_>ValidationPath.MAX_PATH_LENGTH_BYTES){throw new Error(this.errorPrefix_+"has a key path longer than "+ValidationPath.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").")}if(this.parts_.length>ValidationPath.MAX_PATH_DEPTH){throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ValidationPath.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())}};ValidationPath.prototype.toErrorString=function(){if(this.parts_.length==0){return""}return"in property '"+this.parts_.join(".")+"'"};return ValidationPath}();exports.ValidationPath=ValidationPath},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartManager=void 0;var _control=__webpack_require__(36);var _chart=__webpack_require__(100);var indicators=_interopRequireWildcard(__webpack_require__(104));var ranges=_interopRequireWildcard(__webpack_require__(58));var templates=_interopRequireWildcard(__webpack_require__(25));var data_sources=_interopRequireWildcard(__webpack_require__(11));var _chart_settings=__webpack_require__(18);var data_providers=_interopRequireWildcard(__webpack_require__(40));var themes=_interopRequireWildcard(__webpack_require__(20));var plotters=_interopRequireWildcard(__webpack_require__(39));var ctools=_interopRequireWildcard(__webpack_require__(38));var areas=_interopRequireWildcard(__webpack_require__(41));var _util=__webpack_require__(19);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ChartManager=function(){function ChartManager(){_classCallCheck(this,ChartManager);this._dataSources={};this._dataSourceCache={};this._dataProviders={};this._frames={};this._areas={};this._timelines={};this._ranges={};this._plotters={};this._themes={};this._titles={};this._frameMousePos={};this._dsChartStyle={};this._dragStarted=false;this._oldX=0;this._fakeIndicators={};this._captureMouseWheelDirectly=true;this._chart={};this._chart.defaultFrame=new _chart.Chart;this._drawingTool=ChartManager.DrawingTool["CrossCursor"];this._beforeDrawingTool=this._drawingTool;this._language="zh-cn";this._mainCanvas=null;this._overlayCanvas=null;this._mainContext=null;this._overlayContext=null;if(!ChartManager.created){ChartManager.instance=this;ChartManager.created=true}return ChartManager.instance}_createClass(ChartManager,[{key:"redraw",value:function redraw(layer,refresh){if(layer===undefined||refresh){layer="All"}if(layer==="All"||layer==="MainCanvas"){if(refresh){this.getFrame("frame0").setChanged(true)}this.layout(this._mainContext,"frame0",0,0,this._mainCanvas.width,this._mainCanvas.height);this.drawMain("frame0",this._mainContext)}if(layer==="All"||layer==="OverlayCanvas"){this._overlayContext.clearRect(0,0,this._overlayCanvas.width,this._overlayCanvas.height);this.drawOverlay("frame0",this._overlayContext)}}},{key:"bindCanvas",value:function bindCanvas(layer,canvas){if(layer==="main"){this._mainCanvas=canvas;this._mainContext=canvas.getContext("2d")}else if(layer==="overlay"){this._overlayCanvas=canvas;this._overlayContext=canvas.getContext("2d");if(this._captureMouseWheelDirectly){$(this._overlayCanvas).bind("mousewheel",_control.Control.mouseWheel)}}}},{key:"getCaptureMouseWheelDirectly",value:function getCaptureMouseWheelDirectly(){return this._captureMouseWheelDirectly}},{key:"setCaptureMouseWheelDirectly",value:function setCaptureMouseWheelDirectly(v){this._captureMouseWheelDirectly=v;if(v)$(this._overlayCanvas).bind("mousewheel",_control.Control.mouseWheel);else $(this._overlayCanvas).unbind("mousewheel")}},{key:"getChart",value:function getChart(nouseParam){return this._chart["defaultFrame"]}},{key:"init",value:function init(){delete this._ranges["frame0.k0.indic1"];delete this._ranges["frame0.k0.indic1Range"];delete this._areas["frame0.k0.indic1"];delete this._areas["frame0.k0.indic1Range"];templates.DefaultTemplate.loadTemplate("frame0.k0","");this.redraw("All",true)}},{key:"setCurrentDrawingTool",value:function setCurrentDrawingTool(paramTool){this._drawingTool=ChartManager.DrawingTool[paramTool];this.setRunningMode(this._drawingTool)}},{key:"getLanguage",value:function getLanguage(){return this._language}},{key:"setLanguage",value:function setLanguage(lang){this._language=lang}},{key:"setThemeName",value:function setThemeName(frameName,themeName){if(themeName===undefined)themeName="Dark";var theme;switch(themeName){case"Light":theme=new themes.LightTheme;break;default:themeName="Dark";theme=new themes.DarkTheme;break}this._themeName=themeName;this.setTheme(frameName,theme);this.getFrame(frameName).setChanged(true)}},{key:"getChartStyle",value:function getChartStyle(dsName){var chartStyle=this._dsChartStyle[dsName];if(chartStyle===undefined)return"CandleStick";return chartStyle}},{key:"setChartStyle",value:function setChartStyle(dsName,style){if(this._dsChartStyle[dsName]===style)return;var areaName=dsName+".main";var dpName=areaName+".main";var plotterName=areaName+".main";var dp,plotter;switch(style){case"CandleStick":case"CandleStickHLC":case"OHLC":dp=this.getDataProvider(dpName);if(dp===undefined||!_util.Util.isInstance(dp,data_providers.MainDataProvider)){dp=new data_providers.MainDataProvider(dpName);this.setDataProvider(dpName,dp);dp.updateData()}this.setMainIndicator(dsName,_chart_settings.ChartSettings.get().charts.mIndic);switch(style){case"CandleStick":plotter=new plotters.CandlestickPlotter(plotterName);break;case"CandleStickHLC":plotter=new plotters.CandlestickHLCPlotter(plotterName);break;case"OHLC":plotter=new plotters.OHLCPlotter(plotterName);break}this.setPlotter(plotterName,plotter);plotter=new plotters.MinMaxPlotter(areaName+".decoration");this.setPlotter(plotter.getName(),plotter);break;case"Line":dp=new data_providers.IndicatorDataProvider(dpName);this.setDataProvider(dp.getName(),dp);dp.setIndicator(new indicators.HLCIndicator);this.removeMainIndicator(dsName);plotter=new plotters.IndicatorPlotter(plotterName);this.setPlotter(plotterName,plotter);this.removePlotter(areaName+".decoration");break}this.getArea(plotter.getAreaName()).setChanged(true);this._dsChartStyle[dsName]=style}},{key:"setNormalMode",value:function setNormalMode(){this._drawingTool=this._beforeDrawingTool;$(".chart_dropdown_data").removeClass("chart_dropdown-hover");$("#chart_toolpanel .chart_toolpanel_button").removeClass("selected");$("#chart_CrossCursor").parent().addClass("selected");if(this._drawingTool===ChartManager.DrawingTool.Cursor){this.showCursor();$("#mode a").removeClass("selected");$("#chart_toolpanel .chart_toolpanel_button").removeClass("selected");$("#chart_Cursor").parent().addClass("selected")}else{this.hideCursor()}}},{key:"setRunningMode",value:function setRunningMode(mode){var pds=this.getDataSource("frame0.k0");var curr_o=pds.getCurrentToolObject();if(curr_o!==null&&curr_o.state!==ctools.CToolObject.state.AfterDraw){pds.delToolObject()}if(pds.getToolObjectCount()>10){this.setNormalMode();return}this._drawingTool=mode;if(mode===ChartManager.DrawingTool.Cursor){this.showCursor()}else{}switch(mode){case ChartManager.DrawingTool.Cursor:{this._beforeDrawingTool=mode;break}case ChartManager.DrawingTool.ArrowLine:{pds.addToolObject(new ctools.CArrowLineObject("frame0.k0"));break}case ChartManager.DrawingTool.BandLine:{pds.addToolObject(new ctools.CBandLineObject("frame0.k0"));break}case ChartManager.DrawingTool.BiParallelLine:{pds.addToolObject(new ctools.CBiParallelLineObject("frame0.k0"));break}case ChartManager.DrawingTool.BiParallelRayLine:{pds.addToolObject(new ctools.CBiParallelRayLineObject("frame0.k0"));break}case ChartManager.DrawingTool.CrossCursor:{this._beforeDrawingTool=mode;break}case ChartManager.DrawingTool.DrawFibFans:{pds.addToolObject(new ctools.CFibFansObject("frame0.k0"));break}case ChartManager.DrawingTool.DrawFibRetrace:{pds.addToolObject(new ctools.CFibRetraceObject("frame0.k0"));break}case ChartManager.DrawingTool.DrawLines:{pds.addToolObject(new ctools.CStraightLineObject("frame0.k0"));break}case ChartManager.DrawingTool.HoriRayLine:{pds.addToolObject(new ctools.CHoriRayLineObject("frame0.k0"));break}case ChartManager.DrawingTool.HoriSegLine:{pds.addToolObject(new ctools.CHoriSegLineObject("frame0.k0"));break}case ChartManager.DrawingTool.HoriStraightLine:{pds.addToolObject(new ctools.CHoriStraightLineObject("frame0.k0"));break}case ChartManager.DrawingTool.PriceLine:{pds.addToolObject(new ctools.CPriceLineObject("frame0.k0"));break}case ChartManager.DrawingTool.RayLine:{pds.addToolObject(new ctools.CRayLineObject("frame0.k0"));break}case ChartManager.DrawingTool.SegLine:{pds.addToolObject(new ctools.CSegLineObject("frame0.k0"));break}case ChartManager.DrawingTool.StraightLine:{pds.addToolObject(new ctools.CStraightLineObject("frame0.k0"));break}case ChartManager.DrawingTool.TriParallelLine:{pds.addToolObject(new ctools.CTriParallelLineObject("frame0.k0"));break}case ChartManager.DrawingTool.VertiStraightLine:{pds.addToolObject(new ctools.CVertiStraightLineObject("frame0.k0"));break}}}},{key:"getTitle",value:function getTitle(dsName){return this._titles[dsName]}},{key:"setTitle",value:function setTitle(dsName,title){this._titles[dsName]=title}},{key:"setCurrentDataSource",value:function setCurrentDataSource(dsName,dsAlias){var cached=this.getCachedDataSource(dsAlias);if(cached!==undefined&&cached!==null){this.setDataSource(dsName,cached,true)}else{cached=new data_sources.MainDataSource(dsAlias);this.setDataSource(dsName,cached,true);this.setCachedDataSource(dsAlias,cached)}}},{key:"getDataSource",value:function getDataSource(name){return this._dataSources[name]}},{key:"setDataSource",value:function setDataSource(name,ds,forceRefresh){this._dataSources[name]=ds;if(forceRefresh){this.updateData(name,null)}}},{key:"getCachedDataSource",value:function getCachedDataSource(name){return this._dataSourceCache[name]}},{key:"setCachedDataSource",value:function setCachedDataSource(name,ds){this._dataSourceCache[name]=ds}},{key:"getDataProvider",value:function getDataProvider(name){return this._dataProviders[name]}},{key:"setDataProvider",value:function setDataProvider(name,dp){this._dataProviders[name]=dp}},{key:"removeDataProvider",value:function removeDataProvider(name){delete this._dataProviders[name]}},{key:"getFrame",value:function getFrame(name){return this._frames[name]}},{key:"setFrame",value:function setFrame(name,frame){this._frames[name]=frame}},{key:"removeFrame",value:function removeFrame(name){delete this._frames[name]}},{key:"getArea",value:function getArea(name){return this._areas[name]}},{key:"setArea",value:function setArea(name,area){this._areas[name]=area}},{key:"removeArea",value:function removeArea(name){delete this._areas[name]}},{key:"getTimeline",value:function getTimeline(name){return this._timelines[name]}},{key:"setTimeline",value:function setTimeline(name,timeline){this._timelines[name]=timeline}},{key:"removeTimeline",value:function removeTimeline(name){delete this._timelines[name]}},{key:"getRange",value:function getRange(name){return this._ranges[name]}},{key:"setRange",value:function setRange(name,range){this._ranges[name]=range}},{key:"removeRange",value:function removeRange(name){delete this._ranges[name]}},{key:"getPlotter",value:function getPlotter(name){return this._plotters[name]}},{key:"setPlotter",value:function setPlotter(name,plotter){this._plotters[name]=plotter}},{key:"removePlotter",value:function removePlotter(name){delete this._plotters[name]}},{key:"getTheme",value:function getTheme(name){return this._themes[name]}},{key:"setTheme",value:function setTheme(name,theme){this._themes[name]=theme}},{key:"getFrameMousePos",value:function getFrameMousePos(name,point){if(this._frameMousePos[name]!==undefined){point.x=this._frameMousePos[name].x;point.y=this._frameMousePos[name].y}else{point.x=-1;point.y=-1}}},{key:"setFrameMousePos",value:function setFrameMousePos(name,px,py){this._frameMousePos[name]={x:px,y:py}}},{key:"drawArea",value:function drawArea(context,area,plotterNames){var areaName=area.getNameObject().getCompAt(2);if(areaName==="timeline"){if(area.getHeight()<20)return}else{if(area.getHeight()<30)return}if(area.getWidth()<30)return;areaName=area.getName();var plotter;var i,cnt=plotterNames.length;for(i=0;i<cnt;i++){plotter=this._plotters[areaName+plotterNames[i]];if(plotter!==undefined)plotter.Draw(context)}}},{key:"drawAreaMain",value:function drawAreaMain(context,area){var ds=this._dataSources[area.getDataSourceName()];var plotterNames;if(ds.getDataCount()<1)plotterNames=[".background"];else plotterNames=[".background",".grid",".main",".secondary"];this.drawArea(context,area,plotterNames);area.setChanged(false)}},{key:"drawAreaOverlay",value:function drawAreaOverlay(context,area){var ds=this._dataSources[area.getDataSourceName()];var plotterNames;if(ds.getDataCount()<1)plotterNames=[".selection"];else plotterNames=[".decoration",".selection",".info",".tool"];this.drawArea(context,area,plotterNames)}},{key:"drawMain",value:function drawMain(frameName,context){var drawn=false;if(!drawn){for(var it in this._areas){if(this._areas[it].getFrameName()===frameName&&!_util.Util.isInstance(this._areas[it],areas.ChartAreaGroup))this.drawAreaMain(context,this._areas[it])}}var e;for(var i in this._timelines){e=this._timelines[i];if(e.getFrameName()===frameName)e.setUpdated(false)}for(var _i in this._ranges){e=this._ranges[_i];if(e.getFrameName()===frameName)e.setUpdated(false)}for(var _i2 in this._areas){e=this._areas[_i2];if(e.getFrameName()===frameName)e.setChanged(false)}}},{key:"drawOverlay",value:function drawOverlay(frameName,context){for(var n in this._areas){var area=this._areas[n];if(_util.Util.isInstance(area,areas.ChartAreaGroup))if(area.getFrameName()===frameName){area.drawGrid(context)}}for(var _n in this._areas){var _area=this._areas[_n];if(_util.Util.isInstance(_area,areas.ChartAreaGroup)===false)if(_area.getFrameName()===frameName){this.drawAreaOverlay(context,_area)}}}},{key:"updateData",value:function updateData(dsName,data){var ds=this.getDataSource(dsName);if(ds===undefined||ds===null){return}if(data!==undefined&&data!==null){if(!ds.update(data)){return false}if(ds.getUpdateMode()===data_sources.DataSource.UpdateMode.DoNothing)return true}else{ds.setUpdateMode(data_sources.DataSource.UpdateMode.Refresh)}var timeline=this.getTimeline(dsName);if(timeline!==undefined&&timeline!==null){timeline.update()}if(ds.getDataCount()<1){return true}var dpNames=[".main",".secondary"];var area,areaName;for(var n in this._areas){area=this._areas[n];if(_util.Util.isInstance(area,areas.ChartAreaGroup)){continue}if(area.getDataSourceName()!==dsName){continue}areaName=area.getName();for(var i=0;i<dpNames.length;i++){var dp=this.getDataProvider(areaName+dpNames[i]);if(dp!==undefined&&dp!==null){dp.updateData()}}}return true}},{key:"updateRange",value:function updateRange(dsName){var ds=this.getDataSource(dsName);if(ds.getDataCount()<1){return}var dpNames=[".main",".secondary"];var area,areaName;for(var n in this._areas){area=this._areas[n];if(_util.Util.isInstance(area,areas.ChartAreaGroup))continue;if(area.getDataSourceName()!==dsName)continue;areaName=area.getName();for(var i=0;i<dpNames.length;i++){var dp=this.getDataProvider(areaName+dpNames[i]);if(dp!==undefined&&dp!==null){dp.updateRange()}}var timeline=this.getTimeline(dsName);if(timeline!==undefined&&timeline.getMaxItemCount()>0){var range=this.getRange(areaName);if(range!==undefined&&range!==null){range.update()}}}}},{key:"layout",value:function layout(context,frameName,left,top,right,bottom){var frame=this.getFrame(frameName);frame.measure(context,right-left,bottom-top);frame.layout(left,top,right,bottom);for(var n in this._timelines){var e=this._timelines[n];if(e.getFrameName()===frameName)e.onLayout()}for(var _n2 in this._dataSources){if(_n2.substring(0,frameName.length)===frameName)this.updateRange(_n2)}
}},{key:"SelectRange",value:function SelectRange(pArea,y){for(var ee in this._ranges){var _1=this._ranges[ee].getAreaName();var _2=pArea.getName();if(_1===_2)this._ranges[ee].selectAt(y);else this._ranges[ee].unselect()}}},{key:"scale",value:function scale(s){if(this._highlightedFrame===null)return;var hiArea=this._highlightedFrame.getHighlightedArea();if(this.getRange(hiArea.getName())!==undefined){var dsName=hiArea.getDataSourceName();var timeline=this.getTimeline(dsName);if(timeline!==null){timeline.scale(s);this.updateRange(dsName)}}}},{key:"showCursor",value:function showCursor(cursor){if(cursor===undefined)cursor="default";this._mainCanvas.style.cursor=cursor;this._overlayCanvas.style.cursor=cursor}},{key:"hideCursor",value:function hideCursor(){this._mainCanvas.style.cursor="none";this._overlayCanvas.style.cursor="none"}},{key:"showCrossCursor",value:function showCrossCursor(area,x,y){var e=this.getRange(area.getName());if(e!==undefined){e.selectAt(y);e=this.getTimeline(area.getDataSourceName());if(e!==undefined)if(e.selectAt(x))return true}return false}},{key:"hideCrossCursor",value:function hideCrossCursor(exceptTimeline){if(exceptTimeline!==null&&exceptTimeline!==undefined){for(var n in this._timelines){var e=this._timelines[n];if(e!==exceptTimeline){e.unselect()}}}else{for(var _n3 in this._timelines){this._timelines[_n3].unselect()}}for(var _n4 in this._ranges){this._ranges[_n4].unselect()}}},{key:"clearHighlight",value:function clearHighlight(){if(this._highlightedFrame!==null&&this._highlightedFrame!==undefined){this._highlightedFrame.highlight(null);this._highlightedFrame=null}}},{key:"onToolMouseMove",value:function onToolMouseMove(frameName,x,y){var ret=false;frameName+=".";for(var n in this._dataSources){if(n.indexOf(frameName)===0){var ds=this._dataSources[n];if(_util.Util.isInstance(ds,data_sources.MainDataSource))if(ds.toolManager.acceptMouseMoveEvent(x,y))ret=true}}return ret}},{key:"onToolMouseDown",value:function onToolMouseDown(frameName,x,y){var ret=false;frameName+=".";for(var n in this._dataSources){if(n.indexOf(frameName)===0){var ds=this._dataSources[n];if(_util.Util.isInstance(ds,data_sources.MainDataSource))if(ds.toolManager.acceptMouseDownEvent(x,y))ret=true}}return ret}},{key:"onToolMouseUp",value:function onToolMouseUp(frameName,x,y){var ret=false;frameName+=".";for(var n in this._dataSources){if(n.indexOf(frameName)===0){var ds=this._dataSources[n];if(_util.Util.isInstance(ds,data_sources.MainDataSource))if(ds.toolManager.acceptMouseUpEvent(x,y))ret=true}}return ret}},{key:"onToolMouseDrag",value:function onToolMouseDrag(frameName,x,y){var ret=false;frameName+=".";for(var n in this._dataSources){if(n.indexOf(frameName)===0){var ds=this._dataSources[n];if(_util.Util.isInstance(ds,data_sources.MainDataSource))if(ds.toolManager.acceptMouseDownMoveEvent(x,y))ret=true}}return ret}},{key:"onMouseMove",value:function onMouseMove(frameName,x,y,drag){var frame=this.getFrame(frameName);if(frame===undefined)return;this.setFrameMousePos(frameName,x,y);this.hideCrossCursor();if(this._highlightedFrame!==frame)this.clearHighlight();if(this._capturingMouseArea!==null&&this._capturingMouseArea!==undefined){this._capturingMouseArea.onMouseMove(x,y);return}var _areas=frame.contains(x,y);if(_areas===null)return;var a,i,cnt=_areas.length;for(i=cnt-1;i>=0;i--){a=_areas[i];a=a.onMouseMove(x,y);if(a!==null){if(!_util.Util.isInstance(a,areas.ChartAreaGroup)){frame.highlight(a);this._highlightedFrame=frame}return}}}},{key:"onMouseLeave",value:function onMouseLeave(frameName,x,y,move){var frame=this.getFrame(frameName);if(frame===undefined)return;this.setFrameMousePos(frameName,x,y);this.hideCrossCursor();this.clearHighlight();if(this._capturingMouseArea!==null&&this._capturingMouseArea!==undefined){this._capturingMouseArea.onMouseLeave(x,y);this._capturingMouseArea=null}this._dragStarted=false}},{key:"onMouseDown",value:function onMouseDown(frameName,x,y){var frame=this.getFrame(frameName);if(frame===undefined)return;var areas=frame.contains(x,y);if(areas===null)return;var a,i,cnt=areas.length;for(i=cnt-1;i>=0;i--){a=areas[i];a=a.onMouseDown(x,y);if(a!==null){this._capturingMouseArea=a;return}}}},{key:"onMouseUp",value:function onMouseUp(frameName,x,y){var frame=this.getFrame(frameName);if(frame===undefined)return;if(this._capturingMouseArea){if(this._capturingMouseArea.onMouseUp(x,y)===null&&this._dragStarted===false){if(this._selectedFrame!==null&&this._selectedFrame!==undefined&&this._selectedFrame!==frame)this._selectedFrame.select(null);if(this._capturingMouseArea.isSelected()){if(!this._captureMouseWheelDirectly)$(this._overlayCanvas).unbind("mousewheel");frame.select(null);this._selectedFrame=null}else{if(this._selectedFrame!==frame)if(!this._captureMouseWheelDirectly)$(this._overlayCanvas).bind("mousewheel",_control.Control.mouseWheel);frame.select(this._capturingMouseArea);this._selectedFrame=frame}}this._capturingMouseArea=null;this._dragStarted=false}}},{key:"deleteToolObject",value:function deleteToolObject(){var pDPTool=this.getDataSource("frame0.k0");var selectObject=pDPTool.getSelectToolObjcet();if(selectObject!==null)pDPTool.delSelectToolObject();var currentObject=pDPTool.getCurrentToolObject();if(currentObject!==null&&currentObject.getState()!==ctools.CToolObject.state.AfterDraw){pDPTool.delToolObject()}this.setNormalMode()}},{key:"unloadTemplate",value:function unloadTemplate(frameName){var frame=this.getFrame(frameName);if(frame===undefined)return;for(var n in this._dataSources){if(n.match(frameName+"."))delete this._dataSources[n]}for(var _n5 in this._dataProviders){if(this._dataProviders[_n5].getFrameName()===frameName)delete this._dataProviders[_n5]}delete this._frames[frameName];for(var _n6 in this._areas){if(this._areas[_n6].getFrameName()===frameName)delete this._areas[_n6]}for(var _n7 in this._timelines){if(this._timelines[_n7].getFrameName()===frameName)delete this._timelines[_n7]}for(var _n8 in this._ranges){if(this._ranges[_n8].getFrameName()===frameName)delete this._ranges[_n8]}for(var _n9 in this._plotters){if(this._plotters[_n9].getFrameName()===frameName)delete this._plotters[_n9]}delete this._themes[frameName];delete this._frameMousePos[frameName]}},{key:"createIndicatorAndRange",value:function createIndicatorAndRange(areaName,indicName,notLoadSettings){var indic,range;switch(indicName){case"MA":indic=new indicators.MAIndicator;range=new ranges.PositiveRange(areaName);break;case"EMA":indic=new indicators.EMAIndicator;range=new ranges.PositiveRange(areaName);break;case"VOLUME":indic=new indicators.VOLUMEIndicator;range=new ranges.ZeroBasedPositiveRange(areaName);break;case"MACD":indic=new indicators.MACDIndicator;range=new ranges.ZeroCenteredRange(areaName);break;case"DMI":indic=new indicators.DMIIndicator;range=new ranges.PercentageRange(areaName);break;case"DMA":indic=new indicators.DMAIndicator;range=new ranges.Range(areaName);break;case"TRIX":indic=new indicators.TRIXIndicator;range=new ranges.Range(areaName);break;case"BRAR":indic=new indicators.BRARIndicator;range=new ranges.Range(areaName);break;case"VR":indic=new indicators.VRIndicator;range=new ranges.Range(areaName);break;case"OBV":indic=new indicators.OBVIndicator;range=new ranges.Range(areaName);break;case"EMV":indic=new indicators.EMVIndicator;range=new ranges.Range(areaName);break;case"RSI":indic=new indicators.RSIIndicator;range=new ranges.PercentageRange(areaName);break;case"WR":indic=new indicators.WRIndicator;range=new ranges.PercentageRange(areaName);break;case"SAR":indic=new indicators.SARIndicator;range=new ranges.PositiveRange(areaName);break;case"KDJ":indic=new indicators.KDJIndicator;range=new ranges.PercentageRange(areaName);break;case"ROC":indic=new indicators.ROCIndicator;range=new ranges.Range(areaName);break;case"MTM":indic=new indicators.MTMIndicator;range=new ranges.Range(areaName);break;case"BOLL":indic=new indicators.BOLLIndicator;range=new ranges.Range(areaName);break;case"PSY":indic=new indicators.PSYIndicator;range=new ranges.Range(areaName);break;case"StochRSI":indic=new indicators.STOCHRSIIndicator;range=new ranges.PercentageRange(areaName);break;default:return null}if(!notLoadSettings){indic.setParameters(_chart_settings.ChartSettings.get().indics[indicName])}return{indic:indic,range:range}}},{key:"setMainIndicator",value:function setMainIndicator(dsName,indicName){var areaName=dsName+".main";var dp=this.getDataProvider(areaName+".main");if(dp===undefined||!_util.Util.isInstance(dp,data_providers.MainDataProvider))return false;var indic;switch(indicName){case"MA":indic=new indicators.MAIndicator;break;case"EMA":indic=new indicators.EMAIndicator;break;case"BOLL":indic=new indicators.BOLLIndicator;break;case"SAR":indic=new indicators.SARIndicator;break;default:return false}indic.setParameters(_chart_settings.ChartSettings.get().indics[indicName]);var indicDpName=areaName+".secondary";var indicDp=this.getDataProvider(indicDpName);if(indicDp===undefined){indicDp=new data_providers.IndicatorDataProvider(indicDpName);this.setDataProvider(indicDp.getName(),indicDp)}indicDp.setIndicator(indic);var plotter=this.getPlotter(indicDpName);if(plotter===undefined){plotter=new plotters.IndicatorPlotter(indicDpName);this.setPlotter(plotter.getName(),plotter)}this.getArea(areaName).setChanged(true);return true}},{key:"setIndicator",value:function setIndicator(areaName,indicName){var area=this.getArea(areaName);if(area===null||area===undefined||area.getNameObject().getCompAt(2)==="main"){return false}var dp=this.getDataProvider(areaName+".secondary");if(dp===null||dp===undefined||!_util.Util.isInstance(dp,data_providers.IndicatorDataProvider)){return false}var ret=this.createIndicatorAndRange(areaName,indicName);if(ret===null||ret===undefined){return false}var indic=ret.indic;var range=ret.range;this.removeDataProvider(areaName+".main");this.removePlotter(areaName+".main");this.removeRange(areaName);this.removePlotter(areaName+"Range.decoration");dp.setIndicator(indic);this.setRange(areaName,range);range.setPaddingTop(20);range.setPaddingBottom(4);range.setMinInterval(20);if(_util.Util.isInstance(indic,indicators.VOLUMEIndicator)){var plotter=new plotters.LastVolumePlotter(areaName+"Range.decoration");this.setPlotter(plotter.getName(),plotter)}else if(_util.Util.isInstance(indic,indicators.BOLLIndicator)||_util.Util.isInstance(indic,indicators.SARIndicator)){var _dp=new data_providers.MainDataProvider(areaName+".main");this.setDataProvider(_dp.getName(),_dp);_dp.updateData();var _plotter=new plotters.OHLCPlotter(areaName+".main");this.setPlotter(_plotter.getName(),_plotter)}return true}},{key:"removeMainIndicator",value:function removeMainIndicator(dsName){var areaName=dsName+".main";var indicDpName=areaName+".secondary";var indicDp=this.getDataProvider(indicDpName);if(indicDp===undefined||!_util.Util.isInstance(indicDp,data_providers.IndicatorDataProvider))return;this.removeDataProvider(indicDpName);this.removePlotter(indicDpName);this.getArea(areaName).setChanged(true)}},{key:"removeIndicator",value:function removeIndicator(areaName){var area=this.getArea(areaName);if(area===undefined||area.getNameObject().getCompAt(2)==="main")return;var dp=this.getDataProvider(areaName+".secondary");if(dp===undefined||!_util.Util.isInstance(dp,data_providers.IndicatorDataProvider))return;var rangeAreaName=areaName+"Range";var rangeArea=this.getArea(rangeAreaName);if(rangeArea===undefined)return;var tableLayout=this.getArea(area.getDataSourceName()+".charts");if(tableLayout===undefined)return;tableLayout.removeArea(area);this.removeArea(areaName);tableLayout.removeArea(rangeArea);this.removeArea(rangeAreaName);for(var n in this._dataProviders){if(this._dataProviders[n].getAreaName()===areaName)this.removeDataProvider(n)}for(var _n10 in this._ranges){if(this._ranges[_n10].getAreaName()===areaName)this.removeRange(_n10)}for(var _n11 in this._plotters){if(this._plotters[_n11].getAreaName()===areaName)this.removePlotter(_n11)}for(var _n12 in this._plotters){if(this._plotters[_n12].getAreaName()===rangeAreaName)this.removePlotter(_n12)}}},{key:"getIndicatorParameters",value:function getIndicatorParameters(indicName){var indic=this._fakeIndicators[indicName];if(indic===undefined){var ret=this.createIndicatorAndRange("",indicName);if(ret===null)return null;this._fakeIndicators[indicName]=indic=ret.indic}var params=[];var i,cnt=indic.getParameterCount();for(i=0;i<cnt;i++){params.push(indic.getParameterAt(i))}return params}},{key:"setIndicatorParameters",value:function setIndicatorParameters(indicName,params){var n,indic;for(n in this._dataProviders){var dp=this._dataProviders[n];if(_util.Util.isInstance(dp,data_providers.IndicatorDataProvider)===false)continue;indic=dp.getIndicator();if(indic.getName()===indicName){indic.setParameters(params);dp.refresh();this.getArea(dp.getAreaName()).setChanged(true)}}indic=this._fakeIndicators[indicName];if(indic===undefined){var ret=this.createIndicatorAndRange("",indicName,true);if(ret===null)return;this._fakeIndicators[indicName]=indic=ret.indic}indic.setParameters(params)}},{key:"getIndicatorAreaName",value:function getIndicatorAreaName(dsName,index){var tableLayout=this.getArea(dsName+".charts");var cnt=tableLayout.getAreaCount()>>1;if(index<0||index>=cnt)return"";return tableLayout.getAreaAt(index<<1).getName()}}]);return ChartManager}();exports.ChartManager=ChartManager;ChartManager.DrawingTool={Cursor:0,CrossCursor:1,DrawLines:2,DrawFibRetrace:3,DrawFibFans:4,SegLine:5,StraightLine:6,ArrowLine:7,RayLine:8,HoriStraightLine:9,HoriRayLine:10,HoriSegLine:11,VertiStraightLine:12,PriceLine:13,BiParallelLine:14,BiParallelRayLine:15,TriParallelLine:16,BandLine:17};ChartManager.created=false;ChartManager.instance=null},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var Index_1=__webpack_require__(28);var util_1=__webpack_require__(1);var Node_1=__webpack_require__(6);var LeafNode_1=__webpack_require__(29);var nodeFromJSON;var MAX_NODE;function setNodeFromJSON(val){nodeFromJSON=val}exports.setNodeFromJSON=setNodeFromJSON;function setMaxNode(val){MAX_NODE=val}exports.setMaxNode=setMaxNode;var PriorityIndex=function(_super){__extends(PriorityIndex,_super);function PriorityIndex(){return _super!==null&&_super.apply(this,arguments)||this}PriorityIndex.prototype.compare=function(a,b){var aPriority=a.node.getPriority();var bPriority=b.node.getPriority();var indexCmp=aPriority.compareTo(bPriority);if(indexCmp===0){return util_1.nameCompare(a.name,b.name)}else{return indexCmp}};PriorityIndex.prototype.isDefinedOn=function(node){return!node.getPriority().isEmpty()};PriorityIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.getPriority().equals(newNode.getPriority())};PriorityIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN};PriorityIndex.prototype.maxPost=function(){return new Node_1.NamedNode(util_1.MAX_NAME,new LeafNode_1.LeafNode("[PRIORITY-POST]",MAX_NODE))};PriorityIndex.prototype.makePost=function(indexValue,name){var priorityNode=nodeFromJSON(indexValue);return new Node_1.NamedNode(name,new LeafNode_1.LeafNode("[PRIORITY-POST]",priorityNode))};PriorityIndex.prototype.toString=function(){return".priority"};return PriorityIndex}(Index_1.Index);exports.PriorityIndex=PriorityIndex;exports.PRIORITY_INDEX=new PriorityIndex},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var SortedMap_1=__webpack_require__(30);var Node_1=__webpack_require__(6);var snap_1=__webpack_require__(70);var PriorityIndex_1=__webpack_require__(4);var KeyIndex_1=__webpack_require__(21);var IndexMap_1=__webpack_require__(72);var LeafNode_1=__webpack_require__(29);var comparators_1=__webpack_require__(74);var EMPTY_NODE;var ChildrenNode=function(){function ChildrenNode(children_,priorityNode_,indexMap_){this.children_=children_;this.priorityNode_=priorityNode_;this.indexMap_=indexMap_;this.lazyHash_=null;if(this.priorityNode_){snap_1.validatePriorityNode(this.priorityNode_)}if(this.children_.isEmpty()){util_1.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}}Object.defineProperty(ChildrenNode,"EMPTY_NODE",{get:function(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR),null,IndexMap_1.IndexMap.Default))},enumerable:true,configurable:true});ChildrenNode.prototype.isLeafNode=function(){return false};ChildrenNode.prototype.getPriority=function(){return this.priorityNode_||EMPTY_NODE};ChildrenNode.prototype.updatePriority=function(newPriorityNode){if(this.children_.isEmpty()){return this}else{return new ChildrenNode(this.children_,newPriorityNode,this.indexMap_)}};ChildrenNode.prototype.getImmediateChild=function(childName){if(childName===".priority"){return this.getPriority()}else{var child=this.children_.get(childName);return child===null?EMPTY_NODE:child}};ChildrenNode.prototype.getChild=function(path){var front=path.getFront();if(front===null)return this;return this.getImmediateChild(front).getChild(path.popFront())};ChildrenNode.prototype.hasChild=function(childName){return this.children_.get(childName)!==null};ChildrenNode.prototype.updateImmediateChild=function(childName,newChildNode){util_1.assert(newChildNode,"We should always be passing snapshot nodes");if(childName===".priority"){return this.updatePriority(newChildNode)}else{var namedNode=new Node_1.NamedNode(childName,newChildNode);var newChildren=void 0,newIndexMap=void 0,newPriority=void 0;if(newChildNode.isEmpty()){newChildren=this.children_.remove(childName);newIndexMap=this.indexMap_.removeFromIndexes(namedNode,this.children_)}else{newChildren=this.children_.insert(childName,newChildNode);newIndexMap=this.indexMap_.addToIndexes(namedNode,this.children_)}newPriority=newChildren.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(newChildren,newPriority,newIndexMap)}};ChildrenNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();if(front===null){return newChildNode}else{util_1.assert(path.getFront()!==".priority"||path.getLength()===1,".priority must be the last token in a path");var newImmediateChild=this.getImmediateChild(front).updateChild(path.popFront(),newChildNode);return this.updateImmediateChild(front,newImmediateChild)}};ChildrenNode.prototype.isEmpty=function(){return this.children_.isEmpty()};ChildrenNode.prototype.numChildren=function(){return this.children_.count()};ChildrenNode.prototype.val=function(exportFormat){if(this.isEmpty())return null;var obj={};var numKeys=0,maxKey=0,allIntegerKeys=true;this.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){obj[key]=childNode.val(exportFormat);numKeys++;if(allIntegerKeys&&ChildrenNode.INTEGER_REGEXP_.test(key)){maxKey=Math.max(maxKey,Number(key))}else{allIntegerKeys=false}});if(!exportFormat&&allIntegerKeys&&maxKey<2*numKeys){var array=[];for(var key in obj)array[key]=obj[key];return array}else{if(exportFormat&&!this.getPriority().isEmpty()){obj[".priority"]=this.getPriority().val()}return obj}};ChildrenNode.prototype.hash=function(){if(this.lazyHash_===null){var toHash_1="";if(!this.getPriority().isEmpty())toHash_1+="priority:"+snap_1.priorityHashText(this.getPriority().val())+":";this.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){var childHash=childNode.hash();if(childHash!=="")toHash_1+=":"+key+":"+childHash});this.lazyHash_=toHash_1===""?"":util_2.sha1(toHash_1)}return this.lazyHash_};ChildrenNode.prototype.getPredecessorChildName=function(childName,childNode,index){var idx=this.resolveIndex_(index);if(idx){var predecessor=idx.getPredecessorKey(new Node_1.NamedNode(childName,childNode));return predecessor?predecessor.name:null}else{return this.children_.getPredecessorKey(childName)}};ChildrenNode.prototype.getFirstChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var minKey=idx.minKey();return minKey&&minKey.name}else{return this.children_.minKey()}};ChildrenNode.prototype.getFirstChild=function(indexDefinition){var minKey=this.getFirstChildName(indexDefinition);if(minKey){return new Node_1.NamedNode(minKey,this.children_.get(minKey))}else{return null}};ChildrenNode.prototype.getLastChildName=function(indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){var maxKey=idx.maxKey();return maxKey&&maxKey.name}else{return this.children_.maxKey()}};ChildrenNode.prototype.getLastChild=function(indexDefinition){var maxKey=this.getLastChildName(indexDefinition);if(maxKey){return new Node_1.NamedNode(maxKey,this.children_.get(maxKey))}else{return null}};ChildrenNode.prototype.forEachChild=function(index,action){var idx=this.resolveIndex_(index);if(idx){return idx.inorderTraversal(function(wrappedNode){return action(wrappedNode.name,wrappedNode.node)})}else{return this.children_.inorderTraversal(action)}};ChildrenNode.prototype.getIterator=function(indexDefinition){return this.getIteratorFrom(indexDefinition.minPost(),indexDefinition)};ChildrenNode.prototype.getIteratorFrom=function(startPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){return idx.getIteratorFrom(startPost,function(key){return key})}else{var iterator=this.children_.getIteratorFrom(startPost.name,Node_1.NamedNode.Wrap);var next=iterator.peek();while(next!=null&&indexDefinition.compare(next,startPost)<0){iterator.getNext();next=iterator.peek()}return iterator}};ChildrenNode.prototype.getReverseIterator=function(indexDefinition){return this.getReverseIteratorFrom(indexDefinition.maxPost(),indexDefinition)};ChildrenNode.prototype.getReverseIteratorFrom=function(endPost,indexDefinition){var idx=this.resolveIndex_(indexDefinition);if(idx){return idx.getReverseIteratorFrom(endPost,function(key){return key})}else{var iterator=this.children_.getReverseIteratorFrom(endPost.name,Node_1.NamedNode.Wrap);var next=iterator.peek();while(next!=null&&indexDefinition.compare(next,endPost)>0){iterator.getNext();next=iterator.peek()}return iterator}};ChildrenNode.prototype.compareTo=function(other){if(this.isEmpty()){if(other.isEmpty()){return 0}else{return-1}}else if(other.isLeafNode()||other.isEmpty()){return 1}else if(other===exports.MAX_NODE){return-1}else{return 0}};ChildrenNode.prototype.withIndex=function(indexDefinition){if(indexDefinition===KeyIndex_1.KEY_INDEX||this.indexMap_.hasIndex(indexDefinition)){return this}else{var newIndexMap=this.indexMap_.addIndex(indexDefinition,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,newIndexMap)}};ChildrenNode.prototype.isIndexed=function(index){return index===KeyIndex_1.KEY_INDEX||this.indexMap_.hasIndex(index)};ChildrenNode.prototype.equals=function(other){if(other===this){return true}else if(other.isLeafNode()){return false}else{var otherChildrenNode=other;if(!this.getPriority().equals(otherChildrenNode.getPriority())){return false}else if(this.children_.count()===otherChildrenNode.children_.count()){var thisIter=this.getIterator(PriorityIndex_1.PRIORITY_INDEX);var otherIter=otherChildrenNode.getIterator(PriorityIndex_1.PRIORITY_INDEX);var thisCurrent=thisIter.getNext();var otherCurrent=otherIter.getNext();while(thisCurrent&&otherCurrent){if(thisCurrent.name!==otherCurrent.name||!thisCurrent.node.equals(otherCurrent.node)){return false}thisCurrent=thisIter.getNext();otherCurrent=otherIter.getNext()}return thisCurrent===null&&otherCurrent===null}else{return false}}};ChildrenNode.prototype.resolveIndex_=function(indexDefinition){if(indexDefinition===KeyIndex_1.KEY_INDEX){return null}else{return this.indexMap_.get(indexDefinition.toString())}};ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;return ChildrenNode}();exports.ChildrenNode=ChildrenNode;var MaxNode=function(_super){__extends(MaxNode,_super);function MaxNode(){return _super.call(this,new SortedMap_1.SortedMap(comparators_1.NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap_1.IndexMap.Default)||this}MaxNode.prototype.compareTo=function(other){if(other===this){return 0}else{return 1}};MaxNode.prototype.equals=function(other){return other===this};MaxNode.prototype.getPriority=function(){return this};MaxNode.prototype.getImmediateChild=function(childName){return ChildrenNode.EMPTY_NODE};MaxNode.prototype.isEmpty=function(){return false};return MaxNode}(ChildrenNode);exports.MaxNode=MaxNode;exports.MAX_NODE=new MaxNode;Object.defineProperties(Node_1.NamedNode,{MIN:{value:new Node_1.NamedNode(util_2.MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new Node_1.NamedNode(util_2.MAX_NAME,exports.MAX_NODE)}});KeyIndex_1.KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE;LeafNode_1.LeafNode.__childrenNodeConstructor=ChildrenNode;snap_1.setMaxNode(exports.MAX_NODE);PriorityIndex_1.setMaxNode(exports.MAX_NODE)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var NamedNode=function(){function NamedNode(name,node){this.name=name;this.node=node}NamedNode.Wrap=function(name,node){return new NamedNode(name,node)};return NamedNode}();exports.NamedNode=NamedNode},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=isDef;__webpack_exports__["c"]=isJustDef;__webpack_exports__["b"]=isFunction;__webpack_exports__["i"]=isObject;__webpack_exports__["g"]=isNonNullObject;__webpack_exports__["f"]=isNonArrayObject;__webpack_exports__["j"]=isString;__webpack_exports__["h"]=isNumber;__webpack_exports__["d"]=isNativeBlob;__webpack_exports__["e"]=isNativeBlobDefined;function isDef(p){return p!=null}function isJustDef(p){return p!==void 0}function isFunction(p){return typeof p==="function"}function isObject(p){return typeof p==="object"}function isNonNullObject(p){return isObject(p)&&p!==null}function isNonArrayObject(p){return isObject(p)&&!Array.isArray(p)}function isString(p){return typeof p==="string"||p instanceof String}function isNumber(p){return typeof p==="number"||p instanceof Number}function isNativeBlob(p){return isNativeBlobDefined()&&p instanceof Blob}function isNativeBlobDefined(){return typeof Blob!=="undefined"}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NamedObject=void 0;var _cname=__webpack_require__(55);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var NamedObject=function(){function NamedObject(name){_classCallCheck(this,NamedObject);this._name=name;this._nameObj=new _cname.CName(name)}_createClass(NamedObject,[{key:"getFrameName",value:function getFrameName(){return this._nameObj.getName(0)}},{key:"getDataSourceName",value:function getDataSourceName(){return this._nameObj.getName(1)}},{key:"getAreaName",value:function getAreaName(){return this._nameObj.getName(2)}},{key:"getName",value:function getName(){return this._nameObj.getName(-1)}},{key:"getNameObject",value:function getNameObject(){return this._nameObj}},{key:"getRectCrossPt",value:function getRectCrossPt(rect,startPt,endPt){var crossPt;var firstPt={x:-1,y:-1};var secondPt={x:-1,y:-1};var xdiff=endPt.x-startPt.x;var ydiff=endPt.y-startPt.y;if(Math.abs(xdiff)<2){firstPt={x:startPt.x,y:rect.top};secondPt={x:endPt.x,y:rect.bottom};crossPt=[firstPt,secondPt];return crossPt}var k=ydiff/xdiff;secondPt.x=rect.right;secondPt.y=startPt.y+(rect.right-startPt.x)*k;firstPt.x=rect.left;firstPt.y=startPt.y+(rect.left-startPt.x)*k;crossPt=[firstPt,secondPt];return crossPt}}]);return NamedObject}();exports.NamedObject=NamedObject},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Code});__webpack_exports__["s"]=unknown;__webpack_exports__["m"]=objectNotFound;__webpack_exports__["n"]=quotaExceeded;__webpack_exports__["q"]=unauthenticated;__webpack_exports__["r"]=unauthorized;__webpack_exports__["o"]=retryLimitExceeded;__webpack_exports__["c"]=canceled;__webpack_exports__["k"]=invalidUrl;__webpack_exports__["h"]=invalidDefaultBucket;__webpack_exports__["d"]=cannotSliceBlob;__webpack_exports__["p"]=serverFileWrongSize;__webpack_exports__["l"]=noDownloadURL;__webpack_exports__["f"]=invalidArgument;__webpack_exports__["g"]=invalidArgumentCount;__webpack_exports__["b"]=appDeleted;__webpack_exports__["j"]=invalidRootOperation;__webpack_exports__["i"]=invalidFormat;__webpack_exports__["e"]=internalError;var __WEBPACK_IMPORTED_MODULE_0__constants__=__webpack_require__(34);var FirebaseStorageError=function(){function FirebaseStorageError(code,message){this.code_=prependCode(code);this.message_="Firebase Storage: "+message;this.serverResponse_=null;this.name_="FirebaseError"}FirebaseStorageError.prototype.codeProp=function(){return this.code};FirebaseStorageError.prototype.codeEquals=function(code){return prependCode(code)===this.codeProp()};FirebaseStorageError.prototype.serverResponseProp=function(){return this.serverResponse_};FirebaseStorageError.prototype.setServerResponseProp=function(serverResponse){this.serverResponse_=serverResponse};Object.defineProperty(FirebaseStorageError.prototype,"name",{get:function(){return this.name_},enumerable:true,configurable:true});Object.defineProperty(FirebaseStorageError.prototype,"code",{get:function(){return this.code_},enumerable:true,configurable:true});Object.defineProperty(FirebaseStorageError.prototype,"message",{get:function(){return this.message_},enumerable:true,configurable:true});Object.defineProperty(FirebaseStorageError.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:true,configurable:true});return FirebaseStorageError}();var errors={};var Code={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function prependCode(code){return"storage/"+code}function unknown(){var message="An unknown error occurred, please check the error payload for "+"server response.";return new FirebaseStorageError(Code.UNKNOWN,message)}
function objectNotFound(path){return new FirebaseStorageError(Code.OBJECT_NOT_FOUND,"Object '"+path+"' does not exist.")}function bucketNotFound(bucket){return new FirebaseStorageError(Code.BUCKET_NOT_FOUND,"Bucket '"+bucket+"' does not exist.")}function projectNotFound(project){return new FirebaseStorageError(Code.PROJECT_NOT_FOUND,"Project '"+project+"' does not exist.")}function quotaExceeded(bucket){return new FirebaseStorageError(Code.QUOTA_EXCEEDED,"Quota for bucket '"+bucket+"' exceeded, please view quota on "+"https://firebase.google.com/pricing/.")}function unauthenticated(){var message="User is not authenticated, please authenticate using Firebase "+"Authentication and try again.";return new FirebaseStorageError(Code.UNAUTHENTICATED,message)}function unauthorized(path){return new FirebaseStorageError(Code.UNAUTHORIZED,"User does not have permission to access '"+path+"'.")}function retryLimitExceeded(){return new FirebaseStorageError(Code.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function invalidChecksum(path,checksum,calculated){return new FirebaseStorageError(Code.INVALID_CHECKSUM,"Uploaded/downloaded object '"+path+"' has checksum '"+checksum+"' which does not match '"+calculated+"'. Please retry the upload/download.")}function canceled(){return new FirebaseStorageError(Code.CANCELED,"User canceled the upload/download.")}function invalidEventName(name){return new FirebaseStorageError(Code.INVALID_EVENT_NAME,"Invalid event name '"+name+"'.")}function invalidUrl(url){return new FirebaseStorageError(Code.INVALID_URL,"Invalid URL '"+url+"'.")}function invalidDefaultBucket(bucket){return new FirebaseStorageError(Code.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+bucket+"'.")}function noDefaultBucket(){return new FirebaseStorageError(Code.NO_DEFAULT_BUCKET,"No default bucket "+"found. Did you set the '"+__WEBPACK_IMPORTED_MODULE_0__constants__["c"]+"' property when initializing the app?")}function cannotSliceBlob(){return new FirebaseStorageError(Code.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function serverFileWrongSize(){return new FirebaseStorageError(Code.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function noDownloadURL(){return new FirebaseStorageError(Code.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function invalidArgument(index,fnName,message){return new FirebaseStorageError(Code.INVALID_ARGUMENT,"Invalid argument in `"+fnName+"` at index "+index+": "+message)}function invalidArgumentCount(argMin,argMax,fnName,real){var countPart;var plural;if(argMin===argMax){countPart=argMin;plural=argMin===1?"argument":"arguments"}else{countPart="between "+argMin+" and "+argMax;plural="arguments"}return new FirebaseStorageError(Code.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+fnName+"`: Expected "+countPart+" "+plural+", received "+real+".")}function appDeleted(){return new FirebaseStorageError(Code.APP_DELETED,"The Firebase app was deleted.")}function invalidRootOperation(name){return new FirebaseStorageError(Code.INVALID_ROOT_OPERATION,"The operation '"+name+"' cannot be performed on a root reference, create a non-root "+"reference using child, such as .child('file.png').")}function invalidFormat(format,message){return new FirebaseStorageError(Code.INVALID_FORMAT,"String does not match format '"+format+"': "+message)}function internalError(message){throw new FirebaseStorageError(Code.INTERNAL_ERROR,"Internal error: "+message)}},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});__webpack_require__.d(__webpack_exports__,"firebase",function(){return firebase});var __WEBPACK_IMPORTED_MODULE_0__src_firebaseApp__=__webpack_require__(131);var firebase=Object(__WEBPACK_IMPORTED_MODULE_0__src_firebaseApp__["a"])();__webpack_exports__["default"]=firebase},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MainDataSource=exports.DataSource=void 0;var _named_object=__webpack_require__(8);var _ctool_manager=__webpack_require__(101);var _kline=_interopRequireDefault(__webpack_require__(15));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DataSource=function(_NamedObject){_inherits(DataSource,_NamedObject);function DataSource(name){_classCallCheck(this,DataSource);return _possibleConstructorReturn(this,(DataSource.__proto__||Object.getPrototypeOf(DataSource)).call(this,name))}_createClass(DataSource,[{key:"getUpdateMode",value:function getUpdateMode(){return this._updateMode}},{key:"setUpdateMode",value:function setUpdateMode(mode){this._updateMode=mode}},{key:"getCacheSize",value:function getCacheSize(){return 0}},{key:"getDataCount",value:function getDataCount(){return 0}},{key:"getDataAt",value:function getDataAt(index){return this._dataItems[index]}}]);return DataSource}(_named_object.NamedObject);exports.DataSource=DataSource;DataSource.UpdateMode={DoNothing:0,Refresh:1,Update:2,Append:3};var MainDataSource=function(_DataSource){_inherits(MainDataSource,_DataSource);function MainDataSource(name){var _this;_classCallCheck(this,MainDataSource);_this=_possibleConstructorReturn(this,(MainDataSource.__proto__||Object.getPrototypeOf(MainDataSource)).call(this,name));_this._erasedCount=0;_this._dataItems=[];_this._decimalDigits=0;_this.toolManager=new _ctool_manager.CToolManager(name);return _this}_createClass(MainDataSource,[{key:"getCacheSize",value:function getCacheSize(){return this._dataItems.length}},{key:"getDataCount",value:function getDataCount(){return this._dataItems.length}},{key:"getUpdatedCount",value:function getUpdatedCount(){return this._updatedCount}},{key:"getAppendedCount",value:function getAppendedCount(){return this._appendedCount}},{key:"getErasedCount",value:function getErasedCount(){return this._erasedCount}},{key:"getDecimalDigits",value:function getDecimalDigits(){return this._decimalDigits}},{key:"calcDecimalDigits",value:function calcDecimalDigits(v){var str=""+v;var i=str.indexOf(".");if(i<0){return 0}return str.length-1-i}},{key:"getLastDate",value:function getLastDate(){var count=this.getDataCount();if(count<1){return-1}return this.getDataAt(count-1).date}},{key:"getDataAt",value:function getDataAt(index){return this._dataItems[index]}},{key:"update",value:function update(data){this._updatedCount=0;this._appendedCount=0;this._erasedCount=0;var len=this._dataItems.length;if(len>0){var lastIndex=len-1;var lastItem=this._dataItems[lastIndex];var _e,_i,_cnt=data.length;for(_i=0;_i<_cnt;_i++){_e=data[_i];if(_e[0]===lastItem.date){if(lastItem.open===_e[1]&&lastItem.high===_e[2]&&lastItem.low===_e[3]&&lastItem.close===_e[4]&&lastItem.volume===_e[5]){this.setUpdateMode(DataSource.UpdateMode.DoNothing)}else{this.setUpdateMode(DataSource.UpdateMode.Update);this._dataItems[lastIndex]={date:_e[0],open:_e[1],high:_e[2],low:_e[3],close:_e[4],volume:_e[5]};this._updatedCount++}_i++;if(_i<_cnt){this.setUpdateMode(DataSource.UpdateMode.Append);for(;_i<_cnt;_i++,this._appendedCount++){_e=data[_i];this._dataItems.push({date:_e[0],open:_e[1],high:_e[2],low:_e[3],close:_e[4],volume:_e[5]})}}return true}}if(_cnt<_kline.default.instance.limit){this.setUpdateMode(DataSource.UpdateMode.DoNothing);return false}}this.setUpdateMode(DataSource.UpdateMode.Refresh);this._dataItems=[];var d,n,e,i,cnt=data.length;for(i=0;i<cnt;i++){e=data[i];for(n=1;n<=4;n++){d=this.calcDecimalDigits(e[n]);if(this._decimalDigits<d)this._decimalDigits=d}this._dataItems.push({date:e[0],open:e[1],high:e[2],low:e[3],close:e[4],volume:e[5]})}return true}},{key:"select",value:function select(id){this.toolManager.selecedObject=id}},{key:"unselect",value:function unselect(){this.toolManager.selecedObject=-1}},{key:"addToolObject",value:function addToolObject(toolObject){this.toolManager.addToolObject(toolObject)}},{key:"delToolObject",value:function delToolObject(){this.toolManager.delCurrentObject()}},{key:"getToolObject",value:function getToolObject(index){return this.toolManager.getToolObject(index)}},{key:"getToolObjectCount",value:function getToolObjectCount(){return this.toolManager.toolObjects.length}},{key:"getCurrentToolObject",value:function getCurrentToolObject(){return this.toolManager.getCurrentObject()}},{key:"getSelectToolObjcet",value:function getSelectToolObjcet(){return this.toolManager.getSelectedObject()}},{key:"delSelectToolObject",value:function delSelectToolObject(){this.toolManager.delSelectedObject()}}]);return MainDataSource}(DataSource);exports.MainDataSource=MainDataSource},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Path_1=__webpack_require__(2);var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var util_3=__webpack_require__(0);var util_4=__webpack_require__(0);exports.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/;exports.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/;exports.MAX_LEAF_SIZE_=10*1024*1024;exports.isValidKey=function(key){return typeof key==="string"&&key.length!==0&&!exports.INVALID_KEY_REGEX_.test(key)};exports.isValidPathString=function(pathString){return typeof pathString==="string"&&pathString.length!==0&&!exports.INVALID_PATH_REGEX_.test(pathString)};exports.isValidRootPathString=function(pathString){if(pathString){pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")}return exports.isValidPathString(pathString)};exports.isValidPriority=function(priority){return priority===null||typeof priority==="string"||typeof priority==="number"&&!util_2.isInvalidJSONNumber(priority)||priority&&typeof priority==="object"&&util_1.contains(priority,".sv")};exports.validateFirebaseDataArg=function(fnName,argumentNumber,data,path,optional){if(optional&&data===undefined)return;exports.validateFirebaseData(util_3.errorPrefix(fnName,argumentNumber,optional),data,path)};exports.validateFirebaseData=function(errorPrefix,data,path_){var path=path_ instanceof Path_1.Path?new Path_1.ValidationPath(path_,errorPrefix):path_;if(data===undefined){throw new Error(errorPrefix+"contains undefined "+path.toErrorString())}if(typeof data==="function"){throw new Error(errorPrefix+"contains a function "+path.toErrorString()+" with contents = "+data.toString())}if(util_2.isInvalidJSONNumber(data)){throw new Error(errorPrefix+"contains "+data.toString()+" "+path.toErrorString())}if(typeof data==="string"&&data.length>exports.MAX_LEAF_SIZE_/3&&util_4.stringLength(data)>exports.MAX_LEAF_SIZE_){throw new Error(errorPrefix+"contains a string greater than "+exports.MAX_LEAF_SIZE_+" utf8 bytes "+path.toErrorString()+" ('"+data.substring(0,50)+"...')")}if(data&&typeof data==="object"){var hasDotValue_1=false,hasActualChild_1=false;util_1.forEach(data,function(key,value){if(key===".value"){hasDotValue_1=true}else if(key!==".priority"&&key!==".sv"){hasActualChild_1=true;if(!exports.isValidKey(key)){throw new Error(errorPrefix+" contains an invalid key ("+key+") "+path.toErrorString()+".  Keys must be non-empty strings "+'and can\'t contain ".", "#", "$", "/", "[", or "]"')}}path.push(key);exports.validateFirebaseData(errorPrefix,value,path);path.pop()});if(hasDotValue_1&&hasActualChild_1){throw new Error(errorPrefix+' contains ".value" child '+path.toErrorString()+" in addition to actual children.")}}};exports.validateFirebaseMergePaths=function(errorPrefix,mergePaths){var i,curPath;for(i=0;i<mergePaths.length;i++){curPath=mergePaths[i];var keys=curPath.slice();for(var j=0;j<keys.length;j++){if(keys[j]===".priority"&&j===keys.length-1){}else if(!exports.isValidKey(keys[j])){throw new Error(errorPrefix+"contains an invalid key ("+keys[j]+") in path "+curPath.toString()+". Keys must be non-empty strings "+'and can\'t contain ".", "#", "$", "/", "[", or "]"')}}}mergePaths.sort(Path_1.Path.comparePaths);var prevPath=null;for(i=0;i<mergePaths.length;i++){curPath=mergePaths[i];if(prevPath!==null&&prevPath.contains(curPath)){throw new Error(errorPrefix+"contains a path "+prevPath.toString()+" that is ancestor of another path "+curPath.toString())}prevPath=curPath}};exports.validateFirebaseMergeDataArg=function(fnName,argumentNumber,data,path,optional){if(optional&&data===undefined)return;var errorPrefix=util_3.errorPrefix(fnName,argumentNumber,optional);if(!(data&&typeof data==="object")||Array.isArray(data)){throw new Error(errorPrefix+" must be an object containing the children to replace.")}var mergePaths=[];util_1.forEach(data,function(key,value){var curPath=new Path_1.Path(key);exports.validateFirebaseData(errorPrefix,value,path.child(curPath));if(curPath.getBack()===".priority"){if(!exports.isValidPriority(value)){throw new Error(errorPrefix+"contains an invalid value for '"+curPath.toString()+"', which must be a valid "+"Firebase priority (a string, finite number, server value, or null).")}}mergePaths.push(curPath)});exports.validateFirebaseMergePaths(errorPrefix,mergePaths)};exports.validatePriority=function(fnName,argumentNumber,priority,optional){if(optional&&priority===undefined)return;if(util_2.isInvalidJSONNumber(priority))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"is "+priority.toString()+", but must be a valid Firebase priority (a string, finite number, "+"server value, or null).");if(!exports.isValidPriority(priority))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid Firebase priority "+"(a string, finite number, server value, or null).")};exports.validateEventType=function(fnName,argumentNumber,eventType,optional){if(optional&&eventType===undefined)return;switch(eventType){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must be a valid event type = "value", "child_added", "child_removed", '+'"child_changed", or "child_moved".')}};exports.validateKey=function(fnName,argumentNumber,key,optional){if(optional&&key===undefined)return;if(!exports.isValidKey(key))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'was an invalid key = "'+key+'".  Firebase keys must be non-empty strings and '+'can\'t contain ".", "#", "$", "/", "[", or "]").')};exports.validatePathString=function(fnName,argumentNumber,pathString,optional){if(optional&&pathString===undefined)return;if(!exports.isValidPathString(pathString))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'was an invalid path = "'+pathString+'". Paths must be non-empty strings and '+'can\'t contain ".", "#", "$", "[", or "]"')};exports.validateRootPathString=function(fnName,argumentNumber,pathString,optional){if(pathString){pathString=pathString.replace(/^\/*\.info(\/|$)/,"/")}exports.validatePathString(fnName,argumentNumber,pathString,optional)};exports.validateWritablePath=function(fnName,path){if(path.getFront()===".info"){throw new Error(fnName+" failed = Can't modify data under /.info/")}};exports.validateUrl=function(fnName,argumentNumber,parsedUrl){var pathString=parsedUrl.path.toString();if(!(typeof parsedUrl.repoInfo.host==="string")||parsedUrl.repoInfo.host.length===0||!exports.isValidKey(parsedUrl.repoInfo.namespace)||pathString.length!==0&&!exports.isValidRootPathString(pathString)){throw new Error(util_3.errorPrefix(fnName,argumentNumber,false)+"must be a valid firebase URL and "+'the path can\'t contain ".", "#", "$", "[", or "]".')}};exports.validateCredential=function(fnName,argumentNumber,cred,optional){if(optional&&cred===undefined)return;if(!(typeof cred==="string"))throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid credential (a string).")};exports.validateBoolean=function(fnName,argumentNumber,bool,optional){if(optional&&bool===undefined)return;if(typeof bool!=="boolean")throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a boolean.")};exports.validateString=function(fnName,argumentNumber,string,optional){if(optional&&string===undefined)return;if(!(typeof string==="string")){throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid string.")}};exports.validateObject=function(fnName,argumentNumber,obj,optional){if(optional&&obj===undefined)return;if(!(obj&&typeof obj==="object")||obj===null){throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+"must be a valid object.")}};exports.validateObjectContainsKey=function(fnName,argumentNumber,obj,key,optional,opt_type){var objectContainsKey=obj&&typeof obj==="object"&&util_1.contains(obj,key);if(!objectContainsKey){if(optional){return}else{throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must contain the key "'+key+'"')}}if(opt_type){var val=util_1.safeGet(obj,key);if(opt_type==="number"&&!(typeof val==="number")||opt_type==="string"&&!(typeof val==="string")||opt_type==="boolean"&&!(typeof val==="boolean")||opt_type==="function"&&!(typeof val==="function")||opt_type==="object"&&!(typeof val==="object")&&val){if(optional){throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'contains invalid value for key "'+key+'" (must be of type "'+opt_type+'")')}else{throw new Error(util_3.errorPrefix(fnName,argumentNumber,optional)+'must contain the key "'+key+'" with type "'+opt_type+'"')}}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var OperationType;(function(OperationType){OperationType[OperationType["OVERWRITE"]=0]="OVERWRITE";OperationType[OperationType["MERGE"]=1]="MERGE";OperationType[OperationType["ACK_USER_WRITE"]=2]="ACK_USER_WRITE";OperationType[OperationType["LISTEN_COMPLETE"]=3]="LISTEN_COMPLETE"})(OperationType=exports.OperationType||(exports.OperationType={}));var OperationSource=function(){function OperationSource(fromUser,fromServer,queryId,tagged){this.fromUser=fromUser;this.fromServer=fromServer;this.queryId=queryId;this.tagged=tagged;util_1.assert(!tagged||fromServer,"Tagged queries must be from server.")}OperationSource.User=new OperationSource(true,false,null,false);OperationSource.Server=new OperationSource(false,true,null,false);OperationSource.forServerTaggedQuery=function(queryId){return new OperationSource(false,true,queryId,true)};return OperationSource}();exports.OperationSource=OperationSource},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=make;__webpack_exports__["c"]=resolve;__webpack_exports__["b"]=reject;function make(resolver){return new Promise(resolver)}function resolve(value){return Promise.resolve(value)}function reject(error){return Promise.reject(error)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _control=__webpack_require__(36);var _kline_trade=__webpack_require__(54);var _chart_manager=__webpack_require__(3);var _chart_settings=__webpack_require__(18);var _templates=__webpack_require__(25);__webpack_require__(105);var _tpl=_interopRequireDefault(__webpack_require__(120));var _firebase=_interopRequireDefault(__webpack_require__(121));var _jquery=_interopRequireDefault(__webpack_require__(59));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Kline=function(){function Kline(option){_classCallCheck(this,Kline);this.element="#kline_container";this.chartMgr=null;this.G_HTTP_REQUEST=null;this.timer=null;this.buttonDown=false;this.init=false;this.requestParam="";this.data={};this.width=1200;this.height=650;this.symbol="";this.symbolName="";this.range=null;this.url="";this.limit=1e3;this.type="poll";this.subscribePath="";this.sendPath="";this.stompClient=null;this.intervalTime=5e3;this.debug=true;this.language="zh-cn";this.theme="dark";this.ranges=["1M","1w","1d","12h","6h","4h","2h","1h","30m","15m","5m","1m","line"];this.showTrade=true;this.tradeWidth=250;this.socketConnected=false;this.enableSockjs=true;this.reverseColor=false;this.isSized=false;this.paused=false;this.subscribed=null;this.disableFirebase=true;this.periodMap={"1M":30*86400*1e3,"01w":7*86400*1e3,"03d":3*86400*1e3,"01d":86400*1e3,"12h":12*3600*1e3,"06h":6*3600*1e3,"04h":4*3600*1e3,"02h":2*3600*1e3,"01h":3600*1e3,"30m":30*60*1e3,"15m":15*60*1e3,"05m":5*60*1e3,"03m":3*60*1e3,"01m":60*1e3,line:60*1e3};this.tagMapPeriod={"1M":"1M","1w":"01w","3d":"03d","1d":"01d","12h":"12h","6h":"06h","4h":"04h","2h":"02h","1h":"01h","30m":"30m","15m":"15m","5m":"05m","3m":"03m","1m":"01m",line:"line"};Object.assign(this,option);if(!Kline.created){Kline.instance=this;Kline.created=true}return Kline.instance}_createClass(Kline,[{key:"draw",value:function draw(){Kline.trade=new _kline_trade.KlineTrade;Kline.chartMgr=new _chart_manager.ChartManager;var view=_jquery.default.parseHTML(_tpl.default);for(var k in this.ranges){var res=(0,_jquery.default)(view).find('[name="'+this.ranges[k]+'"]');res.each(function(i,e){(0,_jquery.default)(e).attr("style","display:inline-block")})}(0,_jquery.default)(this.element).html(view);setInterval(_control.Control.refreshFunction,this.intervalTime);if(this.type==="stomp"){_control.Control.socketConnect()}if(!this.disableFirebase){(0,_firebase.default)()}this.registerMouseEvent();_chart_manager.ChartManager.instance.bindCanvas("main",document.getElementById("chart_mainCanvas"));_chart_manager.ChartManager.instance.bindCanvas("overlay",document.getElementById("chart_overlayCanvas"));_control.Control.refreshTemplate();_control.Control.onSize(this.width,this.height);_control.Control.readCookie();this.setTheme(this.theme);this.setLanguage(this.language);(0,_jquery.default)(this.element).css({visibility:"visible"})}},{key:"resize",value:function resize(width,height){this.width=width;this.height=height;_control.Control.onSize(this.width,this.height)}},{key:"setSymbol",value:function setSymbol(symbol,symbolName){this.symbol=symbol;this.symbolName=symbolName;_control.Control.switchSymbol(symbol);this.onSymbolChange(symbol,symbolName)}},{key:"setTheme",value:function setTheme(style){this.theme=style;_control.Control.switchTheme(style)}},{key:"setLanguage",value:function setLanguage(lang){this.language=lang;_control.Control.chartSwitchLanguage(lang)}},{key:"setShowTrade",value:function setShowTrade(isShow){this.showTrade=isShow;if(isShow){(0,_jquery.default)(".trade_container").show()}else{(0,_jquery.default)(".trade_container").hide()}_control.Control.onSize(this.width,this.height)}},{key:"toggleTrade",value:function toggleTrade(){if(!this.showTrade){this.showTrade=true;(0,_jquery.default)(".trade_container").show()}else{this.showTrade=false;(0,_jquery.default)(".trade_container").hide()}_control.Control.onSize(this.width,this.height)}},{key:"setIntervalTime",value:function setIntervalTime(intervalTime){this.intervalTime=intervalTime;if(this.debug){console.log("DEBUG: interval time changed to "+intervalTime)}}},{key:"pause",value:function pause(){if(this.debug){console.log("DEBUG: kline paused")}this.paused=true}},{key:"resend",value:function resend(){if(this.debug){console.log("DEBUG: kline continue")}this.paused=false;_control.Control.requestData(true)}},{key:"connect",value:function connect(){if(this.type!=="stomp"){if(this.debug){console.log("DEBUG: this is for stomp type")}return}_control.Control.socketConnect()}},{key:"disconnect",value:function disconnect(){if(this.type!=="stomp"){if(this.debug){console.log("DEBUG: this is for stomp type")}return}if(this.stompClient){this.stompClient.disconnect();this.socketConnected=false}if(this.debug){console.log("DEBUG: socket disconnected")}}},{key:"onResize",value:function onResize(width,height){if(this.debug){console.log("DEBUG: chart resized to width: "+width+" height: "+height)}}},{key:"onLangChange",value:function onLangChange(lang){if(this.debug){console.log("DEBUG: language changed to "+lang)}}},{key:"onSymbolChange",value:function onSymbolChange(symbol,symbolName){if(this.debug){console.log("DEBUG: symbol changed to "+symbol+" "+symbolName)}}},{key:"onThemeChange",value:function onThemeChange(theme){if(this.debug){console.log("DEBUG: themes changed to : "+theme)}}},{key:"onRangeChange",value:function onRangeChange(range){if(this.debug){console.log("DEBUG: range changed to "+range)}}},{key:"registerMouseEvent",value:function registerMouseEvent(){(0,_jquery.default)(document).ready(function(){function __resize(){if(navigator.userAgent.indexOf("Firefox")>=0){setTimeout(function(){_control.Control.onSize(this.width,this.height)},200)}else{_control.Control.onSize(this.width,this.height)}}(0,_jquery.default)("#chart_overlayCanvas").bind("contextmenu",function(e){e.cancelBubble=true;e.returnValue=false;e.preventDefault();e.stopPropagation();return false});(0,_jquery.default)(".chart_container .chart_dropdown .chart_dropdown_t").mouseover(function(){var container=(0,_jquery.default)(".chart_container");var title=(0,_jquery.default)(this);var dropdown=title.next();var containerLeft=container.offset().left;var titleLeft=title.offset().left;var containerWidth=container.width();var titleWidth=title.width();var dropdownWidth=dropdown.width();var d=(dropdownWidth-titleWidth)/2<<0;if(titleLeft-d<containerLeft+4){d=titleLeft-containerLeft-4}else if(titleLeft+titleWidth+d>containerLeft+containerWidth-4){d+=titleLeft+titleWidth+d-(containerLeft+containerWidth-4)+19}else{d+=4}dropdown.css({"margin-left":-d});title.addClass("chart_dropdown-hover");dropdown.addClass("chart_dropdown-hover")}).mouseout(function(){(0,_jquery.default)(this).next().removeClass("chart_dropdown-hover");(0,_jquery.default)(this).removeClass("chart_dropdown-hover")});(0,_jquery.default)(".chart_dropdown_data").mouseover(function(){(0,_jquery.default)(this).addClass("chart_dropdown-hover");(0,_jquery.default)(this).prev().addClass("chart_dropdown-hover")}).mouseout(function(){(0,_jquery.default)(this).prev().removeClass("chart_dropdown-hover");(0,_jquery.default)(this).removeClass("chart_dropdown-hover")});(0,_jquery.default)("#chart_btn_parameter_settings").click(function(){(0,_jquery.default)("#chart_parameter_settings").addClass("clicked");(0,_jquery.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover");(0,_jquery.default)("#chart_parameter_settings").find("th").each(function(){var name=(0,_jquery.default)(this).html();var index=0;var tmp=_chart_settings.ChartSettings.get();var value=tmp.indics[name];(0,_jquery.default)(this.nextElementSibling).find("input").each(function(){if(value!==null&&index<value.length){(0,_jquery.default)(this).val(value[index])}index++})})});(0,_jquery.default)("#close_settings").click(function(){(0,_jquery.default)("#chart_parameter_settings").removeClass("clicked")});(0,_jquery.default)(".chart_container .chart_toolbar_tabgroup a").click(function(){_control.Control.switchPeriod((0,_jquery.default)(this).parent().attr("name"))});(0,_jquery.default)("#chart_toolbar_periods_vert ul a").click(function(){_control.Control.switchPeriod((0,_jquery.default)(this).parent().attr("name"))});(0,_jquery.default)("#chart_toolbar_periods_vert1 ul a").click(function(){_control.Control.switchPeriod((0,_jquery.default)(this).parent().attr("name"))});(0,_jquery.default)(".market_chooser ul a").click(function(){_control.Control.switchSymbol((0,_jquery.default)(this).attr("name"))});(0,_jquery.default)("#chart_show_tools").click(function(){if((0,_jquery.default)(this).hasClass("selected")){_control.Control.switchTools("off")}else{_control.Control.switchTools("on")}});(0,_jquery.default)("#chart_toolpanel .chart_toolpanel_button").click(function(){(0,_jquery.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover");(0,_jquery.default)("#chart_toolpanel .chart_toolpanel_button").removeClass("selected");(0,_jquery.default)(this).addClass("selected");var name=(0,_jquery.default)(this).children().attr("name");Kline.instance.chartMgr.setRunningMode(_chart_manager.ChartManager.DrawingTool[name])});(0,_jquery.default)("#chart_show_indicator").click(function(){if((0,_jquery.default)(this).hasClass("selected")){_control.Control.switchIndic("off")}else{_control.Control.switchIndic("on")}});(0,_jquery.default)("#chart_tabbar li a").click(function(){(0,_jquery.default)("#chart_tabbar li a").removeClass("selected");(0,_jquery.default)(this).addClass("selected");var name=(0,_jquery.default)(this).attr("name");var tmp=_chart_settings.ChartSettings.get();tmp.charts.indics[1]=name;_chart_settings.ChartSettings.save();if(_templates.Template.displayVolume===false)_chart_manager.ChartManager.instance.getChart().setIndicator(1,name);else _chart_manager.ChartManager.instance.getChart().setIndicator(2,name)});(0,_jquery.default)("#chart_select_chart_style a").click(function(){(0,_jquery.default)("#chart_select_chart_style a").removeClass("selected");(0,_jquery.default)(this).addClass("selected");var tmp=_chart_settings.ChartSettings.get();tmp.charts.chartStyle=(0,_jquery.default)(this)[0].innerHTML;_chart_settings.ChartSettings.save();var mgr=_chart_manager.ChartManager.instance;mgr.setChartStyle("frame0.k0",(0,_jquery.default)(this).html());mgr.redraw()});(0,_jquery.default)("#chart_dropdown_themes li").click(function(){(0,_jquery.default)("#chart_dropdown_themes li a").removeClass("selected");var name=(0,_jquery.default)(this).attr("name");if(name==="chart_themes_dark"){_control.Control.switchTheme("dark")}else if(name==="chart_themes_light"){_control.Control.switchTheme("light")}});(0,_jquery.default)("#chart_select_main_indicator a").click(function(){(0,_jquery.default)("#chart_select_main_indicator a").removeClass("selected");(0,_jquery.default)(this).addClass("selected");var name=(0,_jquery.default)(this).attr("name")
;var tmp=_chart_settings.ChartSettings.get();tmp.charts.mIndic=name;_chart_settings.ChartSettings.save();var mgr=_chart_manager.ChartManager.instance;if(!mgr.setMainIndicator("frame0.k0",name))mgr.removeMainIndicator("frame0.k0");mgr.redraw()});(0,_jquery.default)("#chart_toolbar_theme a").click(function(){(0,_jquery.default)("#chart_toolbar_theme a").removeClass("selected");if((0,_jquery.default)(this).attr("name")==="dark"){_control.Control.switchTheme("dark")}else if((0,_jquery.default)(this).attr("name")==="light"){_control.Control.switchTheme("light")}});(0,_jquery.default)("#chart_select_theme li a").click(function(){(0,_jquery.default)("#chart_select_theme a").removeClass("selected");if((0,_jquery.default)(this).attr("name")==="dark"){_control.Control.switchTheme("dark")}else if((0,_jquery.default)(this).attr("name")==="light"){_control.Control.switchTheme("light")}});(0,_jquery.default)("#chart_enable_tools li a").click(function(){(0,_jquery.default)("#chart_enable_tools a").removeClass("selected");if((0,_jquery.default)(this).attr("name")==="on"){_control.Control.switchTools("on")}else if((0,_jquery.default)(this).attr("name")==="off"){_control.Control.switchTools("off")}});(0,_jquery.default)("#chart_enable_indicator li a").click(function(){(0,_jquery.default)("#chart_enable_indicator a").removeClass("selected");if((0,_jquery.default)(this).attr("name")==="on"){_control.Control.switchIndic("on")}else if((0,_jquery.default)(this).attr("name")==="off"){_control.Control.switchIndic("off")}});(0,_jquery.default)("#chart_language_setting_div li a").click(function(){(0,_jquery.default)("#chart_language_setting_div a").removeClass("selected");if((0,_jquery.default)(this).attr("name")==="zh-cn"){_control.Control.chartSwitchLanguage("zh-cn")}else if((0,_jquery.default)(this).attr("name")==="en-us"){_control.Control.chartSwitchLanguage("en-us")}else if((0,_jquery.default)(this).attr("name")==="zh-tw"){_control.Control.chartSwitchLanguage("zh-tw")}});(0,_jquery.default)(document).keyup(function(e){if(e.keyCode===46){_chart_manager.ChartManager.instance.deleteToolObject();_chart_manager.ChartManager.instance.redraw("OverlayCanvas",false)}});(0,_jquery.default)("#clearCanvas").click(function(){var pDPTool=_chart_manager.ChartManager.instance.getDataSource("frame0.k0");var len=pDPTool.getToolObjectCount();for(var i=0;i<len;i++){pDPTool.delToolObject()}_chart_manager.ChartManager.instance.redraw("OverlayCanvas",false)});(0,_jquery.default)("#chart_overlayCanvas").mousemove(function(e){var r=e.target.getBoundingClientRect();var x=e.clientX-r.left;var y=e.clientY-r.top;var mgr=_chart_manager.ChartManager.instance;if(Kline.instance.buttonDown===true){mgr.onMouseMove("frame0",x,y,true);mgr.redraw("All",false)}else{mgr.onMouseMove("frame0",x,y,false);mgr.redraw("OverlayCanvas")}}).mouseleave(function(e){var r=e.target.getBoundingClientRect();var x=e.clientX-r.left;var y=e.clientY-r.top;var mgr=_chart_manager.ChartManager.instance;mgr.onMouseLeave("frame0",x,y,false);mgr.redraw("OverlayCanvas")}).mouseup(function(e){if(e.which!==1){return}Kline.instance.buttonDown=false;var r=e.target.getBoundingClientRect();var x=e.clientX-r.left;var y=e.clientY-r.top;var mgr=_chart_manager.ChartManager.instance;mgr.onMouseUp("frame0",x,y);mgr.redraw("All")}).mousedown(function(e){if(e.which!==1){_chart_manager.ChartManager.instance.deleteToolObject();_chart_manager.ChartManager.instance.redraw("OverlayCanvas",false);return}Kline.instance.buttonDown=true;var r=e.target.getBoundingClientRect();var x=e.clientX-r.left;var y=e.clientY-r.top;_chart_manager.ChartManager.instance.onMouseDown("frame0",x,y)});(0,_jquery.default)("#chart_parameter_settings :input").change(function(){var name=(0,_jquery.default)(this).attr("name");var index=0;var valueArray=[];var mgr=_chart_manager.ChartManager.instance;(0,_jquery.default)("#chart_parameter_settings :input").each(function(){if((0,_jquery.default)(this).attr("name")===name){if((0,_jquery.default)(this).val()!==""&&(0,_jquery.default)(this).val()!==null&&(0,_jquery.default)(this).val()!==undefined){var i=parseInt((0,_jquery.default)(this).val());valueArray.push(i)}index++}});if(valueArray.length!==0){mgr.setIndicatorParameters(name,valueArray);var value=mgr.getIndicatorParameters(name);var cookieArray=[];index=0;(0,_jquery.default)("#chart_parameter_settings :input").each(function(){if((0,_jquery.default)(this).attr("name")===name){if((0,_jquery.default)(this).val()!==""&&(0,_jquery.default)(this).val()!==null&&(0,_jquery.default)(this).val()!==undefined){(0,_jquery.default)(this).val(value[index].getValue());cookieArray.push(value[index].getValue())}index++}});var tmp=_chart_settings.ChartSettings.get();tmp.indics[name]=cookieArray;_chart_settings.ChartSettings.save();mgr.redraw("All",false)}});(0,_jquery.default)("#chart_parameter_settings button").click(function(){var name=(0,_jquery.default)(this).parents("tr").children("th").html();var index=0;var value=_chart_manager.ChartManager.instance.getIndicatorParameters(name);var valueArray=[];(0,_jquery.default)(this).parent().prev().children("input").each(function(){if(value!==null&&index<value.length){(0,_jquery.default)(this).val(value[index].getDefaultValue());valueArray.push(value[index].getDefaultValue())}index++});_chart_manager.ChartManager.instance.setIndicatorParameters(name,valueArray);var tmp=_chart_settings.ChartSettings.get();tmp.indics[name]=valueArray;_chart_settings.ChartSettings.save();_chart_manager.ChartManager.instance.redraw("All",false)});(0,_jquery.default)("body").on("click","#sizeIcon",function(){Kline.instance.isSized=!Kline.instance.isSized;if(Kline.instance.isSized){(0,_jquery.default)(Kline.instance.element).css({position:"fixed",left:"0",right:"0",top:"0",bottom:"0",width:"100%",height:"100%",zIndex:"10000"});_control.Control.onSize();(0,_jquery.default)("html,body").css({width:"100%",height:"100%",overflow:"hidden"})}else{(0,_jquery.default)(Kline.instance.element).attr("style","");(0,_jquery.default)("html,body").attr("style","");_control.Control.onSize(Kline.instance.width,Kline.instance.height);(0,_jquery.default)(Kline.instance.element).css({visibility:"visible",height:Kline.instance.height+"px"})}})})}}]);return Kline}();exports.default=Kline;Kline.created=false;Kline.instance=null},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Change=function(){function Change(type,snapshotNode,childName,oldSnap,prevName){this.type=type;this.snapshotNode=snapshotNode;this.childName=childName;this.oldSnap=oldSnap;this.prevName=prevName}Change.valueChange=function(snapshot){return new Change(Change.VALUE,snapshot)};Change.childAddedChange=function(childKey,snapshot){return new Change(Change.CHILD_ADDED,snapshot,childKey)};Change.childRemovedChange=function(childKey,snapshot){return new Change(Change.CHILD_REMOVED,snapshot,childKey)};Change.childChangedChange=function(childKey,newSnapshot,oldSnapshot){return new Change(Change.CHILD_CHANGED,newSnapshot,childKey,oldSnapshot)};Change.childMovedChange=function(childKey,snapshot){return new Change(Change.CHILD_MOVED,snapshot,childKey)};Change.CHILD_ADDED="child_added";Change.CHILD_REMOVED="child_removed";Change.CHILD_CHANGED="child_changed";Change.CHILD_MOVED="child_moved";Change.VALUE="value";return Change}();exports.Change=Change},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=forEach;__webpack_exports__["a"]=clone;function contains(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}function forEach(obj,f){for(var key in obj){if(contains(obj,key)){f(key,obj[key])}}}function clone(obj){if(obj==null){return{}}var c={};forEach(obj,function(key,val){c[key]=val});return c}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartSettings=void 0;var _chart_manager=__webpack_require__(3);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ChartSettings=function(){function ChartSettings(){_classCallCheck(this,ChartSettings)}_createClass(ChartSettings,null,[{key:"checkVersion",value:function checkVersion(){if(ChartSettings._data.ver<2){ChartSettings._data.ver=2;var charts=ChartSettings._data.charts;charts.period_weight={};charts.period_weight["line"]=8;charts.period_weight["1min"]=7;charts.period_weight["5min"]=6;charts.period_weight["15min"]=5;charts.period_weight["30min"]=4;charts.period_weight["1hour"]=3;charts.period_weight["1day"]=2;charts.period_weight["1week"]=1;charts.period_weight["1M"]=0;charts.period_weight["3min"]=0;charts.period_weight["2hour"]=0;charts.period_weight["4hour"]=0;charts.period_weight["6hour"]=0;charts.period_weight["12hour"]=0;charts.period_weight["3day"]=0}if(ChartSettings._data.ver<3){ChartSettings._data.ver=3;var _charts=ChartSettings._data.charts;_charts.areaHeight=[]}}},{key:"get",value:function get(){if(ChartSettings._data===undefined){ChartSettings.init();ChartSettings.load();ChartSettings.checkVersion()}return ChartSettings._data}},{key:"init",value:function init(){var _indic_param={};var _name=["MA","EMA","VOLUME","MACD","KDJ","StochRSI","RSI","DMI","OBV","BOLL","DMA","TRIX","BRAR","VR","EMV","WR","ROC","MTM","PSY"];for(var i=0;i<_name.length;i++){var _value=_chart_manager.ChartManager.instance.createIndicatorAndRange("",_name[i],true);if(_value===null)continue;_indic_param[_name[i]]=[];var param=_value.indic.getParameters();for(var j=0;j<param.length;j++){_indic_param[_name[i]].push(param[j])}}var _chart_style="CandleStick";var _m_indic="MA";var _indic=["VOLUME","MACD"];var _range="1h";var _frame={};_frame.chartStyle=_chart_style;_frame.mIndic=_m_indic;_frame.indics=_indic;_frame.indicsStatus="open";_frame.period=_range;ChartSettings._data={ver:1,charts:_frame,indics:_indic_param,theme:"light"};ChartSettings.checkVersion()}},{key:"load",value:function load(){if(document.cookie.length<=0)return;var start=document.cookie.indexOf("chartSettings=");if(start<0)return;start+="chartSettings=".length;var end=document.cookie.indexOf(";",start);if(end<0)end=document.cookie.length;var json=unescape(document.cookie.substring(start,end));ChartSettings._data=JSON.parse(json)}},{key:"save",value:function save(){var exdate=new Date;exdate.setDate(exdate.getDate()+2);document.cookie="chartSettings="+escape(JSON.stringify(ChartSettings._data))+";expires="+exdate.toGMTString()}}]);return ChartSettings}();exports.ChartSettings=ChartSettings},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Util=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Util=function(){function Util(){_classCallCheck(this,Util)}_createClass(Util,null,[{key:"fromFloat",value:function fromFloat(v,fractionDigits){var text=v.toFixed(fractionDigits);for(var i=text.length-1;i>=0;i--){if(text[i]===".")return text.substring(0,i);if(text[i]!=="0")return text.substring(0,i+1)}}},{key:"formatTime",value:function formatTime(v){return v<10?"0"+v.toString():v.toString()}},{key:"isInstance",value:function isInstance(obj,clazz){if(obj===null||obj===undefined){return false}return obj instanceof clazz}}]);return Util}();exports.Util=Util},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LightTheme=exports.DarkTheme=exports.Theme=void 0;var _kline=_interopRequireDefault(__webpack_require__(15));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Theme=function(){function Theme(){_classCallCheck(this,Theme);this.getFont=function(which){return this._fonts[which]}}_createClass(Theme,[{key:"getColor",value:function getColor(which){return this._colors[which]}}]);return Theme}();exports.Theme=Theme;Theme.theme_color_id=0;Theme.theme_font_id=0;Theme.Color={Positive:Theme.theme_color_id++,Negative:Theme.theme_color_id++,PositiveDark:Theme.theme_color_id++,NegativeDark:Theme.theme_color_id++,Unchanged:Theme.theme_color_id++,Background:Theme.theme_color_id++,Cursor:Theme.theme_color_id++,RangeMark:Theme.theme_color_id++,Indicator0:Theme.theme_color_id++,Indicator1:Theme.theme_color_id++,Indicator2:Theme.theme_color_id++,Indicator3:Theme.theme_color_id++,Indicator4:Theme.theme_color_id++,Indicator5:Theme.theme_color_id++,Grid0:Theme.theme_color_id++,Grid1:Theme.theme_color_id++,Grid2:Theme.theme_color_id++,Grid3:Theme.theme_color_id++,Grid4:Theme.theme_color_id++,TextPositive:Theme.theme_color_id++,TextNegative:Theme.theme_color_id++,Text0:Theme.theme_color_id++,Text1:Theme.theme_color_id++,Text2:Theme.theme_color_id++,Text3:Theme.theme_color_id++,Text4:Theme.theme_color_id++,LineColorNormal:Theme.theme_color_id++,LineColorSelected:Theme.theme_color_id++,CircleColorFill:Theme.theme_color_id++,CircleColorStroke:Theme.theme_color_id++};Theme.Font={Default:Theme.theme_font_id++};var DarkTheme=function(_Theme){_inherits(DarkTheme,_Theme);function DarkTheme(){var _this;_classCallCheck(this,DarkTheme);_this=_possibleConstructorReturn(this,(DarkTheme.__proto__||Object.getPrototypeOf(DarkTheme)).call(this));_this._colors=[];if(_kline.default.instance.reverseColor){_this._colors[Theme.Color.Positive]="#41a3f6";_this._colors[Theme.Color.Negative]="#fb5b71";_this._colors[Theme.Color.PositiveDark]="#41a3f6";_this._colors[Theme.Color.NegativeDark]="#fb5b71"}else{_this._colors[Theme.Color.Positive]="#41a3f6";_this._colors[Theme.Color.Negative]="#fb5b71";_this._colors[Theme.Color.PositiveDark]="#41a3f6";_this._colors[Theme.Color.NegativeDark]="#fb5b71"}_this._colors[Theme.Color.Unchanged]="#fff";_this._colors[Theme.Color.Background]="rgba(19,21,39,1)";_this._colors[Theme.Color.Cursor]="#aaa";_this._colors[Theme.Color.RangeMark]="#f9ee30";_this._colors[Theme.Color.Indicator0]="#ddd";_this._colors[Theme.Color.Indicator1]="#f9ee30";_this._colors[Theme.Color.Indicator2]="#f600ff";_this._colors[Theme.Color.Indicator3]="#6bf";_this._colors[Theme.Color.Indicator4]="#a5cf81";_this._colors[Theme.Color.Indicator5]="#e18b89";_this._colors[Theme.Color.Grid0]="#333";_this._colors[Theme.Color.Grid1]="#444";_this._colors[Theme.Color.Grid2]="#666";_this._colors[Theme.Color.Grid3]="#888";_this._colors[Theme.Color.Grid4]="#aaa";_this._colors[Theme.Color.TextPositive]="#41a3f6";_this._colors[Theme.Color.TextNegative]="#fb5b71";_this._colors[Theme.Color.Text0]="#444";_this._colors[Theme.Color.Text1]="#666";_this._colors[Theme.Color.Text2]="#888";_this._colors[Theme.Color.Text3]="#aaa";_this._colors[Theme.Color.Text4]="#ccc";_this._colors[Theme.Color.LineColorNormal]="#a6a6a6";_this._colors[Theme.Color.LineColorSelected]="#ffffff";_this._colors[Theme.Color.CircleColorFill]="#000000";_this._colors[Theme.Color.CircleColorStroke]="#ffffff";_this._fonts=[];_this._fonts[Theme.Font.Default]="12px Tahoma";return _this}return DarkTheme}(Theme);exports.DarkTheme=DarkTheme;var LightTheme=function(_Theme2){_inherits(LightTheme,_Theme2);function LightTheme(){var _this2;_classCallCheck(this,LightTheme);_this2=_possibleConstructorReturn(this,(LightTheme.__proto__||Object.getPrototypeOf(LightTheme)).call(this));_this2._colors=[];if(_kline.default.instance.reverseColor){_this2._colors[Theme.Color.Positive]="#41a3f6";_this2._colors[Theme.Color.Negative]="#fb5b71";_this2._colors[Theme.Color.PositiveDark]="#41a3f6";_this2._colors[Theme.Color.NegativeDark]="#fb5b71"}else{_this2._colors[Theme.Color.Positive]="#41a3f6";_this2._colors[Theme.Color.Negative]="#fb5b71";_this2._colors[Theme.Color.PositiveDark]="#41a3f6";_this2._colors[Theme.Color.NegativeDark]="#fb5b71"}_this2._colors[Theme.Color.Unchanged]="#fff";_this2._colors[Theme.Color.Background]="#fff";_this2._colors[Theme.Color.Cursor]="#aaa";_this2._colors[Theme.Color.RangeMark]="#f27935";_this2._colors[Theme.Color.Indicator0]="#2fd2b2";_this2._colors[Theme.Color.Indicator1]="#ffb400";_this2._colors[Theme.Color.Indicator2]="#e849b9";_this2._colors[Theme.Color.Indicator3]="#1478c8";_this2._colors[Theme.Color.Grid0]="#eee";_this2._colors[Theme.Color.Grid1]="#afb1b3";_this2._colors[Theme.Color.Grid2]="#ccc";_this2._colors[Theme.Color.Grid3]="#bbb";_this2._colors[Theme.Color.Grid4]="#aaa";_this2._colors[Theme.Color.TextPositive]="#41a3f6";_this2._colors[Theme.Color.TextNegative]="#fb5b71";_this2._colors[Theme.Color.Text0]="#ccc";_this2._colors[Theme.Color.Text1]="#aaa";_this2._colors[Theme.Color.Text2]="#888";_this2._colors[Theme.Color.Text3]="#666";_this2._colors[Theme.Color.Text4]="#444";_this2._colors[Theme.Color.LineColorNormal]="#8c8c8c";_this2._colors[Theme.Color.LineColorSelected]="#393c40";_this2._colors[Theme.Color.CircleColorFill]="#ffffff";_this2._colors[Theme.Color.CircleColorStroke]="#393c40";_this2._fonts=[];_this2._fonts[Theme.Font.Default]="12px Tahoma";return _this2}return LightTheme}(Theme);exports.LightTheme=LightTheme},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var Index_1=__webpack_require__(28);var Node_1=__webpack_require__(6);var util_1=__webpack_require__(1);var util_2=__webpack_require__(0);var __EMPTY_NODE;var KeyIndex=function(_super){__extends(KeyIndex,_super);function KeyIndex(){return _super!==null&&_super.apply(this,arguments)||this}Object.defineProperty(KeyIndex,"__EMPTY_NODE",{get:function(){return __EMPTY_NODE},set:function(val){__EMPTY_NODE=val},enumerable:true,configurable:true});KeyIndex.prototype.compare=function(a,b){return util_1.nameCompare(a.name,b.name)};KeyIndex.prototype.isDefinedOn=function(node){throw util_2.assertionError("KeyIndex.isDefinedOn not expected to be called.")};KeyIndex.prototype.indexedValueChanged=function(oldNode,newNode){return false};KeyIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN};KeyIndex.prototype.maxPost=function(){return new Node_1.NamedNode(util_1.MAX_NAME,__EMPTY_NODE)};KeyIndex.prototype.makePost=function(indexValue,name){util_2.assert(typeof indexValue==="string","KeyIndex indexValue must always be a string.");return new Node_1.NamedNode(indexValue,__EMPTY_NODE)};KeyIndex.prototype.toString=function(){return".key"};return KeyIndex}(Index_1.Index);exports.KeyIndex=KeyIndex;exports.KEY_INDEX=new KeyIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ChildrenNode_1=__webpack_require__(5);var LeafNode_1=__webpack_require__(29);var Node_1=__webpack_require__(6);var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var childSet_1=__webpack_require__(73);var comparators_1=__webpack_require__(74);var IndexMap_1=__webpack_require__(72);var PriorityIndex_1=__webpack_require__(4);var USE_HINZE=true;function nodeFromJSON(json,priority){if(priority===void 0){priority=null}if(json===null){return ChildrenNode_1.ChildrenNode.EMPTY_NODE}if(typeof json==="object"&&".priority"in json){priority=json[".priority"]}util_2.assert(priority===null||typeof priority==="string"||typeof priority==="number"||typeof priority==="object"&&".sv"in priority,"Invalid priority type found: "+typeof priority);if(typeof json==="object"&&".value"in json&&json[".value"]!==null){json=json[".value"]}if(typeof json!=="object"||".sv"in json){var jsonLeaf=json;return new LeafNode_1.LeafNode(jsonLeaf,nodeFromJSON(priority))}if(!(json instanceof Array)&&USE_HINZE){var children_1=[];var childrenHavePriority_1=false;var hinzeJsonObj_1=json;util_1.forEach(hinzeJsonObj_1,function(key,child){if(typeof key!=="string"||key.substring(0,1)!=="."){var childNode=nodeFromJSON(hinzeJsonObj_1[key]);if(!childNode.isEmpty()){childrenHavePriority_1=childrenHavePriority_1||!childNode.getPriority().isEmpty();children_1.push(new Node_1.NamedNode(key,childNode))}}});if(children_1.length==0){return ChildrenNode_1.ChildrenNode.EMPTY_NODE}var childSet=childSet_1.buildChildSet(children_1,comparators_1.NAME_ONLY_COMPARATOR,function(namedNode){return namedNode.name},comparators_1.NAME_COMPARATOR);if(childrenHavePriority_1){var sortedChildSet=childSet_1.buildChildSet(children_1,PriorityIndex_1.PRIORITY_INDEX.getCompare());return new ChildrenNode_1.ChildrenNode(childSet,nodeFromJSON(priority),new IndexMap_1.IndexMap({".priority":sortedChildSet},{".priority":PriorityIndex_1.PRIORITY_INDEX}))}else{return new ChildrenNode_1.ChildrenNode(childSet,nodeFromJSON(priority),IndexMap_1.IndexMap.Default)}}else{var node_1=ChildrenNode_1.ChildrenNode.EMPTY_NODE;var jsonObj_1=json;util_1.forEach(jsonObj_1,function(key,childData){if(util_1.contains(jsonObj_1,key)){if(key.substring(0,1)!=="."){var childNode=nodeFromJSON(childData);if(childNode.isLeafNode()||!childNode.isEmpty())node_1=node_1.updateImmediateChild(key,childNode)}}});return node_1.updatePriority(nodeFromJSON(priority))}}exports.nodeFromJSON=nodeFromJSON;PriorityIndex_1.setNodeFromJSON(nodeFromJSON)},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return StringFormat});__webpack_exports__["c"]=formatValidator;__webpack_exports__["b"]=dataFromString;var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(9);var StringFormat={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function formatValidator(stringFormat){switch(stringFormat){case StringFormat.RAW:case StringFormat.BASE64:case StringFormat.BASE64URL:case StringFormat.DATA_URL:return;default:throw"Expected one of the event types: ["+StringFormat.RAW+", "+StringFormat.BASE64+", "+StringFormat.BASE64URL+", "+StringFormat.DATA_URL+"]."}}var StringData=function(){function StringData(data,opt_contentType){this.data=data;this.contentType=opt_contentType||null}return StringData}();function dataFromString(format,string){switch(format){case StringFormat.RAW:return new StringData(utf8Bytes_(string));case StringFormat.BASE64:case StringFormat.BASE64URL:return new StringData(base64Bytes_(format,string));case StringFormat.DATA_URL:return new StringData(dataURLBytes_(string),dataURLContentType_(string))}throw __WEBPACK_IMPORTED_MODULE_0__error__["s"]()}function utf8Bytes_(string){var b=[];for(var i=0;i<string.length;i++){var c=string.charCodeAt(i);if(c<=127){b.push(c)}else{if(c<=2047){b.push(192|c>>6,128|c&63)}else{if((c&64512)==55296){var valid=i<string.length-1&&(string.charCodeAt(i+1)&64512)==56320;if(!valid){b.push(239,191,189)}else{var hi=c;var lo=string.charCodeAt(++i);c=65536|(hi&1023)<<10|lo&1023;b.push(240|c>>18,128|c>>12&63,128|c>>6&63,128|c&63)}}else{if((c&64512)==56320){b.push(239,191,189)}else{b.push(224|c>>12,128|c>>6&63,128|c&63)}}}}}return new Uint8Array(b)}function percentEncodedBytes_(string){var decoded;try{decoded=decodeURIComponent(string)}catch(e){throw __WEBPACK_IMPORTED_MODULE_0__error__["i"](StringFormat.DATA_URL,"Malformed data URL.")}return utf8Bytes_(decoded)}function base64Bytes_(format,string){switch(format){case StringFormat.BASE64:{var hasMinus=string.indexOf("-")!==-1;var hasUnder=string.indexOf("_")!==-1;if(hasMinus||hasUnder){var invalidChar=hasMinus?"-":"_";throw __WEBPACK_IMPORTED_MODULE_0__error__["i"](format,"Invalid character '"+invalidChar+"' found: is it base64url encoded?")}break}case StringFormat.BASE64URL:{var hasPlus=string.indexOf("+")!==-1;var hasSlash=string.indexOf("/")!==-1;if(hasPlus||hasSlash){var invalidChar=hasPlus?"+":"/";throw __WEBPACK_IMPORTED_MODULE_0__error__["i"](format,"Invalid character '"+invalidChar+"' found: is it base64 encoded?")}string=string.replace(/-/g,"+").replace(/_/g,"/");break}}var bytes;try{bytes=atob(string)}catch(e){throw __WEBPACK_IMPORTED_MODULE_0__error__["i"](format,"Invalid character found")}var array=new Uint8Array(bytes.length);for(var i=0;i<bytes.length;i++){array[i]=bytes.charCodeAt(i)}return array}var DataURLParts=function(){function DataURLParts(dataURL){this.base64=false;this.contentType=null;var matches=dataURL.match(/^data:([^,]+)?,/);if(matches===null){throw __WEBPACK_IMPORTED_MODULE_0__error__["i"](StringFormat.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>")}var middle=matches[1]||null;if(middle!=null){this.base64=endsWith(middle,";base64");this.contentType=this.base64?middle.substring(0,middle.length-";base64".length):middle}this.rest=dataURL.substring(dataURL.indexOf(",")+1)}return DataURLParts}();function dataURLBytes_(string){var parts=new DataURLParts(string);if(parts.base64){return base64Bytes_(StringFormat.BASE64,parts.rest)}else{return percentEncodedBytes_(parts.rest)}}function dataURLContentType_(string){var parts=new DataURLParts(string);return parts.contentType}function endsWith(s,end){var longEnough=s.length>=end.length;if(!longEnough){return false}return s.substring(s.length-end.length)===end}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"b",function(){return TaskEvent});__webpack_require__.d(__webpack_exports__,"a",function(){return InternalTaskState});__webpack_require__.d(__webpack_exports__,"c",function(){return TaskState});__webpack_exports__["d"]=taskStateFromInternalTaskState;var TaskEvent={STATE_CHANGED:"state_changed"};var InternalTaskState={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"};var TaskState={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function taskStateFromInternalTaskState(state){switch(state){case InternalTaskState.RUNNING:case InternalTaskState.PAUSING:case InternalTaskState.CANCELING:return TaskState.RUNNING;case InternalTaskState.PAUSED:return TaskState.PAUSED;case InternalTaskState.SUCCESS:return TaskState.SUCCESS;case InternalTaskState.CANCELED:return TaskState.CANCELED;case InternalTaskState.ERROR:return TaskState.ERROR;default:return TaskState.ERROR}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TemplateMeasuringHandler=exports.DefaultTemplate=exports.Template=void 0;var _chart_manager=__webpack_require__(3);var _chart_settings=__webpack_require__(18);var data_sources=_interopRequireWildcard(__webpack_require__(11));var data_providers=_interopRequireWildcard(__webpack_require__(40));var areas=_interopRequireWildcard(__webpack_require__(41));var plotters=_interopRequireWildcard(__webpack_require__(39));var _timeline=__webpack_require__(102);var _cname=__webpack_require__(55);var layouts=_interopRequireWildcard(__webpack_require__(103));var themes=_interopRequireWildcard(__webpack_require__(20));var ranges=_interopRequireWildcard(__webpack_require__(58));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Template=function(){function Template(){_classCallCheck(this,Template)}_createClass(Template,null,[{key:"createCandlestickDataSource",value:function createCandlestickDataSource(dsAlias){return new data_sources.MainDataSource(dsAlias)}},{key:"createDataSource",value:function createDataSource(dsName,dsAlias,createFunc){var mgr=_chart_manager.ChartManager.instance
;if(mgr.getCachedDataSource(dsAlias)===null)mgr.setCachedDataSource(dsAlias,createFunc(dsAlias));mgr.setCurrentDataSource(dsName,dsAlias);mgr.updateData(dsName,null)}},{key:"createTableComps",value:function createTableComps(dsName){this.createMainChartComps(dsName);if(this.displayVolume){this.createIndicatorChartComps(dsName,"VOLUME")}this.createTimelineComps(dsName)}},{key:"createMainChartComps",value:function createMainChartComps(dsName){var mgr=_chart_manager.ChartManager.instance;var tableLayout=mgr.getArea(dsName+".charts");var areaName=dsName+".main";var rangeAreaName=areaName+"Range";var area=new areas.MainArea(areaName);mgr.setArea(areaName,area);tableLayout.addArea(area);var rangeArea=new areas.MainRangeArea(rangeAreaName);mgr.setArea(rangeAreaName,rangeArea);tableLayout.addArea(rangeArea);var dp=new data_providers.MainDataProvider(areaName+".main");mgr.setDataProvider(dp.getName(),dp);mgr.setMainIndicator(dsName,"MA");var range=new ranges.MainRange(areaName);mgr.setRange(range.getName(),range);range.setPaddingTop(28);range.setPaddingBottom(12);var plotter=new plotters.MainAreaBackgroundPlotter(areaName+".background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CGridPlotter(areaName+".grid");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CandlestickPlotter(areaName+".main");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.MinMaxPlotter(areaName+".decoration");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.MainInfoPlotter(areaName+".info");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.SelectionPlotter(areaName+".selection");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CDynamicLinePlotter(areaName+".tool");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangeAreaBackgroundPlotter(areaName+"Range.background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.COrderGraphPlotter(areaName+"Range.grid");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangePlotter(areaName+"Range.main");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangeSelectionPlotter(areaName+"Range.selection");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.LastClosePlotter(areaName+"Range.decoration");mgr.setPlotter(plotter.getName(),plotter)}},{key:"createIndicatorChartComps",value:function createIndicatorChartComps(dsName,indicName){var mgr=_chart_manager.ChartManager.instance;var tableLayout=mgr.getArea(dsName+".charts");var areaName=dsName+".indic"+tableLayout.getNextRowId();var rangeAreaName=areaName+"Range";var area=new areas.IndicatorArea(areaName);mgr.setArea(areaName,area);tableLayout.addArea(area);var rowIndex=tableLayout.getAreaCount()>>1;var heights=_chart_settings.ChartSettings.get().charts.areaHeight;if(heights.length>rowIndex){var a,i;for(i=0;i<rowIndex;i++){a=tableLayout.getAreaAt(i<<1);a.setTop(0);a.setBottom(heights[i])}area.setTop(0);area.setBottom(heights[rowIndex])}var rangeArea=new areas.IndicatorRangeArea(rangeAreaName);mgr.setArea(rangeAreaName,rangeArea);tableLayout.addArea(rangeArea);var dp=new data_providers.IndicatorDataProvider(areaName+".secondary");mgr.setDataProvider(dp.getName(),dp);if(mgr.setIndicator(areaName,indicName)===false){mgr.removeIndicator(areaName);return}var plotter=new plotters.MainAreaBackgroundPlotter(areaName+".background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CGridPlotter(areaName+".grid");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.IndicatorPlotter(areaName+".secondary");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.IndicatorInfoPlotter(areaName+".info");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.SelectionPlotter(areaName+".selection");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangeAreaBackgroundPlotter(areaName+"Range.background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangePlotter(areaName+"Range.main");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.RangeSelectionPlotter(areaName+"Range.selection");mgr.setPlotter(plotter.getName(),plotter)}},{key:"createTimelineComps",value:function createTimelineComps(dsName){var mgr=_chart_manager.ChartManager.instance;var plotter;var timeline=new _timeline.Timeline(dsName);mgr.setTimeline(timeline.getName(),timeline);plotter=new plotters.TimelineAreaBackgroundPlotter(dsName+".timeline.background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.TimelinePlotter(dsName+".timeline.main");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.TimelineSelectionPlotter(dsName+".timeline.selection");mgr.setPlotter(plotter.getName(),plotter)}},{key:"createLiveOrderComps",value:function createLiveOrderComps(dsName){var mgr=_chart_manager.ChartManager.instance;var plotter;plotter=new plotters.BackgroundPlotter(dsName+".main.background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CLiveOrderPlotter(dsName+".main.main");mgr.setPlotter(plotter.getName(),plotter)}},{key:"createLiveTradeComps",value:function createLiveTradeComps(dsName){var mgr=_chart_manager.ChartManager.instance;var plotter;plotter=new plotters.BackgroundPlotter(dsName+".main.background");mgr.setPlotter(plotter.getName(),plotter);plotter=new plotters.CLiveTradePlotter(dsName+".main.main");mgr.setPlotter(plotter.getName(),plotter)}}]);return Template}();exports.Template=Template;Template.displayVolume=true;var DefaultTemplate=function(_Template){_inherits(DefaultTemplate,_Template);function DefaultTemplate(){_classCallCheck(this,DefaultTemplate);return _possibleConstructorReturn(this,(DefaultTemplate.__proto__||Object.getPrototypeOf(DefaultTemplate)).apply(this,arguments))}_createClass(DefaultTemplate,null,[{key:"loadTemplate",value:function loadTemplate(dsName,dsAlias){var mgr=_chart_manager.ChartManager.instance;var settings=_chart_settings.ChartSettings.get();var frameName=new _cname.CName(dsName).getCompAt(0);mgr.unloadTemplate(frameName);this.createDataSource(dsName,dsAlias,this.createCandlestickDataSource);var frame=new layouts.DockableLayout(frameName);mgr.setFrame(frame.getName(),frame);mgr.setArea(frame.getName(),frame);frame.setGridColor(themes.Theme.Color.Grid1);var area=new areas.TimelineArea(dsName+".timeline");mgr.setArea(area.getName(),area);frame.addArea(area);area.setDockStyle(areas.ChartArea.DockStyle.Bottom);area.Measuring.addHandler(area,TemplateMeasuringHandler.onMeasuring);var tableLayout=new layouts.TableLayout(dsName+".charts");mgr.setArea(tableLayout.getName(),tableLayout);tableLayout.setDockStyle(areas.ChartArea.DockStyle.Fill);frame.addArea(tableLayout);this.createTableComps(dsName);mgr.setThemeName(frameName,settings.theme);return mgr}}]);return DefaultTemplate}(Template);exports.DefaultTemplate=DefaultTemplate;var TemplateMeasuringHandler=function(){function TemplateMeasuringHandler(){_classCallCheck(this,TemplateMeasuringHandler)}_createClass(TemplateMeasuringHandler,null,[{key:"onMeasuring",value:function onMeasuring(sender,args){var width=args.Width;var height=args.Height;var areaName=sender.getNameObject().getCompAt(2);if(areaName==="timeline"){sender.setMeasuredDimension(width,22)}}}]);return TemplateMeasuringHandler}();exports.TemplateMeasuringHandler=TemplateMeasuringHandler},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DOMStorageWrapper_1=__webpack_require__(147);var MemoryStorage_1=__webpack_require__(148);var createStoragefor=function(domStorageName){try{if(typeof window!=="undefined"&&typeof window[domStorageName]!=="undefined"){var domStorage=window[domStorageName];domStorage.setItem("firebase:sentinel","cache");domStorage.removeItem("firebase:sentinel");return new DOMStorageWrapper_1.DOMStorageWrapper(domStorage)}}catch(e){}return new MemoryStorage_1.MemoryStorage};exports.PersistentStorage=createStoragefor("localStorage");exports.SessionStorage=createStoragefor("sessionStorage")},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PROTOCOL_VERSION="5";exports.VERSION_PARAM="v";exports.TRANSPORT_SESSION_PARAM="s";exports.REFERER_PARAM="r";exports.FORGE_REF="f";exports.FORGE_DOMAIN="firebaseio.com";exports.LAST_SESSION_PARAM="ls";exports.WEBSOCKET="websocket";exports.LONG_POLLING="long_polling"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Node_1=__webpack_require__(6);var util_1=__webpack_require__(1);var Index=function(){function Index(){}Index.prototype.getCompare=function(){return this.compare.bind(this)};Index.prototype.indexedValueChanged=function(oldNode,newNode){var oldWrapped=new Node_1.NamedNode(util_1.MIN_NAME,oldNode);var newWrapped=new Node_1.NamedNode(util_1.MIN_NAME,newNode);return this.compare(oldWrapped,newWrapped)!==0};Index.prototype.minPost=function(){return Node_1.NamedNode.MIN};return Index}();exports.Index=Index},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var snap_1=__webpack_require__(70);var __childrenNodeConstructor;var LeafNode=function(){function LeafNode(value_,priorityNode_){if(priorityNode_===void 0){priorityNode_=LeafNode.__childrenNodeConstructor.EMPTY_NODE}this.value_=value_;this.priorityNode_=priorityNode_;this.lazyHash_=null;util_1.assert(this.value_!==undefined&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value.");snap_1.validatePriorityNode(this.priorityNode_)}Object.defineProperty(LeafNode,"__childrenNodeConstructor",{get:function(){return __childrenNodeConstructor},set:function(val){__childrenNodeConstructor=val},enumerable:true,configurable:true});LeafNode.prototype.isLeafNode=function(){return true};LeafNode.prototype.getPriority=function(){return this.priorityNode_};LeafNode.prototype.updatePriority=function(newPriorityNode){return new LeafNode(this.value_,newPriorityNode)};LeafNode.prototype.getImmediateChild=function(childName){if(childName===".priority"){return this.priorityNode_}else{return LeafNode.__childrenNodeConstructor.EMPTY_NODE}};LeafNode.prototype.getChild=function(path){if(path.isEmpty()){return this}else if(path.getFront()===".priority"){return this.priorityNode_}else{return LeafNode.__childrenNodeConstructor.EMPTY_NODE}};LeafNode.prototype.hasChild=function(){return false};LeafNode.prototype.getPredecessorChildName=function(childName,childNode){return null};LeafNode.prototype.updateImmediateChild=function(childName,newChildNode){if(childName===".priority"){return this.updatePriority(newChildNode)}else if(newChildNode.isEmpty()&&childName!==".priority"){return this}else{return LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(childName,newChildNode).updatePriority(this.priorityNode_)}};LeafNode.prototype.updateChild=function(path,newChildNode){var front=path.getFront();if(front===null){return newChildNode}else if(newChildNode.isEmpty()&&front!==".priority"){return this}else{util_1.assert(front!==".priority"||path.getLength()===1,".priority must be the last token in a path");return this.updateImmediateChild(front,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(path.popFront(),newChildNode))}};LeafNode.prototype.isEmpty=function(){return false};LeafNode.prototype.numChildren=function(){return 0};LeafNode.prototype.forEachChild=function(index,action){return false};LeafNode.prototype.val=function(exportFormat){if(exportFormat&&!this.getPriority().isEmpty())return{".value":this.getValue(),".priority":this.getPriority().val()};else return this.getValue()};LeafNode.prototype.hash=function(){if(this.lazyHash_===null){var toHash="";if(!this.priorityNode_.isEmpty())toHash+="priority:"+snap_1.priorityHashText(this.priorityNode_.val())+":";var type=typeof this.value_;toHash+=type+":";if(type==="number"){toHash+=util_2.doubleToIEEE754String(this.value_)}else{toHash+=this.value_}this.lazyHash_=util_2.sha1(toHash)}return this.lazyHash_};LeafNode.prototype.getValue=function(){return this.value_};LeafNode.prototype.compareTo=function(other){if(other===LeafNode.__childrenNodeConstructor.EMPTY_NODE){return 1}else if(other instanceof LeafNode.__childrenNodeConstructor){return-1}else{util_1.assert(other.isLeafNode(),"Unknown node type");return this.compareToLeafNode_(other)}};LeafNode.prototype.compareToLeafNode_=function(otherLeaf){var otherLeafType=typeof otherLeaf.value_;var thisLeafType=typeof this.value_;var otherIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(otherLeafType);var thisIndex=LeafNode.VALUE_TYPE_ORDER.indexOf(thisLeafType);util_1.assert(otherIndex>=0,"Unknown leaf type: "+otherLeafType);util_1.assert(thisIndex>=0,"Unknown leaf type: "+thisLeafType);if(otherIndex===thisIndex){if(thisLeafType==="object"){return 0}else{if(this.value_<otherLeaf.value_){return-1}else if(this.value_===otherLeaf.value_){return 0}else{return 1}}}else{return thisIndex-otherIndex}};LeafNode.prototype.withIndex=function(){return this};LeafNode.prototype.isIndexed=function(){return true};LeafNode.prototype.equals=function(other){if(other===this){return true}else if(other.isLeafNode()){var otherLeaf=other;return this.value_===otherLeaf.value_&&this.priorityNode_.equals(otherLeaf.priorityNode_)}else{return false}};LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];return LeafNode}();exports.LeafNode=LeafNode},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var SortedMapIterator=function(){function SortedMapIterator(node,startKey,comparator,isReverse_,resultGenerator_){if(resultGenerator_===void 0){resultGenerator_=null}this.isReverse_=isReverse_;this.resultGenerator_=resultGenerator_;this.nodeStack_=[];var cmp=1;while(!node.isEmpty()){node=node;cmp=startKey?comparator(node.key,startKey):1;if(isReverse_)cmp*=-1;if(cmp<0){if(this.isReverse_){node=node.left}else{node=node.right}}else if(cmp===0){this.nodeStack_.push(node);break}else{this.nodeStack_.push(node);if(this.isReverse_){node=node.right}else{node=node.left}}}}SortedMapIterator.prototype.getNext=function(){if(this.nodeStack_.length===0)return null;var node=this.nodeStack_.pop();var result;if(this.resultGenerator_)result=this.resultGenerator_(node.key,node.value);else result={key:node.key,value:node.value};if(this.isReverse_){node=node.left;while(!node.isEmpty()){this.nodeStack_.push(node);node=node.right}}else{node=node.right;while(!node.isEmpty()){this.nodeStack_.push(node);node=node.left}}return result};SortedMapIterator.prototype.hasNext=function(){return this.nodeStack_.length>0};SortedMapIterator.prototype.peek=function(){if(this.nodeStack_.length===0)return null;var node=this.nodeStack_[this.nodeStack_.length-1];if(this.resultGenerator_){return this.resultGenerator_(node.key,node.value)}else{return{key:node.key,value:node.value}}};return SortedMapIterator}();exports.SortedMapIterator=SortedMapIterator;var LLRBNode=function(){function LLRBNode(key,value,color,left,right){this.key=key;this.value=value;this.color=color!=null?color:LLRBNode.RED;this.left=left!=null?left:SortedMap.EMPTY_NODE;this.right=right!=null?right:SortedMap.EMPTY_NODE}LLRBNode.prototype.copy=function(key,value,color,left,right){return new LLRBNode(key!=null?key:this.key,value!=null?value:this.value,color!=null?color:this.color,left!=null?left:this.left,right!=null?right:this.right)};LLRBNode.prototype.count=function(){return this.left.count()+1+this.right.count()};LLRBNode.prototype.isEmpty=function(){return false};LLRBNode.prototype.inorderTraversal=function(action){return this.left.inorderTraversal(action)||action(this.key,this.value)||this.right.inorderTraversal(action)};LLRBNode.prototype.reverseTraversal=function(action){return this.right.reverseTraversal(action)||action(this.key,this.value)||this.left.reverseTraversal(action)};LLRBNode.prototype.min_=function(){if(this.left.isEmpty()){return this}else{return this.left.min_()}};LLRBNode.prototype.minKey=function(){return this.min_().key};LLRBNode.prototype.maxKey=function(){if(this.right.isEmpty()){return this.key}else{return this.right.maxKey()}};LLRBNode.prototype.insert=function(key,value,comparator){var cmp,n;n=this;cmp=comparator(key,n.key);if(cmp<0){n=n.copy(null,null,null,n.left.insert(key,value,comparator),null)}else if(cmp===0){n=n.copy(null,value,null,null,null)}else{n=n.copy(null,null,null,null,n.right.insert(key,value,comparator))}return n.fixUp_()};LLRBNode.prototype.removeMin_=function(){if(this.left.isEmpty()){return SortedMap.EMPTY_NODE}var n=this;if(!n.left.isRed_()&&!n.left.left.isRed_())n=n.moveRedLeft_();n=n.copy(null,null,null,n.left.removeMin_(),null);return n.fixUp_()};LLRBNode.prototype.remove=function(key,comparator){var n,smallest;n=this;if(comparator(key,n.key)<0){if(!n.left.isEmpty()&&!n.left.isRed_()&&!n.left.left.isRed_()){n=n.moveRedLeft_()}n=n.copy(null,null,null,n.left.remove(key,comparator),null)}else{if(n.left.isRed_())n=n.rotateRight_();if(!n.right.isEmpty()&&!n.right.isRed_()&&!n.right.left.isRed_()){n=n.moveRedRight_()}if(comparator(key,n.key)===0){if(n.right.isEmpty()){return SortedMap.EMPTY_NODE}else{smallest=n.right.min_();n=n.copy(smallest.key,smallest.value,null,null,n.right.removeMin_())}}n=n.copy(null,null,null,null,n.right.remove(key,comparator))}return n.fixUp_()};LLRBNode.prototype.isRed_=function(){return this.color};LLRBNode.prototype.fixUp_=function(){var n=this;if(n.right.isRed_()&&!n.left.isRed_())n=n.rotateLeft_();if(n.left.isRed_()&&n.left.left.isRed_())n=n.rotateRight_();if(n.left.isRed_()&&n.right.isRed_())n=n.colorFlip_();return n};LLRBNode.prototype.moveRedLeft_=function(){var n=this.colorFlip_();if(n.right.left.isRed_()){n=n.copy(null,null,null,null,n.right.rotateRight_());n=n.rotateLeft_();n=n.colorFlip_()}return n};LLRBNode.prototype.moveRedRight_=function(){var n=this.colorFlip_();if(n.left.left.isRed_()){n=n.rotateRight_();n=n.colorFlip_()}return n};LLRBNode.prototype.rotateLeft_=function(){var nl=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,nl,null)};LLRBNode.prototype.rotateRight_=function(){var nr=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,nr)};LLRBNode.prototype.colorFlip_=function(){var left=this.left.copy(null,null,!this.left.color,null,null);var right=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,left,right)};LLRBNode.prototype.checkMaxDepth_=function(){var blackDepth=this.check_();return Math.pow(2,blackDepth)<=this.count()+1};LLRBNode.prototype.check_=function(){var blackDepth;if(this.isRed_()&&this.left.isRed_()){throw new Error("Red node has red child("+this.key+","+this.value+")")}if(this.right.isRed_()){throw new Error("Right child of ("+this.key+","+this.value+") is red")}blackDepth=this.left.check_();if(blackDepth!==this.right.check_()){throw new Error("Black depths differ")}else{return blackDepth+(this.isRed_()?0:1)}};LLRBNode.RED=true;LLRBNode.BLACK=false;return LLRBNode}();exports.LLRBNode=LLRBNode;var LLRBEmptyNode=function(){function LLRBEmptyNode(){}LLRBEmptyNode.prototype.copy=function(key,value,color,left,right){return this};LLRBEmptyNode.prototype.insert=function(key,value,comparator){return new LLRBNode(key,value,null)};LLRBEmptyNode.prototype.remove=function(key,comparator){return this};LLRBEmptyNode.prototype.count=function(){return 0};LLRBEmptyNode.prototype.isEmpty=function(){return true};LLRBEmptyNode.prototype.inorderTraversal=function(action){return false};LLRBEmptyNode.prototype.reverseTraversal=function(action){return false};LLRBEmptyNode.prototype.minKey=function(){return null};LLRBEmptyNode.prototype.maxKey=function(){return null};LLRBEmptyNode.prototype.check_=function(){return 0};LLRBEmptyNode.prototype.isRed_=function(){return false};return LLRBEmptyNode}();exports.LLRBEmptyNode=LLRBEmptyNode;var SortedMap=function(){function SortedMap(comparator_,root_){if(root_===void 0){root_=SortedMap.EMPTY_NODE}this.comparator_=comparator_;this.root_=root_}SortedMap.prototype.insert=function(key,value){return new SortedMap(this.comparator_,this.root_.insert(key,value,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))};SortedMap.prototype.remove=function(key){return new SortedMap(this.comparator_,this.root_.remove(key,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))};SortedMap.prototype.get=function(key){var cmp;var node=this.root_;while(!node.isEmpty()){cmp=this.comparator_(key,node.key);if(cmp===0){return node.value}else if(cmp<0){node=node.left}else if(cmp>0){node=node.right}}return null};SortedMap.prototype.getPredecessorKey=function(key){var cmp,node=this.root_,rightParent=null;while(!node.isEmpty()){cmp=this.comparator_(key,node.key);if(cmp===0){if(!node.left.isEmpty()){node=node.left;while(!node.right.isEmpty())node=node.right;return node.key}else if(rightParent){return rightParent.key}else{return null}}else if(cmp<0){node=node.left}else if(cmp>0){rightParent=node;node=node.right}}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")};SortedMap.prototype.isEmpty=function(){return this.root_.isEmpty()};SortedMap.prototype.count=function(){return this.root_.count()};SortedMap.prototype.minKey=function(){return this.root_.minKey()};SortedMap.prototype.maxKey=function(){return this.root_.maxKey()};SortedMap.prototype.inorderTraversal=function(action){return this.root_.inorderTraversal(action)};SortedMap.prototype.reverseTraversal=function(action){return this.root_.reverseTraversal(action)};SortedMap.prototype.getIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,false,resultGenerator)};SortedMap.prototype.getIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,false,resultGenerator)};SortedMap.prototype.getReverseIteratorFrom=function(key,resultGenerator){return new SortedMapIterator(this.root_,key,this.comparator_,true,resultGenerator)};SortedMap.prototype.getReverseIterator=function(resultGenerator){return new SortedMapIterator(this.root_,null,this.comparator_,true,resultGenerator)};SortedMap.EMPTY_NODE=new LLRBEmptyNode;return SortedMap}();exports.SortedMap=SortedMap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServerValues_1=__webpack_require__(76);var nodeFromJSON_1=__webpack_require__(22);var Path_1=__webpack_require__(2);var SparseSnapshotTree_1=__webpack_require__(77);var SyncTree_1=__webpack_require__(153);var SnapshotHolder_1=__webpack_require__(164);var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var util_3=__webpack_require__(0);var AuthTokenProvider_1=__webpack_require__(165);var StatsManager_1=__webpack_require__(48);var StatsReporter_1=__webpack_require__(167);var StatsListener_1=__webpack_require__(82);var EventQueue_1=__webpack_require__(168);var PersistentConnection_1=__webpack_require__(83);var ReadonlyRestClient_1=__webpack_require__(173);var Database_1=__webpack_require__(65);var INTERRUPT_REASON="repo_interrupt";var Repo=function(){function Repo(repoInfo_,forceRestClient,app){var _this=this;this.repoInfo_=repoInfo_;this.app=app;this.dataUpdateCount=0;this.statsListener_=null;this.eventQueue_=new EventQueue_1.EventQueue;this.nextWriteId_=1;this.interceptServerDataCallback_=null;this.onDisconnect_=new SparseSnapshotTree_1.SparseSnapshotTree;this.persistentConnection_=null;var authTokenProvider=new AuthTokenProvider_1.AuthTokenProvider(app);this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo_);if(forceRestClient||util_2.beingCrawled()){this.server_=new ReadonlyRestClient_1.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),authTokenProvider);setTimeout(this.onConnectStatus_.bind(this,true),0)}else{var authOverride=app.options["databaseAuthVariableOverride"];if(typeof authOverride!=="undefined"&&authOverride!==null){if(typeof authOverride!=="object"){throw new Error("Only objects are supported for option databaseAuthVariableOverride")}try{util_1.stringify(authOverride)}catch(e){throw new Error("Invalid authOverride provided: "+e)}}this.persistentConnection_=new PersistentConnection_1.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),authTokenProvider,authOverride);this.server_=this.persistentConnection_}authTokenProvider.addTokenChangeListener(function(token){_this.server_.refreshAuthToken(token)});this.statsReporter_=StatsManager_1.StatsManager.getOrCreateReporter(repoInfo_,function(){return new StatsReporter_1.StatsReporter(_this.stats_,_this.server_)});this.transactions_init_();this.infoData_=new SnapshotHolder_1.SnapshotHolder;this.infoSyncTree_=new SyncTree_1.SyncTree({startListening:function(query,tag,currentHashFn,onComplete){var infoEvents=[];var node=_this.infoData_.getNode(query.path);if(!node.isEmpty()){infoEvents=_this.infoSyncTree_.applyServerOverwrite(query.path,node);setTimeout(function(){onComplete("ok")},0)}return infoEvents},stopListening:function(){}});this.updateInfo_("connected",false);this.serverSyncTree_=new SyncTree_1.SyncTree({startListening:function(query,tag,currentHashFn,onComplete){_this.server_.listen(query,currentHashFn,tag,function(status,data){var events=onComplete(status,data);_this.eventQueue_.raiseEventsForChangedPath(query.path,events)});return[]},stopListening:function(query,tag){_this.server_.unlisten(query,tag)}})}Repo.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host};Repo.prototype.name=function(){return this.repoInfo_.namespace};Repo.prototype.serverTime=function(){var offsetNode=this.infoData_.getNode(new Path_1.Path(".info/serverTimeOffset"));var offset=offsetNode.val()||0;return(new Date).getTime()+offset};Repo.prototype.generateServerValues=function(){return ServerValues_1.generateWithValues({timestamp:this.serverTime()})};Repo.prototype.onDataUpdate_=function(pathString,data,isMerge,tag){this.dataUpdateCount++;var path=new Path_1.Path(pathString);data=this.interceptServerDataCallback_?this.interceptServerDataCallback_(pathString,data):data;var events=[];if(tag){if(isMerge){var taggedChildren=util_3.map(data,function(raw){return nodeFromJSON_1.nodeFromJSON(raw)});events=this.serverSyncTree_.applyTaggedQueryMerge(path,taggedChildren,tag)}else{var taggedSnap=nodeFromJSON_1.nodeFromJSON(data);events=this.serverSyncTree_.applyTaggedQueryOverwrite(path,taggedSnap,tag)}}else if(isMerge){var changedChildren=util_3.map(data,function(raw){return nodeFromJSON_1.nodeFromJSON(raw)});events=this.serverSyncTree_.applyServerMerge(path,changedChildren)}else{var snap=nodeFromJSON_1.nodeFromJSON(data);events=this.serverSyncTree_.applyServerOverwrite(path,snap)}var affectedPath=path;if(events.length>0){affectedPath=this.rerunTransactions_(path)}this.eventQueue_.raiseEventsForChangedPath(affectedPath,events)};Repo.prototype.interceptServerData_=function(callback){this.interceptServerDataCallback_=callback};Repo.prototype.onConnectStatus_=function(connectStatus){this.updateInfo_("connected",connectStatus);if(connectStatus===false){this.runOnDisconnectEvents_()}};Repo.prototype.onServerInfoUpdate_=function(updates){var _this=this;util_2.each(updates,function(value,key){_this.updateInfo_(key,value)})};Repo.prototype.updateInfo_=function(pathString,value){var path=new Path_1.Path("/.info/"+pathString);var newNode=nodeFromJSON_1.nodeFromJSON(value);this.infoData_.updateSnapshot(path,newNode);var events=this.infoSyncTree_.applyServerOverwrite(path,newNode);this.eventQueue_.raiseEventsForChangedPath(path,events)};Repo.prototype.getNextWriteId_=function(){return this.nextWriteId_++};Repo.prototype.setWithPriority=function(path,newVal,newPriority,onComplete){var _this=this;this.log_("set",{path:path.toString(),value:newVal,priority:newPriority});var serverValues=this.generateServerValues();var newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(newVal,newPriority);var newNode=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues);var writeId=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserOverwrite(path,newNode,writeId,true);this.eventQueue_.queueEvents(events);this.server_.put(path.toString(),newNodeUnresolved.val(true),function(status,errorReason){var success=status==="ok";if(!success){util_2.warn("set at "+path+" failed: "+status)}var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId,!success);_this.eventQueue_.raiseEventsForChangedPath(path,clearEvents);_this.callOnCompleteCallback(onComplete,status,errorReason)});var affectedPath=this.abortTransactions_(path);this.rerunTransactions_(affectedPath);this.eventQueue_.raiseEventsForChangedPath(affectedPath,[])};Repo.prototype.update=function(path,childrenToMerge,onComplete){var _this=this;this.log_("update",{path:path.toString(),value:childrenToMerge});var empty=true;var serverValues=this.generateServerValues();var changedChildren={};util_3.forEach(childrenToMerge,function(changedKey,changedValue){empty=false;var newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(changedValue);changedChildren[changedKey]=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues)});if(!empty){var writeId_1=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserMerge(path,changedChildren,writeId_1);this.eventQueue_.queueEvents(events);this.server_.merge(path.toString(),childrenToMerge,function(status,errorReason){var success=status==="ok";if(!success){util_2.warn("update at "+path+" failed: "+status)}var clearEvents=_this.serverSyncTree_.ackUserWrite(writeId_1,!success);var affectedPath=clearEvents.length>0?_this.rerunTransactions_(path):path;_this.eventQueue_.raiseEventsForChangedPath(affectedPath,clearEvents);_this.callOnCompleteCallback(onComplete,status,errorReason)});util_3.forEach(childrenToMerge,function(changedPath){var affectedPath=_this.abortTransactions_(path.child(changedPath));_this.rerunTransactions_(affectedPath)});this.eventQueue_.raiseEventsForChangedPath(path,[])}else{util_2.log("update() called with empty data.  Don't do anything.");this.callOnCompleteCallback(onComplete,"ok")}};Repo.prototype.runOnDisconnectEvents_=function(){var _this=this;this.log_("onDisconnectEvents");var serverValues=this.generateServerValues();var resolvedOnDisconnectTree=ServerValues_1.resolveDeferredValueTree(this.onDisconnect_,serverValues);var events=[];resolvedOnDisconnectTree.forEachTree(Path_1.Path.Empty,function(path,snap){events=events.concat(_this.serverSyncTree_.applyServerOverwrite(path,snap));var affectedPath=_this.abortTransactions_(path);_this.rerunTransactions_(affectedPath)});this.onDisconnect_=new SparseSnapshotTree_1.SparseSnapshotTree;this.eventQueue_.raiseEventsForChangedPath(Path_1.Path.Empty,events)};Repo.prototype.onDisconnectCancel=function(path,onComplete){var _this=this;this.server_.onDisconnectCancel(path.toString(),function(status,errorReason){if(status==="ok"){_this.onDisconnect_.forget(path)}_this.callOnCompleteCallback(onComplete,status,errorReason)})};Repo.prototype.onDisconnectSet=function(path,value,onComplete){var _this=this;var newNode=nodeFromJSON_1.nodeFromJSON(value);this.server_.onDisconnectPut(path.toString(),newNode.val(true),function(status,errorReason){if(status==="ok"){_this.onDisconnect_.remember(path,newNode)}_this.callOnCompleteCallback(onComplete,status,errorReason)})};Repo.prototype.onDisconnectSetWithPriority=function(path,value,priority,onComplete){var _this=this;var newNode=nodeFromJSON_1.nodeFromJSON(value,priority);this.server_.onDisconnectPut(path.toString(),newNode.val(true),function(status,errorReason){if(status==="ok"){_this.onDisconnect_.remember(path,newNode)}_this.callOnCompleteCallback(onComplete,status,errorReason)})}
;Repo.prototype.onDisconnectUpdate=function(path,childrenToMerge,onComplete){var _this=this;if(util_3.isEmpty(childrenToMerge)){util_2.log("onDisconnect().update() called with empty data.  Don't do anything.");this.callOnCompleteCallback(onComplete,"ok");return}this.server_.onDisconnectMerge(path.toString(),childrenToMerge,function(status,errorReason){if(status==="ok"){util_3.forEach(childrenToMerge,function(childName,childNode){var newChildNode=nodeFromJSON_1.nodeFromJSON(childNode);_this.onDisconnect_.remember(path.child(childName),newChildNode)})}_this.callOnCompleteCallback(onComplete,status,errorReason)})};Repo.prototype.addEventCallbackForQuery=function(query,eventRegistration){var events;if(query.path.getFront()===".info"){events=this.infoSyncTree_.addEventRegistration(query,eventRegistration)}else{events=this.serverSyncTree_.addEventRegistration(query,eventRegistration)}this.eventQueue_.raiseEventsAtPath(query.path,events)};Repo.prototype.removeEventCallbackForQuery=function(query,eventRegistration){var events;if(query.path.getFront()===".info"){events=this.infoSyncTree_.removeEventRegistration(query,eventRegistration)}else{events=this.serverSyncTree_.removeEventRegistration(query,eventRegistration)}this.eventQueue_.raiseEventsAtPath(query.path,events)};Repo.prototype.interrupt=function(){if(this.persistentConnection_){this.persistentConnection_.interrupt(INTERRUPT_REASON)}};Repo.prototype.resume=function(){if(this.persistentConnection_){this.persistentConnection_.resume(INTERRUPT_REASON)}};Repo.prototype.stats=function(showDelta){if(showDelta===void 0){showDelta=false}if(typeof console==="undefined")return;var stats;if(showDelta){if(!this.statsListener_)this.statsListener_=new StatsListener_1.StatsListener(this.stats_);stats=this.statsListener_.get()}else{stats=this.stats_.get()}var longestName=Object.keys(stats).reduce(function(previousValue,currentValue){return Math.max(currentValue.length,previousValue)},0);util_3.forEach(stats,function(stat,value){for(var i=stat.length;i<longestName+2;i++)stat+=" ";console.log(stat+value)})};Repo.prototype.statsIncrementCounter=function(metric){this.stats_.incrementCounter(metric);this.statsReporter_.includeStat(metric)};Repo.prototype.log_=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}var prefix="";if(this.persistentConnection_){prefix=this.persistentConnection_.id+":"}util_2.log.apply(void 0,[prefix].concat(var_args))};Repo.prototype.callOnCompleteCallback=function(callback,status,errorReason){if(callback){util_2.exceptionGuard(function(){if(status=="ok"){callback(null)}else{var code=(status||"error").toUpperCase();var message=code;if(errorReason)message+=": "+errorReason;var error=new Error(message);error.code=code;callback(error)}})}};Object.defineProperty(Repo.prototype,"database",{get:function(){return this.__database||(this.__database=new Database_1.Database(this))},enumerable:true,configurable:true});return Repo}();exports.Repo=Repo},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var CacheNode=function(){function CacheNode(node_,fullyInitialized_,filtered_){this.node_=node_;this.fullyInitialized_=fullyInitialized_;this.filtered_=filtered_}CacheNode.prototype.isFullyInitialized=function(){return this.fullyInitialized_};CacheNode.prototype.isFiltered=function(){return this.filtered_};CacheNode.prototype.isCompleteForPath=function(path){if(path.isEmpty()){return this.isFullyInitialized()&&!this.filtered_}var childKey=path.getFront();return this.isCompleteForChild(childKey)};CacheNode.prototype.isCompleteForChild=function(key){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(key)};CacheNode.prototype.getNode=function(){return this.node_};return CacheNode}();exports.CacheNode=CacheNode},function(module,__webpack_exports__,__webpack_require__){"use strict";var CODES={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"};var ERROR_MAP=(_a={},_a[CODES.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",_a[CODES.AVAILABLE_IN_SW]="This method is available in a service worker "+"context.",_a[CODES.SHOULD_BE_INHERITED]="This method should be overriden by "+"extended classes.",_a[CODES.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set "+"correctly in the options passed into firebase.initializeApp().",_a[CODES.PERMISSION_DEFAULT]="The required permissions were not granted and "+"dismissed instead.",_a[CODES.PERMISSION_BLOCKED]="The required permissions were not granted and "+"blocked instead.",_a[CODES.UNSUPPORTED_BROWSER]="This browser doesn't support the API's "+"required to use the firebase SDK.",_a[CODES.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",_a[CODES.FAILED_DEFAULT_REGISTRATION]="We are unable to register the "+"default service worker. {$browserErrorMessage}",_a[CODES.SW_REGISTRATION_EXPECTED]="A service worker registration was the "+"expected input.",_a[CODES.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get "+"any existing Push Subscriptions.",_a[CODES.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",_a[CODES.SW_REG_REDUNDANT]="The service worker being used for push was made "+"redundant.",_a[CODES.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the "+"user to FCM: {$message}",_a[CODES.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing "+"the user to push.",_a[CODES.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response "+"when getting an FCM token.",_a[CODES.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before "+"calling getToken() to ensure your service worker is used.",_a[CODES.INVALID_DELETE_TOKEN]="You must pass a valid token into "+"deleteToken(), i.e. the token from getToken().",_a[CODES.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not "+"be performed as the token was not found.",_a[CODES.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker "+"scope could not be performed as the scope was not found.",_a[CODES.BG_HANDLER_FUNCTION_EXPECTED]="The input to "+"setBackgroundMessageHandler() must be a function.",_a[CODES.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a "+"non-existant window client.",_a[CODES.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing "+"the FCM token for push messaging. Will have to resubscribe the "+"user on next visit. {$message}",_a[CODES.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token "+"and as a result, unable to resubscribe. Will have to resubscribe the "+"user on next visit.",_a[CODES.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",_a[CODES.NO_SW_IN_REG]="Even though the service worker registration was "+"successful, there was a problem accessing the service worker itself.",_a[CODES.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's "+"'gcm_sender_id' value to '103953800507' to use Firebase messaging.",_a[CODES.BAD_SCOPE]="The service worker scope must be a string with at "+"least one character.",_a[CODES.BAD_VAPID_KEY]="The public VAPID key must be a string with at "+"least one character.",_a[CODES.BAD_SUBSCRIPTION]="The subscription must be a valid "+"PushSubscription.",_a[CODES.BAD_TOKEN]="The FCM Token used for storage / lookup was not "+"a valid token string.",_a[CODES.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not "+"not a valid push set string.",_a[CODES.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",_a);__webpack_exports__["a"]={codes:CODES,map:ERROR_MAP};var _a},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"f",function(){return domainBase});__webpack_require__.d(__webpack_exports__,"g",function(){return downloadBase});__webpack_require__.d(__webpack_exports__,"a",function(){return apiBaseUrl});__webpack_require__.d(__webpack_exports__,"b",function(){return apiUploadBaseUrl});__webpack_require__.d(__webpack_exports__,"c",function(){return configOption});__webpack_require__.d(__webpack_exports__,"d",function(){return defaultMaxOperationRetryTime});__webpack_require__.d(__webpack_exports__,"e",function(){return defaultMaxUploadRetryTime});__webpack_require__.d(__webpack_exports__,"h",function(){return minSafeInteger});var domainBase="https://firebasestorage.googleapis.com";var downloadBase="https://firebasestorage.googleapis.com";var apiBaseUrl="/v0";var apiUploadBaseUrl="/v0";function setDomainBase(domainBase){domainBase=domainBase}var configOption="storageBucket";var shortMaxOperationRetryTime=1*60*1e3;var defaultMaxOperationRetryTime=2*60*1e3;var defaultMaxUploadRetryTime=10*60*100;var minSafeInteger=-9007199254740991},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Location});var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(9);var Location=function(){function Location(bucket,path){this.bucket=bucket;this.path_=path}Object.defineProperty(Location.prototype,"path",{get:function(){return this.path_},enumerable:true,configurable:true});Location.prototype.fullServerUrl=function(){var encode=encodeURIComponent;return"/b/"+encode(this.bucket)+"/o/"+encode(this.path)};Location.prototype.bucketOnlyServerUrl=function(){var encode=encodeURIComponent;return"/b/"+encode(this.bucket)+"/o"};Location.makeFromBucketSpec=function(bucketString){var bucketLocation;try{bucketLocation=Location.makeFromUrl(bucketString)}catch(e){return new Location(bucketString,"")}if(bucketLocation.path===""){return bucketLocation}else{throw __WEBPACK_IMPORTED_MODULE_0__error__["h"](bucketString)}};Location.makeFromUrl=function(url){var location=null;var bucketDomain="([A-Za-z0-9.\\-]+)";function gsModify(loc){if(loc.path.charAt(loc.path.length-1)==="/"){loc.path_=loc.path_.slice(0,-1)}}var gsPath="(/(.*))?$";var path="(/([^?#]*).*)?$";var gsRegex=new RegExp("^gs://"+bucketDomain+gsPath,"i");var gsIndices={bucket:1,path:3};function httpModify(loc){loc.path_=decodeURIComponent(loc.path)}var version="v[A-Za-z0-9_]+";var httpRegex=new RegExp("^https?://firebasestorage\\.googleapis\\.com/"+version+"/b/"+bucketDomain+"/o"+path,"i");var httpIndices={bucket:1,path:3};var groups=[{regex:gsRegex,indices:gsIndices,postModify:gsModify},{regex:httpRegex,indices:httpIndices,postModify:httpModify}];for(var i=0;i<groups.length;i++){var group=groups[i];var captures=group.regex.exec(url);if(captures){var bucketValue=captures[group.indices.bucket];var pathValue=captures[group.indices.path];if(!pathValue){pathValue=""}location=new Location(bucketValue,pathValue);group.postModify(location);break}}if(location==null){throw __WEBPACK_IMPORTED_MODULE_0__error__["k"](url)}return location};return Location}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Control=void 0;var _kline=_interopRequireDefault(__webpack_require__(15));var _kline_trade=__webpack_require__(54);var _chart_manager=__webpack_require__(3);var _chart_settings=__webpack_require__(18);var _templates=__webpack_require__(25);var _mevent=__webpack_require__(57);var _jquery=_interopRequireDefault(__webpack_require__(59));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Control=function(){function Control(){_classCallCheck(this,Control)}_createClass(Control,null,[{key:"refreshFunction",value:function refreshFunction(){Control.refreshCounter++;var lang=_chart_manager.ChartManager.instance.getLanguage();if(Control.refreshCounter>3600){var num=Number(Control.refreshCounter/3600);if(lang==="en-us"){(0,_jquery.default)("#chart_updated_time_text").html(num.toFixed(0)+"h")}else if(lang==="zh-tw"){(0,_jquery.default)("#chart_updated_time_text").html(num.toFixed(0)+"小時")}else{(0,_jquery.default)("#chart_updated_time_text").html(num.toFixed(0)+"小时")}}else if(Control.refreshCounter>60&&Control.refreshCounter<=3600){var _num=Number(Control.refreshCounter/60);if(lang==="en-us"){(0,_jquery.default)("#chart_updated_time_text").html(_num.toFixed(0)+"m")}else if(lang==="zh-tw"){(0,_jquery.default)("#chart_updated_time_text").html(_num.toFixed(0)+"分鐘")}else{(0,_jquery.default)("#chart_updated_time_text").html(_num.toFixed(0)+"分钟")}}else if(Control.refreshCounter<=60){if(lang==="en-us"){(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"s")}else{(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"秒")}}}},{key:"clearRefreshCounter",value:function clearRefreshCounter(){window.clearInterval(Control.refreshHandler);Control.refreshCounter=0;var lang=_chart_manager.ChartManager.instance.getLanguage();if(lang==="en-us"){(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"s")}else{(0,_jquery.default)("#chart_updated_time_text").html(Control.refreshCounter+"秒")}Control.refreshHandler=setInterval(Control.refreshFunction,_kline.default.instance.intervalTime)}},{key:"requestData",value:function requestData(showLoading){Control.AbortRequest();window.clearTimeout(_kline.default.instance.timer);if(_kline.default.instance.paused){return}if(showLoading===true){(0,_jquery.default)("#chart_loading").addClass("activated")}if(_kline.default.instance.type==="stomp"&&_kline.default.instance.stompClient){Control.requestOverStomp()}else{Control.requestOverHttp()}}},{key:"parseRequestParam",value:function parseRequestParam(str){return JSON.parse('{"'+decodeURI(str.replace(/&/g,'","').replace(/=/g,'":"'))+'"}')}},{key:"requestOverStomp",value:function requestOverStomp(){if(!_kline.default.instance.socketConnected){if(_kline.default.instance.debug){console.log("DEBUG: socket is not coonnected")}return}if(_kline.default.instance.stompClient&&_kline.default.instance.stompClient.ws.readyState===1){_kline.default.instance.stompClient.send(_kline.default.instance.sendPath,{},JSON.stringify(Control.parseRequestParam(_kline.default.instance.requestParam)));return}if(_kline.default.instance.debug){console.log("DEBUG: stomp client is not ready yet ...")}_kline.default.instance.timer=setTimeout(function(){Control.requestData(true)},1e3)}},{key:"requestOverHttp",value:function requestOverHttp(){if(_kline.default.instance.debug){console.log("DEBUG: "+_kline.default.instance.requestParam)}(0,_jquery.default)(document).ready(_kline.default.instance.G_HTTP_REQUEST=_jquery.default.ajax({type:"GET",url:_kline.default.instance.url,dataType:"json",data:_kline.default.instance.requestParam,timeout:3e4,created:Date.now(),beforeSend:function beforeSend(){this.range=_kline.default.instance.range;this.symbol=_kline.default.instance.symbol},success:function success(res){if(_kline.default.instance.G_HTTP_REQUEST){Control.requestSuccessHandler(res)}},error:function error(xhr,textStatus,errorThrown){if(_kline.default.instance.debug){console.log(xhr)}if(xhr.status===200&&xhr.readyState===4){return}_kline.default.instance.timer=setTimeout(function(){Control.requestData(true)},_kline.default.instance.intervalTime)},complete:function complete(){_kline.default.instance.G_HTTP_REQUEST=null}}))}},{key:"requestSuccessHandler",value:function requestSuccessHandler(res){if(_kline.default.instance.debug){console.log(res)}if(!res||!res.success){if(_kline.default.instance.type==="poll"){_kline.default.instance.timer=setTimeout(function(){Control.requestData(true)},_kline.default.instance.intervalTime)}return}(0,_jquery.default)("#chart_loading").removeClass("activated");var chart=_chart_manager.ChartManager.instance.getChart();chart.setTitle();_kline.default.instance.data=eval(res.data);var updateDataRes=_kline.default.instance.chartMgr.updateData("frame0.k0",_kline.default.instance.data.lines);_kline.default.instance.requestParam=Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,null,_kline.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate());var intervalTime=_kline.default.instance.intervalTime<_kline.default.instance.range?_kline.default.instance.intervalTime:_kline.default.instance.range;if(!updateDataRes){if(_kline.default.instance.type==="poll"){_kline.default.instance.timer=setTimeout(Control.requestData,intervalTime)}return}if(_kline.default.instance.data.trades&&_kline.default.instance.data.trades.length>0){_kline_trade.KlineTrade.instance.pushTrades(_kline.default.instance.data.trades);_kline_trade.KlineTrade.instance.klineTradeInit=true}if(_kline.default.instance.data.depths){_kline_trade.KlineTrade.instance.updateDepth(_kline.default.instance.data.depths)}Control.clearRefreshCounter();if(_kline.default.instance.type==="poll"){_kline.default.instance.timer=setTimeout(Control.TwoSecondThread,intervalTime)}_chart_manager.ChartManager.instance.redraw("All",false)}},{key:"AbortRequest",value:function AbortRequest(){if(_kline.default.instance.type!=="stomp"||!_kline.default.instance.stompClient){if(_kline.default.instance.G_HTTP_REQUEST&&_kline.default.instance.G_HTTP_REQUEST.readyState!==4){_kline.default.instance.G_HTTP_REQUEST.abort()}}}},{key:"TwoSecondThread",value:function TwoSecondThread(){var f=_kline.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate();if(f===-1){_kline.default.instance.requestParam=Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,_kline.default.instance.limit,null)}else{_kline.default.instance.requestParam=Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,null,f.toString())}Control.requestData()}},{key:"readCookie",value:function readCookie(){_chart_settings.ChartSettings.get();_chart_settings.ChartSettings.save();var tmp=_chart_settings.ChartSettings.get();_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",tmp.charts.chartStyle);var symbol=tmp.charts.symbol;if(!_kline.default.instance.init){symbol=_kline.default.instance.symbol;_kline.default.instance.init=true}_kline.default.instance.symbol=symbol;Control.switchSymbolSelected(symbol);var period=tmp.charts.period;Control.switchPeriod(period);(0,_jquery.default)("#chart_period_"+period+"_v a").addClass("selected");(0,_jquery.default)("#chart_period_"+period+"_h a").addClass("selected");if(tmp.charts.indicsStatus==="close"){Control.switchIndic("off")}else if(tmp.charts.indicsStatus==="open"){Control.switchIndic("on")}var mainIndic=(0,_jquery.default)("#chart_select_main_indicator");mainIndic.find("a").each(function(){if((0,_jquery.default)(this).attr("name")===tmp.charts.mIndic){(0,_jquery.default)(this).addClass("selected")}});var chart_style=(0,_jquery.default)("#chart_select_chart_style");chart_style.find("a").each(function(){if((0,_jquery.default)(this)[0].innerHTML===tmp.charts.chartStyle){(0,_jquery.default)(this).addClass("selected")}});_chart_manager.ChartManager.instance.getChart().setMainIndicator(tmp.charts.mIndic);_chart_manager.ChartManager.instance.setThemeName("frame0",tmp.theme);Control.switchTools("off");if(tmp.theme==="Dark"){Control.switchTheme("dark")}else if(tmp.theme==="Light"){Control.switchTheme("light")}Control.chartSwitchLanguage(tmp.language||"zh-cn")}},{key:"setHttpRequestParam",value:function setHttpRequestParam(symbol,range,limit,since){var str="symbol="+symbol+"&range="+range;if(limit!==null)str+="&limit="+limit;else str+="&since="+since;if(_kline_trade.KlineTrade.instance.tradeDate.getTime()!==0){str+="&prevTradeTime="+_kline_trade.KlineTrade.instance.tradeDate.getTime()}return str}},{key:"refreshTemplate",value:function refreshTemplate(){_kline.default.instance.chartMgr=_templates.DefaultTemplate.loadTemplate("frame0.k0","");_chart_manager.ChartManager.instance.redraw("All",true)}},{key:"chartSwitchLanguage",value:function chartSwitchLanguage(lang){var langTmp=lang.replace(/-/,"_");(0,_jquery.default)("#chart_language_switch_tmp").find("span").each(function(){var name=(0,_jquery.default)(this).attr("name");var attr=(0,_jquery.default)(this).attr(langTmp);name="."+name;var obj=(0,_jquery.default)(name)[0];if(name===".chart_str_period_hour"||name===".chart_str_period_minute"){var mhName=(0,_jquery.default)(name).attr("name");var mhHtml=(0,_jquery.default)('#chart_language_switch_tmp > [name="'+mhName+'"]').attr(langTmp);(0,_jquery.default)(name)[0].innerHTML=mhHtml;(0,_jquery.default)(name).attr("orignalName",attr)}else{if(!obj)return;(0,_jquery.default)(name).each(function(){(0,_jquery.default)(this)[0].innerHTML=attr})}});(0,_jquery.default)("#chart_language_setting_div li a").removeClass("selected");(0,_jquery.default)("#chart_language_setting_div li a[name='"+lang+"']").addClass("selected");_chart_manager.ChartManager.instance.setLanguage(lang);_chart_manager.ChartManager.instance.getChart().setTitle();var tmp=_chart_settings.ChartSettings.get();tmp.language=lang;_chart_settings.ChartSettings.save();_kline.default.instance.onLangChange(lang)}},{key:"onSize",value:function onSize(w,h){var width=w||window.innerWidth;var chartWidth=_kline.default.instance.showTrade?width-_kline.default.instance.tradeWidth:width;var height=h||window.innerHeight;var container=(0,_jquery.default)(_kline.default.instance.element);container.css({width:width+"px",height:height+"px"});var toolBar=(0,_jquery.default)("#chart_toolbar");var toolPanel=(0,_jquery.default)("#chart_toolpanel");var canvasGroup=(0,_jquery.default)("#chart_canvasGroup");var tabBar=(0,_jquery.default)("#chart_tabbar");var toolPanelShown=toolPanel[0].style.display!=="inline"?false:true;var tabBarShown=tabBar[0].style.display!=="block"?false:true;var toolBarRect={};toolBarRect.x=0;toolBarRect.y=0;toolBarRect.w=chartWidth;toolBarRect.h=29;var toolPanelRect={};toolPanelRect.x=0;toolPanelRect.y=toolBarRect.h+1;toolPanelRect.w=toolPanelShown?32:0;toolPanelRect.h=height-toolPanelRect.y;var tabBarRect={};tabBarRect.w=toolPanelShown?chartWidth-(toolPanelRect.w+1):chartWidth;tabBarRect.h=tabBarShown?22:-1;tabBarRect.x=chartWidth-tabBarRect.w;tabBarRect.y=height-(tabBarRect.h+1);var canvasGroupRect={};canvasGroupRect.x=tabBarRect.x;canvasGroupRect.y=toolPanelRect.y;canvasGroupRect.w=tabBarRect.w;canvasGroupRect.h=tabBarRect.y-toolPanelRect.y;toolBar.css({left:toolBarRect.x+"px",top:toolBarRect.y+"px",width:toolBarRect.w+"px",height:toolBarRect.h+"px"});if(toolPanelShown){toolPanel.css({left:toolPanelRect.x+"px",top:toolPanelRect.y+"px",width:toolPanelRect.w+"px",height:toolPanelRect.h+"px"})}canvasGroup.css({left:canvasGroupRect.x+"px",top:canvasGroupRect.y+"px",height:canvasGroupRect.h+"px"});var mainCanvas=(0,_jquery.default)("#chart_mainCanvas")[0];var overlayCanvas=(0,_jquery.default)("#chart_overlayCanvas")[0];mainCanvas.width=canvasGroupRect.w;mainCanvas.height=canvasGroupRect.h;overlayCanvas.width=canvasGroupRect.w;overlayCanvas.height=canvasGroupRect.h;if(tabBarShown){tabBar.css({left:tabBarRect.x+"px",top:tabBarRect.y+"px",width:tabBarRect.w+"px",height:tabBarRect.h+"px"})}var dlgSettings=(0,_jquery.default)("#chart_parameter_settings");dlgSettings.css({left:chartWidth-dlgSettings.width()>>1,top:height-dlgSettings.height()>>1});var dlgLoading=(0,_jquery.default)("#chart_loading");dlgLoading.css({left:chartWidth-dlgLoading.width()>>1,top:height-dlgLoading.height()>>2});var domElemCache=(0,_jquery.default)("#chart_dom_elem_cache");var rowTheme=(0,_jquery.default)("#chart_select_theme")[0];var rowTools=(0,_jquery.default)("#chart_enable_tools")[0];var rowIndic=(0,_jquery.default)("#chart_enable_indicator")[0];var periodsVert=(0,_jquery.default)("#chart_toolbar_periods_vert");var periodsVert1=(0,_jquery.default)("#chart_toolbar_periods_vert1");var periodsHorz=(0,_jquery.default)("#chart_toolbar_periods_horz");var periodsHorz1=(0,_jquery.default)("#chart_toolbar_periods_horz1");var showIndic=(0,_jquery.default)("#chart_show_indicator")[0];var showTools=(0,_jquery.default)("#chart_show_tools")[0];var selectTheme=(0,_jquery.default)("#chart_toolbar_theme")[0];var dropDownSettings=(0,_jquery.default)("#chart_dropdown_settings");var periodsVertNW=periodsVert[0].offsetWidth+periodsVert1[0].offsetWidth;var periodsHorzNW=periodsVertNW+periodsHorz[0].offsetWidth+periodsHorz1[0].offsetWidth;var showIndicNW=periodsVertNW+showIndic.offsetWidth+4;var showToolsNW=showIndicNW+showTools.offsetWidth+4;var selectThemeNW=showToolsNW+selectTheme.offsetWidth;var dropDownSettingsW=dropDownSettings.find(".chart_dropdown_t")[0].offsetWidth+200;periodsVertNW+=dropDownSettingsW;periodsHorzNW+=dropDownSettingsW;showIndicNW+=dropDownSettingsW;showToolsNW+=dropDownSettingsW;selectThemeNW+=dropDownSettingsW;if(chartWidth<showIndicNW){domElemCache.append(showIndic);rowIndic.style.display=""}else{dropDownSettings.before(showIndic);rowIndic.style.display="none"}if(chartWidth<showToolsNW){domElemCache.append(showTools);rowTools.style.display=""}else{dropDownSettings.before(showTools);rowTools.style.display="none"}if(chartWidth<selectThemeNW){domElemCache.append(selectTheme);rowTheme.style.display=""}else{dropDownSettings.before(selectTheme);rowTheme.style.display="none"}_chart_manager.ChartManager.instance.redraw("All",true);_kline.default.instance.onResize(width,height)}},{key:"mouseWheel",value:function mouseWheel(e,delta){_chart_manager.ChartManager.instance.scale(delta>0?1:-1);_chart_manager.ChartManager.instance.redraw("All",true);return false}},{key:"switchTheme",value:function switchTheme(name){(0,_jquery.default)("#chart_toolbar_theme a").removeClass("selected");(0,_jquery.default)("#chart_select_theme a").removeClass("selected");(0,_jquery.default)("#chart_toolbar_theme").find("a").each(function(){if((0,_jquery.default)(this).attr("name")===name){(0,_jquery.default)(this).addClass("selected")}});(0,_jquery.default)("#chart_select_theme a").each(function(){if((0,_jquery.default)(this).attr("name")===name){(0,_jquery.default)(this).addClass("selected")}});(0,_jquery.default)(".chart_container").attr("class","chart_container "+name);(0,_jquery.default)(".marketName_ a").attr("class",name);if(name==="dark"){(0,_jquery.default)(".trade_container").addClass("dark").removeClass("light");_chart_manager.ChartManager.instance.setThemeName("frame0","Dark");var tmp=_chart_settings.ChartSettings.get();tmp.theme="Dark";_chart_settings.ChartSettings.save()}else if(name==="light"){(0,_jquery.default)(".trade_container").addClass("light").removeClass("dark");_chart_manager.ChartManager.instance.setThemeName("frame0","Light");var _tmp=_chart_settings.ChartSettings.get();_tmp.theme="Light";_chart_settings.ChartSettings.save()}var a={};a.command="set current themes";a.content=name;(0,_jquery.default)("#chart_output_interface_text").val(JSON.stringify(a));(0,_jquery.default)("#chart_output_interface_submit").submit();(new _mevent.MEvent).raise(name);_chart_manager.ChartManager.instance.redraw();_kline.default.instance.onThemeChange(name)}},{key:"switchTools",value:function switchTools(name){(0,_jquery.default)(".chart_dropdown_data").removeClass("chart_dropdown-hover");(0,_jquery.default)("#chart_toolpanel .chart_toolpanel_button").removeClass("selected");(0,_jquery.default)("#chart_enable_tools a").removeClass("selected");if(name==="on"){(0,_jquery.default)("#chart_show_tools").addClass("selected");(0,_jquery.default)("#chart_enable_tools a").each(function(){if((0,_jquery.default)(this).attr("name")==="on"){(0,_jquery.default)(this).addClass("selected")}});(0,_jquery.default)("#chart_toolpanel")[0].style.display="inline";if(_chart_manager.ChartManager.instance._drawingTool===_chart_manager.ChartManager.DrawingTool.Cursor){(0,_jquery.default)("#chart_Cursor").parent().addClass("selected")}else if(_chart_manager.ChartManager.instance._drawingTool===_chart_manager.ChartManager.DrawingTool.CrossCursor){(0,_jquery.default)("#chart_CrossCursor").parent().addClass("selected")}}else if(name==="off"){(0,_jquery.default)("#chart_show_tools").removeClass("selected");(0,_jquery.default)("#chart_enable_tools a").each(function(){if((0,_jquery.default)(this).attr("name")==="off"){(0,_jquery.default)(this).addClass("selected")}});(0,_jquery.default)("#chart_toolpanel")[0].style.display="none";_chart_manager.ChartManager.instance.setRunningMode(_chart_manager.ChartManager.instance._beforeDrawingTool);_chart_manager.ChartManager.instance.redraw("All",true)}if(_kline.default.instance.isSized){Control.onSize()}else{Control.onSize(_kline.default.instance.width,_kline.default.instance.height)}}},{key:"switchIndic",value:function switchIndic(name){(0,_jquery.default)("#chart_enable_indicator a").removeClass("selected");(0,_jquery.default)("#chart_enable_indicator a[name='"+name+"']").addClass("selected");if(name==="on"){(0,_jquery.default)("#chart_show_indicator").addClass("selected");var tmp=_chart_settings.ChartSettings.get();tmp.charts.indicsStatus="open";_chart_settings.ChartSettings.save();var value=tmp.charts.indics[1];if(_templates.Template.displayVolume===false)_chart_manager.ChartManager.instance.getChart().setIndicator(2,value);else _chart_manager.ChartManager.instance.getChart().setIndicator(2,value);(0,_jquery.default)("#chart_tabbar").find("a").each(function(){if((0,_jquery.default)(this).attr("name")===value)(0,_jquery.default)(this).addClass("selected")});(0,_jquery.default)("#chart_tabbar")[0].style.display="block"}else if(name==="off"){(0,_jquery.default)("#chart_show_indicator").removeClass("selected");_chart_manager.ChartManager.instance.getChart().setIndicator(2,"NONE");var _tmp2=_chart_settings.ChartSettings.get();_tmp2.charts.indicsStatus="close";_chart_settings.ChartSettings.save();(0,_jquery.default)("#chart_tabbar")[0].style.display="none";(0,_jquery.default)("#chart_tabbar a").removeClass("selected")}if(_kline.default.instance.isSized){Control.onSize()}else{Control.onSize(_kline.default.instance.width,_kline.default.instance.height)}}},{key:"switchPeriod",value:function switchPeriod(name){(0,_jquery.default)(".chart_container .chart_toolbar_tabgroup a").removeClass("selected");(0,_jquery.default)("#chart_toolbar_periods_vert ul a").removeClass("selected");(0,
_jquery.default)("#chart_toolbar_periods_vert1 ul a").removeClass("selected");(0,_jquery.default)(".chart_str_period_hour").removeClass("selected");(0,_jquery.default)(".chart_str_period_minute").removeClass("selected");(0,_jquery.default)(".chart_container .chart_toolbar_tabgroup a").each(function(){if((0,_jquery.default)(this).parent().attr("name")===name){(0,_jquery.default)(this).addClass("selected")}});(0,_jquery.default)("#chart_toolbar_periods_vert ul a").each(function(){if((0,_jquery.default)(this).parent().attr("name")===name){(0,_jquery.default)(this).addClass("selected");(0,_jquery.default)(".chart_str_period_minute").addClass("selected");(0,_jquery.default)(".chart_str_period_minute").attr("name","chart_str_period_"+name);(0,_jquery.default)(".chart_str_period_minute").html((0,_jquery.default)(".chart_str_period_"+name).html());(0,_jquery.default)(".chart_str_period_hour").attr("name","chart_str_period_hour");(0,_jquery.default)(".chart_str_period_hour").html((0,_jquery.default)(".chart_str_period_hour").attr("orignalName"))}});(0,_jquery.default)("#chart_toolbar_periods_vert1 ul a").each(function(){if((0,_jquery.default)(this).parent().attr("name")===name){(0,_jquery.default)(this).addClass("selected");(0,_jquery.default)(".chart_str_period_hour").addClass("selected");(0,_jquery.default)(".chart_str_period_hour").attr("name","chart_str_period_"+name);(0,_jquery.default)(".chart_str_period_hour").html((0,_jquery.default)(".chart_str_period_"+name).html());(0,_jquery.default)(".chart_str_period_minute").attr("name","chart_str_period_minute");(0,_jquery.default)(".chart_str_period_minute").html((0,_jquery.default)(".chart_str_period_minute").attr("orignalName"))}});if(["line","1d","1w","1M"].indexOf(name)!==-1){(0,_jquery.default)(".chart_str_period_minute").attr("name","chart_str_period_minute");(0,_jquery.default)(".chart_str_period_minute").html((0,_jquery.default)(".chart_str_period_minute").attr("orignalName"));(0,_jquery.default)(".chart_str_period_hour").attr("name","chart_str_period_hour");(0,_jquery.default)(".chart_str_period_hour").html((0,_jquery.default)(".chart_str_period_hour").attr("orignalName"))}_chart_manager.ChartManager.instance.showCursor();Control.calcPeriodWeight(name);if(name==="line"){_chart_manager.ChartManager.instance.getChart().strIsLine=true;_chart_manager.ChartManager.instance.setChartStyle("frame0.k0","Line");_chart_manager.ChartManager.instance.getChart().setCurrentPeriod("line");var _settings=_chart_settings.ChartSettings.get();_settings.charts.period=name;_chart_settings.ChartSettings.save();return}_chart_manager.ChartManager.instance.getChart().strIsLine=false;var p=_kline.default.instance.tagMapPeriod[name];_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",_chart_settings.ChartSettings.get().charts.chartStyle);_chart_manager.ChartManager.instance.getChart().setCurrentPeriod(p);var settings=_chart_settings.ChartSettings.get();settings.charts.period=name;_chart_settings.ChartSettings.save()}},{key:"reset",value:function reset(symbol){_kline.default.instance.symbol=symbol;if(_kline.default.instance.showTrade){_kline_trade.KlineTrade.instance.reset(symbol)}}},{key:"switchSymbolSelected",value:function switchSymbolSelected(symbol){Control.reset(symbol);(0,_jquery.default)(".market_chooser ul a").removeClass("selected");(0,_jquery.default)(".market_chooser ul a[name='"+symbol+"']").addClass("selected");_chart_manager.ChartManager.instance.getChart()._symbol=symbol;var settings=_chart_settings.ChartSettings.get();settings.charts.symbol=symbol;_chart_settings.ChartSettings.save()}},{key:"switchSymbol",value:function switchSymbol(symbol){if(_kline.default.instance.type==="stomp"&&_kline.default.instance.stompClient.ws.readyState===1){_kline.default.instance.subscribed.unsubscribe();_kline.default.instance.subscribed=_kline.default.instance.stompClient.subscribe(_kline.default.instance.subscribePath+"/"+symbol+"/"+_kline.default.instance.range,Control.subscribeCallback)}Control.switchSymbolSelected(symbol);var settings=_chart_settings.ChartSettings.get();if(settings.charts.period==="line"){_chart_manager.ChartManager.instance.getChart().strIsLine=true;_chart_manager.ChartManager.instance.setChartStyle("frame0.k0","Line")}else{_chart_manager.ChartManager.instance.getChart().strIsLine=false;_chart_manager.ChartManager.instance.setChartStyle("frame0.k0",_chart_settings.ChartSettings.get().charts.chartStyle)}_chart_manager.ChartManager.instance.getChart().setSymbol(symbol)}},{key:"calcPeriodWeight",value:function calcPeriodWeight(period){var index=period;if(period!=="line")index=_kline.default.instance.periodMap[_kline.default.instance.tagMapPeriod[period]];var periodWeight=_chart_settings.ChartSettings.get().charts.period_weight;for(var i in periodWeight){if(periodWeight[i]>periodWeight[index]){periodWeight[i]-=1}}periodWeight[index]=8;_chart_settings.ChartSettings.save()}},{key:"subscribeCallback",value:function subscribeCallback(res){Control.requestSuccessHandler(JSON.parse(res.body))}},{key:"socketConnect",value:function socketConnect(){if(!_kline.default.instance.stompClient||!_kline.default.instance.socketConnected){if(_kline.default.instance.enableSockjs){var socket=new SockJS(_kline.default.instance.url);_kline.default.instance.stompClient=Stomp.over(socket)}else{_kline.default.instance.stompClient=Stomp.client(_kline.default.instance.url)}_kline.default.instance.socketConnected=true}if(_kline.default.instance.stompClient.ws.readyState===1){console.log("DEBUG: already connected");return}if(!_kline.default.instance.debug){_kline.default.instance.stompClient.debug=null}_kline.default.instance.stompClient.connect({},function(){_kline.default.instance.stompClient.subscribe("/user"+_kline.default.instance.subscribePath,Control.subscribeCallback);_kline.default.instance.subscribed=_kline.default.instance.stompClient.subscribe(_kline.default.instance.subscribePath+"/"+_kline.default.instance.symbol+"/"+_kline.default.instance.range,Control.subscribeCallback);Control.requestData(true)},function(){_kline.default.instance.stompClient.disconnect();console.log("DEBUG: reconnect in 5 seconds ...");setTimeout(function(){Control.socketConnect()},5e3)})}}]);return Control}();exports.Control=Control;Control.refreshCounter=0;Control.refreshHandler=null},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CPoint=void 0;var _chart_manager=__webpack_require__(3);var _named_object=__webpack_require__(8);var data_sources=_interopRequireWildcard(__webpack_require__(11));var _util=__webpack_require__(19);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CPoint=function(_NamedObject){_inherits(CPoint,_NamedObject);function CPoint(name){var _this;_classCallCheck(this,CPoint);_this=_possibleConstructorReturn(this,(CPoint.__proto__||Object.getPrototypeOf(CPoint)).call(this,name));_this.pos={index:-1,value:-1};_this.state=CPoint.state.Hide;return _this}_createClass(CPoint,[{key:"getChartObjects",value:function getChartObjects(){var ppMgr=_chart_manager.ChartManager.instance;var ppCDS=ppMgr.getDataSource("frame0.k0");if(ppCDS===null||!_util.Util.isInstance(ppCDS,data_sources.MainDataSource))return null;var ppTimeline=ppMgr.getTimeline("frame0.k0");if(ppTimeline===null)return null;var ppRange=ppMgr.getRange("frame0.k0.main");if(ppRange===null)return null;return{pMgr:ppMgr,pCDS:ppCDS,pTimeline:ppTimeline,pRange:ppRange}}},{key:"setPosXY",value:function setPosXY(x,y){var pObj=this.getChartObjects();var i=pObj.pTimeline.toIndex(x);var v=pObj.pRange.toValue(y);var result=this.snapValue(i,v);if(result!==null)v=result;this.setPosIV(i,v)}},{key:"setPosXYNoSnap",value:function setPosXYNoSnap(x,y){var pObj=this.getChartObjects();var i=pObj.pTimeline.toIndex(x);var v=pObj.pRange.toValue(y);this.setPosIV(i,v)}},{key:"setPosIV",value:function setPosIV(i,v){this.pos={index:i,value:v}}},{key:"getPosXY",value:function getPosXY(){var pObj=this.getChartObjects();var _x=pObj.pTimeline.toItemCenter(this.pos.index);var _y=pObj.pRange.toY(this.pos.value);return{x:_x,y:_y}}},{key:"getPosIV",value:function getPosIV(){return{i:this.pos.index,v:this.pos.value}}},{key:"setState",value:function setState(s){this.state=s}},{key:"getState",value:function getState(){return this.state}},{key:"isSelected",value:function isSelected(x,y){var xy=this.getPosXY();if(x<xy.x-4||x>xy.x+4||y<xy.y-4||y>xy.y+4)return false;this.setState(CPoint.state.Highlight);return true}},{key:"snapValue",value:function snapValue(i,v){var pObj=this.getChartObjects();var result=null;var first=Math.floor(pObj.pTimeline.getFirstIndex());var last=Math.floor(pObj.pTimeline.getLastIndex());if(i<first||i>last)return result;var y=pObj.pRange.toY(v);var pData=pObj.pCDS.getDataAt(i);if(pData===null||pData===undefined)return result;var pDataPre=null;if(i>0)pDataPre=pObj.pCDS.getDataAt(i-1);else pDataPre=pObj.pCDS.getDataAt(i);var candleStickStyle=pObj.pMgr.getChartStyle(pObj.pCDS.getFrameName());var open=pObj.pRange.toY(pData.open);var high=pObj.pRange.toY(pData.high);var low=pObj.pRange.toY(pData.low);var close=pObj.pRange.toY(pData.close);if(candleStickStyle==="CandleStickHLC"){open=pObj.pRange.toY(pDataPre.close)}var dif_open=Math.abs(open-y);var dif_high=Math.abs(high-y);var dif_low=Math.abs(low-y);var dif_close=Math.abs(close-y);if(dif_open<=dif_high&&dif_open<=dif_low&&dif_open<=dif_close){if(dif_open<6)result=pData.open}if(dif_high<=dif_open&&dif_high<=dif_low&&dif_high<=dif_close){if(dif_high<6)result=pData.high}if(dif_low<=dif_open&&dif_low<=dif_high&&dif_low<=dif_close){if(dif_low<6)result=pData.low}if(dif_close<=dif_open&&dif_close<=dif_high&&dif_close<=dif_low){if(dif_close<6)result=pData.close}return result}}]);return CPoint}(_named_object.NamedObject);exports.CPoint=CPoint;CPoint.state={Hide:0,Show:1,Highlight:2}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CArrowLineObject=exports.CPriceLineObject=exports.CVertiStraightLineObject=exports.CTriParallelLineObject=exports.CStraightLineObject=exports.CSegLineObject=exports.CRayLineObject=exports.CHoriStraightLineObject=exports.CHoriSegLineObject=exports.CHoriRayLineObject=exports.CFibRetraceObject=exports.CFibFansObject=exports.CBiParallelRayLineObject=exports.CBiParallelLineObject=exports.CBandLineObject=exports.CTriToolObject=exports.CBiToolObject=exports.CToolObject=void 0;var _chart_manager=__webpack_require__(3);var _named_object=__webpack_require__(8);var _cpoint=__webpack_require__(37);var _util=__webpack_require__(19);var data_sources=_interopRequireWildcard(__webpack_require__(11));var plotters=_interopRequireWildcard(__webpack_require__(39));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _assertThisInitialized(self){if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return _get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CToolObject=function(_NamedObject){_inherits(CToolObject,_NamedObject);function CToolObject(name){var _this;_classCallCheck(this,CToolObject);_this=_possibleConstructorReturn(this,(CToolObject.__proto__||Object.getPrototypeOf(CToolObject)).call(this,name));_this.drawer=null;_this.state=CToolObject.state.BeforeDraw;_this.points=[];_this.step=0;return _this}_createClass(CToolObject,[{key:"getChartObjects",value:function getChartObjects(){var ppMgr=_chart_manager.ChartManager.instance;var ppCDS=ppMgr.getDataSource("frame0.k0");if(ppCDS===null||!_util.Util.isInstance(ppCDS,data_sources.MainDataSource))return null;var ppTimeline=ppMgr.getTimeline("frame0.k0");if(ppTimeline===null)return null;var ppArea=ppMgr.getArea("frame0.k0.main");if(ppArea===null)return null;var ppRange=ppMgr.getRange("frame0.k0.main");if(ppRange===null)return null;return{pMgr:ppMgr,pCDS:ppCDS,pTimeline:ppTimeline,pArea:ppArea,pRange:ppRange}}},{key:"isValidMouseXY",value:function isValidMouseXY(x,y){var pObj=this.getChartObjects();var areaPos={left:pObj.pArea.getLeft(),top:pObj.pArea.getTop(),right:pObj.pArea.getRight(),bottom:pObj.pArea.getBottom()};return!(x<areaPos.left||x>areaPos.right||y<areaPos.top||y>areaPos.bottom)}},{key:"getPlotter",value:function getPlotter(){return this.drawer}},{key:"setState",value:function setState(s){this.state=s}},{key:"getState",value:function getState(){return this.state}},{key:"addPoint",value:function addPoint(point){this.points.push(point)}},{key:"getPoint",value:function getPoint(i){return this.points[i]}},{key:"acceptMouseMoveEvent",value:function acceptMouseMoveEvent(x,y){if(this.isValidMouseXY(x,y)===false){return false}if(this.state===CToolObject.state.BeforeDraw){this.setBeforeDrawPos(x,y)}else if(this.state===CToolObject.state.Draw){this.setDrawPos(x,y)}else if(this.state===CToolObject.state.AfterDraw){this.setAfterDrawPos(x,y)}return true}},{key:"acceptMouseDownEvent",value:function acceptMouseDownEvent(x,y){if(this.isValidMouseXY(x,y)===false){return false}if(this.state===CToolObject.state.BeforeDraw){this.setDrawPos(x,y);this.setState(CToolObject.state.Draw)}else if(this.state===CToolObject.state.Draw){this.setAfterDrawPos(x,y);if(this.step===0)this.setState(CToolObject.state.AfterDraw)}else if(this.state===CToolObject.state.AfterDraw){if(CToolObject.prototype.isSelected(x,y)){this.setDrawPos(x,y);this.setState(CToolObject.state.Draw)}else{this.oldx=x;this.oldy=y}}return true}},{key:"acceptMouseDownMoveEvent",value:function acceptMouseDownMoveEvent(x,y){if(this.isValidMouseXY(x,y)===false){return false}if(this.state===CToolObject.state.Draw){this.setDrawPos(x,y)}else if(this.state===CToolObject.state.AfterDraw){var pObj=this.getChartObjects();var _width=pObj.pTimeline.getItemWidth();var _height=pObj.pRange;if(Math.abs(x-this.oldx)<_width&&Math.abs(y-this.oldy)===0)return true;var _old_x=pObj.pTimeline.toIndex(this.oldx);var _old_y=pObj.pRange.toValue(this.oldy);var _new_x=pObj.pTimeline.toIndex(x);var _new_y=pObj.pRange.toValue(y);this.oldx=x;this.oldy=y;var _dif_x=_new_x-_old_x;var _dif_y=_new_y-_old_y;for(var index in this.points){this.points[index].pos.index+=_dif_x;this.points[index].pos.value+=_dif_y}}return true}},{key:"acceptMouseUpEvent",value:function acceptMouseUpEvent(x,y){if(this.isValidMouseXY(x,y)===false){return false}if(this.state===CToolObject.state.Draw){this.setAfterDrawPos(x,y);if(this.step===0)this.setState(CToolObject.state.AfterDraw);return true}return false}},{key:"setBeforeDrawPos",value:function setBeforeDrawPos(x,y){for(var index in this.points){this.points[index].setPosXY(x,y);this.points[index].setState(_cpoint.CPoint.state.Show)}}},{key:"setDrawPos",value:function setDrawPos(x,y){for(var index in this.points){if(this.points[index].getState()===_cpoint.CPoint.state.Highlight){this.points[index].setPosXY(x,y)}}}},{key:"setAfterDrawPos",value:function setAfterDrawPos(x,y){if(this.step!==0){this.step-=1}for(var index in this.points){this.points[index].setState(_cpoint.CPoint.state.Hide)}if(this.step===0){var pObj=this.getChartObjects();pObj.pMgr.setNormalMode()}}},{key:"isSelected",value:function isSelected(x,y){var isFind=false;for(var index in this.points){if(this.points[index].isSelected(x,y)){this.points[index].setState(_cpoint.CPoint.state.Highlight);isFind=true;break}}if(isFind===true){this.select();return true}return false}},{key:"select",value:function select(){for(var index in this.points){if(this.points[index].getState()===_cpoint.CPoint.state.Hide){this.points[index].setState(_cpoint.CPoint.state.Show)}}}},{key:"unselect",value:function unselect(){for(var index in this.points){if(this.points[index].getState()!==_cpoint.CPoint.state.Hide){this.points[index].setState(_cpoint.CPoint.state.Hide)}}}},{key:"calcDistance",value:function calcDistance(point1,point2,point3){var xa=point1.getPosXY().x;var ya=point1.getPosXY().y;var xb=point2.getPosXY().x;var yb=point2.getPosXY().y;var xc=point3.getPosXY().x;var yc=point3.getPosXY().y;var a1=xa-xc;var a2=ya-yc;var b1=xb-xc;var b2=yb-yc;var area=Math.abs(a1*b2-a2*b1);var len=Math.sqrt(Math.pow(xb-xa,2)+Math.pow(yb-ya,2));return area/len}},{key:"calcGap",value:function calcGap(r,x,y){var xa=r.sx;var ya=r.sy;var xb=r.ex;var yb=r.ey;var xc=x;var yc=y;var a1=xa-xc;var a2=ya-yc;var b1=xb-xc;var b2=yb-yc;var area=Math.abs(a1*b2-a2*b1);var len=Math.sqrt(Math.pow(xb-xa,2)+Math.pow(yb-ya,2));return area/len}},{key:"isWithRect",value:function isWithRect(point1,point2,point3){var sx=point1.getPosXY().x;var sy=point1.getPosXY().y;var ex=point2.getPosXY().x;var ey=point2.getPosXY().y;var x=point3.getPosXY().x;var y=point3.getPosXY().y;if(sx>ex){sx+=4;ex-=4}else{sx-=4;ex+=4}if(sy>ey){sy+=4;ey-=4}else{sy-=4;ey+=4}if(sx<=x&&ex>=x&&sy<=y&&ey>=y){return true}if(sx>=x&&ex<=x&&sy<=y&&ey>=y){return true}if(sx<=x&&ex>=x&&sy>=y&&ey<=y){return true}if(sx>=x&&ex<=x&&sy>=y&&ey<=y){return true}return false}}]);return CToolObject}(_named_object.NamedObject);exports.CToolObject=CToolObject;CToolObject.state={BeforeDraw:0,Draw:1,AfterDraw:2};var CBiToolObject=function(_CToolObject){_inherits(CBiToolObject,_CToolObject);function CBiToolObject(name){var _this2;_classCallCheck(this,CBiToolObject);_this2=_possibleConstructorReturn(this,(CBiToolObject.__proto__||Object.getPrototypeOf(CBiToolObject)).call(this,name));_this2.addPoint(new _cpoint.CPoint(name));_this2.addPoint(new _cpoint.CPoint(name));return _this2}_createClass(CBiToolObject,[{key:"setBeforeDrawPos",value:function setBeforeDrawPos(x,y){this.step=1;_get(CBiToolObject.prototype.__proto__||Object.getPrototypeOf(CBiToolObject.prototype),"setBeforeDrawPos",this).call(this,x,y);this.getPoint(0).setState(_cpoint.CPoint.state.Show);this.getPoint(1).setState(_cpoint.CPoint.state.Highlight)}}]);return CBiToolObject}(CToolObject);exports.CBiToolObject=CBiToolObject;var CTriToolObject=function(_CToolObject2){_inherits(CTriToolObject,_CToolObject2);function CTriToolObject(name){var _this3;_classCallCheck(this,CTriToolObject);_this3=_possibleConstructorReturn(this,(CTriToolObject.__proto__||Object.getPrototypeOf(CTriToolObject)).call(this,name));_this3.addPoint(new _cpoint.CPoint(name));_this3.addPoint(new _cpoint.CPoint(name));_this3.addPoint(new _cpoint.CPoint(name));return _this3}_createClass(CTriToolObject,[{key:"setBeforeDrawPos",value:function setBeforeDrawPos(x,y){this.step=2;_get(CTriToolObject.prototype.__proto__||Object.getPrototypeOf(CTriToolObject.prototype),"setBeforeDrawPos",this).call(this,x,y);this.getPoint(0).setState(_cpoint.CPoint.state.Show);this.getPoint(1).setState(_cpoint.CPoint.state.Show);this.getPoint(2).setState(_cpoint.CPoint.state.Highlight)}},{key:"setAfterDrawPos",value:function setAfterDrawPos(x,y){if(this.step!==0)this.step-=1;if(this.step===0){for(var index in this.points){this.points[index].setState(_cpoint.CPoint.state.Hide)}}else{this.getPoint(0).setState(_cpoint.CPoint.state.Show);this.getPoint(1).setState(_cpoint.CPoint.state.Highlight);this.getPoint(2).setState(_cpoint.CPoint.state.Show)}if(this.step===0){var pObj=this.getChartObjects();pObj.pMgr.setNormalMode()}}}]);return CTriToolObject}(CToolObject);exports.CTriToolObject=CTriToolObject;var CBandLineObject=function(_CBiToolObject){_inherits(CBandLineObject,_CBiToolObject);function CBandLineObject(name){var _this4;_classCallCheck(this,CBandLineObject);_this4=_possibleConstructorReturn(this,(CBandLineObject.__proto__||Object.getPrototypeOf(CBandLineObject)).call(this,name));_this4.drawer=new plotters.DrawBandLinesPlotter(name,_assertThisInitialized(_this4));return _this4}_createClass(CBandLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CBandLineObject.prototype.__proto__||Object.getPrototypeOf(CBandLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;var sy=this.getPoint(0).getPosXY().y;var ex=this.getPoint(1).getPosXY().x;var ey=this.getPoint(1).getPosXY().y;var fibSequence=[100,87.5,75,62.5,50,37.5,25,12.5,0];for(var i=0;i<fibSequence.length;i++){var stage_y=sy+(100-fibSequence[i])/100*(ey-sy);if(stage_y<y+4&&stage_y>y-4){this.select();return true}}return false}}]);return CBandLineObject}(CBiToolObject);exports.CBandLineObject=CBandLineObject;var CBiParallelLineObject=function(_CTriToolObject){_inherits(CBiParallelLineObject,_CTriToolObject);function CBiParallelLineObject(name){var _this5;_classCallCheck(this,CBiParallelLineObject);_this5=_possibleConstructorReturn(this,(CBiParallelLineObject.__proto__||Object.getPrototypeOf(CBiParallelLineObject)).call(this,name));_this5.drawer=new plotters.DrawBiParallelLinesPlotter(name,_assertThisInitialized(_this5));return _this5}_createClass(CBiParallelLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CBiParallelLineObject.prototype.__proto__||Object.getPrototypeOf(CBiParallelLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var _0x=this.getPoint(0).getPosXY().x;var _0y=this.getPoint(0).getPosXY().y;var _1x=this.getPoint(1).getPosXY().x;var _1y=this.getPoint(1).getPosXY().y;var _2x=this.getPoint(2).getPosXY().x;var _2y=this.getPoint(2).getPosXY().y;var _a={x:_0x-_1x,y:_0y-_1y};var _b={x:_0x-_2x,y:_0y-_2y};var _c={x:_a.x+_b.x,y:_a.y+_b.y};var _3x=_0x-_c.x;var _3y=_0y-_c.y;var r1={sx:_0x,sy:_0y,ex:_2x,ey:_2y};var r2={sx:_1x,sy:_1y,ex:_3x,ey:_3y};if(this.calcGap(r1,x,y)>4&&this.calcGap(r2,x,y)>4){return false}return true}}]);return CBiParallelLineObject}(CTriToolObject);exports.CBiParallelLineObject=CBiParallelLineObject;var CBiParallelRayLineObject=function(_CTriToolObject2){_inherits(CBiParallelRayLineObject,_CTriToolObject2);function CBiParallelRayLineObject(name){var _this6;_classCallCheck(this,CBiParallelRayLineObject);_this6=_possibleConstructorReturn(this,(CBiParallelRayLineObject.__proto__||Object.getPrototypeOf(CBiParallelRayLineObject)).call(this,name));_this6.drawer=new plotters.DrawBiParallelRayLinesPlotter(name,_assertThisInitialized(_this6));return _this6}_createClass(CBiParallelRayLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CBiParallelRayLineObject.prototype.__proto__||Object.getPrototypeOf(CBiParallelRayLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var _0x=this.getPoint(0).getPosXY().x;var _0y=this.getPoint(0).getPosXY().y;var _1x=this.getPoint(1).getPosXY().x;var _1y=this.getPoint(1).getPosXY().y;var _2x=this.getPoint(2).getPosXY().x;var _2y=this.getPoint(2).getPosXY().y;var _a={x:_0x-_1x,y:_0y-_1y};var _b={x:_0x-_2x,y:_0y-_2y};var _c={x:_a.x+_b.x,y:_a.y+_b.y};var _3x=_0x-_c.x;var _3y=_0y-_c.y;var r1={sx:_0x,sy:_0y,ex:_2x,ey:_2y};var r2={sx:_1x,sy:_1y,ex:_3x,ey:_3y};if(r1.ex>r1.sx&&x>r1.sx-4||r1.ex<r1.sx&&x<r1.sx+4||r2.ex>r2.sx&&x>r2.sx-4||r2.ex<r2.sx&&x<r2.sx+4){if(this.calcGap(r1,x,y)>4&&this.calcGap(r2,x,y)>4){return false}}else{return false}this.select();return true}}]);return CBiParallelRayLineObject}(CTriToolObject);exports.CBiParallelRayLineObject=CBiParallelRayLineObject;var CFibFansObject=function(_CBiToolObject2){_inherits(CFibFansObject,_CBiToolObject2);function CFibFansObject(name){var _this7;_classCallCheck(this,CFibFansObject);_this7=_possibleConstructorReturn(this,(CFibFansObject.__proto__||Object.getPrototypeOf(CFibFansObject)).call(this,name));_this7.drawer=new plotters.DrawFibFansPlotter(name,_assertThisInitialized(_this7));return _this7}_createClass(CFibFansObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CFibFansObject.prototype.__proto__||Object.getPrototypeOf(CFibFansObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;var sy=this.getPoint(0).getPosXY().y;var ex=this.getPoint(1).getPosXY().x;var ey=this.getPoint(1).getPosXY().y;var pObj=this.getChartObjects();var areaPos={left:pObj.pArea.getLeft(),top:pObj.pArea.getTop(),right:pObj.pArea.getRight(),bottom:pObj.pArea.getBottom()};var fibFansSequence=[0,38.2,50,61.8];for(var i=0;i<fibFansSequence.length;i++){var stageY=sy+(100-fibFansSequence[i])/100*(ey-sy);var tempStartPt={x:sx,y:sy};var tempEndPt={x:ex,y:stageY};var crossPt=this.getRectCrossPt(areaPos,tempStartPt,tempEndPt);var lenToStartPt=Math.pow(crossPt[0].x-sx,2)+Math.pow(crossPt[0].y-sy,2);var lenToEndPt=Math.pow(crossPt[0].x-ex,2)+Math.pow(crossPt[0].y-ey,2);var tempCrossPt=lenToStartPt>lenToEndPt?{x:crossPt[0].x,y:crossPt[0].y}:{x:crossPt[1].x,y:crossPt[1].y};if(tempCrossPt.x>sx&&x<sx)continue;if(tempCrossPt.x<sx&&x>sx)continue;var a=new _cpoint.CPoint("frame0.k0");a.setPosXY(sx,sy);var b=new _cpoint.CPoint("frame0.k0");b.setPosXY(tempCrossPt.x,tempCrossPt.y);if(this.calcDistance(a,b,c)>4){continue}this.select();return true}return false}}]);return CFibFansObject}(CBiToolObject);exports.CFibFansObject=CFibFansObject;var CFibRetraceObject=function(_CBiToolObject3){_inherits(CFibRetraceObject,_CBiToolObject3);function CFibRetraceObject(name){var _this8;_classCallCheck(this,CFibRetraceObject);_this8=_possibleConstructorReturn(this,(CFibRetraceObject.__proto__||Object.getPrototypeOf(CFibRetraceObject)).call(this,name));_this8.drawer=new plotters.DrawFibRetracePlotter(name,_assertThisInitialized(_this8));return _this8}_createClass(CFibRetraceObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CFibRetraceObject.prototype.__proto__||Object.getPrototypeOf(CFibRetraceObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;var sy=this.getPoint(0).getPosXY().y;var ex=this.getPoint(1).getPosXY().x;var ey=this.getPoint(1).getPosXY().y;var fibSequence=[100,78.6,61.8,50,38.2,23.6,0];for(var i=0;i<fibSequence.length;i++){var stage_y=sy+(100-fibSequence[i])/100*(ey-sy);if(stage_y<y+4&&stage_y>y-4){this.select();return true}}return false}}]);return CFibRetraceObject}(CBiToolObject);exports.CFibRetraceObject=CFibRetraceObject;var CHoriRayLineObject=function(_CBiToolObject4){_inherits(CHoriRayLineObject,_CBiToolObject4);function CHoriRayLineObject(name){var _this9;_classCallCheck(this,CHoriRayLineObject);_this9=_possibleConstructorReturn(this,(CHoriRayLineObject.__proto__||Object.getPrototypeOf(CHoriRayLineObject)).call(this,name));_this9.drawer=new plotters.DrawHoriRayLinesPlotter(name,_assertThisInitialized(_this9));return _this9}_createClass(CHoriRayLineObject,[{key:"setDrawPos",value:function setDrawPos(x,y){if(this.points[0].getState()===_cpoint.CPoint.state.Highlight){this.points[0].setPosXY(x,y);this.points[1].setPosXYNoSnap(this.points[1].getPosXY().x,this.points[0].getPosXY().y);return}if(this.points[1].getState()===_cpoint.CPoint.state.Highlight){this.points[1].setPosXY(x,y);this.points[0].setPosXYNoSnap(this.points[0].getPosXY().x,this.points[1].getPosXY().y)}}},{key:"isSelected",value:function isSelected(x,y){if(_get(CHoriRayLineObject.prototype.__proto__||Object.getPrototypeOf(CHoriRayLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sy=this.getPoint(0).getPosXY().y;var sx=this.getPoint(0).getPosXY().x;var ex=this.getPoint(1).getPosXY().x;if(y>sy+4||y<sy-4){return false}if(ex>sx&&x<sx-4){return false}if(ex<sx&&x>sx+4){return false}this.select();return true}}]);return CHoriRayLineObject}(CBiToolObject);exports.CHoriRayLineObject=CHoriRayLineObject;var CHoriSegLineObject=function(_CBiToolObject5){_inherits(CHoriSegLineObject,_CBiToolObject5);function CHoriSegLineObject(name){var _this10;_classCallCheck(this,CHoriSegLineObject);_this10=_possibleConstructorReturn(this,(CHoriSegLineObject.__proto__||Object.getPrototypeOf(CHoriSegLineObject)).call(this,name))
;_this10.drawer=new plotters.DrawHoriSegLinesPlotter(name,_assertThisInitialized(_this10));return _this10}_createClass(CHoriSegLineObject,[{key:"setDrawPos",value:function setDrawPos(x,y){if(this.points[0].getState()===_cpoint.CPoint.state.Highlight){this.points[0].setPosXY(x,y);this.points[1].setPosXYNoSnap(this.points[1].getPosXY().x,this.points[0].getPosXY().y);return}if(this.points[1].getState()===_cpoint.CPoint.state.Highlight){this.points[1].setPosXY(x,y);this.points[0].setPosXYNoSnap(this.points[0].getPosXY().x,this.points[1].getPosXY().y)}}},{key:"isSelected",value:function isSelected(x,y){if(_get(CHoriSegLineObject.prototype.__proto__||Object.getPrototypeOf(CHoriSegLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sy=this.getPoint(0).getPosXY().y;var sx=this.getPoint(0).getPosXY().x;var ex=this.getPoint(1).getPosXY().x;if(y>sy+4||y<sy-4){return false}if(sx>ex&&(x>sx+4||x<ex-4)){return false}if(sx<ex&&(x<sx-4||x>ex+4)){return false}this.select();return true}}]);return CHoriSegLineObject}(CBiToolObject);exports.CHoriSegLineObject=CHoriSegLineObject;var CHoriStraightLineObject=function(_CBiToolObject6){_inherits(CHoriStraightLineObject,_CBiToolObject6);function CHoriStraightLineObject(name){var _this11;_classCallCheck(this,CHoriStraightLineObject);_this11=_possibleConstructorReturn(this,(CHoriStraightLineObject.__proto__||Object.getPrototypeOf(CHoriStraightLineObject)).call(this,name));_this11.drawer=new plotters.DrawHoriStraightLinesPlotter(name,_assertThisInitialized(_this11));return _this11}_createClass(CHoriStraightLineObject,[{key:"setDrawPos",value:function setDrawPos(x,y){for(var index in this.points){this.points[index].setPosXY(x,y)}}},{key:"isSelected",value:function isSelected(x,y){if(_get(CHoriStraightLineObject.prototype.__proto__||Object.getPrototypeOf(CHoriStraightLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sy=this.getPoint(0).getPosXY().y;if(y>sy+4||y<sy-4){return false}this.select();return true}}]);return CHoriStraightLineObject}(CBiToolObject);exports.CHoriStraightLineObject=CHoriStraightLineObject;var CRayLineObject=function(_CBiToolObject7){_inherits(CRayLineObject,_CBiToolObject7);function CRayLineObject(name){var _this12;_classCallCheck(this,CRayLineObject);_this12=_possibleConstructorReturn(this,(CRayLineObject.__proto__||Object.getPrototypeOf(CRayLineObject)).call(this,name));_this12.drawer=new plotters.DrawRayLinesPlotter(name,_assertThisInitialized(_this12));return _this12}_createClass(CRayLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CRayLineObject.prototype.__proto__||Object.getPrototypeOf(CRayLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;var ex=this.getPoint(1).getPosXY().x;if(ex>sx&&x<sx-4){return false}if(ex<sx&&x>sx+4){return false}if(this.calcDistance(this.getPoint(0),this.getPoint(1),c)<4){this.select();return true}return false}}]);return CRayLineObject}(CBiToolObject);exports.CRayLineObject=CRayLineObject;var CSegLineObject=function(_CBiToolObject8){_inherits(CSegLineObject,_CBiToolObject8);function CSegLineObject(name){var _this13;_classCallCheck(this,CSegLineObject);_this13=_possibleConstructorReturn(this,(CSegLineObject.__proto__||Object.getPrototypeOf(CSegLineObject)).call(this,name));_this13.drawer=new plotters.DrawSegLinesPlotter(name,_assertThisInitialized(_this13));return _this13}_createClass(CSegLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CSegLineObject.prototype.__proto__||Object.getPrototypeOf(CSegLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);if(this.isWithRect(this.getPoint(0),this.getPoint(1),c)===false){return false}if(this.calcDistance(this.getPoint(0),this.getPoint(1),c)<4){this.select();return true}return false}}]);return CSegLineObject}(CBiToolObject);exports.CSegLineObject=CSegLineObject;var CStraightLineObject=function(_CBiToolObject9){_inherits(CStraightLineObject,_CBiToolObject9);function CStraightLineObject(name){var _this14;_classCallCheck(this,CStraightLineObject);_this14=_possibleConstructorReturn(this,(CStraightLineObject.__proto__||Object.getPrototypeOf(CStraightLineObject)).call(this,name));_this14.drawer=new plotters.DrawStraightLinesPlotter(name,_assertThisInitialized(_this14));return _this14}_createClass(CStraightLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CStraightLineObject.prototype.__proto__||Object.getPrototypeOf(CStraightLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);if(this.calcDistance(this.getPoint(0),this.getPoint(1),c)<4){this.select();return true}return false}}]);return CStraightLineObject}(CBiToolObject);exports.CStraightLineObject=CStraightLineObject;var CTriParallelLineObject=function(_CTriToolObject3){_inherits(CTriParallelLineObject,_CTriToolObject3);function CTriParallelLineObject(name){var _this15;_classCallCheck(this,CTriParallelLineObject);_this15=_possibleConstructorReturn(this,(CTriParallelLineObject.__proto__||Object.getPrototypeOf(CTriParallelLineObject)).call(this,name));_this15.drawer=new plotters.DrawTriParallelLinesPlotter(name,_assertThisInitialized(_this15));return _this15}_createClass(CTriParallelLineObject,[{key:"isSelected",value:function isSelected(x,y){if(_get(CTriParallelLineObject.prototype.__proto__||Object.getPrototypeOf(CTriParallelLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var pObj=this.getChartObjects();var _0x=this.getPoint(0).getPosXY().x;var _0y=this.getPoint(0).getPosXY().y;var _1x=this.getPoint(1).getPosXY().x;var _1y=this.getPoint(1).getPosXY().y;var _2x=this.getPoint(2).getPosXY().x;var _2y=this.getPoint(2).getPosXY().y;var _a={x:_0x-_1x,y:_0y-_1y};var _b={x:_0x-_2x,y:_0y-_2y};var _c={x:_a.x+_b.x,y:_a.y+_b.y};var _3x=_0x-_c.x;var _3y=_0y-_c.y;var r1={sx:_0x,sy:_0y,ex:_2x,ey:_2y};var r2={sx:_1x,sy:_1y,ex:_3x,ey:_3y};var _i={x:_0x-_1x,y:_0y-_1y};var _j={x:_2x-_3x,y:_2y-_3y};var _ri={x:_1x-_0x,y:_1y-_0y};var _rj={x:_3x-_2x,y:_3y-_2y};var _4x=Math.abs(_ri.x-_0x);var _4y=Math.abs(_ri.y-_0y);var _5x=Math.abs(_rj.x-_2x);var _5y=Math.abs(_rj.y-_2y);var r3={sx:_4x,sy:_4y,ex:_5x,ey:_5y};if(this.calcGap(r1,x,y)>4&&this.calcGap(r2,x,y)>4&&this.calcGap(r3,x,y)>4){return false}this.select();return true}}]);return CTriParallelLineObject}(CTriToolObject);exports.CTriParallelLineObject=CTriParallelLineObject;var CVertiStraightLineObject=function(_CBiToolObject10){_inherits(CVertiStraightLineObject,_CBiToolObject10);function CVertiStraightLineObject(name){var _this16;_classCallCheck(this,CVertiStraightLineObject);_this16=_possibleConstructorReturn(this,(CVertiStraightLineObject.__proto__||Object.getPrototypeOf(CVertiStraightLineObject)).call(this,name));_this16.drawer=new plotters.DrawVertiStraightLinesPlotter(name,_assertThisInitialized(_this16));return _this16}_createClass(CVertiStraightLineObject,[{key:"setDrawPos",value:function setDrawPos(x,y){for(var index in this.points){this.points[index].setPosXY(x,y)}}},{key:"isSelected",value:function isSelected(x,y){if(_get(CVertiStraightLineObject.prototype.__proto__||Object.getPrototypeOf(CVertiStraightLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;if(x>sx+4||x<sx-4){return false}this.select();return true}}]);return CVertiStraightLineObject}(CBiToolObject);exports.CVertiStraightLineObject=CVertiStraightLineObject;var CPriceLineObject=function(_CSegLineObject){_inherits(CPriceLineObject,_CSegLineObject);function CPriceLineObject(name){var _this17;_classCallCheck(this,CPriceLineObject);_this17=_possibleConstructorReturn(this,(CPriceLineObject.__proto__||Object.getPrototypeOf(CPriceLineObject)).call(this,name));_this17.drawer=new plotters.DrawPriceLinesPlotter(name,_assertThisInitialized(_this17));return _this17}_createClass(CPriceLineObject,[{key:"setDrawPos",value:function setDrawPos(x,y){for(var index in this.points){this.points[index].setPosXY(x,y)}}},{key:"isSelected",value:function isSelected(x,y){if(_get(CPriceLineObject.prototype.__proto__||Object.getPrototypeOf(CPriceLineObject.prototype),"isSelected",this).call(this,x,y)===true){return true}var c=new _cpoint.CPoint("frame0.k0");c.setPosXY(x,y);var sx=this.getPoint(0).getPosXY().x;var sy=this.getPoint(0).getPosXY().y;var ex=this.getPoint(1).getPosXY().x;var ey=this.getPoint(1).getPosXY().y;if(x<sx-4){return false}if(y>=sy+4||y<=sy-4){return false}this.select();return true}}]);return CPriceLineObject}(CSegLineObject);exports.CPriceLineObject=CPriceLineObject;var CArrowLineObject=function(_CSegLineObject2){_inherits(CArrowLineObject,_CSegLineObject2);function CArrowLineObject(name){var _this18;_classCallCheck(this,CArrowLineObject);_this18=_possibleConstructorReturn(this,(CArrowLineObject.__proto__||Object.getPrototypeOf(CArrowLineObject)).call(this,name));_this18.drawer=new plotters.DrawArrowLinesPlotter(name,_assertThisInitialized(_this18));return _this18}return CArrowLineObject}(CSegLineObject);exports.CArrowLineObject=CArrowLineObject},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CDynamicLinePlotter=exports.DrawFibFansPlotter=exports.DrawBandLinesPlotter=exports.DrawFibRetracePlotter=exports.BandLinesPlotter=exports.DrawTriParallelLinesPlotter=exports.DrawBiParallelRayLinesPlotter=exports.DrawBiParallelLinesPlotter=exports.ParallelLinesPlotter=exports.DrawPriceLinesPlotter=exports.DrawVertiStraightLinesPlotter=exports.DrawHoriSegLinesPlotter=exports.DrawHoriRayLinesPlotter=exports.DrawHoriStraightLinesPlotter=exports.DrawArrowLinesPlotter=exports.DrawRayLinesPlotter=exports.DrawSegLinesPlotter=exports.DrawStraightLinesPlotter=exports.CToolPlotter=exports.RangeSelectionPlotter=exports.TimelineSelectionPlotter=exports.SelectionPlotter=exports.LastClosePlotter=exports.LastVolumePlotter=exports.COrderGraphPlotter=exports.RangePlotter=exports.TimelinePlotter=exports.MinMaxPlotter=exports.IndicatorInfoPlotter=exports.IndicatorPlotter=exports.MainInfoPlotter=exports.OHLCPlotter=exports.CandlestickHLCPlotter=exports.CandlestickPlotter=exports.CGridPlotter=exports.TimelineAreaBackgroundPlotter=exports.RangeAreaBackgroundPlotter=exports.MainAreaBackgroundPlotter=exports.BackgroundPlotter=exports.Plotter=void 0;var _kline=_interopRequireDefault(__webpack_require__(15));var _named_object=__webpack_require__(8);var _chart_manager=__webpack_require__(3);var _util=__webpack_require__(19);var _cpoint=__webpack_require__(37);var exprs=_interopRequireWildcard(__webpack_require__(56));var themes=_interopRequireWildcard(__webpack_require__(20));var data_providers=_interopRequireWildcard(__webpack_require__(40));var data_sources=_interopRequireWildcard(__webpack_require__(11));var ctools=_interopRequireWildcard(__webpack_require__(38));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Plotter=function(_NamedObject){_inherits(Plotter,_NamedObject);function Plotter(name){_classCallCheck(this,Plotter);return _possibleConstructorReturn(this,(Plotter.__proto__||Object.getPrototypeOf(Plotter)).call(this,name))}_createClass(Plotter,null,[{key:"drawLine",value:function drawLine(context,x1,y1,x2,y2){context.beginPath();context.moveTo((x1<<0)+.5,(y1<<0)+.5);context.lineTo((x2<<0)+.5,(y2<<0)+.5);context.stroke()}},{key:"drawLines",value:function drawLines(context,points){var i,cnt=points.length;context.beginPath();context.moveTo(points[0].x,points[0].y);for(i=1;i<cnt;i++){context.lineTo(points[i].x,points[i].y)}if(Plotter.isChrome){context.moveTo(points[0].x,points[0].y);for(i=1;i<cnt;i++){context.lineTo(points[i].x,points[i].y)}}context.stroke()}},{key:"drawDashedLine",value:function drawDashedLine(context,x1,y1,x2,y2,dashLen,dashSolid){if(dashLen<2){dashLen=2}var dX=x2-x1;var dY=y2-y1;context.beginPath();if(dY===0){var count=dX/dashLen+.5<<0;for(var i=0;i<count;i++){context.rect(x1,y1,dashSolid,1);x1+=dashLen}context.fill()}else{var _count=Math.sqrt(dX*dX+dY*dY)/dashLen+.5<<0;dX=dX/_count;dY=dY/_count;var dashX=dX*dashSolid/dashLen;var dashY=dY*dashSolid/dashLen;for(var _i=0;_i<_count;_i++){context.moveTo(x1+.5,y1+.5);context.lineTo(x1+.5+dashX,y1+.5+dashY);x1+=dX;y1+=dY}context.stroke()}}},{key:"createHorzDashedLine",value:function createHorzDashedLine(context,x1,x2,y,dashLen,dashSolid){if(dashLen<2){dashLen=2}var dX=x2-x1;var count=dX/dashLen+.5<<0;context.rect(x1,y,dX,1)}},{key:"createVerticalLine",value:function createVerticalLine(context,y1,y2,x,dashLen,dashSolid){var dY=y2-y1;context.rect(x,y1,1,dY)}},{key:"createRectangles",value:function createRectangles(context,rects){context.beginPath();var e,i,cnt=rects.length;for(i=0;i<cnt;i++){e=rects[i];context.rect(e.x,e.y,e.w,e.h)}}},{key:"createPolygon",value:function createPolygon(context,points){context.beginPath();context.moveTo(points[0].x+.5,points[0].y+.5);var i,cnt=points.length;for(i=1;i<cnt;i++){context.lineTo(points[i].x+.5,points[i].y+.5)}context.closePath()}},{key:"drawString",value:function drawString(context,str,rect){var w=context.measureText(str).width;if(rect.w<w){return false}context.fillText(str,rect.x,rect.y);rect.x+=w;rect.w-=w;return true}}]);return Plotter}(_named_object.NamedObject);exports.Plotter=Plotter;Plotter.isChrome=navigator.userAgent.toLowerCase().match(/chrome/)!==null;var BackgroundPlotter=function(_Plotter){_inherits(BackgroundPlotter,_Plotter);function BackgroundPlotter(name){var _this;_classCallCheck(this,BackgroundPlotter);_this=_possibleConstructorReturn(this,(BackgroundPlotter.__proto__||Object.getPrototypeOf(BackgroundPlotter)).call(this,name));_this._color=themes.Theme.Color.Background;return _this}_createClass(BackgroundPlotter,[{key:"getColor",value:function getColor(){return this._color}},{key:"setColor",value:function setColor(c){this._color=c}},{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(this._color);context.fillRect(area.getLeft(),area.getTop(),area.getWidth(),area.getHeight())}}]);return BackgroundPlotter}(Plotter);exports.BackgroundPlotter=BackgroundPlotter;var MainAreaBackgroundPlotter=function(_BackgroundPlotter){_inherits(MainAreaBackgroundPlotter,_BackgroundPlotter);function MainAreaBackgroundPlotter(name){_classCallCheck(this,MainAreaBackgroundPlotter);return _possibleConstructorReturn(this,(MainAreaBackgroundPlotter.__proto__||Object.getPrototypeOf(MainAreaBackgroundPlotter)).call(this,name))}_createClass(MainAreaBackgroundPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());var theme=mgr.getTheme(this.getFrameName());var rect=area.getRect();if(!area.isChanged()&&!timeline.isUpdated()&&!range.isUpdated()){var first=timeline.getFirstIndex();var last=timeline.getLastIndex()-2;var start=Math.max(first,last);rect.X=timeline.toColumnLeft(start);rect.Width=area.getRight()-rect.X}context.fillStyle=theme.getColor(this._color);context.fillRect(rect.X,rect.Y,rect.Width,rect.Height)}}]);return MainAreaBackgroundPlotter}(BackgroundPlotter);exports.MainAreaBackgroundPlotter=MainAreaBackgroundPlotter;var RangeAreaBackgroundPlotter=function(_BackgroundPlotter2){_inherits(RangeAreaBackgroundPlotter,_BackgroundPlotter2);function RangeAreaBackgroundPlotter(name){_classCallCheck(this,RangeAreaBackgroundPlotter);return _possibleConstructorReturn(this,(RangeAreaBackgroundPlotter.__proto__||Object.getPrototypeOf(RangeAreaBackgroundPlotter)).call(this,name))}_createClass(RangeAreaBackgroundPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var areaName=this.getAreaName();var area=mgr.getArea(areaName);var range=mgr.getRange(areaName.substring(0,areaName.lastIndexOf("Range")));var isMainRange=range.getNameObject().getCompAt(2)==="main";if(!isMainRange&&!area.isChanged()&&!range.isUpdated()){return}var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(this._color);context.fillRect(area.getLeft(),area.getTop(),area.getWidth(),area.getHeight())}}]);return RangeAreaBackgroundPlotter}(BackgroundPlotter);exports.RangeAreaBackgroundPlotter=RangeAreaBackgroundPlotter;var TimelineAreaBackgroundPlotter=function(_BackgroundPlotter3){_inherits(TimelineAreaBackgroundPlotter,_BackgroundPlotter3);function TimelineAreaBackgroundPlotter(name){_classCallCheck(this,TimelineAreaBackgroundPlotter);return _possibleConstructorReturn(this,(TimelineAreaBackgroundPlotter.__proto__||Object.getPrototypeOf(TimelineAreaBackgroundPlotter)).call(this,name))}_createClass(TimelineAreaBackgroundPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());if(!area.isChanged()&&!timeline.isUpdated())return;var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(this._color);context.fillRect(area.getLeft(),area.getTop(),area.getWidth(),area.getHeight())}}]);return TimelineAreaBackgroundPlotter}(BackgroundPlotter);exports.TimelineAreaBackgroundPlotter=TimelineAreaBackgroundPlotter;var CGridPlotter=function(_NamedObject2){_inherits(CGridPlotter,_NamedObject2);function CGridPlotter(name){_classCallCheck(this,CGridPlotter);return _possibleConstructorReturn(this,(CGridPlotter.__proto__||Object.getPrototypeOf(CGridPlotter)).call(this,name))}_createClass(CGridPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());var clipped=false;if(!area.isChanged()&&!timeline.isUpdated()&&!range.isUpdated()){var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var start=Math.max(first,last-2);var left=timeline.toColumnLeft(start);context.save();context.rect(left,area.getTop(),area.getRight()-left,area.getHeight());context.clip();clipped=true}var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(themes.Theme.Color.Grid0);context.beginPath();var dashLen=4,dashSolid=1;if(Plotter.isChrome){dashLen=4;dashSolid=1}var gradations=range.getGradations();for(var n in gradations){Plotter.createHorzDashedLine(context,area.getLeft(),area.getRight(),range.toY(gradations[n]),dashLen,dashSolid)}var first=timeline.getFirstIndex();var last=timeline.getLastIndex();for(var i=last-1;i>first;i=i-12){var x=timeline.toItemCenter(i);Plotter.createVerticalLine(context,area.getTop(),area.getBottom(),x,dashLen,dashSolid)}context.fill();if(clipped){context.restore()}}}]);return CGridPlotter}(_named_object.NamedObject);exports.CGridPlotter=CGridPlotter;var CandlestickPlotter=function(_NamedObject3){_inherits(CandlestickPlotter,_NamedObject3);function CandlestickPlotter(name){_classCallCheck(this,CandlestickPlotter);return _possibleConstructorReturn(this,(CandlestickPlotter.__proto__||Object.getPrototypeOf(CandlestickPlotter)).call(this,name))}_createClass(CandlestickPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1){return}var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());if(range.getRange()===0){return}var theme=mgr.getTheme(this.getFrameName());var dark=_util.Util.isInstance(theme,themes.DarkTheme);var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var start;if(area.isChanged()||timeline.isUpdated()||range.isUpdated())start=first;else start=Math.max(first,last-2);var cW=timeline.getColumnWidth();var iW=timeline.getItemWidth();var left=timeline.toItemLeft(start);var center=timeline.toItemCenter(start);var strokePosRects=[];var fillPosRects=[];var fillUchRects=[];var fillNegRects=[];for(var i=start;i<last;i++){var data=ds.getDataAt(i);var high=range.toY(data.high);var low=range.toY(data.low);var open=data.open;var close=data.close;if(close>open){var top=range.toY(close);var bottom=range.toY(open);var iH=Math.max(bottom-top,1);if(iH>1&&iW>1&&dark)strokePosRects.push({x:left+.5,y:top+.5,w:iW-1,h:iH-1});else fillPosRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)});if(data.high>close){high=Math.min(high,top-1);fillPosRects.push({x:center,y:high,w:1,h:top-high})}if(open>data.low){low=Math.max(low,bottom+1);fillPosRects.push({x:center,y:bottom,w:1,h:low-bottom})}}else if(close===open){var _top=range.toY(close);fillUchRects.push({x:left,y:_top,w:Math.max(iW,1),h:1});if(data.high>close)high=Math.min(high,_top-1);if(open>data.low)low=Math.max(low,_top+1);if(high<low)fillUchRects.push({x:center,y:high,w:1,h:low-high})}else{var _top2=range.toY(open);var _bottom=range.toY(close);var _iH=Math.max(_bottom-_top2,1);fillNegRects.push({x:left,y:_top2,w:Math.max(iW,1),h:Math.max(_iH,1)});if(data.high>open)high=Math.min(high,_top2-1);if(close>data.low)low=Math.max(low,_bottom+1);if(high<low)fillNegRects.push({x:center,y:high,w:1,h:low-high})}left+=cW;center+=cW}if(strokePosRects.length>0){context.strokeStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,strokePosRects);context.stroke()}if(fillPosRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,fillPosRects);context.fill()}if(fillUchRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillUchRects);context.fill()}if(fillNegRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillNegRects);context.fill()}}}]);return CandlestickPlotter}(_named_object.NamedObject);exports.CandlestickPlotter=CandlestickPlotter;var CandlestickHLCPlotter=function(_Plotter2){_inherits(CandlestickHLCPlotter,_Plotter2);function CandlestickHLCPlotter(name){_classCallCheck(this,CandlestickHLCPlotter);return _possibleConstructorReturn(this,(CandlestickHLCPlotter.__proto__||Object.getPrototypeOf(CandlestickHLCPlotter)).call(this,name))}_createClass(CandlestickHLCPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(!_util.Util.isInstance(ds,data_sources.MainDataSource)||ds.getDataCount()<1){return}var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());if(range.getRange()===0){return}var theme=mgr.getTheme(this.getFrameName());var dark=_util.Util.isInstance(theme,themes.DarkTheme);var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var start;if(area.isChanged()||timeline.isUpdated()||range.isUpdated()){start=first}else{start=Math.max(first,last-2)}var cW=timeline.getColumnWidth();var iW=timeline.getItemWidth();var left=timeline.toItemLeft(start);var center=timeline.toItemCenter(start);var strokePosRects=[];var fillPosRects=[];var fillUchRects=[];var fillNegRects=[];for(var i=start;i<last;i++){var data=ds.getDataAt(i);var high=range.toY(data.high);var low=range.toY(data.low);var open=data.open;if(i>0){open=ds.getDataAt(i-1).close}var close=data.close;if(close>open){var top=range.toY(close);var bottom=range.toY(open);var iH=Math.max(bottom-top,1);if(iH>1&&iW>1&&dark){strokePosRects.push({x:left+.5,y:top+.5,w:iW-1,h:iH-1})}else{fillPosRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)})}if(data.high>close){high=Math.min(high,top-1);fillPosRects.push({x:center,y:high,w:1,h:top-high})}if(open>data.low){low=Math.max(low,bottom+1);fillPosRects.push({x:center,y:bottom,w:1,h:low-bottom})}}else if(close===open){var _top3=range.toY(close);fillUchRects.push({x:left,y:_top3,w:Math.max(iW,1),h:1});if(data.high>close){high=Math.min(high,_top3-1)}if(open>data.low){low=Math.max(low,_top3+1)}if(high<low){fillUchRects.push({x:center,y:high,w:1,h:low-high})}}else{var _top4=range.toY(open);var _bottom2=range.toY(close);var _iH2=Math.max(_bottom2-_top4,1);fillNegRects.push({x:left,y:_top4,w:Math.max(iW,1),h:Math.max(_iH2,1)});if(data.high>open){high=Math.min(high,_top4-1)}if(close>data.low){low=Math.max(low,_bottom2+1)}if(high<low){fillNegRects.push({x:center,y:high,w:1,h:low-high})}}left+=cW;center+=cW}if(strokePosRects.length>0){context.strokeStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,strokePosRects);context.stroke()}if(fillPosRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,fillPosRects);context.fill()}if(fillUchRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillUchRects);context.fill()}if(fillNegRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillNegRects);context.fill()}}}]);return CandlestickHLCPlotter}(Plotter);exports.CandlestickHLCPlotter=CandlestickHLCPlotter;var OHLCPlotter=function(_Plotter3){_inherits(OHLCPlotter,_Plotter3);function OHLCPlotter(name){_classCallCheck(this,OHLCPlotter);return _possibleConstructorReturn(this,(OHLCPlotter.__proto__||Object.getPrototypeOf(OHLCPlotter)).call(this,name))}_createClass(OHLCPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(!_util.Util.isInstance(ds,data_sources.MainDataSource)||ds.getDataCount()<1){return}var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());if(range.getRange()===0){return}var theme=mgr.getTheme(this.getFrameName());var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var start;if(area.isChanged()||timeline.isUpdated()||range.isUpdated()){start=first}else{start=Math.max(first,last-2)}var cW=timeline.getColumnWidth();var iW=timeline.getItemWidth()>>1;var left=timeline.toItemLeft(start);var center=timeline.toItemCenter(start);var right=left+timeline.getItemWidth();var fillPosRects=[];var fillUchRects=[];var fillNegRects=[];for(var i=start;i<last;i++){var data=ds.getDataAt(i);var high=range.toY(data.high);var low=range.toY(data.low);var iH=Math.max(low-high,1);if(data.close>data.open){var top=range.toY(data.close);var bottom=range.toY(data.open);fillPosRects.push({x:center,y:high,w:1,h:iH});fillPosRects.push({x:left,y:top,w:iW,h:1});fillPosRects.push({x:center,y:bottom,w:iW,h:1})}else if(data.close===data.open){var y=range.toY(data.close);fillUchRects.push({x:center,y:high,w:1,h:iH});fillUchRects.push({x:left,y:y,w:iW,h:1});fillUchRects.push({x:center,y:y,w:iW,h:1})}else{var _top5=range.toY(data.open);var _bottom3=range.toY(data.close);fillNegRects.push({x:center,y:high,w:1,h:iH});fillNegRects.push({x:left,y:_top5,w:iW,h:1});fillNegRects.push({x:center,y:_bottom3,w:iW,h:1})}left+=cW;center+=cW;right+=cW}if(fillPosRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,fillPosRects);context.fill()}if(fillUchRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillUchRects);context.fill()}if(fillNegRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillNegRects);context.fill()}}}]);return OHLCPlotter}(Plotter);exports.OHLCPlotter=OHLCPlotter;var MainInfoPlotter=function(_Plotter4){_inherits(MainInfoPlotter,_Plotter4);function MainInfoPlotter(name){_classCallCheck(this,MainInfoPlotter);return _possibleConstructorReturn(this,(MainInfoPlotter.__proto__||Object.getPrototypeOf(MainInfoPlotter)).call(this,name))}_createClass(MainInfoPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var ds=mgr.getDataSource(this.getDataSourceName());var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="left";context.textBaseline="top";context.fillStyle=theme.getColor(themes.Theme.Color.Text4);var rect={x:area.getLeft()+4,y:area.getTop()+2,w:area.getWidth()-8,h:20};var selIndex=timeline.getSelectedIndex();if(selIndex<0)return;var data=ds.getDataAt(selIndex);var digits=ds.getDecimalDigits();var time=new Date(data.date);var year=time.getFullYear();var month=_util.Util.formatTime(time.getMonth()+1);var date=_util.Util.formatTime(time.getDate());var hour=_util.Util.formatTime(time.getHours());var minute=_util.Util.formatTime(time.getMinutes());var lang=mgr.getLanguage();if(lang==="zh-cn"){if(!Plotter.drawString(context,"  开: "+data.open.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  高: "+data.high.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  低: "+data.low.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  收: "+data.close.toFixed(digits),rect))return}else if(lang==="en-us"){if(!Plotter.drawString(context,"  O: "+data.open.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  H: "+data.high.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  L: "+data.low.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  C: "+data.close.toFixed(digits),rect))return}else if(lang==="zh-tw"){if(!Plotter.drawString(context,"  開: "+data.open.toFixed(digits),rect))return
;if(!Plotter.drawString(context,"  高: "+data.high.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  低: "+data.low.toFixed(digits),rect))return;if(!Plotter.drawString(context,"  收: "+data.close.toFixed(digits),rect))return}if(selIndex>0){if(lang==="zh-cn"){if(!Plotter.drawString(context,"  涨幅: ",rect))return}else if(lang==="en-us"){if(!Plotter.drawString(context,"  CHANGE: ",rect))return}else if(lang==="zh-tw"){if(!Plotter.drawString(context,"  漲幅: ",rect))return}var prev=ds.getDataAt(selIndex-1);var change;if((data.close-prev.close)/prev.close*100){change=(data.close-prev.close)/prev.close*100}else{change=0}if(change>=0){change=" "+change.toFixed(2);context.fillStyle=theme.getColor(themes.Theme.Color.TextPositive)}else{change=change.toFixed(2);context.fillStyle=theme.getColor(themes.Theme.Color.TextNegative)}if(!Plotter.drawString(context,change,rect))return;context.fillStyle=theme.getColor(themes.Theme.Color.Text4);if(!Plotter.drawString(context," %",rect))return}var amplitude;if((data.high-data.low)/data.low*100){amplitude=(data.high-data.low)/data.low*100}else{amplitude=0}if(lang==="zh-cn"){if(!Plotter.drawString(context,"  振幅: "+amplitude.toFixed(2)+" %",rect)){return}}else if(lang==="en-us"){if(!Plotter.drawString(context,"  AMPLITUDE: "+amplitude.toFixed(2)+" %",rect)){return}}else if(lang==="zh-tw"){if(!Plotter.drawString(context,"  振幅: "+amplitude.toFixed(2)+" %",rect)){return}}var dp=mgr.getDataProvider(this.getAreaName()+".secondary");if(dp===undefined){return}var indic=dp.getIndicator();var n,cnt=indic.getOutputCount();for(n=0;n<cnt;n++){var out=indic.getOutputAt(n);var v=out.execute(selIndex);if(isNaN(v)){continue}var info="  "+out.getName()+": "+v.toFixed(digits);var color=out.getColor();if(color===undefined){color=themes.Theme.Color.Indicator0+n}context.fillStyle=theme.getColor(color);if(!Plotter.drawString(context,info,rect)){return}}}}]);return MainInfoPlotter}(Plotter);exports.MainInfoPlotter=MainInfoPlotter;var IndicatorPlotter=function(_NamedObject4){_inherits(IndicatorPlotter,_NamedObject4);function IndicatorPlotter(name){_classCallCheck(this,IndicatorPlotter);return _possibleConstructorReturn(this,(IndicatorPlotter.__proto__||Object.getPrototypeOf(IndicatorPlotter)).call(this,name))}_createClass(IndicatorPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var range=mgr.getRange(this.getAreaName());if(range.getRange()===0)return;var dp=mgr.getDataProvider(this.getName());if(!_util.Util.isInstance(dp,data_providers.IndicatorDataProvider))return;var theme=mgr.getTheme(this.getFrameName());var cW=timeline.getColumnWidth();var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var start;if(area.isChanged()||timeline.isUpdated()||range.isUpdated())start=first;else start=Math.max(first,last-2);var indic=dp.getIndicator();var out,n,outCount=indic.getOutputCount();for(n=0;n<outCount;n++){out=indic.getOutputAt(n);var style=out.getStyle();if(style===exprs.OutputExpr.outputStyle.VolumeStick){this.drawVolumeStick(context,theme,mgr.getDataSource(this.getDataSourceName()),start,last,timeline.toItemLeft(start),cW,timeline.getItemWidth(),range)}else if(style===exprs.OutputExpr.outputStyle.MACDStick){this.drawMACDStick(context,theme,out,start,last,timeline.toItemLeft(start),cW,timeline.getItemWidth(),range)}else if(style===exprs.OutputExpr.outputStyle.SARPoint){this.drawSARPoint(context,theme,out,start,last,timeline.toItemCenter(start),cW,timeline.getItemWidth(),range)}}var left=timeline.toColumnLeft(start);var center=timeline.toItemCenter(start);context.save();context.rect(left,area.getTop(),area.getRight()-left,area.getHeight());context.clip();context.translate(.5,.5);for(n=0;n<outCount;n++){var x=center;out=indic.getOutputAt(n);if(out.getStyle()===exprs.OutputExpr.outputStyle.Line){var v=void 0,points=[];if(start>first){v=out.execute(start-1);if(isNaN(v)===false)points.push({x:x-cW,y:range.toY(v)})}for(var i=start;i<last;i++,x+=cW){v=out.execute(i);if(isNaN(v)===false)points.push({x:x,y:range.toY(v)})}if(points.length>0){var color=out.getColor();if(color===undefined)color=themes.Theme.Color.Indicator0+n;context.strokeStyle=theme.getColor(color);Plotter.drawLines(context,points)}}}context.restore()}},{key:"drawVolumeStick",value:function drawVolumeStick(context,theme,ds,first,last,startX,cW,iW,range){var dark=_util.Util.isInstance(theme,themes.DarkTheme);var left=startX;var bottom=range.toY(0);var strokePosRects=[];var fillPosRects=[];var fillNegRects=[];for(var i=first;i<last;i++){var data=ds.getDataAt(i);var top=range.toY(data.volume);var iH=range.toHeight(data.volume);if(data.close>data.open){if(iH>1&&iW>1&&dark){strokePosRects.push({x:left+.5,y:top+.5,w:iW-1,h:iH-1})}else{fillPosRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)})}}else if(data.close===data.open){if(i>0&&data.close>=ds.getDataAt(i-1).close){if(iH>1&&iW>1&&dark){strokePosRects.push({x:left+.5,y:top+.5,w:iW-1,h:iH-1})}else{fillPosRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)})}}else{fillNegRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)})}}else{fillNegRects.push({x:left,y:top,w:Math.max(iW,1),h:Math.max(iH,1)})}left+=cW}if(strokePosRects.length>0){context.strokeStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,strokePosRects);context.stroke()}if(fillPosRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,fillPosRects);context.fill()}if(fillNegRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillNegRects);context.fill()}}},{key:"drawMACDStick",value:function drawMACDStick(context,theme,output,first,last,startX,cW,iW,range){var left=startX;var middle=range.toY(0);var strokePosRects=[];var strokeNegRects=[];var fillPosRects=[];var fillNegRects=[];var prevMACD=first>0?output.execute(first-1):NaN;for(var i=first;i<last;i++){var MACD=output.execute(i);if(MACD>=0){var iH=range.toHeight(MACD);if((i===0||MACD>=prevMACD)&&iH>1&&iW>1)strokePosRects.push({x:left+.5,y:middle-iH+.5,w:iW-1,h:iH-1});else fillPosRects.push({x:left,y:middle-iH,w:Math.max(iW,1),h:Math.max(iH,1)})}else{var _iH3=range.toHeight(-MACD);if((i===0||MACD>=prevMACD)&&_iH3>1&&iW>1)strokeNegRects.push({x:left+.5,y:middle+.5,w:iW-1,h:_iH3-1});else fillNegRects.push({x:left,y:middle,w:Math.max(iW,1),h:Math.max(_iH3,1)})}prevMACD=MACD;left+=cW}if(strokePosRects.length>0){context.strokeStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,strokePosRects);context.stroke()}if(strokeNegRects.length>0){context.strokeStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,strokeNegRects);context.stroke()}if(fillPosRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Positive);Plotter.createRectangles(context,fillPosRects);context.fill()}if(fillNegRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Negative);Plotter.createRectangles(context,fillNegRects);context.fill()}}},{key:"drawSARPoint",value:function drawSARPoint(context,theme,output,first,last,startX,cW,iW,range){var r=iW>>1;if(r<.5)r=.5;if(r>4)r=4;var center=startX;var right=center+r;var endAngle=2*Math.PI;context.save();context.translate(.5,.5);context.strokeStyle=theme.getColor(themes.Theme.Color.Indicator3);context.beginPath();for(var i=first;i<last;i++){var y=range.toY(output.execute(i));context.moveTo(right,y);context.arc(center,y,r,0,endAngle);center+=cW;right+=cW}context.stroke();context.restore()}}]);return IndicatorPlotter}(_named_object.NamedObject);exports.IndicatorPlotter=IndicatorPlotter;var IndicatorInfoPlotter=function(_Plotter5){_inherits(IndicatorInfoPlotter,_Plotter5);function IndicatorInfoPlotter(name){_classCallCheck(this,IndicatorInfoPlotter);return _possibleConstructorReturn(this,(IndicatorInfoPlotter.__proto__||Object.getPrototypeOf(IndicatorInfoPlotter)).call(this,name))}_createClass(IndicatorInfoPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());var dp=mgr.getDataProvider(this.getAreaName()+".secondary");var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="left";context.textBaseline="top";context.fillStyle=theme.getColor(themes.Theme.Color.Text4);var rect={x:area.getLeft()+4,y:area.getTop()+2,w:area.getWidth()-8,h:20};var indic=dp.getIndicator();var title;switch(indic.getParameterCount()){case 0:title=indic.getName();break;case 1:title=indic.getName()+"("+indic.getParameterAt(0).getValue()+")";break;case 2:title=indic.getName()+"("+indic.getParameterAt(0).getValue()+","+indic.getParameterAt(1).getValue()+")";break;case 3:title=indic.getName()+"("+indic.getParameterAt(0).getValue()+","+indic.getParameterAt(1).getValue()+","+indic.getParameterAt(2).getValue()+")";break;case 4:title=indic.getName()+"("+indic.getParameterAt(0).getValue()+","+indic.getParameterAt(1).getValue()+","+indic.getParameterAt(2).getValue()+","+indic.getParameterAt(3).getValue()+")";break;default:return}if(!Plotter.drawString(context,title,rect))return;var selIndex=timeline.getSelectedIndex();if(selIndex<0)return;var out,v,info,color;var n,cnt=indic.getOutputCount();for(n=0;n<cnt;n++){out=indic.getOutputAt(n);v=out.execute(selIndex);if(isNaN(v))continue;info="  "+out.getName()+": "+v.toFixed(2);color=out.getColor();if(color===undefined)color=themes.Theme.Color.Indicator0+n;context.fillStyle=theme.getColor(color);if(!Plotter.drawString(context,info,rect))return}}}]);return IndicatorInfoPlotter}(Plotter);exports.IndicatorInfoPlotter=IndicatorInfoPlotter;var MinMaxPlotter=function(_NamedObject5){_inherits(MinMaxPlotter,_NamedObject5);function MinMaxPlotter(name){_classCallCheck(this,MinMaxPlotter);return _possibleConstructorReturn(this,(MinMaxPlotter.__proto__||Object.getPrototypeOf(MinMaxPlotter)).call(this,name))}_createClass(MinMaxPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1)return;var timeline=mgr.getTimeline(this.getDataSourceName());if(timeline.getInnerWidth()<timeline.getColumnWidth())return;var range=mgr.getRange(this.getAreaName());if(range.getRange()===0)return;var dp=mgr.getDataProvider(this.getAreaName()+".main");var first=timeline.getFirstIndex();var center=first+timeline.getLastIndex()>>1;var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.Text4);context.strokeStyle=theme.getColor(themes.Theme.Color.Text4);var digits=ds.getDecimalDigits();this.drawMark(context,dp.getMinValue(),digits,range.toY(dp.getMinValue()),first,center,dp.getMinValueIndex(),timeline);this.drawMark(context,dp.getMaxValue(),digits,range.toY(dp.getMaxValue()),first,center,dp.getMaxValueIndex(),timeline)}},{key:"drawMark",value:function drawMark(context,v,digits,y,first,center,index,timeline){var arrowStart,arrowStop,_arrowStop;var textStart;if(index>center){context.textAlign="right";arrowStart=timeline.toItemCenter(index)-4;arrowStop=arrowStart-7;_arrowStop=arrowStart-3;textStart=arrowStop-4}else{context.textAlign="left";arrowStart=timeline.toItemCenter(index)+4;arrowStop=arrowStart+7;_arrowStop=arrowStart+3;textStart=arrowStop+4}Plotter.drawLine(context,arrowStart,y,arrowStop,y);Plotter.drawLine(context,arrowStart,y,_arrowStop,y+2);Plotter.drawLine(context,arrowStart,y,_arrowStop,y-2);context.fillText(_util.Util.fromFloat(v,digits),textStart,y)}}]);return MinMaxPlotter}(_named_object.NamedObject);exports.MinMaxPlotter=MinMaxPlotter;var TimelinePlotter=function(_Plotter6){_inherits(TimelinePlotter,_Plotter6);function TimelinePlotter(name){_classCallCheck(this,TimelinePlotter);return _possibleConstructorReturn(this,(TimelinePlotter.__proto__||Object.getPrototypeOf(TimelinePlotter)).call(this,name))}_createClass(TimelinePlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());if(!area.isChanged()&&!timeline.isUpdated())return;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<2)return;var timeInterval=ds.getDataAt(1).date-ds.getDataAt(0).date;var n,cnt=TimelinePlotter.TIME_INTERVAL.length;for(n=0;n<cnt;n++){if(timeInterval<TimelinePlotter.TIME_INTERVAL[n])break}for(;n<cnt;n++){if(TimelinePlotter.TIME_INTERVAL[n]%timeInterval===0)if(TimelinePlotter.TIME_INTERVAL[n]/timeInterval*timeline.getColumnWidth()>60)break}var first=timeline.getFirstIndex();var last=timeline.getLastIndex();var d=new Date;var local_utc_diff=d.getTimezoneOffset()*60*1e3;var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="center";context.textBaseline="middle";var lang=mgr.getLanguage();var gridRects=[];var top=area.getTop();var middle=area.getMiddle();for(var i=first;i<last;i++){var utcDate=ds.getDataAt(i).date;var localDate=utcDate-local_utc_diff;var time=new Date(utcDate);var year=time.getFullYear();var month=time.getMonth()+1;var date=time.getDate();var hour=time.getHours();var minute=time.getMinutes();var text="";if(n<cnt){var m=Math.max(TimelinePlotter.TP_DAY,TimelinePlotter.TIME_INTERVAL[n]);if(localDate%m===0){if(lang==="zh-cn")text=month.toString()+"月"+date.toString()+"日";else if(lang==="zh-tw")text=month.toString()+"月"+date.toString()+"日";else if(lang==="en-us")text=TimelinePlotter.MonthConvert[month]+" "+date.toString();context.fillStyle=theme.getColor(themes.Theme.Color.Text4)}else if(localDate%TimelinePlotter.TIME_INTERVAL[n]===0){var strMinute=minute.toString();if(minute<10)strMinute="0"+strMinute;text=hour.toString()+":"+strMinute;context.fillStyle=theme.getColor(themes.Theme.Color.Text2)}}else if(date===1&&hour<timeInterval/TimelinePlotter.TP_HOUR){if(month===1){text=year.toString();if(lang==="zh-cn")text+="年";else if(lang==="zh-tw")text+="年"}else{if(lang==="zh-cn")text=month.toString()+"月";else if(lang==="zh-tw")text=month.toString()+"月";else if(lang==="en-us")text=TimelinePlotter.MonthConvert[month]}context.fillStyle=theme.getColor(themes.Theme.Color.Text4)}if(text.length>0){var x=timeline.toItemCenter(i);gridRects.push({x:x,y:top,w:1,h:4});context.fillText(text,x,middle)}}if(gridRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Grid1);Plotter.createRectangles(context,gridRects);context.fill()}}}]);return TimelinePlotter}(Plotter);exports.TimelinePlotter=TimelinePlotter;TimelinePlotter.TP_MINUTE=60*1e3;TimelinePlotter.TP_HOUR=60*TimelinePlotter.TP_MINUTE;TimelinePlotter.TP_DAY=24*TimelinePlotter.TP_HOUR;TimelinePlotter.TIME_INTERVAL=[5*TimelinePlotter.TP_MINUTE,10*TimelinePlotter.TP_MINUTE,15*TimelinePlotter.TP_MINUTE,30*TimelinePlotter.TP_MINUTE,TimelinePlotter.TP_HOUR,2*TimelinePlotter.TP_HOUR,3*TimelinePlotter.TP_HOUR,6*TimelinePlotter.TP_HOUR,12*TimelinePlotter.TP_HOUR,TimelinePlotter.TP_DAY,2*TimelinePlotter.TP_DAY];TimelinePlotter.MonthConvert={1:"Jan.",2:"Feb.",3:"Mar.",4:"Apr.",5:"May.",6:"Jun.",7:"Jul.",8:"Aug.",9:"Sep.",10:"Oct.",11:"Nov.",12:"Dec."};var RangePlotter=function(_NamedObject6){_inherits(RangePlotter,_NamedObject6);function RangePlotter(name){_classCallCheck(this,RangePlotter);return _possibleConstructorReturn(this,(RangePlotter.__proto__||Object.getPrototypeOf(RangePlotter)).call(this,name))}_createClass(RangePlotter,[{key:"getRequiredWidth",value:function getRequiredWidth(context,v){var mgr=_chart_manager.ChartManager.instance;var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);return context.measureText((Math.floor(v)+.88).toString()).width+16}},{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var areaName=this.getAreaName();var area=mgr.getArea(areaName);var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));var range=mgr.getRange(rangeName);if(range.getRange()===0)return;var isMainRange=range.getNameObject().getCompAt(2)==="main";if(isMainRange){}else{if(!area.isChanged()&&!range.isUpdated())return}var gradations=range.getGradations();if(gradations.length===0)return;var left=area.getLeft();var right=area.getRight();var center=area.getCenter();var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="center";context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.Text2);var gridRects=[];for(var n in gradations){var y=range.toY(gradations[n]);gridRects.push({x:left,y:y,w:6,h:1});gridRects.push({x:right-6,y:y,w:6,h:1});context.fillText(_util.Util.fromFloat(gradations[n],2),center,y)}if(gridRects.length>0){context.fillStyle=theme.getColor(themes.Theme.Color.Grid1);Plotter.createRectangles(context,gridRects);context.fill()}}}]);return RangePlotter}(_named_object.NamedObject);exports.RangePlotter=RangePlotter;var COrderGraphPlotter=function(_NamedObject7){_inherits(COrderGraphPlotter,_NamedObject7);function COrderGraphPlotter(name){_classCallCheck(this,COrderGraphPlotter);return _possibleConstructorReturn(this,(COrderGraphPlotter.__proto__||Object.getPrototypeOf(COrderGraphPlotter)).call(this,name))}_createClass(COrderGraphPlotter,[{key:"Draw",value:function Draw(context){return this._Draw_(context)}},{key:"_Draw_",value:function _Draw_(context){if(this.Update()===false)return;if(this.updateData()===false)return;this.m_top=this.m_pArea.getTop();this.m_bottom=this.m_pArea.getBottom();this.m_left=this.m_pArea.getLeft();this.m_right=this.m_pArea.getRight();context.save();context.rect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top);context.clip();var all=_chart_manager.ChartManager.instance.getChart()._depthData;this.x_offset=0;this.y_offset=0;var ask_tmp={};var bid_tmp={};ask_tmp.x=this.m_left+all.array[this.m_ask_si].amounts*this.m_Step;ask_tmp.y=this.m_pRange.toY(all.array[this.m_ask_si].rate);bid_tmp.x=this.m_left+all.array[this.m_bid_si].amounts*this.m_Step;bid_tmp.y=this.m_pRange.toY(all.array[this.m_bid_si].rate);if(Math.abs(ask_tmp.y-bid_tmp.y)<1){this.y_offset=1}this.x_offset=1;this.DrawBackground(context);this.UpdatePoints();this.FillBlack(context);this.DrawGradations(context);this.DrawLine(context);context.restore()}},{key:"DrawBackground",value:function DrawBackground(context){context.fillStyle=this.m_pTheme.getColor(themes.Theme.Color.Background);context.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top);var all=_chart_manager.ChartManager.instance.getChart()._depthData;if(this.m_mode===0){var ask_bottom=this.m_pRange.toY(all.array[this.m_ask_si].rate)-this.y_offset;var bid_top=this.m_pRange.toY(all.array[this.m_bid_si].rate)+this.y_offset;var ask_gradient=context.createLinearGradient(this.m_left,0,this.m_right,0);ask_gradient.addColorStop(0,this.m_pTheme.getColor(themes.Theme.Color.Background));ask_gradient.addColorStop(1,this.m_pTheme.getColor(themes.Theme.Color.PositiveDark));context.fillStyle=ask_gradient;context.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,ask_bottom-this.m_top);var bid_gradient=context.createLinearGradient(this.m_left,0,this.m_right,0);bid_gradient.addColorStop(0,this.m_pTheme.getColor(themes.Theme.Color.Background));bid_gradient.addColorStop(1,this.m_pTheme.getColor(themes.Theme.Color.NegativeDark));context.fillStyle=bid_gradient;context.fillRect(this.m_left,bid_top,this.m_right-this.m_left,this.m_bottom-bid_top)}else if(this.m_mode===1){var _ask_gradient=context.createLinearGradient(this.m_left,0,this.m_right,0);_ask_gradient.addColorStop(0,this.m_pTheme.getColor(themes.Theme.Color.Background));_ask_gradient.addColorStop(1,this.m_pTheme.getColor(themes.Theme.Color.PositiveDark));context.fillStyle=_ask_gradient;context.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top)}else if(this.m_mode===2){var _bid_gradient=context.createLinearGradient(this.m_left,0,this.m_right,0);_bid_gradient.addColorStop(0,this.m_pTheme.getColor(themes.Theme.Color.Background));_bid_gradient.addColorStop(1,this.m_pTheme.getColor(themes.Theme.Color.NegativeDark));context.fillStyle=_bid_gradient;context.fillRect(this.m_left,this.m_top,this.m_right-this.m_left,this.m_bottom-this.m_top)}}},{key:"DrawLine",value:function DrawLine(context){if(this.m_mode===0||this.m_mode===1){context.strokeStyle=this.m_pTheme.getColor(themes.Theme.Color.Positive);context.beginPath();context.moveTo(Math.floor(this.m_ask_points[0].x)+.5,Math.floor(this.m_ask_points[0].y)+.5);for(var i=1;i<this.m_ask_points.length;i++){context.lineTo(Math.floor(this.m_ask_points[i].x)+.5,Math.floor(this.m_ask_points[i].y)+.5)}context.stroke()}if(this.m_mode===0||this.m_mode===2){context.strokeStyle=this.m_pTheme.getColor(themes.Theme.Color.Negative);context.beginPath();context.moveTo(this.m_bid_points[0].x+.5,this.m_bid_points[0].y+.5);for(var _i2=1;_i2<this.m_bid_points.length;_i2++){context.lineTo(this.m_bid_points[_i2].x+.5,this.m_bid_points[_i2].y+.5)}context.stroke()}}},{key:"UpdatePoints",value:function UpdatePoints(){var all=_chart_manager.ChartManager.instance.getChart()._depthData;this.m_ask_points=[];var index_ask={};index_ask.x=Math.floor(this.m_left);index_ask.y=Math.floor(this.m_pRange.toY(all.array[this.m_ask_si].rate)-this.y_offset);this.m_ask_points.push(index_ask);var ask_p_i=0;for(var i=this.m_ask_si;i>=this.m_ask_ei;i--){var index0={};var index1={};if(i===this.m_ask_si){index0.x=Math.floor(this.m_left+all.array[i].amounts*this.m_Step+this.x_offset);index0.y=Math.floor(this.m_pRange.toY(all.array[i].rate)-this.y_offset);this.m_ask_points.push(index0);ask_p_i=1}else{index0.x=Math.floor(this.m_left+all.array[i].amounts*this.m_Step+this.x_offset);index0.y=Math.floor(this.m_ask_points[ask_p_i].y);index1.x=Math.floor(index0.x);index1.y=Math.floor(this.m_pRange.toY(all.array[i].rate)-this.y_offset);this.m_ask_points.push(index0);ask_p_i++;this.m_ask_points.push(index1);ask_p_i++}}this.m_bid_points=[];var index_bid={};index_bid.x=Math.floor(this.m_left);index_bid.y=Math.ceil(this.m_pRange.toY(all.array[this.m_bid_si].rate)+this.y_offset);this.m_bid_points.push(index_bid);var bid_p_i=0;for(var _i3=this.m_bid_si;_i3<=this.m_bid_ei;_i3++){var _index={};var _index2={};if(_i3===this.m_bid_si){_index.x=Math.floor(this.m_left+all.array[_i3].amounts*this.m_Step+this.x_offset);_index.y=Math.ceil(this.m_pRange.toY(all.array[_i3].rate)+this.y_offset);this.m_bid_points.push(_index);bid_p_i=1}else{_index.x=Math.floor(this.m_left+all.array[_i3].amounts*this.m_Step+this.x_offset);_index.y=Math.ceil(this.m_bid_points[bid_p_i].y);_index2.x=Math.floor(_index.x);_index2.y=Math.ceil(this.m_pRange.toY(all.array[_i3].rate)+this.x_offset);this.m_bid_points.push(_index);bid_p_i++;this.m_bid_points.push(_index2);bid_p_i++}}}},{key:"updateData",value:function updateData(){var all=_chart_manager.ChartManager.instance.getChart()._depthData;if(all.array===null)return false;if(all.array.length<=50)return false;var minRange=this.m_pRange.getOuterMinValue();var maxRange=this.m_pRange.getOuterMaxValue();this.m_ask_si=all.asks_si;this.m_ask_ei=all.asks_si;for(var i=all.asks_si;i>=all.asks_ei;i--){if(all.array[i].rate<maxRange)this.m_ask_ei=i;else break}this.m_bid_si=all.bids_si;this.m_bid_ei=all.bids_si;for(var _i4=all.bids_si;_i4<=all.bids_ei;_i4++){if(all.array[_i4].rate>minRange)this.m_bid_ei=_i4;else break}if(this.m_ask_ei===this.m_ask_si)this.m_mode=2;else if(this.m_bid_ei===this.m_bid_si)this.m_mode=1;else this.m_mode=0;this.m_Step=this.m_pArea.getWidth();if(this.m_mode===0){if(this.m_ask_ei===all.asks_ei&&this.m_bid_ei===all.bids_ei){this.m_Step/=Math.min(all.array[this.m_ask_ei].amounts,all.array[this.m_bid_ei].amounts)}else if(this.m_ask_ei!==all.asks_ei&&this.m_bid_ei===all.bids_ei){this.m_Step/=all.array[this.m_bid_ei].amounts}else if(this.m_ask_ei===all.asks_ei&&this.m_bid_ei!==all.bids_ei){this.m_Step/=all.array[this.m_ask_ei].amounts}else if(this.m_ask_ei!==all.asks_ei&&this.m_bid_ei!==all.bids_ei){this.m_Step/=Math.max(all.array[this.m_ask_ei].amounts,all.array[this.m_bid_ei].amounts)}}else if(this.m_mode===1){this.m_Step/=all.array[this.m_ask_ei].amounts}else if(this.m_mode===2){this.m_Step/=all.array[this.m_bid_ei].amounts}return true}},{key:"Update",value:function Update(){this.m_pMgr=_chart_manager.ChartManager.instance;var areaName=this.getAreaName();this.m_pArea=this.m_pMgr.getArea(areaName);if(this.m_pArea===null)return false;var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));this.m_pRange=this.m_pMgr.getRange(rangeName);if(this.m_pRange===null||this.m_pRange.getRange()===0)return false;this.m_pTheme=this.m_pMgr.getTheme(this.getFrameName());if(this.m_pTheme===null){return false}return true}},{key:"DrawGradations",value:function DrawGradations(context){var mgr=_chart_manager.ChartManager.instance;var areaName=this.getAreaName();var area=mgr.getArea(areaName);var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));var range=mgr.getRange(rangeName);if(range.getRange()===0)return;var gradations=range.getGradations();if(gradations.length===0)return;var left=area.getLeft();var right=area.getRight();var gridRects=[];for(var n in gradations){var y=range.toY(gradations[n]);gridRects.push({x:left,y:y,w:6,h:1});gridRects.push({x:right-6,y:y,w:6,h:1})}if(gridRects.length>0){var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(themes.Theme.Color.Grid1);Plotter.createRectangles(context,gridRects);context.fill()}}},{key:"FillBlack",value:function FillBlack(context){var ask_point=this.m_ask_points;var bid_point=this.m_bid_points;var ask_first_add={};var ask_last_add={};ask_first_add.x=this.m_right;ask_first_add.y=ask_point[0].y;ask_last_add.x=this.m_right;ask_last_add.y=ask_point[ask_point.length-1].y;var bid_first_add={};var bid_last_add={};bid_first_add.x=this.m_right;bid_first_add.y=bid_point[0].y-1;bid_last_add.x=this.m_right;bid_last_add.y=bid_point[bid_point.length-1].y;ask_point.unshift(ask_first_add);ask_point.push(ask_last_add);bid_point.unshift(bid_first_add);bid_point.push(bid_last_add);context.fillStyle=this.m_pTheme.getColor(themes.Theme.Color.Background);context.beginPath();context.moveTo(Math.floor(ask_point[0].x)+.5,Math.floor(ask_point[0].y)+.5);for(var i=1;i<ask_point.length;i++){context.lineTo(Math.floor(ask_point[i].x)+.5,Math.floor(ask_point[i].y)+.5)}context.fill();context.beginPath();context.moveTo(Math.floor(bid_point[0].x)+.5,Math.floor(bid_point[0].y)+.5);for(var _i5=1;_i5<bid_point.length;_i5++){context.lineTo(Math.floor(bid_point[_i5].x)+.5,Math.floor(bid_point[_i5].y)+.5)}context.fill();ask_point.shift();ask_point.pop();bid_point.shift();bid_point.pop()}},{key:"DrawTickerGraph",value:function DrawTickerGraph(context){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());var ticker=ds._dataItems[ds._dataItems.length-1].close;var p1x=this.m_left+1;var p1y=this.m_pRange.toY(ticker);var p2x=p1x+5;var p2y=p1y+2.5;var p3x=p1x+5;var p3y=p1y-2.5;context.fillStyle=this.m_pTheme.getColor(themes.Theme.Color.Mark);context.strokeStyle=this.m_pTheme.getColor(themes.Theme.Color.Mark)}}]);return COrderGraphPlotter}(_named_object.NamedObject);exports.COrderGraphPlotter=COrderGraphPlotter;var LastVolumePlotter=function(_Plotter7){_inherits(LastVolumePlotter,_Plotter7);function LastVolumePlotter(name){_classCallCheck(this,LastVolumePlotter);return _possibleConstructorReturn(this,(LastVolumePlotter.__proto__||Object.getPrototypeOf(LastVolumePlotter)).call(this,name))}_createClass(LastVolumePlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var timeline=mgr.getTimeline(this.getDataSourceName());var areaName=this.getAreaName();var area=mgr.getArea(areaName);var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));var range=mgr.getRange(rangeName);if(range.getRange()===0)return;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1)return;var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="left";context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.RangeMark);context.strokeStyle=theme.getColor(themes.Theme.Color.RangeMark);var v=ds.getDataAt(ds.getDataCount()-1).volume;var y=range.toY(v);var left=area.getLeft()+1;Plotter.drawLine(context,left,y,left+7,y);Plotter.drawLine(context,left,y,left+3,y+2);Plotter.drawLine(context,left,y,left+3,y-2);context.fillText(_util.Util.fromFloat(v,2),left+10,y)}}]);return LastVolumePlotter}(Plotter);exports.LastVolumePlotter=LastVolumePlotter;var LastClosePlotter=function(_Plotter8){_inherits(LastClosePlotter,_Plotter8);function LastClosePlotter(name){_classCallCheck(this,LastClosePlotter);return _possibleConstructorReturn(this,(LastClosePlotter.__proto__||Object.getPrototypeOf(LastClosePlotter)).call(this,name))}_createClass(LastClosePlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var timeline=mgr.getTimeline(this.getDataSourceName());var areaName=this.getAreaName();var area=mgr.getArea(areaName);var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));var range=mgr.getRange(rangeName);if(range.getRange()===0)return;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1)return;var v=ds._dataItems[ds._dataItems.length-1].close;if(v<=range.getMinValue()||v>=range.getMaxValue())return;var theme=mgr.getTheme(this.getFrameName());context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="left";context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.RangeMark);context.strokeStyle=theme.getColor(themes.Theme.Color.RangeMark);var y=range.toY(v);var left=area.getLeft()+1;Plotter.drawLine(context,left,y,left+7,y);Plotter.drawLine(context,left,y,left+3,y+2);Plotter.drawLine(context,left,y,left+3,y-2);context.fillText(_util.Util.fromFloat(v,ds.getDecimalDigits()),left+10,y)}}]);return LastClosePlotter}(Plotter);exports.LastClosePlotter=LastClosePlotter;var SelectionPlotter=function(_Plotter9){_inherits(SelectionPlotter,_Plotter9);function SelectionPlotter(name){_classCallCheck(this,SelectionPlotter);return _possibleConstructorReturn(this,(SelectionPlotter.__proto__||Object.getPrototypeOf(SelectionPlotter)).call(this,name))}_createClass(SelectionPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;if(mgr._drawingTool!==_chart_manager.ChartManager.DrawingTool.CrossCursor){return}var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());if(timeline.getSelectedIndex()<0){return}var range=mgr.getRange(this.getAreaName());var theme=mgr.getTheme(this.getFrameName());context.strokeStyle=theme.getColor(themes.Theme.Color.Cursor);var x=timeline.toItemCenter(timeline.getSelectedIndex());Plotter.drawLine(context,x,area.getTop()-1,x,area.getBottom());var pos=range.getSelectedPosition();if(pos>=0){Plotter.drawLine(context,area.getLeft(),pos,area.getRight(),pos)}}}]);return SelectionPlotter}(Plotter);exports.SelectionPlotter=SelectionPlotter;var TimelineSelectionPlotter=function(_Plotter10){_inherits(TimelineSelectionPlotter,_Plotter10);function TimelineSelectionPlotter(name){_classCallCheck(this,TimelineSelectionPlotter);return _possibleConstructorReturn(this,(TimelineSelectionPlotter.__proto__||Object.getPrototypeOf(TimelineSelectionPlotter)).call(this,name))}_createClass(TimelineSelectionPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var timeline=mgr.getTimeline(this.getDataSourceName());if(timeline.getSelectedIndex()<0)return
;var ds=mgr.getDataSource(this.getDataSourceName());if(!_util.Util.isInstance(ds,data_sources.MainDataSource))return;var theme=mgr.getTheme(this.getFrameName());var lang=mgr.getLanguage();var x=timeline.toItemCenter(timeline.getSelectedIndex());context.fillStyle=theme.getColor(themes.Theme.Color.Background);context.fillRect(x-52.5,area.getTop()+2.5,106,18);context.strokeStyle=theme.getColor(themes.Theme.Color.Grid3);context.strokeRect(x-52.5,area.getTop()+2.5,106,18);context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="center";context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.Text4);var time=new Date(ds.getDataAt(timeline.getSelectedIndex()).date);var month=time.getMonth()+1;var date=time.getDate();var hour=time.getHours();var minute=time.getMinutes();var second=time.getSeconds();var strMonth=month.toString();var strDate=date.toString();var strHour=hour.toString();var strMinute=minute.toString();var strSecond=second.toString();if(minute<10){strMinute="0"+strMinute}if(second<10){strSecond="0"+strSecond}var text="";if(lang==="zh-cn"){text=strMonth+"月"+strDate+"日  "+strHour+":"+strMinute}else if(lang==="zh-tw"){text=strMonth+"月"+strDate+"日  "+strHour+":"+strMinute}else if(lang==="en-us"){text=TimelineSelectionPlotter.MonthConvert[month]+" "+strDate+"  "+strHour+":"+strMinute}if(_kline.default.instance.range<6e4){text+=":"+strSecond}context.fillText(text,x,area.getMiddle())}}]);return TimelineSelectionPlotter}(Plotter);exports.TimelineSelectionPlotter=TimelineSelectionPlotter;TimelineSelectionPlotter.MonthConvert={1:"Jan.",2:"Feb.",3:"Mar.",4:"Apr.",5:"May.",6:"Jun.",7:"Jul.",8:"Aug.",9:"Sep.",10:"Oct.",11:"Nov.",12:"Dec."};var RangeSelectionPlotter=function(_NamedObject8){_inherits(RangeSelectionPlotter,_NamedObject8);function RangeSelectionPlotter(name){_classCallCheck(this,RangeSelectionPlotter);return _possibleConstructorReturn(this,(RangeSelectionPlotter.__proto__||Object.getPrototypeOf(RangeSelectionPlotter)).call(this,name))}_createClass(RangeSelectionPlotter,[{key:"Draw",value:function Draw(context){var mgr=_chart_manager.ChartManager.instance;var areaName=this.getAreaName();var area=mgr.getArea(areaName);var timeline=mgr.getTimeline(this.getDataSourceName());if(timeline.getSelectedIndex()<0){return}var rangeName=areaName.substring(0,areaName.lastIndexOf("Range"));var range=mgr.getRange(rangeName);if(range.getRange()===0||range.getSelectedPosition()<0){return}var v=range.getSelectedValue();if(v===-Number.MAX_VALUE){return}var y=range.getSelectedPosition();Plotter.createPolygon(context,[{x:area.getLeft(),y:y},{x:area.getLeft()+5,y:y+10},{x:area.getRight()-3,y:y+10},{x:area.getRight()-3,y:y-10},{x:area.getLeft()+5,y:y-10}]);var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(themes.Theme.Color.Background);context.fill();context.strokeStyle=theme.getColor(themes.Theme.Color.Grid4);context.stroke();context.font=theme.getFont(themes.Theme.Font.Default);context.textAlign="center";context.textBaseline="middle";context.fillStyle=theme.getColor(themes.Theme.Color.Text3);var digits=2;if(range.getNameObject().getCompAt(2)==="main"){digits=mgr.getDataSource(this.getDataSourceName()).getDecimalDigits()}context.fillText(_util.Util.fromFloat(v,digits),area.getCenter(),y)}}]);return RangeSelectionPlotter}(_named_object.NamedObject);exports.RangeSelectionPlotter=RangeSelectionPlotter;var CToolPlotter=function(_NamedObject9){_inherits(CToolPlotter,_NamedObject9);function CToolPlotter(name,toolObject){var _this2;_classCallCheck(this,CToolPlotter);_this2=_possibleConstructorReturn(this,(CToolPlotter.__proto__||Object.getPrototypeOf(CToolPlotter)).call(this,name));_this2.toolObject=toolObject;var pMgr=_chart_manager.ChartManager.instance;var pArea=pMgr.getArea("frame0.k0.main");if(pArea===null){_this2.areaPos={left:0,top:0,right:0,bottom:0};return _possibleConstructorReturn(_this2)}_this2.areaPos={left:pArea.getLeft(),top:pArea.getTop(),right:pArea.getRight(),bottom:pArea.getBottom()};_this2.crossPt={};_this2.normalSize=4;_this2.selectedSize=6;_this2.cursorLen=4;_this2.cursorGapLen=3;_this2.theme=_chart_manager.ChartManager.instance.getTheme(_this2.getFrameName());return _this2}_createClass(CToolPlotter,[{key:"drawCursor",value:function drawCursor(context){this.drawCrossCursor(context)}},{key:"drawCrossCursor",value:function drawCrossCursor(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);context.fillStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);var tempPt=this.toolObject.getPoint(0).getPosXY();if(tempPt===null){return}var x=tempPt.x;var y=tempPt.y;var cursorLen=this.cursorLen;var cursorGapLen=this.cursorGapLen;context.fillRect(x,y,1,1);Plotter.drawLine(context,x-cursorLen-cursorGapLen,y,x-cursorGapLen,y);Plotter.drawLine(context,x+cursorLen+cursorGapLen,y,x+cursorGapLen,y);Plotter.drawLine(context,x,y-cursorLen-cursorGapLen,x,y-cursorGapLen);Plotter.drawLine(context,x,y+cursorLen+cursorGapLen,x,y+cursorGapLen)}},{key:"drawCircle",value:function drawCircle(context,center,radius){var centerX=center.x;var centerY=center.y;context.beginPath();context.arc(centerX,centerY,radius,0,2*Math.PI,false);context.fillStyle=this.theme.getColor(themes.Theme.Color.CircleColorFill);context.fill();context.stroke()}},{key:"drawCtrlPt",value:function drawCtrlPt(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.CircleColorStroke);for(var i=0;i<this.ctrlPtsNum;i++){this.drawCircle(context,this.ctrlPts[1][i],this.normalSize)}}},{key:"highlightCtrlPt",value:function highlightCtrlPt(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.CircleColorStroke);for(var i=0;i<this.ctrlPtsNum;i++){if(this.toolObject.getPoint(i).getState()===_cpoint.CPoint.state.Highlight)this.drawCircle(context,this.ctrlPts[1][i],this.selectedSize)}}},{key:"drawFibRayLines",value:function drawFibRayLines(context,startPoint,endPoint){for(var i=0;i<this.fiboFansSequence.length;i++){var stageY=startPoint.y+(100-this.fiboFansSequence[i])/100*(endPoint.y-startPoint.y);var tempStartPt={x:startPoint.x,y:startPoint.y};var tempEndPt={x:endPoint.x,y:stageY};this.drawRayLines(context,tempStartPt,tempEndPt)}}},{key:"drawRayLines",value:function drawRayLines(context,startPoint,endPoint){this.getAreaPos();var tempStartPt={x:startPoint.x,y:startPoint.y};var tempEndPt={x:endPoint.x,y:endPoint.y};var crossPt=this.getRectCrossPt(this.areaPos,tempStartPt,tempEndPt);var tempCrossPt;if(endPoint.x===startPoint.x){if(endPoint.y===startPoint.y){tempCrossPt=endPoint}else{tempCrossPt=endPoint.y>startPoint.y?{x:crossPt[1].x,y:crossPt[1].y}:{x:crossPt[0].x,y:crossPt[0].y}}}else{tempCrossPt=endPoint.x>startPoint.x?{x:crossPt[1].x,y:crossPt[1].y}:{x:crossPt[0].x,y:crossPt[0].y}}Plotter.drawLine(context,startPoint.x,startPoint.y,tempCrossPt.x,tempCrossPt.y)}},{key:"lenBetweenPts",value:function lenBetweenPts(pt1,pt2){return Math.sqrt(Math.pow(pt2.x-pt1.x,2)+Math.pow(pt2.y-pt1.y,2))}},{key:"getCtrlPts",value:function getCtrlPts(){for(var i=0;i<this.ctrlPtsNum;i++){this.ctrlPts[0][i]=this.toolObject.getPoint(i)}}},{key:"updateCtrlPtPos",value:function updateCtrlPtPos(){for(var i=0;i<this.ctrlPtsNum;i++){this.ctrlPts[1][i]=this.ctrlPts[0][i].getPosXY()}}},{key:"getAreaPos",value:function getAreaPos(){var pMgr=_chart_manager.ChartManager.instance;var pArea=pMgr.getArea("frame0.k0.main");if(pArea===null){this.areaPos={left:0,top:0,right:0,bottom:0};return}this.areaPos={left:Math.floor(pArea.getLeft()),top:Math.floor(pArea.getTop()),right:Math.floor(pArea.getRight()),bottom:Math.floor(pArea.getBottom())}}},{key:"updateDraw",value:function updateDraw(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);this.draw(context);this.drawCtrlPt(context)}},{key:"finishDraw",value:function finishDraw(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);this.draw(context)}},{key:"highlight",value:function highlight(context){context.strokeStyle=this.theme.getColor(themes.Theme.Color.LineColorSelected);this.draw(context);this.drawCtrlPt(context);this.highlightCtrlPt(context)}}]);return CToolPlotter}(_named_object.NamedObject);exports.CToolPlotter=CToolPlotter;var DrawStraightLinesPlotter=function(_CToolPlotter){_inherits(DrawStraightLinesPlotter,_CToolPlotter);function DrawStraightLinesPlotter(name,toolObject){var _this3;_classCallCheck(this,DrawStraightLinesPlotter);_this3=_possibleConstructorReturn(this,(DrawStraightLinesPlotter.__proto__||Object.getPrototypeOf(DrawStraightLinesPlotter)).call(this,name,toolObject));_this3.toolObject=toolObject;_this3.ctrlPtsNum=2;_this3.ctrlPts=[new Array(_this3.ctrlPtsNum),new Array(2)];_this3.getCtrlPts();return _this3}_createClass(DrawStraightLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){Plotter.drawLine(context,this.areaPos.left,this.startPoint.y,this.areaPos.right,this.startPoint.y)}else{this.crossPt=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint);Plotter.drawLine(context,this.crossPt[0].x,this.crossPt[0].y,this.crossPt[1].x,this.crossPt[1].y)}}}]);return DrawStraightLinesPlotter}(CToolPlotter);exports.DrawStraightLinesPlotter=DrawStraightLinesPlotter;var DrawSegLinesPlotter=function(_CToolPlotter2){_inherits(DrawSegLinesPlotter,_CToolPlotter2);function DrawSegLinesPlotter(name,toolObject){var _this4;_classCallCheck(this,DrawSegLinesPlotter);_this4=_possibleConstructorReturn(this,(DrawSegLinesPlotter.__proto__||Object.getPrototypeOf(DrawSegLinesPlotter)).call(this,name,toolObject));_this4.toolObject=toolObject;_this4.ctrlPtsNum=2;_this4.ctrlPts=[new Array(_this4.ctrlPtsNum),new Array(2)];_this4.getCtrlPts();return _this4}_createClass(DrawSegLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){this.endPoint.x+=1}Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y)}}]);return DrawSegLinesPlotter}(CToolPlotter);exports.DrawSegLinesPlotter=DrawSegLinesPlotter;var DrawRayLinesPlotter=function(_CToolPlotter3){_inherits(DrawRayLinesPlotter,_CToolPlotter3);function DrawRayLinesPlotter(name,toolObject){var _this5;_classCallCheck(this,DrawRayLinesPlotter);_this5=_possibleConstructorReturn(this,(DrawRayLinesPlotter.__proto__||Object.getPrototypeOf(DrawRayLinesPlotter)).call(this,name));_this5.toolObject=toolObject;_this5.ctrlPtsNum=2;_this5.ctrlPts=[new Array(_this5.ctrlPtsNum),new Array(2)];_this5.getCtrlPts();return _this5}_createClass(DrawRayLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){this.endPoint.x+=1}this.drawRayLines(context,this.startPoint,this.endPoint)}}]);return DrawRayLinesPlotter}(CToolPlotter);exports.DrawRayLinesPlotter=DrawRayLinesPlotter;var DrawArrowLinesPlotter=function(_CToolPlotter4){_inherits(DrawArrowLinesPlotter,_CToolPlotter4);function DrawArrowLinesPlotter(name,toolObject){var _this6;_classCallCheck(this,DrawArrowLinesPlotter);_this6=_possibleConstructorReturn(this,(DrawArrowLinesPlotter.__proto__||Object.getPrototypeOf(DrawArrowLinesPlotter)).call(this,name,toolObject));_this6.toolObject=toolObject;_this6.arrowSizeRatio=.03;_this6.arrowSize=4;_this6.crossPt={x:-1,y:-1};_this6.ctrlPtsNum=2;_this6.ctrlPts=[new Array(_this6.ctrlPtsNum),new Array(2)];_this6.getCtrlPts();return _this6}_createClass(DrawArrowLinesPlotter,[{key:"drawArrow",value:function drawArrow(context,startPoint,endPoint){var len=this.lenBetweenPts(startPoint,endPoint);var vectorA=[endPoint.x-startPoint.x,endPoint.y-startPoint.y];this.crossPt.x=startPoint.x+(1-this.arrowSize/len)*vectorA[0];this.crossPt.y=startPoint.y+(1-this.arrowSize/len)*vectorA[1];var vectorAautho=[-vectorA[1],vectorA[0]];var Aautho={x:vectorAautho[0],y:vectorAautho[1]};var origin={x:0,y:0};vectorAautho[0]=this.arrowSize*Aautho.x/this.lenBetweenPts(Aautho,origin);vectorAautho[1]=this.arrowSize*Aautho.y/this.lenBetweenPts(Aautho,origin);var arrowEndPt=[this.crossPt.x+vectorAautho[0],this.crossPt.y+vectorAautho[1]];Plotter.drawLine(context,endPoint.x,endPoint.y,arrowEndPt[0],arrowEndPt[1]);arrowEndPt=[this.crossPt.x-vectorAautho[0],this.crossPt.y-vectorAautho[1]];Plotter.drawLine(context,endPoint.x,endPoint.y,arrowEndPt[0],arrowEndPt[1])}},{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){this.endPoint.x+=1}Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.endPoint.y);this.drawArrow(context,this.startPoint,this.endPoint)}}]);return DrawArrowLinesPlotter}(CToolPlotter);exports.DrawArrowLinesPlotter=DrawArrowLinesPlotter;var DrawHoriStraightLinesPlotter=function(_CToolPlotter5){_inherits(DrawHoriStraightLinesPlotter,_CToolPlotter5);function DrawHoriStraightLinesPlotter(name,toolObject){var _this7;_classCallCheck(this,DrawHoriStraightLinesPlotter);_this7=_possibleConstructorReturn(this,(DrawHoriStraightLinesPlotter.__proto__||Object.getPrototypeOf(DrawHoriStraightLinesPlotter)).call(this,name));_this7.toolObject=toolObject;_this7.ctrlPtsNum=1;_this7.ctrlPts=[new Array(_this7.ctrlPtsNum),new Array(2)];_this7.getCtrlPts();return _this7}_createClass(DrawHoriStraightLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];Plotter.drawLine(context,this.areaPos.left,this.startPoint.y,this.areaPos.right,this.startPoint.y)}}]);return DrawHoriStraightLinesPlotter}(CToolPlotter);exports.DrawHoriStraightLinesPlotter=DrawHoriStraightLinesPlotter;var DrawHoriRayLinesPlotter=function(_CToolPlotter6){_inherits(DrawHoriRayLinesPlotter,_CToolPlotter6);function DrawHoriRayLinesPlotter(name,toolObject){var _this8;_classCallCheck(this,DrawHoriRayLinesPlotter);_this8=_possibleConstructorReturn(this,(DrawHoriRayLinesPlotter.__proto__||Object.getPrototypeOf(DrawHoriRayLinesPlotter)).call(this,name));_this8.toolObject=toolObject;_this8.ctrlPtsNum=2;_this8.ctrlPts=[new Array(_this8.ctrlPtsNum),new Array(2)];_this8.getCtrlPts();return _this8}_createClass(DrawHoriRayLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x){Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.areaPos.right,this.startPoint.y)}else{var tempEndPt={x:this.endPoint.x,y:this.startPoint.y};this.drawRayLines(context,this.startPoint,tempEndPt)}}}]);return DrawHoriRayLinesPlotter}(CToolPlotter);exports.DrawHoriRayLinesPlotter=DrawHoriRayLinesPlotter;var DrawHoriSegLinesPlotter=function(_CToolPlotter7){_inherits(DrawHoriSegLinesPlotter,_CToolPlotter7);function DrawHoriSegLinesPlotter(name,toolObject){var _this9;_classCallCheck(this,DrawHoriSegLinesPlotter);_this9=_possibleConstructorReturn(this,(DrawHoriSegLinesPlotter.__proto__||Object.getPrototypeOf(DrawHoriSegLinesPlotter)).call(this,name,toolObject));_this9.toolObject=toolObject;_this9.ctrlPtsNum=2;_this9.ctrlPts=[new Array(_this9.ctrlPtsNum),new Array(2)];_this9.getCtrlPts();return _this9}_createClass(DrawHoriSegLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];this.endPoint.y=this.startPoint.y;if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.endPoint.x+1,this.startPoint.y)}else{Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.endPoint.x,this.startPoint.y)}}}]);return DrawHoriSegLinesPlotter}(CToolPlotter);exports.DrawHoriSegLinesPlotter=DrawHoriSegLinesPlotter;var DrawVertiStraightLinesPlotter=function(_CToolPlotter8){_inherits(DrawVertiStraightLinesPlotter,_CToolPlotter8);function DrawVertiStraightLinesPlotter(name,toolObject){var _this10;_classCallCheck(this,DrawVertiStraightLinesPlotter);_this10=_possibleConstructorReturn(this,(DrawVertiStraightLinesPlotter.__proto__||Object.getPrototypeOf(DrawVertiStraightLinesPlotter)).call(this,name));_this10.toolObject=toolObject;_this10.ctrlPtsNum=1;_this10.ctrlPts=[new Array(_this10.ctrlPtsNum),new Array(2)];_this10.getCtrlPts();return _this10}_createClass(DrawVertiStraightLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];Plotter.drawLine(context,this.startPoint.x,this.areaPos.top,this.startPoint.x,this.areaPos.bottom)}}]);return DrawVertiStraightLinesPlotter}(CToolPlotter);exports.DrawVertiStraightLinesPlotter=DrawVertiStraightLinesPlotter;var DrawPriceLinesPlotter=function(_CToolPlotter9){_inherits(DrawPriceLinesPlotter,_CToolPlotter9);function DrawPriceLinesPlotter(name,toolObject){var _this11;_classCallCheck(this,DrawPriceLinesPlotter);_this11=_possibleConstructorReturn(this,(DrawPriceLinesPlotter.__proto__||Object.getPrototypeOf(DrawPriceLinesPlotter)).call(this,name));_this11.toolObject=toolObject;_this11.ctrlPtsNum=1;_this11.ctrlPts=[new Array(_this11.ctrlPtsNum),new Array(2)];_this11.getCtrlPts();return _this11}_createClass(DrawPriceLinesPlotter,[{key:"draw",value:function draw(context){context.font="12px Tahoma";context.textAlign="left";context.fillStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];var text=this.ctrlPts[0][0].getPosIV().v;Plotter.drawLine(context,this.startPoint.x,this.startPoint.y,this.areaPos.right,this.startPoint.y);context.fillText(text.toFixed(2),this.startPoint.x+2,this.startPoint.y-15)}}]);return DrawPriceLinesPlotter}(CToolPlotter);exports.DrawPriceLinesPlotter=DrawPriceLinesPlotter;var ParallelLinesPlotter=function(_CToolPlotter10){_inherits(ParallelLinesPlotter,_CToolPlotter10);function ParallelLinesPlotter(name,toolObject){var _this12;_classCallCheck(this,ParallelLinesPlotter);_this12=_possibleConstructorReturn(this,(ParallelLinesPlotter.__proto__||Object.getPrototypeOf(ParallelLinesPlotter)).call(this,name));_this12.toolObject=toolObject;return _this12}_createClass(ParallelLinesPlotter,[{key:"getParaPt",value:function getParaPt(){var vectorA=[];vectorA[0]=this.endPoint.x-this.startPoint.x;vectorA[1]=this.endPoint.y-this.startPoint.y;var vectorB=[];vectorB[0]=this.paraStartPoint.x-this.startPoint.x;vectorB[1]=this.paraStartPoint.y-this.startPoint.y;this.paraEndPoint={x:-1,y:-1};this.paraEndPoint.x=vectorA[0]+vectorB[0]+this.startPoint.x;this.paraEndPoint.y=vectorA[1]+vectorB[1]+this.startPoint.y}}]);return ParallelLinesPlotter}(CToolPlotter);exports.ParallelLinesPlotter=ParallelLinesPlotter;var DrawBiParallelLinesPlotter=function(_ParallelLinesPlotter){_inherits(DrawBiParallelLinesPlotter,_ParallelLinesPlotter);function DrawBiParallelLinesPlotter(name,toolObject){var _this13;_classCallCheck(this,DrawBiParallelLinesPlotter);_this13=_possibleConstructorReturn(this,(DrawBiParallelLinesPlotter.__proto__||Object.getPrototypeOf(DrawBiParallelLinesPlotter)).call(this,name,toolObject));_this13.toolObject=toolObject;_this13.ctrlPtsNum=3;_this13.ctrlPts=[new Array(_this13.ctrlPtsNum),new Array(2)];_this13.getCtrlPts();return _this13}_createClass(DrawBiParallelLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.paraStartPoint=this.ctrlPts[1][1];this.endPoint=this.ctrlPts[1][2];this.getParaPt();this.getAreaPos();this.crossPt0=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint);Plotter.drawLine(context,this.crossPt0[0].x,this.crossPt0[0].y,this.crossPt0[1].x,this.crossPt0[1].y);this.crossPt1=this.getRectCrossPt(this.areaPos,this.paraStartPoint,this.paraEndPoint);Plotter.drawLine(context,this.crossPt1[0].x,this.crossPt1[0].y,this.crossPt1[1].x,this.crossPt1[1].y)}}]);return DrawBiParallelLinesPlotter}(ParallelLinesPlotter);exports.DrawBiParallelLinesPlotter=DrawBiParallelLinesPlotter;var DrawBiParallelRayLinesPlotter=function(_ParallelLinesPlotter2){_inherits(DrawBiParallelRayLinesPlotter,_ParallelLinesPlotter2);function DrawBiParallelRayLinesPlotter(name,toolObject){var _this14;_classCallCheck(this,DrawBiParallelRayLinesPlotter);_this14=_possibleConstructorReturn(this,(DrawBiParallelRayLinesPlotter.__proto__||Object.getPrototypeOf(DrawBiParallelRayLinesPlotter)).call(this,name,toolObject));_this14.toolObject=toolObject;_this14.ctrlPtsNum=3;_this14.ctrlPts=[new Array(_this14.ctrlPtsNum),new Array(2)];_this14.getCtrlPts();return _this14}_createClass(DrawBiParallelRayLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.paraStartPoint=this.ctrlPts[1][1];this.endPoint=this.ctrlPts[1][2];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){this.endPoint.x+=1}this.getParaPt();this.drawRayLines(context,this.startPoint,this.endPoint);this.drawRayLines(context,this.paraStartPoint,this.paraEndPoint)}}]);return DrawBiParallelRayLinesPlotter}(ParallelLinesPlotter);exports.DrawBiParallelRayLinesPlotter=DrawBiParallelRayLinesPlotter;var DrawTriParallelLinesPlotter=function(_ParallelLinesPlotter3){_inherits(DrawTriParallelLinesPlotter,_ParallelLinesPlotter3);function DrawTriParallelLinesPlotter(name,toolObject){var _this15;_classCallCheck(this,DrawTriParallelLinesPlotter);_this15=_possibleConstructorReturn(this,(DrawTriParallelLinesPlotter.__proto__||Object.getPrototypeOf(DrawTriParallelLinesPlotter)).call(this,name,toolObject));_this15.toolObject=toolObject;_this15.ctrlPtsNum=3;_this15.ctrlPts=[new Array(_this15.ctrlPtsNum),new Array(2)];_this15.getCtrlPts();return _this15}_createClass(DrawTriParallelLinesPlotter,[{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.paraStartPoint=this.ctrlPts[1][1];this.endPoint=this.ctrlPts[1][2];var vectorA=[];vectorA[0]=this.endPoint.x-this.startPoint.x;vectorA[1]=this.endPoint.y-this.startPoint.y;var vectorB=[];vectorB[0]=this.paraStartPoint.x-this.startPoint.x;vectorB[1]=this.paraStartPoint.y-this.startPoint.y;this.para1EndPoint={x:-1,y:-1};this.para2EndPoint={x:-1,y:-1};this.para2StartPoint={x:-1,y:-1};this.para1EndPoint.x=vectorA[0]+vectorB[0]+this.startPoint.x;this.para1EndPoint.y=vectorA[1]+vectorB[1]+this.startPoint.y;this.para2StartPoint.x=this.startPoint.x-vectorB[0];this.para2StartPoint.y=this.startPoint.y-vectorB[1];this.para2EndPoint.x=this.endPoint.x-vectorB[0];this.para2EndPoint.y=this.endPoint.y-vectorB[1];this.getAreaPos();this.crossPt0=this.getRectCrossPt(this.areaPos,this.startPoint,this.endPoint);Plotter.drawLine(context,this.crossPt0[0].x,this.crossPt0[0].y,this.crossPt0[1].x,this.crossPt0[1].y);this.crossPt1=this.getRectCrossPt(this.areaPos,this.paraStartPoint,this.para1EndPoint);Plotter.drawLine(context,this.crossPt1[0].x,this.crossPt1[0].y,this.crossPt1[1].x,this.crossPt1[1].y);this.crossPt2=this.getRectCrossPt(this.areaPos,this.para2StartPoint,this.para2EndPoint);Plotter.drawLine(context,this.crossPt2[0].x,this.crossPt2[0].y,this.crossPt2[1].x,this.crossPt2[1].y)}}]);return DrawTriParallelLinesPlotter}(ParallelLinesPlotter);exports.DrawTriParallelLinesPlotter=DrawTriParallelLinesPlotter;var BandLinesPlotter=function(_CToolPlotter11){_inherits(BandLinesPlotter,_CToolPlotter11);function BandLinesPlotter(name,toolObject){var _this16;_classCallCheck(this,BandLinesPlotter);_this16=_possibleConstructorReturn(this,(BandLinesPlotter.__proto__||Object.getPrototypeOf(BandLinesPlotter)).call(this,name));_this16.toolObject=toolObject;_this16.ctrlPtsNum=2;_this16.ctrlPts=[new Array(_this16.ctrlPtsNum),new Array(2)];_this16.getCtrlPts();return _this16}_createClass(BandLinesPlotter,[{key:"drawLinesAndInfo",value:function drawLinesAndInfo(context,startPoint,endPoint){context.font="12px Tahoma";context.textAlign="left";context.fillStyle=this.theme.getColor(themes.Theme.Color.LineColorNormal);var text;if(this.toolObject.state===ctools.CToolObject.state.Draw){this.startPtValue=this.toolObject.getPoint(0).getPosIV().v;this.endPtValue=this.toolObject.getPoint(1).getPosIV().v}this.getAreaPos();for(var i=0;i<this.fiboSequence.length;i++){var stageY=startPoint.y+(100-this.fiboSequence[i])/100*(endPoint.y-startPoint.y);if(stageY>this.areaPos.bottom)continue;var stageYvalue=this.startPtValue+(100-this.fiboSequence[i])/100*(this.endPtValue-this.startPtValue);Plotter.drawLine(context,this.areaPos.left,stageY,this.areaPos.right,stageY);text=this.fiboSequence[i].toFixed(1)+"% "+stageYvalue.toFixed(1);context.fillText(text,this.areaPos.left+2,stageY-15)}}},{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];this.drawLinesAndInfo(context,this.startPoint,this.endPoint)}}]);return BandLinesPlotter}(CToolPlotter);exports.BandLinesPlotter=BandLinesPlotter;var DrawFibRetracePlotter=function(_BandLinesPlotter){_inherits(DrawFibRetracePlotter,_BandLinesPlotter);function DrawFibRetracePlotter(name,toolObject){var _this17;_classCallCheck(this,DrawFibRetracePlotter);_this17=_possibleConstructorReturn(this,(DrawFibRetracePlotter.__proto__||Object.getPrototypeOf(DrawFibRetracePlotter)).call(this,name,toolObject));_this17.toolObject=toolObject;_this17.fiboSequence=[100,78.6,61.8,50,38.2,23.6,0];return _this17}return DrawFibRetracePlotter}(BandLinesPlotter);exports.DrawFibRetracePlotter=DrawFibRetracePlotter;var DrawBandLinesPlotter=function(_BandLinesPlotter2){_inherits(DrawBandLinesPlotter,_BandLinesPlotter2);function DrawBandLinesPlotter(name,toolObject){var _this18;_classCallCheck(this,DrawBandLinesPlotter);_this18=_possibleConstructorReturn(this,(DrawBandLinesPlotter.__proto__||Object.getPrototypeOf(DrawBandLinesPlotter)).call(this,name,toolObject));_this18.toolObject=toolObject;_this18.fiboSequence=[0,12.5,25,37.5,50,62.5,75,87.5,100];return _this18}return DrawBandLinesPlotter}(BandLinesPlotter);exports.DrawBandLinesPlotter=DrawBandLinesPlotter;var DrawFibFansPlotter=function(_CToolPlotter12){_inherits(DrawFibFansPlotter,_CToolPlotter12);function DrawFibFansPlotter(name,toolObject){var _this19;_classCallCheck(this,DrawFibFansPlotter);_this19=_possibleConstructorReturn(this,(DrawFibFansPlotter.__proto__||Object.getPrototypeOf(DrawFibFansPlotter)).call(this,name));_this19.toolObject=toolObject;_this19.fiboFansSequence=[0,38.2,50,61.8];_this19.ctrlPtsNum=2;_this19.ctrlPts=[new Array(_this19.ctrlPtsNum),new Array(2)];_this19.getCtrlPts();return _this19}_createClass(DrawFibFansPlotter,[{key:"drawLinesAndInfo",value:function drawLinesAndInfo(context,startPoint,endPoint){this.drawFibRayLines(context,startPoint,endPoint)}},{key:"draw",value:function draw(context){this.updateCtrlPtPos();this.getAreaPos();this.startPoint=this.ctrlPts[1][0];this.endPoint=this.ctrlPts[1][1];if(this.startPoint.x===this.endPoint.x&&this.startPoint.y===this.endPoint.y){this.endPoint.x+=1}this.drawLinesAndInfo(context,this.startPoint,this.endPoint)}}]);return DrawFibFansPlotter}(CToolPlotter);exports.DrawFibFansPlotter=DrawFibFansPlotter;var CDynamicLinePlotter=function(_NamedObject10){_inherits(CDynamicLinePlotter,_NamedObject10);function CDynamicLinePlotter(name){var _this20;_classCallCheck(this,CDynamicLinePlotter);_this20=_possibleConstructorReturn(this,(CDynamicLinePlotter.__proto__||Object.getPrototypeOf(CDynamicLinePlotter)).call(this,name));_this20.flag=true;_this20.context=_chart_manager.ChartManager.instance._overlayContext;return _this20}_createClass(CDynamicLinePlotter,[{key:"getAreaPos",value:function getAreaPos(){var pMgr=_chart_manager.ChartManager.instance;var pArea=pMgr.getArea("frame0.k0.main");if(pArea===null){this.areaPos={left:0,top:0,right:0,bottom:0};return}this.areaPos={left:Math.floor(pArea.getLeft()),top:Math.floor(pArea.getTop()),right:Math.floor(pArea.getRight()),bottom:Math.floor(pArea.getBottom())}}},{key:"Draw",value:function Draw(context){this.getAreaPos();var pMgr=_chart_manager.ChartManager.instance;var pTDP=pMgr.getDataSource(this.getDataSourceName());if(pTDP===null||!_util.Util.isInstance(pTDP,data_sources.MainDataSource))return;this.context.save();this.context.rect(this.areaPos.left,this.areaPos.top,this.areaPos.right-this.areaPos.left,this.areaPos.bottom-this.areaPos.top);this.context.clip();var count=pTDP.getToolObjectCount();for(var i=0;i<count;i++){var toolObject=pTDP.getToolObject(i);var state=toolObject.getState();switch(state){case ctools.CToolObject.state.BeforeDraw:toolObject.getPlotter().theme=_chart_manager.ChartManager.instance.getTheme(this.getFrameName());toolObject.getPlotter().drawCursor(this.context);break;case ctools.CToolObject.state.Draw:toolObject.getPlotter().theme=_chart_manager.ChartManager.instance.getTheme(this.getFrameName());toolObject.getPlotter().updateDraw(this.context);break;case ctools.CToolObject.state.AfterDraw:toolObject.getPlotter().theme=_chart_manager.ChartManager.instance.getTheme(this.getFrameName());toolObject.getPlotter().finishDraw(this.context);break;default:break}}var sel=pTDP.getSelectToolObjcet();if(sel!==null&&sel!==ctools.CToolObject.state.Draw)sel.getPlotter().highlight(this.context);this.context.restore()}}]);return CDynamicLinePlotter}(_named_object.NamedObject);exports.CDynamicLinePlotter=CDynamicLinePlotter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.IndicatorDataProvider=exports.MainDataProvider=exports.DataProvider=void 0;var _named_object=__webpack_require__(8);var _chart_manager=__webpack_require__(3);var _util=__webpack_require__(19);var data_sources=_interopRequireWildcard(__webpack_require__(11));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,
writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var DataProvider=function(_NamedObject){_inherits(DataProvider,_NamedObject);function DataProvider(name){var _this;_classCallCheck(this,DataProvider);_this=_possibleConstructorReturn(this,(DataProvider.__proto__||Object.getPrototypeOf(DataProvider)).call(this,name));_this._minValue=0;_this._maxValue=0;_this._minValueIndex=-1;_this._maxValueIndex=-1;return _this}_createClass(DataProvider,[{key:"getMinValue",value:function getMinValue(){return this._minValue}},{key:"getMaxValue",value:function getMaxValue(){return this._maxValue}},{key:"getMinValueIndex",value:function getMinValueIndex(){return this._minValueIndex}},{key:"getMaxValueIndex",value:function getMaxValueIndex(){return this._maxValueIndex}},{key:"getMinMaxAt",value:function getMinMaxAt(index,minmax){return true}},{key:"calcRange",value:function calcRange(firstIndexes,lastIndex,minmaxes,indexes){var min=Number.MAX_VALUE;var max=-Number.MAX_VALUE;var minIndex=-1;var maxIndex=-1;var minmax={};var i=lastIndex-1;var n=firstIndexes.length-1;for(;n>=0;n--){var first=firstIndexes[n];if(i<first){minmaxes[n]={min:min,max:max}}else{for(;i>=first;i--){if(this.getMinMaxAt(i,minmax)===false){continue}if(min>minmax.min){min=minmax.min;minIndex=i}if(max<minmax.max){max=minmax.max;maxIndex=i}}minmaxes[n]={min:min,max:max}}if(indexes!==null&&indexes!==undefined){indexes[n]={minIndex:minIndex,maxIndex:maxIndex}}}}},{key:"updateRange",value:function updateRange(){var mgr=_chart_manager.ChartManager.instance;var timeline=mgr.getTimeline(this.getDataSourceName());var firstIndexes=[timeline.getFirstIndex()];var minmaxes=[{}];var indexes=[{}];this.calcRange(firstIndexes,timeline.getLastIndex(),minmaxes,indexes);this._minValue=minmaxes[0].min;this._maxValue=minmaxes[0].max;this._minValueIndex=indexes[0].minIndex;this._maxValueIndex=indexes[0].maxIndex}}]);return DataProvider}(_named_object.NamedObject);exports.DataProvider=DataProvider;var MainDataProvider=function(_DataProvider){_inherits(MainDataProvider,_DataProvider);function MainDataProvider(name){var _this2;_classCallCheck(this,MainDataProvider);_this2=_possibleConstructorReturn(this,(MainDataProvider.__proto__||Object.getPrototypeOf(MainDataProvider)).call(this,name));_this2._candlestickDS=null;return _this2}_createClass(MainDataProvider,[{key:"updateData",value:function updateData(){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(!_util.Util.isInstance(ds,data_sources.MainDataSource)){return}this._candlestickDS=ds}},{key:"getMinMaxAt",value:function getMinMaxAt(index,minmax){var data=this._candlestickDS.getDataAt(index);minmax.min=data.low;minmax.max=data.high;return true}}]);return MainDataProvider}(DataProvider);exports.MainDataProvider=MainDataProvider;var IndicatorDataProvider=function(_DataProvider2){_inherits(IndicatorDataProvider,_DataProvider2);function IndicatorDataProvider(){_classCallCheck(this,IndicatorDataProvider);return _possibleConstructorReturn(this,(IndicatorDataProvider.__proto__||Object.getPrototypeOf(IndicatorDataProvider)).apply(this,arguments))}_createClass(IndicatorDataProvider,[{key:"getIndicator",value:function getIndicator(){return this._indicator}},{key:"setIndicator",value:function setIndicator(v){this._indicator=v;this.refresh()}},{key:"refresh",value:function refresh(){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1){return}var indic=this._indicator;var i,last=ds.getDataCount();indic.clear();indic.reserve(last);for(i=0;i<last;i++){indic.execute(ds,i)}}},{key:"updateData",value:function updateData(){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());if(ds.getDataCount()<1){return}var indic=this._indicator;var mode=ds.getUpdateMode();switch(mode){case data_sources.DataSource.UpdateMode.Refresh:{this.refresh();break}case data_sources.DataSource.UpdateMode.Append:{indic.reserve(ds.getAppendedCount());break}case data_sources.DataSource.UpdateMode.Update:{var i,last=ds.getDataCount();var cnt=ds.getUpdatedCount()+ds.getAppendedCount();for(i=last-cnt;i<last;i++){indic.execute(ds,i)}break}}}},{key:"getMinMaxAt",value:function getMinMaxAt(index,minmax){minmax.min=Number.MAX_VALUE;minmax.max=-Number.MAX_VALUE;var result,valid=false;var i,cnt=this._indicator.getOutputCount();for(i=0;i<cnt;i++){result=this._indicator.getOutputAt(i).execute(index);if(isNaN(result)===false){valid=true;if(minmax.min>result){minmax.min=result}if(minmax.max<result){minmax.max=result}}}return valid}}]);return IndicatorDataProvider}(DataProvider);exports.IndicatorDataProvider=IndicatorDataProvider},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ChartAreaGroup=exports.TimelineArea=exports.IndicatorRangeArea=exports.MainRangeArea=exports.IndicatorArea=exports.MainArea=exports.ChartArea=void 0;var _named_object=__webpack_require__(8);var _chart_manager=__webpack_require__(3);var _mevent=__webpack_require__(57);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return _get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var ChartArea=function(_NamedObject){_inherits(ChartArea,_NamedObject);function ChartArea(name){var _this;_classCallCheck(this,ChartArea);_this=_possibleConstructorReturn(this,(ChartArea.__proto__||Object.getPrototypeOf(ChartArea)).call(this,name));_this._left=0;_this._top=0;_this._right=0;_this._bottom=0;_this._changed=false;_this._highlighted=false;_this._pressed=false;_this._selected=false;_this.Measuring=new _mevent.MEvent;return _this}_createClass(ChartArea,[{key:"getDockStyle",value:function getDockStyle(){return this._dockStyle}},{key:"setDockStyle",value:function setDockStyle(dockStyle){this._dockStyle=dockStyle}},{key:"getLeft",value:function getLeft(){return this._left}},{key:"getTop",value:function getTop(){return this._top}},{key:"setTop",value:function setTop(v){if(this._top!==v){this._top=v;this._changed=true}}},{key:"getRight",value:function getRight(){return this._right}},{key:"getBottom",value:function getBottom(){return this._bottom}},{key:"setBottom",value:function setBottom(v){if(this._bottom!==v){this._bottom=v;this._changed=true}}},{key:"getCenter",value:function getCenter(){return this._left+this._right>>1}},{key:"getMiddle",value:function getMiddle(){return this._top+this._bottom>>1}},{key:"getWidth",value:function getWidth(){return this._right-this._left}},{key:"getHeight",value:function getHeight(){return this._bottom-this._top}},{key:"getRect",value:function getRect(){return{X:this._left,Y:this._top,Width:this._right-this._left,Height:this._bottom-this._top}}},{key:"contains",value:function contains(x,y){if(x>=this._left&&x<this._right)if(y>=this._top&&y<this._bottom)return[this];return null}},{key:"getMeasuredWidth",value:function getMeasuredWidth(){return this._measuredWidth}},{key:"getMeasuredHeight",value:function getMeasuredHeight(){return this._measuredHeight}},{key:"setMeasuredDimension",value:function setMeasuredDimension(width,height){this._measuredWidth=width;this._measuredHeight=height}},{key:"measure",value:function measure(context,width,height){this._measuredWidth=0;this._measuredHeight=0;this.Measuring.raise(this,{Width:width,Height:height});if(this._measuredWidth===0&&this._measuredHeight===0)this.setMeasuredDimension(width,height)}},{key:"layout",value:function layout(left,top,right,bottom,forceChange){left<<=0;if(this._left!==left){this._left=left;this._changed=true}top<<=0;if(this._top!==top){this._top=top;this._changed=true}right<<=0;if(this._right!==right){this._right=right;this._changed=true}bottom<<=0;if(this._bottom!==bottom){this._bottom=bottom;this._changed=true}if(forceChange)this._changed=true}},{key:"isChanged",value:function isChanged(){return this._changed}},{key:"setChanged",value:function setChanged(v){this._changed=v}},{key:"isHighlighted",value:function isHighlighted(){return this._highlighted}},{key:"getHighlightedArea",value:function getHighlightedArea(){return this._highlighted?this:null}},{key:"highlight",value:function highlight(area){this._highlighted=this===area;return this._highlighted?this:null}},{key:"isPressed",value:function isPressed(){return this._pressed}},{key:"setPressed",value:function setPressed(v){this._pressed=v}},{key:"isSelected",value:function isSelected(){return this._selected}},{key:"getSelectedArea",value:function getSelectedArea(){return this._selected?this:null}},{key:"select",value:function select(area){this._selected=this===area;return this._selected?this:null}},{key:"onMouseMove",value:function onMouseMove(x,y){return null}},{key:"onMouseLeave",value:function onMouseLeave(x,y){}},{key:"onMouseDown",value:function onMouseDown(x,y){return null}},{key:"onMouseUp",value:function onMouseUp(x,y){return null}}]);return ChartArea}(_named_object.NamedObject);exports.ChartArea=ChartArea;ChartArea.DockStyle={Left:0,Top:1,Right:2,Bottom:3,Fill:4};var MainArea=function(_ChartArea){_inherits(MainArea,_ChartArea);function MainArea(name){var _this2;_classCallCheck(this,MainArea);_this2=_possibleConstructorReturn(this,(MainArea.__proto__||Object.getPrototypeOf(MainArea)).call(this,name));_this2._dragStarted=false;_this2._oldX=0;_this2._oldY=0;_this2._passMoveEventToToolManager=true;return _this2}_createClass(MainArea,[{key:"onMouseMove",value:function onMouseMove(x,y){var mgr=_chart_manager.ChartManager.instance;if(mgr._capturingMouseArea===this)if(this._dragStarted===false)if(Math.abs(this._oldX-x)>1||Math.abs(this._oldY-y)>1)this._dragStarted=true;if(this._dragStarted){mgr.hideCursor();if(mgr.onToolMouseDrag(this.getFrameName(),x,y))return this;mgr.getTimeline(this.getDataSourceName()).move(x-this._oldX);return this}if(this._passMoveEventToToolManager&&mgr.onToolMouseMove(this.getFrameName(),x,y)){mgr.hideCursor();return this}switch(mgr._drawingTool){case _chart_manager.ChartManager.DrawingTool.Cursor:mgr.showCursor();break;case _chart_manager.ChartManager.DrawingTool.CrossCursor:if(mgr.showCrossCursor(this,x,y))mgr.hideCursor();else mgr.showCursor();break;default:mgr.hideCursor();break}return this}},{key:"onMouseLeave",value:function onMouseLeave(x,y){this._dragStarted=false;this._passMoveEventToToolManager=true}},{key:"onMouseDown",value:function onMouseDown(x,y){var mgr=_chart_manager.ChartManager.instance;mgr.getTimeline(this.getDataSourceName()).startMove();this._oldX=x;this._oldY=y;this._dragStarted=false;if(mgr.onToolMouseDown(this.getFrameName(),x,y))this._passMoveEventToToolManager=false;return this}},{key:"onMouseUp",value:function onMouseUp(x,y){var mgr=_chart_manager.ChartManager.instance;var ret=null;if(this._dragStarted){this._dragStarted=false;ret=this}if(mgr.onToolMouseUp(this.getFrameName(),x,y))ret=this;this._passMoveEventToToolManager=true;return ret}}]);return MainArea}(ChartArea);exports.MainArea=MainArea;var IndicatorArea=function(_ChartArea2){_inherits(IndicatorArea,_ChartArea2);function IndicatorArea(name){var _this3;_classCallCheck(this,IndicatorArea);_this3=_possibleConstructorReturn(this,(IndicatorArea.__proto__||Object.getPrototypeOf(IndicatorArea)).call(this,name));_this3._dragStarted=false;_this3._oldX=0;_this3._oldY=0;return _this3}_createClass(IndicatorArea,[{key:"onMouseMove",value:function onMouseMove(x,y){var mgr=_chart_manager.ChartManager.instance;if(mgr._capturingMouseArea===this){if(this._dragStarted===false){if(this._oldX!==x||this._oldY!==y){this._dragStarted=true}}}if(this._dragStarted){mgr.hideCursor();mgr.getTimeline(this.getDataSourceName()).move(x-this._oldX);return this}switch(mgr._drawingTool){case _chart_manager.ChartManager.DrawingTool.CrossCursor:if(mgr.showCrossCursor(this,x,y))mgr.hideCursor();else mgr.showCursor();break;default:mgr.showCursor();break}return this}},{key:"onMouseLeave",value:function onMouseLeave(x,y){this._dragStarted=false}},{key:"onMouseDown",value:function onMouseDown(x,y){var mgr=_chart_manager.ChartManager.instance;mgr.getTimeline(this.getDataSourceName()).startMove();this._oldX=x;this._oldY=y;this._dragStarted=false;return this}},{key:"onMouseUp",value:function onMouseUp(x,y){if(this._dragStarted){this._dragStarted=false;return this}return null}}]);return IndicatorArea}(ChartArea);exports.IndicatorArea=IndicatorArea;var MainRangeArea=function(_ChartArea3){_inherits(MainRangeArea,_ChartArea3);function MainRangeArea(name){_classCallCheck(this,MainRangeArea);return _possibleConstructorReturn(this,(MainRangeArea.__proto__||Object.getPrototypeOf(MainRangeArea)).call(this,name))}_createClass(MainRangeArea,[{key:"onMouseMove",value:function onMouseMove(x,y){_chart_manager.ChartManager.instance.showCursor();return this}}]);return MainRangeArea}(ChartArea);exports.MainRangeArea=MainRangeArea;var IndicatorRangeArea=function(_ChartArea4){_inherits(IndicatorRangeArea,_ChartArea4);function IndicatorRangeArea(name){_classCallCheck(this,IndicatorRangeArea);return _possibleConstructorReturn(this,(IndicatorRangeArea.__proto__||Object.getPrototypeOf(IndicatorRangeArea)).call(this,name))}_createClass(IndicatorRangeArea,[{key:"onMouseMove",value:function onMouseMove(x,y){_chart_manager.ChartManager.instance.showCursor();return this}}]);return IndicatorRangeArea}(ChartArea);exports.IndicatorRangeArea=IndicatorRangeArea;var TimelineArea=function(_ChartArea5){_inherits(TimelineArea,_ChartArea5);function TimelineArea(name){_classCallCheck(this,TimelineArea);return _possibleConstructorReturn(this,(TimelineArea.__proto__||Object.getPrototypeOf(TimelineArea)).call(this,name))}_createClass(TimelineArea,[{key:"onMouseMove",value:function onMouseMove(x,y){_chart_manager.ChartManager.instance.showCursor();return this}}]);return TimelineArea}(ChartArea);exports.TimelineArea=TimelineArea;var ChartAreaGroup=function(_ChartArea6){_inherits(ChartAreaGroup,_ChartArea6);function ChartAreaGroup(name){var _this4;_classCallCheck(this,ChartAreaGroup);_this4=_possibleConstructorReturn(this,(ChartAreaGroup.__proto__||Object.getPrototypeOf(ChartAreaGroup)).call(this,name));_this4._areas=[];_this4._highlightedArea=null;_this4._selectedArea=null;return _this4}_createClass(ChartAreaGroup,[{key:"contains",value:function contains(x,y){var areas;var a,i,cnt=this._areas.length;for(i=0;i<cnt;i++){a=this._areas[i];areas=a.contains(x,y);if(areas!==null){areas.push(this);return areas}}return _get(ChartAreaGroup.prototype.__proto__||Object.getPrototypeOf(ChartAreaGroup.prototype),"contains",this).call(this,x,y)}},{key:"getAreaCount",value:function getAreaCount(){return this._areas.length}},{key:"getAreaAt",value:function getAreaAt(index){if(index<0||index>=this._areas.length){return null}return this._areas[index]}},{key:"addArea",value:function addArea(area){this._areas.push(area)}},{key:"removeArea",value:function removeArea(area){var i,cnt=this._areas.length;for(i=0;i<cnt;i++){if(area===this._areas[i]){this._areas.splice(i);this.setChanged(true);break}}}},{key:"getGridColor",value:function getGridColor(){return this._gridColor}},{key:"setGridColor",value:function setGridColor(c){this._gridColor=c}},{key:"getHighlightedArea",value:function getHighlightedArea(){if(this._highlightedArea!==null){return this._highlightedArea.getHighlightedArea()}return null}},{key:"highlight",value:function highlight(area){this._highlightedArea=null;var e,i,cnt=this._areas.length;for(i=0;i<cnt;i++){e=this._areas[i].highlight(area);if(e!==null){this._highlightedArea=e;return this}}return null}},{key:"getSelectedArea",value:function getSelectedArea(){if(this._selectedArea!==null){return this._selectedArea.getSelectedArea()}return null}},{key:"select",value:function select(area){this._selectedArea=null;var e,i,cnt=this._areas.length;for(i=0;i<cnt;i++){e=this._areas[i].select(area);if(e!==null){this._selectedArea=e;return this}}return null}},{key:"onMouseLeave",value:function onMouseLeave(x,y){var i,cnt=this._areas.length;for(i=0;i<cnt;i++){this._areas[i].onMouseLeave(x,y)}}},{key:"onMouseUp",value:function onMouseUp(x,y){var a,i,cnt=this._areas.length;for(i=0;i<cnt;i++){a=this._areas[i].onMouseUp(x,y);if(a!==null)return a}return null}}]);return ChartAreaGroup}(ChartArea);exports.ChartAreaGroup=ChartAreaGroup},function(module,exports){var g;g=function(){return this}();try{g=g||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")g=window}module.exports=g},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CONSTANTS={NODE_CLIENT:false,NODE_ADMIN:false,SDK_VERSION:"${JSCORE_VERSION}"}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var onDisconnect_1=__webpack_require__(68);var TransactionResult_1=__webpack_require__(149);var util_1=__webpack_require__(1);var NextPushId_1=__webpack_require__(150);var Query_1=__webpack_require__(69);var Repo_1=__webpack_require__(31);var Path_1=__webpack_require__(2);var QueryParams_1=__webpack_require__(174);var validation_1=__webpack_require__(12);var util_2=__webpack_require__(0);var util_3=__webpack_require__(0);var SyncPoint_1=__webpack_require__(80);var Reference=function(_super){__extends(Reference,_super);function Reference(repo,path){var _this=this;if(!(repo instanceof Repo_1.Repo)){throw new Error("new Reference() no longer supported - use app.database().")}_this=_super.call(this,repo,path,QueryParams_1.QueryParams.DEFAULT,false)||this;return _this}Reference.prototype.getKey=function(){util_2.validateArgCount("Reference.key",0,0,arguments.length);if(this.path.isEmpty())return null;else return this.path.getBack()};Reference.prototype.child=function(pathString){util_2.validateArgCount("Reference.child",1,1,arguments.length);if(typeof pathString==="number"){pathString=String(pathString)}else if(!(pathString instanceof Path_1.Path)){if(this.path.getFront()===null)validation_1.validateRootPathString("Reference.child",1,pathString,false);else validation_1.validatePathString("Reference.child",1,pathString,false)}return new Reference(this.repo,this.path.child(pathString))};Reference.prototype.getParent=function(){util_2.validateArgCount("Reference.parent",0,0,arguments.length);var parentPath=this.path.parent();return parentPath===null?null:new Reference(this.repo,parentPath)};Reference.prototype.getRoot=function(){util_2.validateArgCount("Reference.root",0,0,arguments.length);var ref=this;while(ref.getParent()!==null){ref=ref.getParent()}return ref};Reference.prototype.databaseProp=function(){return this.repo.database};Reference.prototype.set=function(newVal,onComplete){util_2.validateArgCount("Reference.set",1,2,arguments.length);validation_1.validateWritablePath("Reference.set",this.path);validation_1.validateFirebaseDataArg("Reference.set",1,newVal,this.path,false);util_2.validateCallback("Reference.set",2,onComplete,true);var deferred=new util_3.Deferred;this.repo.setWithPriority(this.path,newVal,null,deferred.wrapCallback(onComplete));return deferred.promise};Reference.prototype.update=function(objectToMerge,onComplete){util_2.validateArgCount("Reference.update",1,2,arguments.length);validation_1.validateWritablePath("Reference.update",this.path);if(Array.isArray(objectToMerge)){var newObjectToMerge={};for(var i=0;i<objectToMerge.length;++i){newObjectToMerge[""+i]=objectToMerge[i]}objectToMerge=newObjectToMerge;util_1.warn("Passing an Array to Firebase.update() is deprecated. "+"Use set() if you want to overwrite the existing data, or "+"an Object with integer keys if you really do want to "+"only update some of the children.")}validation_1.validateFirebaseMergeDataArg("Reference.update",1,objectToMerge,this.path,false);util_2.validateCallback("Reference.update",2,onComplete,true);var deferred=new util_3.Deferred;this.repo.update(this.path,objectToMerge,deferred.wrapCallback(onComplete));return deferred.promise};Reference.prototype.setWithPriority=function(newVal,newPriority,onComplete){util_2.validateArgCount("Reference.setWithPriority",2,3,arguments.length);validation_1.validateWritablePath("Reference.setWithPriority",this.path);validation_1.validateFirebaseDataArg("Reference.setWithPriority",1,newVal,this.path,false);validation_1.validatePriority("Reference.setWithPriority",2,newPriority,false);util_2.validateCallback("Reference.setWithPriority",3,onComplete,true);if(this.getKey()===".length"||this.getKey()===".keys")throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var deferred=new util_3.Deferred;this.repo.setWithPriority(this.path,newVal,newPriority,deferred.wrapCallback(onComplete));return deferred.promise};Reference.prototype.remove=function(onComplete){util_2.validateArgCount("Reference.remove",0,1,arguments.length);validation_1.validateWritablePath("Reference.remove",this.path);util_2.validateCallback("Reference.remove",1,onComplete,true);return this.set(null,onComplete)};Reference.prototype.transaction=function(transactionUpdate,onComplete,applyLocally){util_2.validateArgCount("Reference.transaction",1,3,arguments.length);validation_1.validateWritablePath("Reference.transaction",this.path);util_2.validateCallback("Reference.transaction",1,transactionUpdate,false);util_2.validateCallback("Reference.transaction",2,onComplete,true);validation_1.validateBoolean("Reference.transaction",3,applyLocally,true);if(this.getKey()===".length"||this.getKey()===".keys")throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";if(applyLocally===undefined)applyLocally=true;var deferred=new util_3.Deferred;if(typeof onComplete==="function"){deferred.promise.catch(function(){})}var promiseComplete=function(error,committed,snapshot){if(error){deferred.reject(error)}else{deferred.resolve(new TransactionResult_1.TransactionResult(committed,snapshot))}if(typeof onComplete==="function"){onComplete(error,committed,snapshot)}};this.repo.startTransaction(this.path,transactionUpdate,promiseComplete,applyLocally);return deferred.promise};Reference.prototype.setPriority=function(priority,onComplete){util_2.validateArgCount("Reference.setPriority",1,2,arguments.length);validation_1.validateWritablePath("Reference.setPriority",this.path);validation_1.validatePriority("Reference.setPriority",1,priority,false);util_2.validateCallback("Reference.setPriority",2,onComplete,true);var deferred=new util_3.Deferred;this.repo.setWithPriority(this.path.child(".priority"),priority,null,deferred.wrapCallback(onComplete));return deferred.promise};Reference.prototype.push=function(value,onComplete){util_2.validateArgCount("Reference.push",0,2,arguments.length);validation_1.validateWritablePath("Reference.push",this.path);validation_1.validateFirebaseDataArg("Reference.push",1,value,this.path,true);util_2.validateCallback("Reference.push",2,onComplete,true);var now=this.repo.serverTime();var name=NextPushId_1.nextPushId(now);var thennablePushRef=this.child(name);var pushRef=this.child(name);var promise;if(value!=null){promise=thennablePushRef.set(value,onComplete).then(function(){return pushRef})}else{promise=Promise.resolve(pushRef)}thennablePushRef.then=promise.then.bind(promise);thennablePushRef.catch=promise.then.bind(promise,undefined);if(typeof onComplete==="function"){promise.catch(function(){})}return thennablePushRef};Reference.prototype.onDisconnect=function(){validation_1.validateWritablePath("Reference.onDisconnect",this.path);return new onDisconnect_1.OnDisconnect(this.repo,this.path)};Object.defineProperty(Reference.prototype,"database",{get:function(){return this.databaseProp()},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"key",{get:function(){return this.getKey()},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"parent",{get:function(){return this.getParent()},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"root",{get:function(){return this.getRoot()},enumerable:true,configurable:true});return Reference}(Query_1.Query);exports.Reference=Reference;Query_1.Query.__referenceConstructor=Reference;SyncPoint_1.SyncPoint.__referenceConstructor=Reference},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var validation_1=__webpack_require__(12);var Path_1=__webpack_require__(2);var PriorityIndex_1=__webpack_require__(4);var DataSnapshot=function(){function DataSnapshot(node_,ref_,index_){this.node_=node_;this.ref_=ref_;this.index_=index_}DataSnapshot.prototype.val=function(){util_1.validateArgCount("DataSnapshot.val",0,0,arguments.length);return this.node_.val()};DataSnapshot.prototype.exportVal=function(){util_1.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length);return this.node_.val(true)};DataSnapshot.prototype.toJSON=function(){util_1.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length);return this.exportVal()};DataSnapshot.prototype.exists=function(){util_1.validateArgCount("DataSnapshot.exists",0,0,arguments.length);return!this.node_.isEmpty()};DataSnapshot.prototype.child=function(childPathString){util_1.validateArgCount("DataSnapshot.child",0,1,arguments.length);childPathString=String(childPathString);validation_1.validatePathString("DataSnapshot.child",1,childPathString,false);var childPath=new Path_1.Path(childPathString);var childRef=this.ref_.child(childPath);return new DataSnapshot(this.node_.getChild(childPath),childRef,PriorityIndex_1.PRIORITY_INDEX)};DataSnapshot.prototype.hasChild=function(childPathString){util_1.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length);validation_1.validatePathString("DataSnapshot.hasChild",1,childPathString,false);var childPath=new Path_1.Path(childPathString);return!this.node_.getChild(childPath).isEmpty()};DataSnapshot.prototype.getPriority=function(){util_1.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length);return this.node_.getPriority().val()};DataSnapshot.prototype.forEach=function(action){var _this=this;util_1.validateArgCount("DataSnapshot.forEach",1,1,arguments.length);util_1.validateCallback("DataSnapshot.forEach",1,action,false);if(this.node_.isLeafNode())return false;var childrenNode=this.node_;return!!childrenNode.forEachChild(this.index_,function(key,node){return action(new DataSnapshot(node,_this.ref_.child(key),PriorityIndex_1.PRIORITY_INDEX))})};DataSnapshot.prototype.hasChildren=function(){util_1.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length);if(this.node_.isLeafNode())return false;else return!this.node_.isEmpty()};Object.defineProperty(DataSnapshot.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:true,configurable:true});DataSnapshot.prototype.numChildren=function(){util_1.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length);return this.node_.numChildren()};DataSnapshot.prototype.getRef=function(){util_1.validateArgCount("DataSnapshot.ref",0,0,arguments.length);return this.ref_};Object.defineProperty(DataSnapshot.prototype,"ref",{get:function(){return this.getRef()},enumerable:true,configurable:true});return DataSnapshot}();exports.DataSnapshot=DataSnapshot},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var SortedMap_1=__webpack_require__(30);var Path_1=__webpack_require__(2);var util_1=__webpack_require__(1);var util_2=__webpack_require__(0);var emptyChildrenSingleton;var EmptyChildren=function(){if(!emptyChildrenSingleton){emptyChildrenSingleton=new SortedMap_1.SortedMap(util_1.stringCompare)}return emptyChildrenSingleton};var ImmutableTree=function(){function ImmutableTree(value,children){if(children===void 0){children=EmptyChildren()}this.value=value;this.children=children}ImmutableTree.fromObject=function(obj){var tree=ImmutableTree.Empty;util_2.forEach(obj,function(childPath,childSnap){tree=tree.set(new Path_1.Path(childPath),childSnap)});return tree};ImmutableTree.prototype.isEmpty=function(){return this.value===null&&this.children.isEmpty()};ImmutableTree.prototype.findRootMostMatchingPathAndValue=function(relativePath,predicate){if(this.value!=null&&predicate(this.value)){return{path:Path_1.Path.Empty,value:this.value}}else{if(relativePath.isEmpty()){return null}else{var front=relativePath.getFront();var child=this.children.get(front);if(child!==null){var childExistingPathAndValue=child.findRootMostMatchingPathAndValue(relativePath.popFront(),predicate);if(childExistingPathAndValue!=null){var fullPath=new Path_1.Path(front).child(childExistingPathAndValue.path);return{path:fullPath,value:childExistingPathAndValue.value}}else{return null}}else{return null}}}};ImmutableTree.prototype.findRootMostValueAndPath=function(relativePath){return this.findRootMostMatchingPathAndValue(relativePath,function(){return true})};ImmutableTree.prototype.subtree=function(relativePath){if(relativePath.isEmpty()){return this}else{var front=relativePath.getFront();var childTree=this.children.get(front);if(childTree!==null){return childTree.subtree(relativePath.popFront())}else{return ImmutableTree.Empty}}};ImmutableTree.prototype.set=function(relativePath,toSet){if(relativePath.isEmpty()){return new ImmutableTree(toSet,this.children)}else{var front=relativePath.getFront();var child=this.children.get(front)||ImmutableTree.Empty;var newChild=child.set(relativePath.popFront(),toSet);var newChildren=this.children.insert(front,newChild);return new ImmutableTree(this.value,newChildren)}};ImmutableTree.prototype.remove=function(relativePath){if(relativePath.isEmpty()){if(this.children.isEmpty()){return ImmutableTree.Empty}else{return new ImmutableTree(null,this.children)}}else{
var front=relativePath.getFront();var child=this.children.get(front);if(child){var newChild=child.remove(relativePath.popFront());var newChildren=void 0;if(newChild.isEmpty()){newChildren=this.children.remove(front)}else{newChildren=this.children.insert(front,newChild)}if(this.value===null&&newChildren.isEmpty()){return ImmutableTree.Empty}else{return new ImmutableTree(this.value,newChildren)}}else{return this}}};ImmutableTree.prototype.get=function(relativePath){if(relativePath.isEmpty()){return this.value}else{var front=relativePath.getFront();var child=this.children.get(front);if(child){return child.get(relativePath.popFront())}else{return null}}};ImmutableTree.prototype.setTree=function(relativePath,newTree){if(relativePath.isEmpty()){return newTree}else{var front=relativePath.getFront();var child=this.children.get(front)||ImmutableTree.Empty;var newChild=child.setTree(relativePath.popFront(),newTree);var newChildren=void 0;if(newChild.isEmpty()){newChildren=this.children.remove(front)}else{newChildren=this.children.insert(front,newChild)}return new ImmutableTree(this.value,newChildren)}};ImmutableTree.prototype.fold=function(fn){return this.fold_(Path_1.Path.Empty,fn)};ImmutableTree.prototype.fold_=function(pathSoFar,fn){var accum={};this.children.inorderTraversal(function(childKey,childTree){accum[childKey]=childTree.fold_(pathSoFar.child(childKey),fn)});return fn(pathSoFar,this.value,accum)};ImmutableTree.prototype.findOnPath=function(path,f){return this.findOnPath_(path,Path_1.Path.Empty,f)};ImmutableTree.prototype.findOnPath_=function(pathToFollow,pathSoFar,f){var result=this.value?f(pathSoFar,this.value):false;if(result){return result}else{if(pathToFollow.isEmpty()){return null}else{var front=pathToFollow.getFront();var nextChild=this.children.get(front);if(nextChild){return nextChild.findOnPath_(pathToFollow.popFront(),pathSoFar.child(front),f)}else{return null}}}};ImmutableTree.prototype.foreachOnPath=function(path,f){return this.foreachOnPath_(path,Path_1.Path.Empty,f)};ImmutableTree.prototype.foreachOnPath_=function(pathToFollow,currentRelativePath,f){if(pathToFollow.isEmpty()){return this}else{if(this.value){f(currentRelativePath,this.value)}var front=pathToFollow.getFront();var nextChild=this.children.get(front);if(nextChild){return nextChild.foreachOnPath_(pathToFollow.popFront(),currentRelativePath.child(front),f)}else{return ImmutableTree.Empty}}};ImmutableTree.prototype.foreach=function(f){this.foreach_(Path_1.Path.Empty,f)};ImmutableTree.prototype.foreach_=function(currentRelativePath,f){this.children.inorderTraversal(function(childName,childTree){childTree.foreach_(currentRelativePath.child(childName),f)});if(this.value){f(currentRelativePath,this.value)}};ImmutableTree.prototype.foreachChild=function(f){this.children.inorderTraversal(function(childName,childTree){if(childTree.value){f(childName,childTree.value)}})};ImmutableTree.Empty=new ImmutableTree(null);return ImmutableTree}();exports.ImmutableTree=ImmutableTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Change_1=__webpack_require__(16);var ChildrenNode_1=__webpack_require__(5);var PriorityIndex_1=__webpack_require__(4);var IndexedFilter=function(){function IndexedFilter(index_){this.index_=index_}IndexedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){util_1.assert(snap.isIndexed(this.index_),"A node must be indexed if only a child is updated");var oldChild=snap.getImmediateChild(key);if(oldChild.getChild(affectedPath).equals(newChild.getChild(affectedPath))){if(oldChild.isEmpty()==newChild.isEmpty()){return snap}}if(optChangeAccumulator!=null){if(newChild.isEmpty()){if(snap.hasChild(key)){optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key,oldChild))}else{util_1.assert(snap.isLeafNode(),"A child remove without an old child only makes sense on a leaf node")}}else if(oldChild.isEmpty()){optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key,newChild))}else{optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key,newChild,oldChild))}}if(snap.isLeafNode()&&newChild.isEmpty()){return snap}else{return snap.updateImmediateChild(key,newChild).withIndex(this.index_)}};IndexedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){if(optChangeAccumulator!=null){if(!oldSnap.isLeafNode()){oldSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){if(!newSnap.hasChild(key)){optChangeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(key,childNode))}})}if(!newSnap.isLeafNode()){newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){if(oldSnap.hasChild(key)){var oldChild=oldSnap.getImmediateChild(key);if(!oldChild.equals(childNode)){optChangeAccumulator.trackChildChange(Change_1.Change.childChangedChange(key,childNode,oldChild))}}else{optChangeAccumulator.trackChildChange(Change_1.Change.childAddedChange(key,childNode))}})}}return newSnap.withIndex(this.index_)};IndexedFilter.prototype.updatePriority=function(oldSnap,newPriority){if(oldSnap.isEmpty()){return ChildrenNode_1.ChildrenNode.EMPTY_NODE}else{return oldSnap.updatePriority(newPriority)}};IndexedFilter.prototype.filtersNodes=function(){return false};IndexedFilter.prototype.getIndexedFilter=function(){return this};IndexedFilter.prototype.getIndex=function(){return this.index_};return IndexedFilter}();exports.IndexedFilter=IndexedFilter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var StatsCollection_1=__webpack_require__(166);var StatsManager=function(){function StatsManager(){}StatsManager.getCollection=function(repoInfo){var hashString=repoInfo.toString();if(!this.collections_[hashString]){this.collections_[hashString]=new StatsCollection_1.StatsCollection}return this.collections_[hashString]};StatsManager.getOrCreateReporter=function(repoInfo,creatorFunction){var hashString=repoInfo.toString();if(!this.reporters_[hashString]){this.reporters_[hashString]=creatorFunction()}return this.reporters_[hashString]};StatsManager.collections_={};StatsManager.reporters_={};return StatsManager}();exports.StatsManager=StatsManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Repo_1=__webpack_require__(31);var util_2=__webpack_require__(1);var parser_1=__webpack_require__(66);var validation_1=__webpack_require__(12);__webpack_require__(176);var DATABASE_URL_OPTION="databaseURL";var _staticInstance;var RepoManager=function(){function RepoManager(){this.repos_={};this.useRestClient_=false}RepoManager.getInstance=function(){if(!_staticInstance){_staticInstance=new RepoManager}return _staticInstance};RepoManager.prototype.interrupt=function(){for(var appName in this.repos_){for(var dbUrl in this.repos_[appName]){this.repos_[appName][dbUrl].interrupt()}}};RepoManager.prototype.resume=function(){for(var appName in this.repos_){for(var dbUrl in this.repos_[appName]){this.repos_[appName][dbUrl].resume()}}};RepoManager.prototype.databaseFromApp=function(app,url){var dbUrl=url||app.options[DATABASE_URL_OPTION];if(dbUrl===undefined){util_2.fatal("Can't determine Firebase Database URL.  Be sure to include "+DATABASE_URL_OPTION+" option when calling firebase.intializeApp().")}var parsedUrl=parser_1.parseRepoInfo(dbUrl);var repoInfo=parsedUrl.repoInfo;validation_1.validateUrl("Invalid Firebase Database URL",1,parsedUrl);if(!parsedUrl.path.isEmpty()){util_2.fatal("Database URL must point to the root of a Firebase Database "+"(not including a child path).")}var repo=this.createRepo(repoInfo,app);return repo.database};RepoManager.prototype.deleteRepo=function(repo){var appRepos=util_1.safeGet(this.repos_,repo.app.name);if(!appRepos||util_1.safeGet(appRepos,repo.repoInfo_.toURLString())!==repo){util_2.fatal("Database "+repo.app.name+"("+repo.repoInfo_+") has already been deleted.")}repo.interrupt();delete appRepos[repo.repoInfo_.toURLString()]};RepoManager.prototype.createRepo=function(repoInfo,app){var appRepos=util_1.safeGet(this.repos_,app.name);if(!appRepos){appRepos={};this.repos_[app.name]=appRepos}var repo=util_1.safeGet(appRepos,repoInfo.toURLString());if(repo){util_2.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.")}repo=new Repo_1.Repo(repoInfo,this.useRestClient_,app);appRepos[repoInfo.toURLString()]=repo;return repo};RepoManager.prototype.forceRestClient=function(forceRestClient){this.useRestClient_=forceRestClient};return RepoManager}();exports.RepoManager=RepoManager},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["g"]=validate;__webpack_exports__["e"]=stringSpec;__webpack_exports__["f"]=uploadDataSpec;__webpack_exports__["b"]=metadataSpec;__webpack_exports__["c"]=nonNegativeNumberSpec;__webpack_exports__["a"]=looseObjectSpec;__webpack_exports__["d"]=nullFunctionSpec;var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_1__metadata__=__webpack_require__(51);var __WEBPACK_IMPORTED_MODULE_2__type__=__webpack_require__(7);function validate(name,specs,passed){var minArgs=specs.length;var maxArgs=specs.length;for(var i=0;i<specs.length;i++){if(specs[i].optional){minArgs=i;break}}var validLength=minArgs<=passed.length&&passed.length<=maxArgs;if(!validLength){throw __WEBPACK_IMPORTED_MODULE_0__error__["g"](minArgs,maxArgs,name,passed.length)}for(var i=0;i<passed.length;i++){try{specs[i].validator(passed[i])}catch(e){if(e instanceof Error){throw __WEBPACK_IMPORTED_MODULE_0__error__["f"](i,name,e.message)}else{throw __WEBPACK_IMPORTED_MODULE_0__error__["f"](i,name,e)}}}}var ArgSpec=function(){function ArgSpec(validator,opt_optional){var self=this;this.validator=function(p){if(self.optional&&!__WEBPACK_IMPORTED_MODULE_2__type__["c"](p)){return}validator(p)};this.optional=!!opt_optional}return ArgSpec}();function and_(v1,v2){return function(p){v1(p);v2(p)}}function stringSpec(opt_validator,opt_optional){function stringValidator(p){if(!__WEBPACK_IMPORTED_MODULE_2__type__["j"](p)){throw"Expected string."}}var validator;if(opt_validator){validator=and_(stringValidator,opt_validator)}else{validator=stringValidator}return new ArgSpec(validator,opt_optional)}function uploadDataSpec(){function validator(p){var valid=p instanceof Uint8Array||p instanceof ArrayBuffer||__WEBPACK_IMPORTED_MODULE_2__type__["e"]()&&p instanceof Blob;if(!valid){throw"Expected Blob or File."}}return new ArgSpec(validator)}function metadataSpec(opt_optional){return new ArgSpec(__WEBPACK_IMPORTED_MODULE_1__metadata__["c"],opt_optional)}function nonNegativeNumberSpec(){function validator(p){var valid=__WEBPACK_IMPORTED_MODULE_2__type__["h"](p)&&p>=0;if(!valid){throw"Expected a number 0 or greater."}}return new ArgSpec(validator)}function looseObjectSpec(opt_validator,opt_optional){function validator(p){var isLooseObject=p===null||__WEBPACK_IMPORTED_MODULE_2__type__["a"](p)&&p instanceof Object;if(!isLooseObject){throw"Expected an Object."}if(opt_validator!==undefined&&opt_validator!==null){opt_validator(p)}}return new ArgSpec(validator,opt_optional)}function nullFunctionSpec(opt_optional){function validator(p){var valid=p===null||__WEBPACK_IMPORTED_MODULE_2__type__["b"](p);if(!valid){throw"Expected a Function."}}return new ArgSpec(validator,opt_optional)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=getMappings;__webpack_exports__["a"]=fromResourceString;__webpack_exports__["d"]=toResourceString;__webpack_exports__["c"]=metadataValidator;var __WEBPACK_IMPORTED_MODULE_0__json__=__webpack_require__(191);var __WEBPACK_IMPORTED_MODULE_1__location__=__webpack_require__(35);var __WEBPACK_IMPORTED_MODULE_2__path__=__webpack_require__(96);var __WEBPACK_IMPORTED_MODULE_3__type__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_4__url__=__webpack_require__(52);function noXform_(metadata,value){return value}var Mapping=function(){function Mapping(server,opt_local,opt_writable,opt_xform){this.server=server;this.local=opt_local||server;this.writable=!!opt_writable;this.xform=opt_xform||noXform_}return Mapping}();var mappings_=null;function xformPath(fullPath){var valid=__WEBPACK_IMPORTED_MODULE_3__type__["j"](fullPath);if(!valid||fullPath.length<2){return fullPath}else{fullPath=fullPath;return __WEBPACK_IMPORTED_MODULE_2__path__["b"](fullPath)}}function getMappings(){if(mappings_){return mappings_}var mappings=[];mappings.push(new Mapping("bucket"));mappings.push(new Mapping("generation"));mappings.push(new Mapping("metageneration"));mappings.push(new Mapping("name","fullPath",true));function mappingsXformPath(metadata,fullPath){return xformPath(fullPath)}var nameMapping=new Mapping("name");nameMapping.xform=mappingsXformPath;mappings.push(nameMapping);function xformSize(metadata,size){if(__WEBPACK_IMPORTED_MODULE_3__type__["a"](size)){return+size}else{return size}}var sizeMapping=new Mapping("size");sizeMapping.xform=xformSize;mappings.push(sizeMapping);mappings.push(new Mapping("timeCreated"));mappings.push(new Mapping("updated"));mappings.push(new Mapping("md5Hash",null,true));mappings.push(new Mapping("cacheControl",null,true));mappings.push(new Mapping("contentDisposition",null,true));mappings.push(new Mapping("contentEncoding",null,true));mappings.push(new Mapping("contentLanguage",null,true));mappings.push(new Mapping("contentType",null,true));mappings.push(new Mapping("metadata","customMetadata",true));function xformTokens(metadata,tokens){var valid=__WEBPACK_IMPORTED_MODULE_3__type__["j"](tokens)&&tokens.length>0;if(!valid){return[]}var encode=encodeURIComponent;var tokensList=tokens.split(",");var urls=tokensList.map(function(token){var bucket=metadata["bucket"];var path=metadata["fullPath"];var urlPart="/b/"+encode(bucket)+"/o/"+encode(path);var base=__WEBPACK_IMPORTED_MODULE_4__url__["a"](urlPart);var queryString=__WEBPACK_IMPORTED_MODULE_4__url__["c"]({alt:"media",token:token});return base+queryString});return urls}mappings.push(new Mapping("downloadTokens","downloadURLs",false,xformTokens));mappings_=mappings;return mappings_}function addRef(metadata,authWrapper){function generateRef(){var bucket=metadata["bucket"];var path=metadata["fullPath"];var loc=new __WEBPACK_IMPORTED_MODULE_1__location__["a"](bucket,path);return authWrapper.makeStorageReference(loc)}Object.defineProperty(metadata,"ref",{get:generateRef})}function fromResource(authWrapper,resource,mappings){var metadata={};metadata["type"]="file";var len=mappings.length;for(var i=0;i<len;i++){var mapping=mappings[i];metadata[mapping.local]=mapping.xform(metadata,resource[mapping.server])}addRef(metadata,authWrapper);return metadata}function fromResourceString(authWrapper,resourceString,mappings){var obj=__WEBPACK_IMPORTED_MODULE_0__json__["a"](resourceString);if(obj===null){return null}var resource=obj;return fromResource(authWrapper,resource,mappings)}function toResourceString(metadata,mappings){var resource={};var len=mappings.length;for(var i=0;i<len;i++){var mapping=mappings[i];if(mapping.writable){resource[mapping.server]=metadata[mapping.local]}}return JSON.stringify(resource)}function metadataValidator(p){var validType=p&&__WEBPACK_IMPORTED_MODULE_3__type__["i"](p);if(!validType){throw"Expected Metadata object."}for(var key in p){var val=p[key];if(key==="customMetadata"){if(!__WEBPACK_IMPORTED_MODULE_3__type__["i"](val)){throw"Expected object for 'customMetadata' mapping."}}else{if(__WEBPACK_IMPORTED_MODULE_3__type__["g"](val)){throw"Mapping for '"+key+"' cannot be an object."}}}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=makeNormalUrl;__webpack_exports__["a"]=makeDownloadUrl;__webpack_exports__["d"]=makeUploadUrl;__webpack_exports__["c"]=makeQueryString;var __WEBPACK_IMPORTED_MODULE_0__constants__=__webpack_require__(34);var __WEBPACK_IMPORTED_MODULE_1__object__=__webpack_require__(17);function makeNormalUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__["f"]+__WEBPACK_IMPORTED_MODULE_0__constants__["a"]+urlPart}function makeDownloadUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__["g"]+__WEBPACK_IMPORTED_MODULE_0__constants__["a"]+urlPart}function makeUploadUrl(urlPart){return __WEBPACK_IMPORTED_MODULE_0__constants__["f"]+__WEBPACK_IMPORTED_MODULE_0__constants__["b"]+urlPart}function makeQueryString(params){var encode=encodeURIComponent;var queryPart="?";__WEBPACK_IMPORTED_MODULE_1__object__["b"](params,function(key,val){var nextPart=encode(key)+"="+encode(val);queryPart=queryPart+nextPart+"&"});queryPart=queryPart.slice(0,-1);return queryPart}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["b"]=contains;__webpack_exports__["a"]=clone;__webpack_exports__["c"]=remove;function contains(array,elem){return array.indexOf(elem)!==-1}function clone(arraylike){return Array.prototype.slice.call(arraylike)}function remove(array,elem){var i=array.indexOf(elem);if(i!==-1){array.splice(i,1)}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.KlineTrade=void 0;var _chart_manager=__webpack_require__(3);function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var KlineTrade=function(){function KlineTrade(option){_classCallCheck(this,KlineTrade);this.browerState=0;this.tradeDate=new Date;this.tradesLimit=20;this.lastDepth=null;this.depthShowSize=15;this.priceDecimalDigits=6;this.amountDecimalDigits=4;this.symbol=null;this.curPrice=null;this.title="";Object.assign(this,option);if(!KlineTrade.created){KlineTrade.instance=this;KlineTrade.created=true}return KlineTrade.instance}_createClass(KlineTrade,[{key:"reset",value:function reset(symbol){this.symbol=symbol;this.lastDepth=null;this.curPrice=null;this.klineTradeInit=false;$("#trades .trades_list").empty();$("#gasks .table").empty();$("#gbids .table").empty();$("#asks .table").empty();$("#bids .table").empty()}},{key:"pushTrades",value:function pushTrades(array){var $trades=$("#trades .trades_list");var totalUls="";for(var i=0;i<array.length;i++){var item=array[i];if(i>=array.length-this.tradesLimit){this.tradeDate.setTime(item.time);var dateStr=this.dateFormatTf(this.tradeDate.getHours())+":"+this.dateFormatTf(this.tradeDate.getMinutes())+":"+this.dateFormatTf(this.tradeDate.getSeconds());var arr=(item.amount.toFixed(4)+"").split(".");var price=item.price;if(price>1){price=price.toFixed(2)}if(price<1&&price>1e-5){price=price.toFixed(4)}if(price<1e-5){price=price.toFixed(6)}if(this.klineTradeInit){totalUls="<ul class='newul'><li class='tm'>"+dateStr+"</li><li class='pr-"+(item.type==="buy"?"green":"red")+"'>"+price+"</li><li class='vl'>"+arr[0]+"<g>"+(arr.length>1?"."+arr[1]:"")+"</g></li></ul>"+totalUls}else{totalUls="<ul><li class='tm'>"+dateStr+"</li><li class='pr-"+(item.type==="buy"?"green":"red")+"'>"+price+"</li><li class='vl'>"+arr[0]+"<g>"+(arr.length>1?"."+arr[1]:"")+"</g></li></ul>"+totalUls}}}var j=0;var that=this;if(this.klineTradeInit){clearInterval(myTime);var myTime=setInterval(function(){var item=array[j];var price=Number(item.price);if(price>1){price=price.toFixed(2)}if(price<1&&price>1e-4){price=price.toFixed(4)}if(price<1e-4){price=price.toFixed(6)}that.curPrice=price;$("div#price").attr("class",item.type==="buy"?"green":"red").text(price);j++;if(j>=array.length){clearInterval(myTime)}},100)}else{if(array.length>0){var _price=Number(array[array.length-1].price);if(_price>1){_price=_price.toFixed(2)}if(_price<1&&_price>1e-4){_price=_price.toFixed(4)}if(_price<1e-4){_price=_price.toFixed(6)}that.curPrice=_price;$("div#price").attr("class",array[array.length-1].type==="buy"?"green":"red").text(_price)}}if(this.klineTradeInit){$trades.prepend(totalUls)}else{$trades.append(totalUls)}totalUls=null;$trades.find("ul.newul").slideDown(1e3,function(){$(this).removeClass("newul")});$trades.find("ul:gt("+(this.tradesLimit-1)+")").remove()}},{key:"updateDepth",value:function updateDepth(data){_chart_manager.ChartManager.instance.getChart().updateDepth(data);if(!data)return;$("#gasks .table").html(this.getgview(this.getgasks(data.asks)));$("#gbids .table").html(this.getgview(this.getgbids(data.bids)));if(this.lastDepth===null){this.lastDepth={};this.lastDepth.asks=this.getAsks(data.asks,this.depthShowSize);this.depthInit(this.lastDepth.asks,$("#asks .table"));this.lastDepth.bids=this.getBids(data.bids,this.depthShowSize);this.depthInit(this.lastDepth.bids,$("#bids .table"))}else{var parentAsks=$("#asks .table");parentAsks.find("div.remove").remove();parentAsks.find("div.add").removeClass("add");var newasks=this.getAsks(data.asks,this.depthShowSize);var oldasks=this.lastDepth.asks;this.lastDepth.asks=newasks;this.asksAndBids(newasks.slice(0),oldasks,parentAsks);var parentBids=$("#bids .table");parentBids.find("div.remove").remove();parentBids.find("div.add").removeClass("add");var newbids=this.getBids(data.bids,this.depthShowSize);var oldbids=this.lastDepth.bids;this.lastDepth.bids=newbids;this.asksAndBids(newbids.slice(0),oldbids,$("#bids .table"))}}},{key:"depthInit",value:function depthInit(data,$obj){$obj.empty();if(data&&data.length>0){var lastInt,view="";for(var i=0;i<data.length;i++){var arr=(data[i][0]+"").split(".");var prices=this.getPrice(arr,lastInt);lastInt=arr[0];arr=(data[i][1]+"").split(".");var amounts=this.getAmount(arr);view+="<div class='row'><span class='price'>"+prices[0]+"<g>"+prices[1]+"</g></span> <span class='amount'>"+amounts[0]+"<g>"+amounts[1]+"</g></span></div>"}$obj.append(view);view=null}}},{key:"asksAndBids",value:function asksAndBids(addasks,oldasks,tbDiv){for(var i=0;i<oldasks.length;i++){var isExist=false;for(var j=0;j<addasks.length;j++){if(oldasks[i][0]===addasks[j][0]){isExist=true;if(oldasks[i][1]!==addasks[j][1]){var $amount=tbDiv.find("div:eq("+i+") .amount");$amount.addClass(oldasks[i][1]>addasks[j][1]?"red":"green");var amounts=this.getAmount((addasks[j][1]+"").split("."));setTimeout(function($amount,amounts){return function(){$amount.html(amounts[0]+"<g>"+amounts[1]+"</g>");$amount.removeClass("red").removeClass("green");$amount=null;amounts=null}}($amount,amounts),500)}addasks.splice(j,1);break}}if(!isExist){tbDiv.find("div:eq("+i+")").addClass("remove");oldasks[i][2]=-1}}for(var _j=0;_j<oldasks.length;_j++){for(var _i=0;_i<addasks.length;_i++){if(addasks[_i][0]>oldasks[_j][0]){var arr=(addasks[_i][1]+"").split(".");var _amounts=this.getAmount(arr);tbDiv.find("div:eq("+_j+")").before("<div class='row add'><span class='price'></span> <span class='amount'>"+_amounts[0]+"<g>"+_amounts[1]+"</g></span></div>");oldasks.splice(_j,0,addasks[_i]);addasks.splice(_i,1);break}}}var totalDiv="";for(var _i2=0;_i2<addasks.length;_i2++){oldasks.push(addasks[_i2]);var _arr=(addasks[_i2][1]+"").split(".");var _amounts2=this.getAmount(_arr);totalDiv+="<div class='row add'><span class='price'></span> <span class='amount'>"+_amounts2[0]+"<g>"+_amounts2[1]+"</g></span></div>"}if(totalDiv.length>0){tbDiv.append(totalDiv)}totalDiv=null;var lastInt;for(var _i3=0;_i3<oldasks.length;_i3++){var $div=tbDiv.find("div:eq("+_i3+")");if(!(oldasks[_i3].length>=3&&oldasks[_i3][2]===-1)){var _arr2=(oldasks[_i3][0]+"").split(".");var prices=this.getPrice(_arr2,lastInt);lastInt=_arr2[0];$div.find(".price").html(prices[0]+"<g>"+prices[1]+"</g>")}}addasks=null;oldasks=null;tbDiv.find("div.add").slideDown(800);setTimeout(function($remove,$add){return function(){$remove.slideUp(500,function(){$(this).remove()});$add.removeClass("add")}}(tbDiv.find("div.remove"),tbDiv.find("div.add")),1e3)}},{key:"getAsks",value:function getAsks(array,len){if(array.length>len){array.splice(0,array.length-len)}return array}},{key:"getBids",value:function getBids(array,len){if(array.length>len){array.splice(len,array.length-1)}return array}},{key:"getgview",value:function getgview(g){var gstr="";var lastInt;for(var i=0;i<g.length;i++){var arr=g[i][0].split(".");if(arr.length===1||arr[0]!==lastInt){gstr+="<div class='row'><span class='price'>"+g[i][0]+"</span> <span class='amount'>"+g[i][1]+"</span></div>";lastInt=arr[0]}else{gstr+="<div class='row'><span class='price'><h>"+arr[0]+".</h>"+arr[1]+"</span> <span class='amount'>"+g[i][1]+"</span></div>"}}return gstr}},{key:"getgasks",value:function getgasks(array){if(array.length<2){return[]}var low=array[array.length-1][0];var high=array[0][0];var r=high-low;var block=this.getBlock(r,100);var n=Math.abs(Number(Math.log(block)/Math.log(10))).toFixed(0);if(r/block<2){block=block/2;n++}if(block>=1)n=0;low=parseInt(low/block)*block;high=parseInt(high/block)*block;var gasks=[];var amount=0;for(var i=array.length-1;i>=0;i--){if(array[i][0]>low){var amountInt=parseInt(amount,10);if(amountInt>0){gasks.unshift([Number(low).toFixed(n),amountInt])}if(low>=high){break}low+=block}amount+=array[i][1]}return gasks}},{key:"getgbids",value:function getgbids(array){if(array.length<2){return[]}var low=array[array.length-1][0];var high=array[0][0];var r=high-low;var block=this.getBlock(r,100);var n=Math.abs(Number(Math.log(block)/Math.log(10))).toFixed(0);if(r/block<2){block=block/2;n++}if(block>=1)n=0;low=parseInt(low/block)*block;high=parseInt(high/block)*block;var gbids=[];var amount=0;for(var i=0;i<array.length;i++){if(array[i][0]<high){var amountInt=parseInt(amount,10);if(amountInt>0){gbids.push([Number(high).toFixed(n),amountInt])}if(high<=low){break}high-=block}amount+=array[i][1]}return gbids}},{key:"getBlock",value:function getBlock(b,scale){if(b>scale||b<=0){return scale}else{scale=scale/10;return this.getBlock(b,scale)}}},{key:"getZeros",value:function getZeros(i){var zeros="";while(i>0){i--;zeros+="0"}return zeros}},{key:"getPrice",value:function getPrice(arr,lastInt){var price1=arr[0];if(lastInt===price1){price1="<h>"+price1+".</h>"}else{price1+="."}var price2="";if(arr.length===1){price1+="0";price2=this.getZeros(this.priceDecimalDigits-1)}else{price1+=arr[1];price2=this.getZeros(this.priceDecimalDigits-arr[1].length)}return[price1,price2]}},{key:"getAmount",value:function getAmount(arr){var amount1=arr[0];var amount2="";var zerosLen=this.amountDecimalDigits-amount1.length+1;if(zerosLen>0){amount2=".";if(arr.length===1){amount2+=this.getZeros(zerosLen)}else if(zerosLen>arr[1].length){amount2+=arr[1]+this.getZeros(zerosLen-arr[1].length)}else if(zerosLen===arr[1].length){amount2+=arr[1]}else{amount2+=arr[1].substring(0,zerosLen)}}return[amount1,amount2]}},{key:"dateFormatTf",value:function dateFormatTf(i){return(i<10?"0":"")+i}}]);return KlineTrade}();exports.KlineTrade=KlineTrade;KlineTrade.created=false;KlineTrade.instance=null},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CName=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var CName=function(){function CName(name){_classCallCheck(this,CName);this._names=[];this._comps=[];if(name instanceof CName){this._names=name._names;this._comps=name._comps}else{var comps=name.split(".");var dotNum=comps.length-1;if(dotNum>0){this._comps=comps;this._names.push(comps[0]);for(var i=1;i<=dotNum;i++){this._names.push(this._names[i-1]+"."+comps[i])}}else{this._comps.push(name);this._names.push(name)}}}_createClass(CName,[{key:"getCompAt",value:function getCompAt(index){if(index>=0&&index<this._comps.length)return this._comps[index];return""}},{key:"getName",value:function getName(index){if(index<0){if(this._names.length>0)return this._names[this._names.length-1]}else if(index<this._names.length){return this._names[index]}return""}}]);return CName}();exports.CName=CName},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SarExpr=exports.SmaExpr=exports.ExpmemaExpr=exports.EmaExpr=exports.MaExpr=exports.StdExpr=exports.SumExpr=exports.CountExpr=exports.LlvExpr=exports.HhvExpr=exports.RangeExpr=exports.RangeOutputExpr=exports.OutputExpr=exports.AssignExpr=exports.IfExpr=exports.OrExpr=exports.AndExpr=exports.RefExpr=exports.AbsExpr=exports.MaxExpr=exports.EqExpr=exports.LeExpr=exports.LtExpr=exports.GeExpr=exports.GtExpr=exports.DivExpr=exports.MulExpr=exports.SubExpr=exports.AddExpr=exports.NegExpr=exports.OpABCDExpr=exports.OpABCExpr=exports.OpABExpr=exports.OpAExpr=exports.ParameterExpr=exports.ConstExpr=exports.VolumeExpr=exports.CloseExpr=exports.LowExpr=exports.HighExpr=exports.OpenExpr=exports.Expr=exports.ExprEnv=void 0;function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return _get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var ExprEnv=function(){function ExprEnv(){_classCallCheck(this,ExprEnv);this._ds=null;this._firstIndex=null}_createClass(ExprEnv,[{key:"getDataSource",value:function getDataSource(){return this._ds}},{
key:"setDataSource",value:function setDataSource(ds){return this._ds=ds}},{key:"getFirstIndex",value:function getFirstIndex(){return this._firstIndex}},{key:"setFirstIndex",value:function setFirstIndex(n){return this._firstIndex=n}}],[{key:"get",value:function get(){return this.inst}},{key:"set",value:function set(env){this.inst=env}}]);return ExprEnv}();exports.ExprEnv=ExprEnv;ExprEnv.inst=null;var Expr=function(){function Expr(){_classCallCheck(this,Expr);this._rid=0}_createClass(Expr,[{key:"execute",value:function execute(index){}},{key:"reserve",value:function reserve(rid,count){}},{key:"clear",value:function clear(){}}]);return Expr}();exports.Expr=Expr;var OpenExpr=function(_Expr){_inherits(OpenExpr,_Expr);function OpenExpr(){_classCallCheck(this,OpenExpr);return _possibleConstructorReturn(this,(OpenExpr.__proto__||Object.getPrototypeOf(OpenExpr)).apply(this,arguments))}_createClass(OpenExpr,[{key:"execute",value:function execute(index){return ExprEnv.get()._ds.getDataAt(index).open}}]);return OpenExpr}(Expr);exports.OpenExpr=OpenExpr;var HighExpr=function(_Expr2){_inherits(HighExpr,_Expr2);function HighExpr(){_classCallCheck(this,HighExpr);return _possibleConstructorReturn(this,(HighExpr.__proto__||Object.getPrototypeOf(HighExpr)).apply(this,arguments))}_createClass(HighExpr,[{key:"execute",value:function execute(index){return ExprEnv.get()._ds.getDataAt(index).high}}]);return HighExpr}(Expr);exports.HighExpr=HighExpr;var LowExpr=function(_Expr3){_inherits(LowExpr,_Expr3);function LowExpr(){_classCallCheck(this,LowExpr);return _possibleConstructorReturn(this,(LowExpr.__proto__||Object.getPrototypeOf(LowExpr)).apply(this,arguments))}_createClass(LowExpr,[{key:"execute",value:function execute(index){return ExprEnv.get()._ds.getDataAt(index).low}}]);return LowExpr}(Expr);exports.LowExpr=LowExpr;var CloseExpr=function(_Expr4){_inherits(CloseExpr,_Expr4);function CloseExpr(){_classCallCheck(this,CloseExpr);return _possibleConstructorReturn(this,(CloseExpr.__proto__||Object.getPrototypeOf(CloseExpr)).apply(this,arguments))}_createClass(CloseExpr,[{key:"execute",value:function execute(index){return ExprEnv.get()._ds.getDataAt(index).close}}]);return CloseExpr}(Expr);exports.CloseExpr=CloseExpr;var VolumeExpr=function(_Expr5){_inherits(VolumeExpr,_Expr5);function VolumeExpr(){_classCallCheck(this,VolumeExpr);return _possibleConstructorReturn(this,(VolumeExpr.__proto__||Object.getPrototypeOf(VolumeExpr)).apply(this,arguments))}_createClass(VolumeExpr,[{key:"execute",value:function execute(index){return ExprEnv.get()._ds.getDataAt(index).volume}}]);return VolumeExpr}(Expr);exports.VolumeExpr=VolumeExpr;var ConstExpr=function(_Expr6){_inherits(ConstExpr,_Expr6);function ConstExpr(v){var _this;_classCallCheck(this,ConstExpr);_this=_possibleConstructorReturn(this,(ConstExpr.__proto__||Object.getPrototypeOf(ConstExpr)).call(this));_this._value=v;return _this}_createClass(ConstExpr,[{key:"execute",value:function execute(index){return this._value}}]);return ConstExpr}(Expr);exports.ConstExpr=ConstExpr;var ParameterExpr=function(_Expr7){_inherits(ParameterExpr,_Expr7);function ParameterExpr(name,minValue,maxValue,defaultValue){var _this2;_classCallCheck(this,ParameterExpr);_this2=_possibleConstructorReturn(this,(ParameterExpr.__proto__||Object.getPrototypeOf(ParameterExpr)).call(this));_this2._name=name;_this2._minValue=minValue;_this2._maxValue=maxValue;_this2._value=_this2._defaultValue=defaultValue;return _this2}_createClass(ParameterExpr,[{key:"execute",value:function execute(index){return this._value}},{key:"getMinValue",value:function getMinValue(){return this._minValue}},{key:"getMaxValue",value:function getMaxValue(){return this._maxValue}},{key:"getDefaultValue",value:function getDefaultValue(){return this._defaultValue}},{key:"getValue",value:function getValue(){return this._value}},{key:"setValue",value:function setValue(v){if(v===0)this._value=0;else if(v<this._minValue)this._value=this._minValue;else if(v>this._maxValue)this._value=this._maxValue;else this._value=v}}]);return ParameterExpr}(Expr);exports.ParameterExpr=ParameterExpr;var OpAExpr=function(_Expr8){_inherits(OpAExpr,_Expr8);function OpAExpr(a){var _this3;_classCallCheck(this,OpAExpr);_this3=_possibleConstructorReturn(this,(OpAExpr.__proto__||Object.getPrototypeOf(OpAExpr)).call(this));_this3._exprA=a;return _this3}_createClass(OpAExpr,[{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){this._rid=rid;this._exprA.reserve(rid,count)}}},{key:"clear",value:function clear(){this._exprA.clear()}}]);return OpAExpr}(Expr);exports.OpAExpr=OpAExpr;var OpABExpr=function(_Expr9){_inherits(OpABExpr,_Expr9);function OpABExpr(a,b){var _this4;_classCallCheck(this,OpABExpr);_this4=_possibleConstructorReturn(this,(OpABExpr.__proto__||Object.getPrototypeOf(OpABExpr)).call(this));_this4._exprA=a;_this4._exprB=b;return _this4}_createClass(OpABExpr,[{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){this._rid=rid;this._exprA.reserve(rid,count);this._exprB.reserve(rid,count)}}},{key:"clear",value:function clear(){this._exprA.clear();this._exprB.clear()}}]);return OpABExpr}(Expr);exports.OpABExpr=OpABExpr;var OpABCExpr=function(_Expr10){_inherits(OpABCExpr,_Expr10);function OpABCExpr(a,b,c){var _this5;_classCallCheck(this,OpABCExpr);_this5=_possibleConstructorReturn(this,(OpABCExpr.__proto__||Object.getPrototypeOf(OpABCExpr)).call(this));_this5._exprA=a;_this5._exprB=b;_this5._exprC=c;return _this5}_createClass(OpABCExpr,[{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){this._rid=rid;this._exprA.reserve(rid,count);this._exprB.reserve(rid,count);this._exprC.reserve(rid,count)}}},{key:"clear",value:function clear(){this._exprA.clear();this._exprB.clear();this._exprC.clear()}}]);return OpABCExpr}(Expr);exports.OpABCExpr=OpABCExpr;var OpABCDExpr=function(_Expr11){_inherits(OpABCDExpr,_Expr11);function OpABCDExpr(a,b,c,d){var _this6;_classCallCheck(this,OpABCDExpr);_this6=_possibleConstructorReturn(this,(OpABCDExpr.__proto__||Object.getPrototypeOf(OpABCDExpr)).call(this));_this6._exprA=a;_this6._exprB=b;_this6._exprC=c;_this6._exprD=d;return _this6}_createClass(OpABCDExpr,[{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){this._rid=rid;this._exprA.reserve(rid,count);this._exprB.reserve(rid,count);this._exprC.reserve(rid,count);this._exprD.reserve(rid,count)}}},{key:"clear",value:function clear(){this._exprA.clear();this._exprB.clear();this._exprC.clear();this._exprD.clear()}}]);return OpABCDExpr}(Expr);exports.OpABCDExpr=OpABCDExpr;var NegExpr=function(_OpAExpr){_inherits(NegExpr,_OpAExpr);function NegExpr(a){_classCallCheck(this,NegExpr);return _possibleConstructorReturn(this,(NegExpr.__proto__||Object.getPrototypeOf(NegExpr)).call(this,a))}_createClass(NegExpr,[{key:"execute",value:function execute(index){return-this._exprA.execute(index)}}]);return NegExpr}(OpAExpr);exports.NegExpr=NegExpr;var AddExpr=function(_OpABExpr){_inherits(AddExpr,_OpABExpr);function AddExpr(a,b){_classCallCheck(this,AddExpr);return _possibleConstructorReturn(this,(AddExpr.__proto__||Object.getPrototypeOf(AddExpr)).call(this,a,b))}_createClass(AddExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)+this._exprB.execute(index)}}]);return AddExpr}(OpABExpr);exports.AddExpr=AddExpr;var SubExpr=function(_OpABExpr2){_inherits(SubExpr,_OpABExpr2);function SubExpr(a,b){_classCallCheck(this,SubExpr);return _possibleConstructorReturn(this,(SubExpr.__proto__||Object.getPrototypeOf(SubExpr)).call(this,a,b))}_createClass(SubExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)-this._exprB.execute(index)}}]);return SubExpr}(OpABExpr);exports.SubExpr=SubExpr;var MulExpr=function(_OpABExpr3){_inherits(MulExpr,_OpABExpr3);function MulExpr(a,b){_classCallCheck(this,MulExpr);return _possibleConstructorReturn(this,(MulExpr.__proto__||Object.getPrototypeOf(MulExpr)).call(this,a,b))}_createClass(MulExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)*this._exprB.execute(index)}}]);return MulExpr}(OpABExpr);exports.MulExpr=MulExpr;var DivExpr=function(_OpABExpr4){_inherits(DivExpr,_OpABExpr4);function DivExpr(a,b){_classCallCheck(this,DivExpr);return _possibleConstructorReturn(this,(DivExpr.__proto__||Object.getPrototypeOf(DivExpr)).call(this,a,b))}_createClass(DivExpr,[{key:"execute",value:function execute(index){var a=this._exprA.execute(index);var b=this._exprB.execute(index);if(a===0)return a;if(b===0)return a>0?1e6:-1e6;return a/b}}]);return DivExpr}(OpABExpr);exports.DivExpr=DivExpr;var GtExpr=function(_OpABExpr5){_inherits(GtExpr,_OpABExpr5);function GtExpr(a,b){_classCallCheck(this,GtExpr);return _possibleConstructorReturn(this,(GtExpr.__proto__||Object.getPrototypeOf(GtExpr)).call(this,a,b))}_createClass(GtExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)>this._exprB.execute(index)?1:0}}]);return GtExpr}(OpABExpr);exports.GtExpr=GtExpr;var GeExpr=function(_OpABExpr6){_inherits(GeExpr,_OpABExpr6);function GeExpr(a,b){_classCallCheck(this,GeExpr);return _possibleConstructorReturn(this,(GeExpr.__proto__||Object.getPrototypeOf(GeExpr)).call(this,a,b))}_createClass(GeExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)>=this._exprB.execute(index)?1:0}}]);return GeExpr}(OpABExpr);exports.GeExpr=GeExpr;var LtExpr=function(_OpABExpr7){_inherits(LtExpr,_OpABExpr7);function LtExpr(a,b){_classCallCheck(this,LtExpr);return _possibleConstructorReturn(this,(LtExpr.__proto__||Object.getPrototypeOf(LtExpr)).call(this,a,b))}_createClass(LtExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)<this._exprB.execute(index)?1:0}}]);return LtExpr}(OpABExpr);exports.LtExpr=LtExpr;var LeExpr=function(_OpABExpr8){_inherits(LeExpr,_OpABExpr8);function LeExpr(a,b){_classCallCheck(this,LeExpr);return _possibleConstructorReturn(this,(LeExpr.__proto__||Object.getPrototypeOf(LeExpr)).call(this,a,b))}_createClass(LeExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)<=this._exprB.execute(index)?1:0}}]);return LeExpr}(OpABExpr);exports.LeExpr=LeExpr;var EqExpr=function(_OpABExpr9){_inherits(EqExpr,_OpABExpr9);function EqExpr(a,b){_classCallCheck(this,EqExpr);return _possibleConstructorReturn(this,(EqExpr.__proto__||Object.getPrototypeOf(EqExpr)).call(this,a,b))}_createClass(EqExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)===this._exprB.execute(index)?1:0}}]);return EqExpr}(OpABExpr);exports.EqExpr=EqExpr;var MaxExpr=function(_OpABExpr10){_inherits(MaxExpr,_OpABExpr10);function MaxExpr(a,b){_classCallCheck(this,MaxExpr);return _possibleConstructorReturn(this,(MaxExpr.__proto__||Object.getPrototypeOf(MaxExpr)).call(this,a,b))}_createClass(MaxExpr,[{key:"execute",value:function execute(index){return Math.max(this._exprA.execute(index),this._exprB.execute(index))}}]);return MaxExpr}(OpABExpr);exports.MaxExpr=MaxExpr;var AbsExpr=function(_OpAExpr2){_inherits(AbsExpr,_OpAExpr2);function AbsExpr(a){_classCallCheck(this,AbsExpr);return _possibleConstructorReturn(this,(AbsExpr.__proto__||Object.getPrototypeOf(AbsExpr)).call(this,a))}_createClass(AbsExpr,[{key:"execute",value:function execute(index){return Math.abs(this._exprA.execute(index))}}]);return AbsExpr}(OpAExpr);exports.AbsExpr=AbsExpr;var RefExpr=function(_OpABExpr11){_inherits(RefExpr,_OpABExpr11);function RefExpr(a,b){_classCallCheck(this,RefExpr);return _possibleConstructorReturn(this,(RefExpr.__proto__||Object.getPrototypeOf(RefExpr)).call(this,a,b))}_createClass(RefExpr,[{key:"execute",value:function execute(index){if(this._offset===undefined||this._offset<0){this._offset=this._exprB.execute(index);if(this._offset<0){throw"offset < 0"}}index-=this._offset;if(index<0){throw"index < 0"}var result=this._exprA.execute(index);if(isNaN(result)){throw"NaN"}return result}}]);return RefExpr}(OpABExpr);exports.RefExpr=RefExpr;var AndExpr=function(_OpABExpr12){_inherits(AndExpr,_OpABExpr12);function AndExpr(a,b){_classCallCheck(this,AndExpr);return _possibleConstructorReturn(this,(AndExpr.__proto__||Object.getPrototypeOf(AndExpr)).call(this,a,b))}_createClass(AndExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)!==0&&this._exprB.execute(index)!==0?1:0}}]);return AndExpr}(OpABExpr);exports.AndExpr=AndExpr;var OrExpr=function(_OpABExpr13){_inherits(OrExpr,_OpABExpr13);function OrExpr(a,b){_classCallCheck(this,OrExpr);return _possibleConstructorReturn(this,(OrExpr.__proto__||Object.getPrototypeOf(OrExpr)).call(this,a,b))}_createClass(OrExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)!==0||this._exprB.execute(index)!==0?1:0}}]);return OrExpr}(OpABExpr);exports.OrExpr=OrExpr;var IfExpr=function(_OpABCExpr){_inherits(IfExpr,_OpABCExpr);function IfExpr(a,b,c){_classCallCheck(this,IfExpr);return _possibleConstructorReturn(this,(IfExpr.__proto__||Object.getPrototypeOf(IfExpr)).call(this,a,b,c))}_createClass(IfExpr,[{key:"execute",value:function execute(index){return this._exprA.execute(index)!==0?this._exprB.execute(index):this._exprC.execute(index)}}]);return IfExpr}(OpABCExpr);exports.IfExpr=IfExpr;var AssignExpr=function(_OpAExpr3){_inherits(AssignExpr,_OpAExpr3);function AssignExpr(name,a){var _this7;_classCallCheck(this,AssignExpr);_this7=_possibleConstructorReturn(this,(AssignExpr.__proto__||Object.getPrototypeOf(AssignExpr)).call(this,a));_this7._name=name;_this7._buf=[];return _this7}_createClass(AssignExpr,[{key:"getName",value:function getName(){return this._name}},{key:"execute",value:function execute(index){return this._buf[index]}},{key:"assign",value:function assign(index){this._buf[index]=this._exprA.execute(index);if(ExprEnv.get()._firstIndex>=0){if(isNaN(this._buf[index])&&!isNaN(this._buf[index-1])){throw this._name+".assign("+index+"): NaN"}}}},{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){for(var c=count;c>0;c--){this._buf.push(NaN)}}_get(AssignExpr.prototype.__proto__||Object.getPrototypeOf(AssignExpr.prototype),"reserve",this).call(this,rid,count)}},{key:"clear",value:function clear(){_get(AssignExpr.prototype.__proto__||Object.getPrototypeOf(AssignExpr.prototype),"clear",this).call(this);this._buf=[]}}]);return AssignExpr}(OpAExpr);exports.AssignExpr=AssignExpr;var OutputExpr=function(_AssignExpr){_inherits(OutputExpr,_AssignExpr);function OutputExpr(name,a,style,color){var _this8;_classCallCheck(this,OutputExpr);_this8=_possibleConstructorReturn(this,(OutputExpr.__proto__||Object.getPrototypeOf(OutputExpr)).call(this,name,a));_this8._style=style===undefined?OutputExpr.outputStyle.Line:style;_this8._color=color;return _this8}_createClass(OutputExpr,[{key:"getStyle",value:function getStyle(){return this._style}},{key:"getColor",value:function getColor(){return this._color}}]);return OutputExpr}(AssignExpr);exports.OutputExpr=OutputExpr;OutputExpr.outputStyle={None:0,Line:1,VolumeStick:2,MACDStick:3,SARPoint:4};var RangeOutputExpr=function(_OutputExpr){_inherits(RangeOutputExpr,_OutputExpr);function RangeOutputExpr(name,a,style,color){_classCallCheck(this,RangeOutputExpr);return _possibleConstructorReturn(this,(RangeOutputExpr.__proto__||Object.getPrototypeOf(RangeOutputExpr)).call(this,name,a,style,color))}_createClass(RangeOutputExpr,[{key:"getName",value:function getName(){return this._name+this._exprA.getRange()}}]);return RangeOutputExpr}(OutputExpr);exports.RangeOutputExpr=RangeOutputExpr;var RangeExpr=function(_OpABExpr14){_inherits(RangeExpr,_OpABExpr14);function RangeExpr(a,b){var _this9;_classCallCheck(this,RangeExpr);_this9=_possibleConstructorReturn(this,(RangeExpr.__proto__||Object.getPrototypeOf(RangeExpr)).call(this,a,b));_this9._range=-1;_this9._buf=[];return _this9}_createClass(RangeExpr,[{key:"getRange",value:function getRange(){return this._range}},{key:"initRange",value:function initRange(){this._range=this._exprB.execute(0)}},{key:"execute",value:function execute(index){if(this._range<0){this.initRange()}var rA=this._buf[index].resultA=this._exprA.execute(index);return this._buf[index].result=this.calcResult(index,rA)}},{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){for(var c=count;c>0;c--){this._buf.push({resultA:NaN,result:NaN})}}_get(RangeExpr.prototype.__proto__||Object.getPrototypeOf(RangeExpr.prototype),"reserve",this).call(this,rid,count)}},{key:"clear",value:function clear(){_get(RangeExpr.prototype.__proto__||Object.getPrototypeOf(RangeExpr.prototype),"clear",this).call(this);this._range=-1;this._buf=[]}}]);return RangeExpr}(OpABExpr);exports.RangeExpr=RangeExpr;var HhvExpr=function(_RangeExpr){_inherits(HhvExpr,_RangeExpr);function HhvExpr(a,b){_classCallCheck(this,HhvExpr);return _possibleConstructorReturn(this,(HhvExpr.__proto__||Object.getPrototypeOf(HhvExpr)).call(this,a,b))}_createClass(HhvExpr,[{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0){return NaN}var first=ExprEnv.get()._firstIndex;if(first<0){return resultA}if(index>first){var n=this._range;var result=resultA;var start=index-n+1;var i=Math.max(first,start);for(;i<index;i++){var p=this._buf[i];if(result<p.resultA){result=p.resultA}}return result}else{return resultA}}}]);return HhvExpr}(RangeExpr);exports.HhvExpr=HhvExpr;var LlvExpr=function(_RangeExpr2){_inherits(LlvExpr,_RangeExpr2);function LlvExpr(a,b){_classCallCheck(this,LlvExpr);return _possibleConstructorReturn(this,(LlvExpr.__proto__||Object.getPrototypeOf(LlvExpr)).call(this,a,b))}_createClass(LlvExpr,[{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var n=this._range;var result=resultA;var start=index-n+1;var i=Math.max(first,start);for(;i<index;i++){var p=this._buf[i];if(result>p.resultA)result=p.resultA}return result}else{return resultA}}}]);return LlvExpr}(RangeExpr);exports.LlvExpr=LlvExpr;var CountExpr=function(_RangeExpr3){_inherits(CountExpr,_RangeExpr3);function CountExpr(a,b){_classCallCheck(this,CountExpr);return _possibleConstructorReturn(this,(CountExpr.__proto__||Object.getPrototypeOf(CountExpr)).call(this,a,b))}_createClass(CountExpr,[{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var first=ExprEnv.get()._firstIndex;if(first<0)return 0;if(index>=first){var n=this._range-1;if(n>index-first)n=index-first;var count=0;for(;n>=0;n--){if(this._buf[index-n].resultA!==0)count++}return count}else{return 0}}}]);return CountExpr}(RangeExpr);exports.CountExpr=CountExpr;var SumExpr=function(_RangeExpr4){_inherits(SumExpr,_RangeExpr4);function SumExpr(a,b){_classCallCheck(this,SumExpr);return _possibleConstructorReturn(this,(SumExpr.__proto__||Object.getPrototypeOf(SumExpr)).call(this,a,b))}_createClass(SumExpr,[{key:"calcResult",value:function calcResult(index,resultA){var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var n=this._range;if(n===0||n>=index+1-first){return this._buf[index-1].result+resultA}return this._buf[index-1].result+resultA-this._buf[index-n].resultA}else{return resultA}}}]);return SumExpr}(RangeExpr);exports.SumExpr=SumExpr;var StdExpr=function(_RangeExpr5){_inherits(StdExpr,_RangeExpr5);function StdExpr(a,b){_classCallCheck(this,StdExpr);return _possibleConstructorReturn(this,(StdExpr.__proto__||Object.getPrototypeOf(StdExpr)).call(this,a,b))}_createClass(StdExpr,[{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var stdData=this._stdBuf[index];var first=ExprEnv.get()._firstIndex;if(first<0){stdData.resultMA=resultA;return 0}if(index>first){var n=this._range;if(n>=index+1-first){n=index+1-first;stdData.resultMA=this._stdBuf[index-1].resultMA*(1-1/n)+resultA/n}else{stdData.resultMA=this._stdBuf[index-1].resultMA+(resultA-this._buf[index-n].resultA)/n}var sum=0;for(var i=index-n+1;i<=index;i++){sum+=Math.pow(this._buf[i].resultA-stdData.resultMA,2)}return Math.sqrt(sum/n)}stdData.resultMA=resultA;return 0}},{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){for(var c=count;c>0;c--){this._stdBuf.push({resultMA:NaN})}}_get(StdExpr.prototype.__proto__||Object.getPrototypeOf(StdExpr.prototype),"reserve",this).call(this,rid,count)}},{key:"clear",value:function clear(){_get(StdExpr.prototype.__proto__||Object.getPrototypeOf(StdExpr.prototype),"clear",this).call(this);this._stdBuf=[]}}]);return StdExpr}(RangeExpr);exports.StdExpr=StdExpr;var MaExpr=function(_RangeExpr6){_inherits(MaExpr,_RangeExpr6);function MaExpr(a,b){_classCallCheck(this,MaExpr);return _possibleConstructorReturn(this,(MaExpr.__proto__||Object.getPrototypeOf(MaExpr)).call(this,a,b))}_createClass(MaExpr,[{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var n=this._range;if(n>=index+1-first){n=index+1-first;return this._buf[index-1].result*(1-1/n)+resultA/n}return this._buf[index-1].result+(resultA-this._buf[index-n].resultA)/n}else{return resultA}}}]);return MaExpr}(RangeExpr);exports.MaExpr=MaExpr;var EmaExpr=function(_RangeExpr7){_inherits(EmaExpr,_RangeExpr7);function EmaExpr(a,b){_classCallCheck(this,EmaExpr);return _possibleConstructorReturn(this,(EmaExpr.__proto__||Object.getPrototypeOf(EmaExpr)).call(this,a,b))}_createClass(EmaExpr,[{key:"initRange",value:function initRange(){_get(EmaExpr.prototype.__proto__||Object.getPrototypeOf(EmaExpr.prototype),"initRange",this).call(this);this._alpha=2/(this._range+1)}},{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var prev=this._buf[index-1];return this._alpha*(resultA-prev.result)+prev.result}return resultA}}]);return EmaExpr}(RangeExpr);exports.EmaExpr=EmaExpr;var ExpmemaExpr=function(_EmaExpr){_inherits(ExpmemaExpr,_EmaExpr);function ExpmemaExpr(a,b){_classCallCheck(this,ExpmemaExpr);return _possibleConstructorReturn(this,(ExpmemaExpr.__proto__||Object.getPrototypeOf(ExpmemaExpr)).call(this,a,b))}_createClass(ExpmemaExpr,[{key:"calcResult",value:function calcResult(index,resultA){var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var n=this._range;var prev=this._buf[index-1];if(n>=index+1-first){n=index+1-first;return prev.result*(1-1/n)+resultA/n}return this._alpha*(resultA-prev.result)+prev.result}return resultA}}]);return ExpmemaExpr}(EmaExpr);exports.ExpmemaExpr=ExpmemaExpr;var SmaExpr=function(_RangeExpr8){_inherits(SmaExpr,_RangeExpr8);function SmaExpr(a,b,c){var _this10;_classCallCheck(this,SmaExpr);_this10=_possibleConstructorReturn(this,(SmaExpr.__proto__||Object.getPrototypeOf(SmaExpr)).call(this,a,b));_this10._exprC=c;_this10._mul=null;return _this10}_createClass(SmaExpr,[{key:"initRange",value:function initRange(){_get(SmaExpr.prototype.__proto__||Object.getPrototypeOf(SmaExpr.prototype),"initRange",this).call(this);this._mul=this._exprC.execute(0)}},{key:"calcResult",value:function calcResult(index,resultA){if(this._range===0)return NaN;var first=ExprEnv.get()._firstIndex;if(first<0)return resultA;if(index>first){var n=this._range;if(n>index+1-first)n=index+1-first;return((n-1)*this._buf[index-1].result+resultA*this._mul)/n}return resultA}}]);return SmaExpr}(RangeExpr);exports.SmaExpr=SmaExpr;var SarExpr=function(_OpABCDExpr){_inherits(SarExpr,_OpABCDExpr);function SarExpr(a,b,c,d){var _this11;_classCallCheck(this,SarExpr);_this11=_possibleConstructorReturn(this,(SarExpr.__proto__||Object.getPrototypeOf(SarExpr)).call(this,a,b,c,d));_this11._buf=[];_this11._range=-1;_this11._min=null;_this11._step=null;_this11._max=null;return _this11}_createClass(SarExpr,[{key:"execute",value:function execute(index){if(this._range<0){this._range=this._exprA.execute(0);this._min=this._exprB.execute(0)/100;this._step=this._exprC.execute(0)/100;this._max=this._exprD.execute(0)/100}var data=this._buf[index];var exprEnv=ExprEnv.get();var first=exprEnv._firstIndex;if(first<0){data.longPos=true;data.sar=exprEnv._ds.getDataAt(index).low;data.ep=exprEnv._ds.getDataAt(index).high;data.af=.02}else{var high=exprEnv._ds.getDataAt(index).high;var low=exprEnv._ds.getDataAt(index).low;var prev=this._buf[index-1];data.sar=prev.sar+prev.af*(prev.ep-prev.sar);if(prev.longPos){data.longPos=true;if(high>prev.ep){data.ep=high;data.af=Math.min(prev.af+this._step,this._max)}else{data.ep=prev.ep;data.af=prev.af}if(data.sar>low){data.longPos=false;var i=index-this._range+1;for(i=Math.max(i,first);i<index;i++){var h=exprEnv._ds.getDataAt(i).high;if(high<h)high=h}data.sar=high;data.ep=low;data.af=.02}}else{data.longPos=false;if(low<prev.ep){data.ep=low;data.af=Math.min(prev.af+this._step,this._max)}else{data.ep=prev.ep;data.af=prev.af}if(data.sar<high){data.longPos=true;var _i=index-this._range+1;for(_i=Math.max(_i,first);_i<index;_i++){var l=exprEnv._ds.getDataAt(_i).low;if(low>l)low=l}data.sar=low;data.ep=high;data.af=.02}}}return data.sar}},{key:"reserve",value:function reserve(rid,count){if(this._rid<rid){for(var c=count;c>0;c--){this._buf.push({longPos:true,sar:NaN,ep:NaN,af:NaN})}}_get(SarExpr.prototype.__proto__||Object.getPrototypeOf(SarExpr.prototype),"reserve",this).call(this,rid,count)}},{key:"clear",value:function clear(){_get(SarExpr.prototype.__proto__||Object.getPrototypeOf(SarExpr.prototype),"clear",this).call(this);this._range=-1}}]);return SarExpr}(OpABCDExpr);exports.SarExpr=SarExpr},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MEvent=void 0;function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var MEvent=function(){function MEvent(){_classCallCheck(this,MEvent);this._handlers=[]}_createClass(MEvent,[{key:"addHandler",value:function addHandler(o,f){if(this.indexOf(o,f)<0)this._handlers.push({obj:o,func:f})}},{key:"removeHandler",value:function removeHandler(o,f){var i=this.indexOf(o,f);if(i>=0)this._handlers.splice(i,1)}},{key:"raise",value:function raise(s,g){var a=this._handlers;var e,i,c=a.length;for(i=0;i<c;i++){e=a[i];e.func(s,g)}}},{key:"indexOf",value:function indexOf(o,f){var a=this._handlers;var e,i,c=a.length;for(i=0;i<c;i++){e=a[i];if(o===e.obj&&f===e.func)return i}return-1}}]);return MEvent}();exports.MEvent=MEvent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PercentageRange=exports.ZeroCenteredRange=exports.MainRange=exports.ZeroBasedPositiveRange=exports.PositiveRange=exports.Range=void 0;var _named_object=__webpack_require__(8);var _chart_manager=__webpack_require__(3);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Range=function(_NamedObject){_inherits(Range,_NamedObject);function Range(name){var _this;_classCallCheck(this,Range);_this=_possibleConstructorReturn(this,(Range.__proto__||Object.getPrototypeOf(Range)).call(this,name));_this._updated=true;_this._minValue=Number.MAX_VALUE;_this._maxValue=-Number.MAX_VALUE;_this._outerMinValue=Number.MAX_VALUE;_this._outerMaxValue=-Number.MAX_VALUE;_this._ratio=0;_this._top=0;_this._bottom=0;_this._paddingTop=0;_this._paddingBottom=0;_this._minInterval=36;_this._selectedPosition=-1;_this._selectedValue=-Number.MAX_VALUE;_this._gradations=[];return _this}_createClass(Range,[{key:"isUpdated",value:function isUpdated(){return this._updated}},{key:"setUpdated",value:function setUpdated(v){this._updated=v}},{key:"getMinValue",value:function getMinValue(){return this._minValue}},{key:"getMaxValue",value:function getMaxValue(){return this._maxValue}},{key:"getRange",value:function getRange(){return this._maxValue-this._minValue}},{key:"getOuterMinValue",value:function getOuterMinValue(){return this._outerMinValue}},{key:"getOuterMaxValue",value:function getOuterMaxValue(){return this._outerMaxValue}},{key:"getOuterRange",value:function getOuterRange(){return this._outerMaxValue-this._outerMinValue}},{key:"getHeight",value:function getHeight(){return Math.max(0,this._bottom-this._top)}},{key:"getGradations",value:function getGradations(){return this._gradations}},{key:"getMinInterval",value:function getMinInterval(){return this._minInterval}},{key:"setMinInterval",value:function setMinInterval(v){this._minInterval=v}},{key:"getSelectedPosition",value:function getSelectedPosition(){if(this._selectedPosition>=0){return this._selectedPosition}if(this._selectedValue>-Number.MAX_VALUE){return this.toY(this._selectedValue)}return-1}},{key:"getSelectedValue",value:function getSelectedValue(){if(this._selectedValue>-Number.MAX_VALUE){return this._selectedValue}var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());if(area===null){return-Number.MAX_VALUE}if(this._selectedPosition<area.getTop()+12||this._selectedPosition>=area.getBottom()-4){return-Number.MAX_VALUE}return this.toValue(this._selectedPosition)}},{key:"setPaddingTop",value:function setPaddingTop(p){this._paddingTop=p}},{key:"setPaddingBottom",value:function setPaddingBottom(p){this._paddingBottom=p}},{key:"toValue",value:function toValue(y){return this._maxValue-(y-this._top)/this._ratio}},{key:"toY",value:function toY(value){if(this._ratio>0){return this._top+Math.floor((this._maxValue-value)*this._ratio+.5)}return this._top}},{key:"toHeight",value:function toHeight(value){return Math.floor(value*this._ratio+1.5)}},{key:"update",value:function update(){var min=Number.MAX_VALUE;var max=-Number.MAX_VALUE;var mgr=_chart_manager.ChartManager.instance;var dp,dpNames=[".main",".secondary"];for(var i=0;i<dpNames.length;i++){dp=mgr.getDataProvider(this.getName()+dpNames[i]);if(dp!==null&&dp!==undefined){min=Math.min(min,dp.getMinValue());max=Math.max(max,dp.getMaxValue())}}var r={min:min,max:max};this.preSetRange(r);this.setRange(r.min,r.max)}},{key:"select",
value:function select(v){this._selectedValue=v;this._selectedPosition=-1}},{key:"selectAt",value:function selectAt(y){this._selectedPosition=y;this._selectedValue=-Number.MAX_VALUE}},{key:"unselect",value:function unselect(){this._selectedPosition=-1;this._selectedValue=-Number.MAX_VALUE}},{key:"preSetRange",value:function preSetRange(r){if(r.min===r.max){r.min=-1;r.max=1}}},{key:"setRange",value:function setRange(minValue,maxValue){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());if(this._minValue===minValue&&this._maxValue===maxValue&&!area.isChanged()){return}this._updated=true;this._minValue=minValue;this._maxValue=maxValue;this._gradations=[];var top=area.getTop()+this._paddingTop;var bottom=area.getBottom()-(this._paddingBottom+1);if(top>=bottom){this._minValue=this._maxValue;return}this._top=top;this._bottom=bottom;if(this._maxValue>this._minValue)this._ratio=(bottom-top)/(this._maxValue-this._minValue);else{this._ratio=1}this._outerMinValue=this.toValue(area.getBottom());this._outerMaxValue=this.toValue(area.getTop());this.updateGradations()}},{key:"calcInterval",value:function calcInterval(){var H=this.getHeight();var h=this.getMinInterval();if(H/h<=1){h=H>>1}var d=this.getRange();var i=0;while(i>-2&&Math.floor(d)<d){d*=10;i--}var m,c;for(;;i++){c=Math.pow(10,i);m=c;if(this.toHeight(m)>h)break;m=2*c;if(this.toHeight(m)>h)break;m=5*c;if(this.toHeight(m)>h)break}return m}},{key:"updateGradations",value:function updateGradations(){this._gradations=[];var interval=this.calcInterval();if(interval<=0){return}var v=Math.floor(this.getMaxValue()/interval)*interval;do{this._gradations.push(v);v-=interval}while(v>this.getMinValue())}}]);return Range}(_named_object.NamedObject);exports.Range=Range;var PositiveRange=function(_Range){_inherits(PositiveRange,_Range);function PositiveRange(name){_classCallCheck(this,PositiveRange);return _possibleConstructorReturn(this,(PositiveRange.__proto__||Object.getPrototypeOf(PositiveRange)).call(this,name))}_createClass(PositiveRange,[{key:"preSetRange",value:function preSetRange(r){if(r.min<0)r.min=0;if(r.max<0)r.max=0}}]);return PositiveRange}(Range);exports.PositiveRange=PositiveRange;var ZeroBasedPositiveRange=function(_Range2){_inherits(ZeroBasedPositiveRange,_Range2);function ZeroBasedPositiveRange(name){_classCallCheck(this,ZeroBasedPositiveRange);return _possibleConstructorReturn(this,(ZeroBasedPositiveRange.__proto__||Object.getPrototypeOf(ZeroBasedPositiveRange)).call(this,name))}_createClass(ZeroBasedPositiveRange,[{key:"preSetRange",value:function preSetRange(r){r.min=0;if(r.max<0)r.max=0}}]);return ZeroBasedPositiveRange}(Range);exports.ZeroBasedPositiveRange=ZeroBasedPositiveRange;var MainRange=function(_Range3){_inherits(MainRange,_Range3);function MainRange(name){_classCallCheck(this,MainRange);return _possibleConstructorReturn(this,(MainRange.__proto__||Object.getPrototypeOf(MainRange)).call(this,name))}_createClass(MainRange,[{key:"preSetRange",value:function preSetRange(r){var mgr=_chart_manager.ChartManager.instance;var timeline=mgr.getTimeline(this.getDataSourceName());var dIndex=timeline.getMaxIndex()-timeline.getLastIndex();if(dIndex<25){var ds=mgr.getDataSource(this.getDataSourceName());var data=ds.getDataAt(ds.getDataCount()-1);var d=(r.max-r.min)/4*(1-dIndex/25);r.min=Math.min(r.min,Math.max(data.low-d,0));r.max=Math.max(r.max,data.high+d)}if(r.min>0){var a=r.max/r.min;if(a<1.016){var m=(r.max+r.min)/2;var c=(a-1)*1.5;r.max=m*(1+c);r.min=m*(1-c)}else if(a<1.048){var _m=(r.max+r.min)/2;r.max=_m*1.024;r.min=_m*.976}}if(r.min<0)r.min=0;if(r.max<0)r.max=0}}]);return MainRange}(Range);exports.MainRange=MainRange;var ZeroCenteredRange=function(_Range4){_inherits(ZeroCenteredRange,_Range4);function ZeroCenteredRange(name){_classCallCheck(this,ZeroCenteredRange);return _possibleConstructorReturn(this,(ZeroCenteredRange.__proto__||Object.getPrototypeOf(ZeroCenteredRange)).call(this,name))}_createClass(ZeroCenteredRange,[{key:"calcInterval",value:function calcInterval(area){var h=this.getMinInterval();if(area.getHeight()/h<2){return 0}var r=this.getRange();var i;for(i=3;;i+=2){if(this.toHeight(r/i)<=h)break}i-=2;return r/i}},{key:"updateGradations",value:function updateGradations(){this._gradations=[];var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var interval=this.calcInterval(area);if(interval<=0){return}var v=interval/2;do{this._gradations.push(v);this._gradations.push(-v);v+=interval}while(v<=this.getMaxValue())}},{key:"preSetRange",value:function preSetRange(r){var abs=Math.max(Math.abs(r.min),Math.abs(r.max));r.min=-abs;r.max=abs}}]);return ZeroCenteredRange}(Range);exports.ZeroCenteredRange=ZeroCenteredRange;var PercentageRange=function(_Range5){_inherits(PercentageRange,_Range5);function PercentageRange(name){_classCallCheck(this,PercentageRange);return _possibleConstructorReturn(this,(PercentageRange.__proto__||Object.getPrototypeOf(PercentageRange)).call(this,name))}_createClass(PercentageRange,[{key:"updateGradations",value:function updateGradations(){this._gradations=[];var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getAreaName());var interval=10;var h=Math.floor(this.toHeight(interval));if(h<<2>area.getHeight())return;var v=Math.ceil(this.getMinValue()/interval)*interval;if(v===0)v=0;if(h<<2<24){if(h<<1<8)return;do{if(v===20||v===80)this._gradations.push(v);v+=interval}while(v<this.getMaxValue())}else{do{if(h<8){if(v===20||v===50||v===80)this._gradations.push(v)}else{if(v===0||v===20||v===50||v===80||v===100)this._gradations.push(v)}v+=interval}while(v<this.getMaxValue())}}}]);return PercentageRange}(Range);exports.PercentageRange=PercentageRange},function(module,exports){module.exports=__WEBPACK_EXTERNAL_MODULE_59__},function(module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var constants_1=__webpack_require__(43);exports.assert=function(assertion,message){if(!assertion){throw exports.assertionError(message)}};exports.assertionError=function(message){return new Error("Firebase Database ("+constants_1.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+message)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var stringToByteArray=function(str){var out=[],p=0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c<128){out[p++]=c}else if(c<2048){out[p++]=c>>6|192;out[p++]=c&63|128}else if((c&64512)==55296&&i+1<str.length&&(str.charCodeAt(i+1)&64512)==56320){c=65536+((c&1023)<<10)+(str.charCodeAt(++i)&1023);out[p++]=c>>18|240;out[p++]=c>>12&63|128;out[p++]=c>>6&63|128;out[p++]=c&63|128}else{out[p++]=c>>12|224;out[p++]=c>>6&63|128;out[p++]=c&63|128}}return out};var byteArrayToString=function(bytes){var out=[],pos=0,c=0;while(pos<bytes.length){var c1=bytes[pos++];if(c1<128){out[c++]=String.fromCharCode(c1)}else if(c1>191&&c1<224){var c2=bytes[pos++];out[c++]=String.fromCharCode((c1&31)<<6|c2&63)}else if(c1>239&&c1<365){var c2=bytes[pos++];var c3=bytes[pos++];var c4=bytes[pos++];var u=((c1&7)<<18|(c2&63)<<12|(c3&63)<<6|c4&63)-65536;out[c++]=String.fromCharCode(55296+(u>>10));out[c++]=String.fromCharCode(56320+(u&1023))}else{var c2=bytes[pos++];var c3=bytes[pos++];out[c++]=String.fromCharCode((c1&15)<<12|(c2&63)<<6|c3&63)}}return out.join("")};exports.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZ"+"abcdefghijklmnopqrstuvwxyz"+"0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob==="function",encodeByteArray:function(input,opt_webSafe){if(!Array.isArray(input)){throw Error("encodeByteArray takes an array as a parameter")}this.init_();var byteToCharMap=opt_webSafe?this.byteToCharMapWebSafe_:this.byteToCharMap_;var output=[];for(var i=0;i<input.length;i+=3){var byte1=input[i];var haveByte2=i+1<input.length;var byte2=haveByte2?input[i+1]:0;var haveByte3=i+2<input.length;var byte3=haveByte3?input[i+2]:0;var outByte1=byte1>>2;var outByte2=(byte1&3)<<4|byte2>>4;var outByte3=(byte2&15)<<2|byte3>>6;var outByte4=byte3&63;if(!haveByte3){outByte4=64;if(!haveByte2){outByte3=64}}output.push(byteToCharMap[outByte1],byteToCharMap[outByte2],byteToCharMap[outByte3],byteToCharMap[outByte4])}return output.join("")},encodeString:function(input,opt_webSafe){if(this.HAS_NATIVE_SUPPORT&&!opt_webSafe){return btoa(input)}return this.encodeByteArray(stringToByteArray(input),opt_webSafe)},decodeString:function(input,opt_webSafe){if(this.HAS_NATIVE_SUPPORT&&!opt_webSafe){return atob(input)}return byteArrayToString(this.decodeStringToByteArray(input,opt_webSafe))},decodeStringToByteArray:function(input,opt_webSafe){this.init_();var charToByteMap=opt_webSafe?this.charToByteMapWebSafe_:this.charToByteMap_;var output=[];for(var i=0;i<input.length;){var byte1=charToByteMap[input.charAt(i++)];var haveByte2=i<input.length;var byte2=haveByte2?charToByteMap[input.charAt(i)]:0;++i;var haveByte3=i<input.length;var byte3=haveByte3?charToByteMap[input.charAt(i)]:64;++i;var haveByte4=i<input.length;var byte4=haveByte4?charToByteMap[input.charAt(i)]:64;++i;if(byte1==null||byte2==null||byte3==null||byte4==null){throw Error()}var outByte1=byte1<<2|byte2>>4;output.push(outByte1);if(byte3!=64){var outByte2=byte2<<4&240|byte3>>2;output.push(outByte2);if(byte4!=64){var outByte3=byte3<<6&192|byte4;output.push(outByte3)}}}return output},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={};this.charToByteMap_={};this.byteToCharMapWebSafe_={};this.charToByteMapWebSafe_={};for(var i=0;i<this.ENCODED_VALS.length;i++){this.byteToCharMap_[i]=this.ENCODED_VALS.charAt(i);this.charToByteMap_[this.byteToCharMap_[i]]=i;this.byteToCharMapWebSafe_[i]=this.ENCODED_VALS_WEBSAFE.charAt(i);this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[i]]=i;if(i>=this.ENCODED_VALS_BASE.length){this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(i)]=i;this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(i)]=i}}}}};exports.base64Encode=function(str){var utf8Bytes=stringToByteArray(str);return exports.base64.encodeByteArray(utf8Bytes,true)};exports.base64Decode=function(str){try{return exports.base64.decodeString(str,true)}catch(e){console.error("base64Decode failed: ",e)}return null}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function jsonEval(str){return JSON.parse(str)}exports.jsonEval=jsonEval;function stringify(data){return JSON.stringify(data)}exports.stringify=stringify},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)};exports.safeGet=function(obj,key){if(Object.prototype.hasOwnProperty.call(obj,key))return obj[key]};exports.forEach=function(obj,fn){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){fn(key,obj[key])}}};exports.extend=function(objTo,objFrom){exports.forEach(objFrom,function(key,value){objTo[key]=value});return objTo};exports.clone=function(obj){return exports.extend({},obj)};exports.isNonNullObject=function(obj){return typeof obj==="object"&&obj!==null};exports.isEmpty=function(obj){for(var key in obj){return false}return true};exports.getCount=function(obj){var rv=0;for(var key in obj){rv++}return rv};exports.map=function(obj,f,opt_obj){var res={};for(var key in obj){res[key]=f.call(opt_obj,obj[key],key,obj)}return res};exports.findKey=function(obj,fn,opt_this){for(var key in obj){if(fn.call(opt_this,obj[key],key,obj)){return key}}return undefined};exports.findValue=function(obj,fn,opt_this){var key=exports.findKey(obj,fn,opt_this);return key&&obj[key]};exports.getAnyKey=function(obj){for(var key in obj){return key}};exports.getValues=function(obj){var res=[];var i=0;for(var key in obj){res[i++]=obj[key]}return res};exports.every=function(obj,fn){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){if(!fn(key,obj[key])){return false}}}return true}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var parser_1=__webpack_require__(66);var Path_1=__webpack_require__(2);var Reference_1=__webpack_require__(44);var Repo_1=__webpack_require__(31);var RepoManager_1=__webpack_require__(49);var util_2=__webpack_require__(0);var validation_1=__webpack_require__(12);var Database=function(){function Database(repo_){this.repo_=repo_;if(!(repo_ instanceof Repo_1.Repo)){util_1.fatal("Don't call new Database() directly - please use firebase.database().")}this.root_=new Reference_1.Reference(repo_,Path_1.Path.Empty);this.INTERNAL=new DatabaseInternals(this)}Object.defineProperty(Database.prototype,"app",{get:function(){return this.repo_.app},enumerable:true,configurable:true});Database.prototype.ref=function(pathString){this.checkDeleted_("ref");util_2.validateArgCount("database.ref",0,1,arguments.length);return pathString!==undefined?this.root_.child(pathString):this.root_};Database.prototype.refFromURL=function(url){var apiName="database.refFromURL";this.checkDeleted_(apiName);util_2.validateArgCount(apiName,1,1,arguments.length);var parsedURL=parser_1.parseRepoInfo(url);validation_1.validateUrl(apiName,1,parsedURL);var repoInfo=parsedURL.repoInfo;if(repoInfo.host!==this.repo_.repoInfo_.host){util_1.fatal(apiName+": Host name does not match the current database: "+"(found "+repoInfo.host+" but expected "+this.repo_.repoInfo_.host+")")}return this.ref(parsedURL.path.toString())};Database.prototype.checkDeleted_=function(apiName){if(this.repo_===null){util_1.fatal("Cannot call "+apiName+" on a deleted database.")}};Database.prototype.goOffline=function(){util_2.validateArgCount("database.goOffline",0,0,arguments.length);this.checkDeleted_("goOffline");this.repo_.interrupt()};Database.prototype.goOnline=function(){util_2.validateArgCount("database.goOnline",0,0,arguments.length);this.checkDeleted_("goOnline");this.repo_.resume()};Database.ServerValue={TIMESTAMP:{".sv":"timestamp"}};return Database}();exports.Database=Database;var DatabaseInternals=function(){function DatabaseInternals(database){this.database=database}DatabaseInternals.prototype.delete=function(){this.database.checkDeleted_("delete");RepoManager_1.RepoManager.getInstance().deleteRepo(this.database.repo_);this.database.repo_=null;this.database.root_=null;this.database.INTERNAL=null;this.database=null;return Promise.resolve()};return DatabaseInternals}();exports.DatabaseInternals=DatabaseInternals},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Path_1=__webpack_require__(2);var RepoInfo_1=__webpack_require__(67);var util_1=__webpack_require__(1);function decodePath(pathString){var pathStringDecoded="";var pieces=pathString.split("/");for(var i=0;i<pieces.length;i++){if(pieces[i].length>0){var piece=pieces[i];try{piece=decodeURIComponent(piece.replace(/\+/g," "))}catch(e){}pathStringDecoded+="/"+piece}}return pathStringDecoded}exports.parseRepoInfo=function(dataURL){var parsedUrl=exports.parseURL(dataURL),namespace=parsedUrl.subdomain;if(parsedUrl.domain==="firebase"){util_1.fatal(parsedUrl.host+" is no longer supported. "+"Please use <YOUR FIREBASE>.firebaseio.com instead")}if(!namespace||namespace=="undefined"){util_1.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com")}if(!parsedUrl.secure){util_1.warnIfPageIsSecure()}var webSocketOnly=parsedUrl.scheme==="ws"||parsedUrl.scheme==="wss";return{repoInfo:new RepoInfo_1.RepoInfo(parsedUrl.host,parsedUrl.secure,namespace,webSocketOnly),path:new Path_1.Path(parsedUrl.pathString)}};exports.parseURL=function(dataURL){var host="",domain="",subdomain="",pathString="";var secure=true,scheme="https",port=443;if(typeof dataURL==="string"){var colonInd=dataURL.indexOf("//");if(colonInd>=0){scheme=dataURL.substring(0,colonInd-1);dataURL=dataURL.substring(colonInd+2)}var slashInd=dataURL.indexOf("/");if(slashInd===-1){slashInd=dataURL.length}host=dataURL.substring(0,slashInd);pathString=decodePath(dataURL.substring(slashInd));var parts=host.split(".");if(parts.length===3){domain=parts[1];subdomain=parts[0].toLowerCase()}else if(parts.length===2){domain=parts[0]}colonInd=host.indexOf(":");if(colonInd>=0){secure=scheme==="https"||scheme==="wss";port=parseInt(host.substring(colonInd+1),10)}}return{host:host,port:port,domain:domain,subdomain:subdomain,secure:secure,scheme:scheme,pathString:pathString}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var storage_1=__webpack_require__(26);var Constants_1=__webpack_require__(27);var RepoInfo=function(){function RepoInfo(host,secure,namespace,webSocketOnly,persistenceKey){if(persistenceKey===void 0){persistenceKey=""}this.secure=secure;this.namespace=namespace;this.webSocketOnly=webSocketOnly;this.persistenceKey=persistenceKey;this.host=host.toLowerCase();this.domain=this.host.substr(this.host.indexOf(".")+1);this.internalHost=storage_1.PersistentStorage.get("host:"+host)||this.host}RepoInfo.prototype.needsQueryParam=function(){return this.host!==this.internalHost};RepoInfo.prototype.isCacheableHost=function(){return this.internalHost.substr(0,2)==="s-"};RepoInfo.prototype.isDemoHost=function(){return this.domain==="firebaseio-demo.com"};RepoInfo.prototype.isCustomHost=function(){return this.domain!=="firebaseio.com"&&this.domain!=="firebaseio-demo.com"};RepoInfo.prototype.updateHost=function(newHost){if(newHost!==this.internalHost){this.internalHost=newHost;if(this.isCacheableHost()){storage_1.PersistentStorage.set("host:"+this.host,this.internalHost)}}};RepoInfo.prototype.connectionURL=function(type,params){util_1.assert(typeof type==="string","typeof type must == string");util_1.assert(typeof params==="object","typeof params must == object");var connURL;if(type===Constants_1.WEBSOCKET){connURL=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?"}else if(type===Constants_1.LONG_POLLING){connURL=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}else{throw new Error("Unknown connection type: "+type)}if(this.needsQueryParam()){params["ns"]=this.namespace}var pairs=[];util_2.forEach(params,function(key,value){pairs.push(key+"="+value)});return connURL+pairs.join("&")};RepoInfo.prototype.toString=function(){var str=this.toURLString();if(this.persistenceKey){str+="<"+this.persistenceKey+">"}return str};RepoInfo.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host};return RepoInfo}();exports.RepoInfo=RepoInfo},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var validation_1=__webpack_require__(12);var util_2=__webpack_require__(1);var util_3=__webpack_require__(0);var OnDisconnect=function(){function OnDisconnect(repo_,path_){this.repo_=repo_;this.path_=path_}OnDisconnect.prototype.cancel=function(onComplete){util_1.validateArgCount("OnDisconnect.cancel",0,1,arguments.length);util_1.validateCallback("OnDisconnect.cancel",1,onComplete,true);var deferred=new util_3.Deferred;this.repo_.onDisconnectCancel(this.path_,deferred.wrapCallback(onComplete));return deferred.promise};OnDisconnect.prototype.remove=function(onComplete){util_1.validateArgCount("OnDisconnect.remove",0,1,arguments.length);validation_1.validateWritablePath("OnDisconnect.remove",this.path_);util_1.validateCallback("OnDisconnect.remove",1,onComplete,true);var deferred=new util_3.Deferred;this.repo_.onDisconnectSet(this.path_,null,deferred.wrapCallback(onComplete));return deferred.promise};OnDisconnect.prototype.set=function(value,onComplete){util_1.validateArgCount("OnDisconnect.set",1,2,arguments.length);validation_1.validateWritablePath("OnDisconnect.set",this.path_);validation_1.validateFirebaseDataArg("OnDisconnect.set",1,value,this.path_,false);util_1.validateCallback("OnDisconnect.set",2,onComplete,true);var deferred=new util_3.Deferred;this.repo_.onDisconnectSet(this.path_,value,deferred.wrapCallback(onComplete));return deferred.promise};OnDisconnect.prototype.setWithPriority=function(value,priority,onComplete){util_1.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length);validation_1.validateWritablePath("OnDisconnect.setWithPriority",this.path_);validation_1.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,value,this.path_,false);validation_1.validatePriority("OnDisconnect.setWithPriority",2,priority,false);util_1.validateCallback("OnDisconnect.setWithPriority",3,onComplete,true);var deferred=new util_3.Deferred;this.repo_.onDisconnectSetWithPriority(this.path_,value,priority,deferred.wrapCallback(onComplete));return deferred.promise};OnDisconnect.prototype.update=function(objectToMerge,onComplete){util_1.validateArgCount("OnDisconnect.update",1,2,arguments.length);validation_1.validateWritablePath("OnDisconnect.update",this.path_);if(Array.isArray(objectToMerge)){var newObjectToMerge={};for(var i=0;i<objectToMerge.length;++i){newObjectToMerge[""+i]=objectToMerge[i]}objectToMerge=newObjectToMerge;util_2.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the "+"existing data, or an Object with integer keys if you really do want to only update some of the children.")}validation_1.validateFirebaseMergeDataArg("OnDisconnect.update",1,objectToMerge,this.path_,false);util_1.validateCallback("OnDisconnect.update",2,onComplete,true);var deferred=new util_3.Deferred;this.repo_.onDisconnectUpdate(this.path_,objectToMerge,deferred.wrapCallback(onComplete));return deferred.promise};return OnDisconnect}();exports.OnDisconnect=OnDisconnect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var KeyIndex_1=__webpack_require__(21);var PriorityIndex_1=__webpack_require__(4);var ValueIndex_1=__webpack_require__(71);var PathIndex_1=__webpack_require__(75);var util_2=__webpack_require__(1);var Path_1=__webpack_require__(2);var validation_1=__webpack_require__(12);var util_3=__webpack_require__(0);var EventRegistration_1=__webpack_require__(151);var util_4=__webpack_require__(0);var __referenceConstructor;var Query=function(){function Query(repo,path,queryParams_,orderByCalled_){this.repo=repo;this.path=path;this.queryParams_=queryParams_;this.orderByCalled_=orderByCalled_}Object.defineProperty(Query,"__referenceConstructor",{get:function(){util_1.assert(__referenceConstructor,"Reference.ts has not been loaded");return __referenceConstructor},set:function(val){__referenceConstructor=val},enumerable:true,configurable:true});Query.validateQueryEndpoints_=function(params){var startNode=null;var endNode=null;if(params.hasStart()){startNode=params.getIndexStartValue()}if(params.hasEnd()){endNode=params.getIndexEndValue()}if(params.getIndex()===KeyIndex_1.KEY_INDEX){var tooManyArgsError="Query: When ordering by key, you may only pass one argument to "+"startAt(), endAt(), or equalTo().";var wrongArgTypeError="Query: When ordering by key, the argument passed to startAt(), endAt(),"+"or equalTo() must be a string.";if(params.hasStart()){var startName=params.getIndexStartName();if(startName!=util_2.MIN_NAME){throw new Error(tooManyArgsError)}else if(typeof startNode!=="string"){throw new Error(wrongArgTypeError)}}if(params.hasEnd()){var endName=params.getIndexEndName();if(endName!=util_2.MAX_NAME){throw new Error(tooManyArgsError)}else if(typeof endNode!=="string"){throw new Error(wrongArgTypeError)}}}else if(params.getIndex()===PriorityIndex_1.PRIORITY_INDEX){if(startNode!=null&&!validation_1.isValidPriority(startNode)||endNode!=null&&!validation_1.isValidPriority(endNode)){throw new Error("Query: When ordering by priority, the first argument passed to startAt(), "+"endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}}else{util_1.assert(params.getIndex()instanceof PathIndex_1.PathIndex||params.getIndex()===ValueIndex_1.VALUE_INDEX,"unknown index type.");if(startNode!=null&&typeof startNode==="object"||endNode!=null&&typeof endNode==="object"){throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be "+"an object.")}}};Query.validateLimit_=function(params){if(params.hasStart()&&params.hasEnd()&&params.hasLimit()&&!params.hasAnchoredLimit()){throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")}};Query.prototype.validateNoPreviousOrderByCall_=function(fnName){if(this.orderByCalled_===true){throw new Error(fnName+": You can't combine multiple orderBy calls.")}};Query.prototype.getQueryParams=function(){return this.queryParams_};Query.prototype.getRef=function(){util_3.validateArgCount("Query.ref",0,0,arguments.length);return new Query.__referenceConstructor(this.repo,this.path)};Query.prototype.on=function(eventType,callback,cancelCallbackOrContext,context){util_3.validateArgCount("Query.on",2,4,arguments.length);validation_1.validateEventType("Query.on",1,eventType,false);util_3.validateCallback("Query.on",2,callback,false);var ret=Query.getCancelAndContextArgs_("Query.on",cancelCallbackOrContext,context);if(eventType==="value"){this.onValueEvent(callback,ret.cancel,ret.context)}else{var callbacks={};callbacks[eventType]=callback;this.onChildEvent(callbacks,ret.cancel,ret.context)}return callback};Query.prototype.onValueEvent=function(callback,cancelCallback,context){var container=new EventRegistration_1.ValueEventRegistration(callback,cancelCallback||null,context||null);this.repo.addEventCallbackForQuery(this,container)};Query.prototype.onChildEvent=function(callbacks,cancelCallback,context){var container=new EventRegistration_1.ChildEventRegistration(callbacks,cancelCallback,context);this.repo.addEventCallbackForQuery(this,container)};Query.prototype.off=function(eventType,callback,context){util_3.validateArgCount("Query.off",0,3,arguments.length);validation_1.validateEventType("Query.off",1,eventType,true);util_3.validateCallback("Query.off",2,callback,true);util_3.validateContextObject("Query.off",3,context,true);var container=null;var callbacks=null;if(eventType==="value"){var valueCallback=callback||null;container=new EventRegistration_1.ValueEventRegistration(valueCallback,null,context||null)}else if(eventType){if(callback){callbacks={};callbacks[eventType]=callback}container=new EventRegistration_1.ChildEventRegistration(callbacks,null,context||null)}this.repo.removeEventCallbackForQuery(this,container)};Query.prototype.once=function(eventType,userCallback,cancelOrContext,context){var _this=this;util_3.validateArgCount("Query.once",1,4,arguments.length);validation_1.validateEventType("Query.once",1,eventType,false);util_3.validateCallback("Query.once",2,userCallback,true);var ret=Query.getCancelAndContextArgs_("Query.once",cancelOrContext,context);var firstCall=true;var deferred=new util_4.Deferred;deferred.promise.catch(function(){});var onceCallback=function(snapshot){if(firstCall){firstCall=false;_this.off(eventType,onceCallback);if(userCallback){userCallback.bind(ret.context)(snapshot)}deferred.resolve(snapshot)}};this.on(eventType,onceCallback,function(err){_this.off(eventType,onceCallback);if(ret.cancel)ret.cancel.bind(ret.context)(err);deferred.reject(err)});return deferred.promise};Query.prototype.limitToFirst=function(limit){util_3.validateArgCount("Query.limitToFirst",1,1,arguments.length);if(typeof limit!=="number"||Math.floor(limit)!==limit||limit<=0){throw new Error("Query.limitToFirst: First argument must be a positive integer.")}if(this.queryParams_.hasLimit()){throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, "+"limitToFirst, or limitToLast).")}return new Query(this.repo,this.path,this.queryParams_.limitToFirst(limit),this.orderByCalled_)};Query.prototype.limitToLast=function(limit){util_3.validateArgCount("Query.limitToLast",1,1,arguments.length);if(typeof limit!=="number"||Math.floor(limit)!==limit||limit<=0){throw new Error("Query.limitToLast: First argument must be a positive integer.")}if(this.queryParams_.hasLimit()){throw new Error("Query.limitToLast: Limit was already set (by another call to limit, "+"limitToFirst, or limitToLast).")}return new Query(this.repo,this.path,this.queryParams_.limitToLast(limit),this.orderByCalled_)};Query.prototype.orderByChild=function(path){util_3.validateArgCount("Query.orderByChild",1,1,arguments.length);if(path==="$key"){throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.')}else if(path==="$priority"){throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.')}else if(path==="$value"){
throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.')}validation_1.validatePathString("Query.orderByChild",1,path,false);this.validateNoPreviousOrderByCall_("Query.orderByChild");var parsedPath=new Path_1.Path(path);if(parsedPath.isEmpty()){throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.")}var index=new PathIndex_1.PathIndex(parsedPath);var newParams=this.queryParams_.orderBy(index);Query.validateQueryEndpoints_(newParams);return new Query(this.repo,this.path,newParams,true)};Query.prototype.orderByKey=function(){util_3.validateArgCount("Query.orderByKey",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByKey");var newParams=this.queryParams_.orderBy(KeyIndex_1.KEY_INDEX);Query.validateQueryEndpoints_(newParams);return new Query(this.repo,this.path,newParams,true)};Query.prototype.orderByPriority=function(){util_3.validateArgCount("Query.orderByPriority",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByPriority");var newParams=this.queryParams_.orderBy(PriorityIndex_1.PRIORITY_INDEX);Query.validateQueryEndpoints_(newParams);return new Query(this.repo,this.path,newParams,true)};Query.prototype.orderByValue=function(){util_3.validateArgCount("Query.orderByValue",0,0,arguments.length);this.validateNoPreviousOrderByCall_("Query.orderByValue");var newParams=this.queryParams_.orderBy(ValueIndex_1.VALUE_INDEX);Query.validateQueryEndpoints_(newParams);return new Query(this.repo,this.path,newParams,true)};Query.prototype.startAt=function(value,name){if(value===void 0){value=null}util_3.validateArgCount("Query.startAt",0,2,arguments.length);validation_1.validateFirebaseDataArg("Query.startAt",1,value,this.path,true);validation_1.validateKey("Query.startAt",2,name,true);var newParams=this.queryParams_.startAt(value,name);Query.validateLimit_(newParams);Query.validateQueryEndpoints_(newParams);if(this.queryParams_.hasStart()){throw new Error("Query.startAt: Starting point was already set (by another call to startAt "+"or equalTo).")}if(value===undefined){value=null;name=null}return new Query(this.repo,this.path,newParams,this.orderByCalled_)};Query.prototype.endAt=function(value,name){if(value===void 0){value=null}util_3.validateArgCount("Query.endAt",0,2,arguments.length);validation_1.validateFirebaseDataArg("Query.endAt",1,value,this.path,true);validation_1.validateKey("Query.endAt",2,name,true);var newParams=this.queryParams_.endAt(value,name);Query.validateLimit_(newParams);Query.validateQueryEndpoints_(newParams);if(this.queryParams_.hasEnd()){throw new Error("Query.endAt: Ending point was already set (by another call to endAt or "+"equalTo).")}return new Query(this.repo,this.path,newParams,this.orderByCalled_)};Query.prototype.equalTo=function(value,name){util_3.validateArgCount("Query.equalTo",1,2,arguments.length);validation_1.validateFirebaseDataArg("Query.equalTo",1,value,this.path,false);validation_1.validateKey("Query.equalTo",2,name,true);if(this.queryParams_.hasStart()){throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or "+"equalTo).")}if(this.queryParams_.hasEnd()){throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or "+"equalTo).")}return this.startAt(value,name).endAt(value,name)};Query.prototype.toString=function(){util_3.validateArgCount("Query.toString",0,0,arguments.length);return this.repo.toString()+this.path.toUrlEncodedString()};Query.prototype.toJSON=function(){util_3.validateArgCount("Query.toJSON",0,1,arguments.length);return this.toString()};Query.prototype.queryObject=function(){return this.queryParams_.getQueryObject()};Query.prototype.queryIdentifier=function(){var obj=this.queryObject();var id=util_2.ObjectToUniqueKey(obj);return id==="{}"?"default":id};Query.prototype.isEqual=function(other){util_3.validateArgCount("Query.isEqual",1,1,arguments.length);if(!(other instanceof Query)){var error="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(error)}var sameRepo=this.repo===other.repo;var samePath=this.path.equals(other.path);var sameQueryIdentifier=this.queryIdentifier()===other.queryIdentifier();return sameRepo&&samePath&&sameQueryIdentifier};Query.getCancelAndContextArgs_=function(fnName,cancelOrContext,context){var ret={cancel:null,context:null};if(cancelOrContext&&context){ret.cancel=cancelOrContext;util_3.validateCallback(fnName,3,ret.cancel,true);ret.context=context;util_3.validateContextObject(fnName,4,ret.context,true)}else if(cancelOrContext){if(typeof cancelOrContext==="object"&&cancelOrContext!==null){ret.context=cancelOrContext}else if(typeof cancelOrContext==="function"){ret.cancel=cancelOrContext}else{throw new Error(util_3.errorPrefix(fnName,3,true)+" must either be a cancel callback or a context object.")}}return ret};Object.defineProperty(Query.prototype,"ref",{get:function(){return this.getRef()},enumerable:true,configurable:true});return Query}();exports.Query=Query},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var util_3=__webpack_require__(0);var MAX_NODE;function setMaxNode(val){MAX_NODE=val}exports.setMaxNode=setMaxNode;exports.priorityHashText=function(priority){if(typeof priority==="number")return"number:"+util_2.doubleToIEEE754String(priority);else return"string:"+priority};exports.validatePriorityNode=function(priorityNode){if(priorityNode.isLeafNode()){var val=priorityNode.val();util_1.assert(typeof val==="string"||typeof val==="number"||typeof val==="object"&&util_3.contains(val,".sv"),"Priority must be a string or number.")}else{util_1.assert(priorityNode===MAX_NODE||priorityNode.isEmpty(),"priority of unexpected type.")}util_1.assert(priorityNode===MAX_NODE||priorityNode.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var Index_1=__webpack_require__(28);var Node_1=__webpack_require__(6);var util_1=__webpack_require__(1);var nodeFromJSON_1=__webpack_require__(22);var ValueIndex=function(_super){__extends(ValueIndex,_super);function ValueIndex(){return _super!==null&&_super.apply(this,arguments)||this}ValueIndex.prototype.compare=function(a,b){var indexCmp=a.node.compareTo(b.node);if(indexCmp===0){return util_1.nameCompare(a.name,b.name)}else{return indexCmp}};ValueIndex.prototype.isDefinedOn=function(node){return true};ValueIndex.prototype.indexedValueChanged=function(oldNode,newNode){return!oldNode.equals(newNode)};ValueIndex.prototype.minPost=function(){return Node_1.NamedNode.MIN};ValueIndex.prototype.maxPost=function(){return Node_1.NamedNode.MAX};ValueIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON_1.nodeFromJSON(indexValue);return new Node_1.NamedNode(name,valueNode)};ValueIndex.prototype.toString=function(){return".value"};return ValueIndex}(Index_1.Index);exports.ValueIndex=ValueIndex;exports.VALUE_INDEX=new ValueIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var childSet_1=__webpack_require__(73);var util_2=__webpack_require__(0);var Node_1=__webpack_require__(6);var PriorityIndex_1=__webpack_require__(4);var KeyIndex_1=__webpack_require__(21);var _defaultIndexMap;var fallbackObject={};var IndexMap=function(){function IndexMap(indexes_,indexSet_){this.indexes_=indexes_;this.indexSet_=indexSet_}Object.defineProperty(IndexMap,"Default",{get:function(){util_1.assert(fallbackObject&&PriorityIndex_1.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded");_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PriorityIndex_1.PRIORITY_INDEX});return _defaultIndexMap},enumerable:true,configurable:true});IndexMap.prototype.get=function(indexKey){var sortedMap=util_2.safeGet(this.indexes_,indexKey);if(!sortedMap)throw new Error("No index defined for "+indexKey);if(sortedMap===fallbackObject){return null}else{return sortedMap}};IndexMap.prototype.hasIndex=function(indexDefinition){return util_2.contains(this.indexSet_,indexDefinition.toString())};IndexMap.prototype.addIndex=function(indexDefinition,existingChildren){util_1.assert(indexDefinition!==KeyIndex_1.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");var childList=[];var sawIndexedValue=false;var iter=existingChildren.getIterator(Node_1.NamedNode.Wrap);var next=iter.getNext();while(next){sawIndexedValue=sawIndexedValue||indexDefinition.isDefinedOn(next.node);childList.push(next);next=iter.getNext()}var newIndex;if(sawIndexedValue){newIndex=childSet_1.buildChildSet(childList,indexDefinition.getCompare())}else{newIndex=fallbackObject}var indexName=indexDefinition.toString();var newIndexSet=util_2.clone(this.indexSet_);newIndexSet[indexName]=indexDefinition;var newIndexes=util_2.clone(this.indexes_);newIndexes[indexName]=newIndex;return new IndexMap(newIndexes,newIndexSet)};IndexMap.prototype.addToIndexes=function(namedNode,existingChildren){var _this=this;var newIndexes=util_2.map(this.indexes_,function(indexedChildren,indexName){var index=util_2.safeGet(_this.indexSet_,indexName);util_1.assert(index,"Missing index implementation for "+indexName);if(indexedChildren===fallbackObject){if(index.isDefinedOn(namedNode.node)){var childList=[];var iter=existingChildren.getIterator(Node_1.NamedNode.Wrap);var next=iter.getNext();while(next){if(next.name!=namedNode.name){childList.push(next)}next=iter.getNext()}childList.push(namedNode);return childSet_1.buildChildSet(childList,index.getCompare())}else{return fallbackObject}}else{var existingSnap=existingChildren.get(namedNode.name);var newChildren=indexedChildren;if(existingSnap){newChildren=newChildren.remove(new Node_1.NamedNode(namedNode.name,existingSnap))}return newChildren.insert(namedNode,namedNode.node)}});return new IndexMap(newIndexes,this.indexSet_)};IndexMap.prototype.removeFromIndexes=function(namedNode,existingChildren){var newIndexes=util_2.map(this.indexes_,function(indexedChildren){if(indexedChildren===fallbackObject){return indexedChildren}else{var existingSnap=existingChildren.get(namedNode.name);if(existingSnap){return indexedChildren.remove(new Node_1.NamedNode(namedNode.name,existingSnap))}else{return indexedChildren}}});return new IndexMap(newIndexes,this.indexSet_)};return IndexMap}();exports.IndexMap=IndexMap},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var SortedMap_1=__webpack_require__(30);var SortedMap_2=__webpack_require__(30);var LOG_2=Math.log(2);var Base12Num=function(){function Base12Num(length){var logBase2=function(num){return parseInt(Math.log(num)/LOG_2,10)};var bitMask=function(bits){return parseInt(Array(bits+1).join("1"),2)};this.count=logBase2(length+1);this.current_=this.count-1;var mask=bitMask(this.count);this.bits_=length+1&mask}Base12Num.prototype.nextBitIsOne=function(){var result=!(this.bits_&1<<this.current_);this.current_--;return result};return Base12Num}();exports.buildChildSet=function(childList,cmp,keyFn,mapSortFn){childList.sort(cmp);var buildBalancedTree=function(low,high){var length=high-low;var namedNode;var key;if(length==0){return null}else if(length==1){namedNode=childList[low];key=keyFn?keyFn(namedNode):namedNode;return new SortedMap_1.LLRBNode(key,namedNode.node,SortedMap_1.LLRBNode.BLACK,null,null)}else{var middle=parseInt(length/2,10)+low;var left=buildBalancedTree(low,middle);var right=buildBalancedTree(middle+1,high);namedNode=childList[middle];key=keyFn?keyFn(namedNode):namedNode;return new SortedMap_1.LLRBNode(key,namedNode.node,SortedMap_1.LLRBNode.BLACK,left,right)}};var buildFrom12Array=function(base12){var node=null;var root=null;var index=childList.length;var buildPennant=function(chunkSize,color){var low=index-chunkSize;var high=index;index-=chunkSize;var childTree=buildBalancedTree(low+1,high);var namedNode=childList[low];var key=keyFn?keyFn(namedNode):namedNode;attachPennant(new SortedMap_1.LLRBNode(key,namedNode.node,color,null,childTree))};var attachPennant=function(pennant){if(node){node.left=pennant;node=pennant}else{root=pennant;node=pennant}};for(var i=0;i<base12.count;++i){var isOne=base12.nextBitIsOne();var chunkSize=Math.pow(2,base12.count-(i+1));if(isOne){buildPennant(chunkSize,SortedMap_1.LLRBNode.BLACK)}else{buildPennant(chunkSize,SortedMap_1.LLRBNode.BLACK);buildPennant(chunkSize,SortedMap_1.LLRBNode.RED)}}return root};var base12=new Base12Num(childList.length);var root=buildFrom12Array(base12);return new SortedMap_2.SortedMap(mapSortFn||cmp,root)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);function NAME_ONLY_COMPARATOR(left,right){return util_1.nameCompare(left.name,right.name)}exports.NAME_ONLY_COMPARATOR=NAME_ONLY_COMPARATOR;function NAME_COMPARATOR(left,right){return util_1.nameCompare(left,right)}exports.NAME_COMPARATOR=NAME_COMPARATOR},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var Index_1=__webpack_require__(28);var ChildrenNode_1=__webpack_require__(5);var Node_1=__webpack_require__(6);var nodeFromJSON_1=__webpack_require__(22);var PathIndex=function(_super){__extends(PathIndex,_super);function PathIndex(indexPath_){var _this=_super.call(this)||this;_this.indexPath_=indexPath_;util_1.assert(!indexPath_.isEmpty()&&indexPath_.getFront()!==".priority","Can't create PathIndex with empty path or .priority key");return _this}PathIndex.prototype.extractChild=function(snap){return snap.getChild(this.indexPath_)};PathIndex.prototype.isDefinedOn=function(node){return!node.getChild(this.indexPath_).isEmpty()};PathIndex.prototype.compare=function(a,b){var aChild=this.extractChild(a.node);var bChild=this.extractChild(b.node);var indexCmp=aChild.compareTo(bChild);if(indexCmp===0){return util_2.nameCompare(a.name,b.name)}else{return indexCmp}};PathIndex.prototype.makePost=function(indexValue,name){var valueNode=nodeFromJSON_1.nodeFromJSON(indexValue);var node=ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,valueNode);return new Node_1.NamedNode(name,node)};PathIndex.prototype.maxPost=function(){var node=ChildrenNode_1.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,ChildrenNode_1.MAX_NODE);return new Node_1.NamedNode(util_2.MAX_NAME,node)};PathIndex.prototype.toString=function(){return this.indexPath_.slice().join("/")};return PathIndex}(Index_1.Index);exports.PathIndex=PathIndex},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Path_1=__webpack_require__(2);var SparseSnapshotTree_1=__webpack_require__(77);var LeafNode_1=__webpack_require__(29);var nodeFromJSON_1=__webpack_require__(22);var PriorityIndex_1=__webpack_require__(4);exports.generateWithValues=function(values){values=values||{};values["timestamp"]=values["timestamp"]||(new Date).getTime();return values};exports.resolveDeferredValue=function(value,serverValues){if(!value||typeof value!=="object"){return value}else{util_1.assert(".sv"in value,"Unexpected leaf node or priority contents");return serverValues[value[".sv"]]}};exports.resolveDeferredValueTree=function(tree,serverValues){var resolvedTree=new SparseSnapshotTree_1.SparseSnapshotTree;tree.forEachTree(new Path_1.Path(""),function(path,node){resolvedTree.remember(path,exports.resolveDeferredValueSnapshot(node,serverValues))});return resolvedTree};exports.resolveDeferredValueSnapshot=function(node,serverValues){var rawPri=node.getPriority().val();var priority=exports.resolveDeferredValue(rawPri,serverValues);var newNode;if(node.isLeafNode()){var leafNode=node;var value=exports.resolveDeferredValue(leafNode.getValue(),serverValues);if(value!==leafNode.getValue()||priority!==leafNode.getPriority().val()){return new LeafNode_1.LeafNode(value,nodeFromJSON_1.nodeFromJSON(priority))}else{return node}}else{var childrenNode=node;newNode=childrenNode;if(priority!==childrenNode.getPriority().val()){newNode=newNode.updatePriority(new LeafNode_1.LeafNode(priority))}childrenNode.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){var newChildNode=exports.resolveDeferredValueSnapshot(childNode,serverValues);if(newChildNode!==childNode){newNode=newNode.updateImmediateChild(childName,newChildNode)}});return newNode}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Path_1=__webpack_require__(2);var PriorityIndex_1=__webpack_require__(4);var CountedSet_1=__webpack_require__(78);var SparseSnapshotTree=function(){function SparseSnapshotTree(){this.value_=null;this.children_=null}SparseSnapshotTree.prototype.find=function(path){if(this.value_!=null){return this.value_.getChild(path)}else if(!path.isEmpty()&&this.children_!=null){var childKey=path.getFront();path=path.popFront();if(this.children_.contains(childKey)){var childTree=this.children_.get(childKey);return childTree.find(path)}else{return null}}else{return null}};SparseSnapshotTree.prototype.remember=function(path,data){if(path.isEmpty()){this.value_=data;this.children_=null}else if(this.value_!==null){this.value_=this.value_.updateChild(path,data)}else{if(this.children_==null){this.children_=new CountedSet_1.CountedSet}var childKey=path.getFront();if(!this.children_.contains(childKey)){this.children_.add(childKey,new SparseSnapshotTree)}var child=this.children_.get(childKey);path=path.popFront();child.remember(path,data)}};SparseSnapshotTree.prototype.forget=function(path){if(path.isEmpty()){this.value_=null;this.children_=null;return true}else{if(this.value_!==null){if(this.value_.isLeafNode()){return false}else{var value=this.value_;this.value_=null;var self_1=this;value.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,tree){self_1.remember(new Path_1.Path(key),tree)});return this.forget(path)}}else if(this.children_!==null){var childKey=path.getFront();path=path.popFront();if(this.children_.contains(childKey)){var safeToRemove=this.children_.get(childKey).forget(path);if(safeToRemove){this.children_.remove(childKey)}}if(this.children_.isEmpty()){this.children_=null;return true}else{return false}}else{return true}}};SparseSnapshotTree.prototype.forEachTree=function(prefixPath,func){if(this.value_!==null){func(prefixPath,this.value_)}else{this.forEachChild(function(key,tree){var path=new Path_1.Path(prefixPath.toString()+"/"+key);tree.forEachTree(path,func)})}};SparseSnapshotTree.prototype.forEachChild=function(func){if(this.children_!==null){this.children_.each(function(key,tree){func(key,tree)})}};return SparseSnapshotTree}();exports.SparseSnapshotTree=SparseSnapshotTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var CountedSet=function(){function CountedSet(){this.set={}}CountedSet.prototype.add=function(item,val){this.set[item]=val!==null?val:true};CountedSet.prototype.contains=function(key){return util_1.contains(this.set,key)};CountedSet.prototype.get=function(item){return this.contains(item)?this.set[item]:undefined};CountedSet.prototype.remove=function(item){delete this.set[item]};CountedSet.prototype.clear=function(){this.set={}};CountedSet.prototype.isEmpty=function(){return util_1.isEmpty(this.set)};CountedSet.prototype.count=function(){return util_1.getCount(this.set)};CountedSet.prototype.each=function(fn){util_1.forEach(this.set,function(k,v){return fn(k,v)})};CountedSet.prototype.keys=function(){var keys=[];util_1.forEach(this.set,function(k){keys.push(k)});return keys};return CountedSet}();exports.CountedSet=CountedSet},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Operation_1=__webpack_require__(13);var Path_1=__webpack_require__(2);var Overwrite=function(){function Overwrite(source,path,snap){this.source=source;this.path=path;this.snap=snap;this.type=Operation_1.OperationType.OVERWRITE}Overwrite.prototype.operationForChild=function(childName){if(this.path.isEmpty()){return new Overwrite(this.source,Path_1.Path.Empty,this.snap.getImmediateChild(childName))}else{return new Overwrite(this.source,this.path.popFront(),this.snap)}};return Overwrite}();exports.Overwrite=Overwrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var CacheNode_1=__webpack_require__(32);var ChildrenNode_1=__webpack_require__(5);var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var ViewCache_1=__webpack_require__(81);var View_1=__webpack_require__(157);var __referenceConstructor;var SyncPoint=function(){function SyncPoint(){this.views_={}}Object.defineProperty(SyncPoint,"__referenceConstructor",{get:function(){util_1.assert(__referenceConstructor,"Reference.ts has not been loaded");return __referenceConstructor},set:function(val){util_1.assert(!__referenceConstructor,"__referenceConstructor has already been defined");__referenceConstructor=val},enumerable:true,configurable:true});SyncPoint.prototype.isEmpty=function(){return util_2.isEmpty(this.views_)};SyncPoint.prototype.applyOperation=function(operation,writesCache,optCompleteServerCache){var queryId=operation.source.queryId;if(queryId!==null){var view=util_2.safeGet(this.views_,queryId);util_1.assert(view!=null,"SyncTree gave us an op for an invalid query.");return view.applyOperation(operation,writesCache,optCompleteServerCache)}else{var events_1=[];util_2.forEach(this.views_,function(key,view){events_1=events_1.concat(view.applyOperation(operation,writesCache,optCompleteServerCache))});return events_1}};SyncPoint.prototype.addEventRegistration=function(query,eventRegistration,writesCache,serverCache,serverCacheComplete){var queryId=query.queryIdentifier();var view=util_2.safeGet(this.views_,queryId);if(!view){var eventCache=writesCache.calcCompleteEventCache(serverCacheComplete?serverCache:null);var eventCacheComplete=false;if(eventCache){eventCacheComplete=true}else if(serverCache instanceof ChildrenNode_1.ChildrenNode){eventCache=writesCache.calcCompleteEventChildren(serverCache);eventCacheComplete=false}else{eventCache=ChildrenNode_1.ChildrenNode.EMPTY_NODE;eventCacheComplete=false}var viewCache=new ViewCache_1.ViewCache(new CacheNode_1.CacheNode(eventCache,eventCacheComplete,false),new CacheNode_1.CacheNode(serverCache,serverCacheComplete,false));view=new View_1.View(query,viewCache);this.views_[queryId]=view}view.addEventRegistration(eventRegistration);return view.getInitialEvents(eventRegistration)};SyncPoint.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var queryId=query.queryIdentifier();var removed=[];var cancelEvents=[];var hadCompleteView=this.hasCompleteView();if(queryId==="default"){var self_1=this;util_2.forEach(this.views_,function(viewQueryId,view){cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError));if(view.isEmpty()){delete self_1.views_[viewQueryId];if(!view.getQuery().getQueryParams().loadsAllData()){removed.push(view.getQuery())}}})}else{var view=util_2.safeGet(this.views_,queryId);if(view){cancelEvents=cancelEvents.concat(view.removeEventRegistration(eventRegistration,cancelError));if(view.isEmpty()){delete this.views_[queryId];if(!view.getQuery().getQueryParams().loadsAllData()){removed.push(view.getQuery())}}}}if(hadCompleteView&&!this.hasCompleteView()){removed.push(new SyncPoint.__referenceConstructor(query.repo,query.path))}return{removed:removed,events:cancelEvents}};SyncPoint.prototype.getQueryViews=function(){var _this=this;var values=Object.keys(this.views_).map(function(key){return _this.views_[key]});return values.filter(function(view){return!view.getQuery().getQueryParams().loadsAllData()})};SyncPoint.prototype.getCompleteServerCache=function(path){var serverCache=null;util_2.forEach(this.views_,function(key,view){serverCache=serverCache||view.getCompleteServerCache(path)});return serverCache};SyncPoint.prototype.viewForQuery=function(query){var params=query.getQueryParams();if(params.loadsAllData()){return this.getCompleteView()}else{var queryId=query.queryIdentifier();return util_2.safeGet(this.views_,queryId)}};SyncPoint.prototype.viewExistsForQuery=function(query){return this.viewForQuery(query)!=null};SyncPoint.prototype.hasCompleteView=function(){return this.getCompleteView()!=null};SyncPoint.prototype.getCompleteView=function(){var completeView=util_2.findValue(this.views_,function(view){return view.getQuery().getQueryParams().loadsAllData()});return completeView||null};return SyncPoint}();exports.SyncPoint=SyncPoint},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ChildrenNode_1=__webpack_require__(5);var CacheNode_1=__webpack_require__(32);var ViewCache=function(){function ViewCache(eventCache_,serverCache_){this.eventCache_=eventCache_;this.serverCache_=serverCache_}ViewCache.prototype.updateEventSnap=function(eventSnap,complete,filtered){return new ViewCache(new CacheNode_1.CacheNode(eventSnap,complete,filtered),this.serverCache_)};ViewCache.prototype.updateServerSnap=function(serverSnap,complete,filtered){return new ViewCache(this.eventCache_,new CacheNode_1.CacheNode(serverSnap,complete,filtered))};ViewCache.prototype.getEventCache=function(){return this.eventCache_};ViewCache.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null};ViewCache.prototype.getServerCache=function(){return this.serverCache_};ViewCache.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null};ViewCache.Empty=new ViewCache(new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,false,false),new CacheNode_1.CacheNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,false,false));return ViewCache}();exports.ViewCache=ViewCache},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var StatsListener=function(){function StatsListener(collection_){this.collection_=collection_;this.last_=null}StatsListener.prototype.get=function(){var newStats=this.collection_.get();var delta=util_1.clone(newStats);if(this.last_){util_1.forEach(this.last_,function(stat,value){delta[stat]=delta[stat]-value})}this.last_=newStats;return delta};return StatsListener}();exports.StatsListener=StatsListener},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var app_1=__webpack_require__(10);var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var util_3=__webpack_require__(0);var util_4=__webpack_require__(1);var Path_1=__webpack_require__(2);var VisibilityMonitor_1=__webpack_require__(169);var OnlineMonitor_1=__webpack_require__(170);var util_5=__webpack_require__(0);var Connection_1=__webpack_require__(85);var util_6=__webpack_require__(0);var util_7=__webpack_require__(0);var ServerActions_1=__webpack_require__(88);var RECONNECT_MIN_DELAY=1e3;var RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3;var RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3;var RECONNECT_DELAY_MULTIPLIER=1.3;var RECONNECT_DELAY_RESET_TIMEOUT=3e4;var SERVER_KILL_INTERRUPT_REASON="server_kill";var INVALID_AUTH_TOKEN_THRESHOLD=3;var PersistentConnection=function(_super){__extends(PersistentConnection,_super);function PersistentConnection(repoInfo_,onDataUpdate_,onConnectStatus_,onServerInfoUpdate_,authTokenProvider_,authOverride_){var _this=_super.call(this)||this;_this.repoInfo_=repoInfo_;_this.onDataUpdate_=onDataUpdate_;_this.onConnectStatus_=onConnectStatus_;_this.onServerInfoUpdate_=onServerInfoUpdate_;_this.authTokenProvider_=authTokenProvider_;_this.authOverride_=authOverride_;_this.id=PersistentConnection.nextPersistentConnectionId_++;_this.log_=util_4.logWrapper("p:"+_this.id+":");_this.interruptReasons_={};_this.listens_={};_this.outstandingPuts_=[];_this.outstandingPutCount_=0;_this.onDisconnectRequestQueue_=[];_this.connected_=false;_this.reconnectDelay_=RECONNECT_MIN_DELAY;_this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT;_this.securityDebugCallback_=null;_this.lastSessionId=null;_this.establishConnectionTimer_=null;_this.visible_=false;_this.requestCBHash_={};_this.requestNumber_=0;_this.realtime_=null;_this.authToken_=null;_this.forceTokenRefresh_=false;_this.invalidAuthTokenCount_=0;_this.firstConnection_=true;_this.lastConnectionAttemptTime_=null;_this.lastConnectionEstablishedTime_=null;if(authOverride_&&!util_7.isNodeSdk()){throw new Error("Auth override specified in options, but not supported on non Node.js platforms")}_this.scheduleConnect_(0);VisibilityMonitor_1.VisibilityMonitor.getInstance().on("visible",_this.onVisible_,_this);if(repoInfo_.host.indexOf("fblocal")===-1){OnlineMonitor_1.OnlineMonitor.getInstance().on("online",_this.onOnline_,_this)}return _this}PersistentConnection.prototype.sendRequest=function(action,body,onResponse){var curReqNum=++this.requestNumber_;var msg={r:curReqNum,a:action,b:body};this.log_(util_2.stringify(msg));util_3.assert(this.connected_,"sendRequest call when we're not connected not allowed.");this.realtime_.sendRequest(msg);if(onResponse){this.requestCBHash_[curReqNum]=onResponse}};PersistentConnection.prototype.listen=function(query,currentHashFn,tag,onComplete){var queryId=query.queryIdentifier();var pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+queryId);this.listens_[pathString]=this.listens_[pathString]||{};util_3.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"listen() called for non-default but complete query");util_3.assert(!this.listens_[pathString][queryId],"listen() called twice for same path/queryId.");var listenSpec={onComplete:onComplete,hashFn:currentHashFn,query:query,tag:tag};this.listens_[pathString][queryId]=listenSpec;if(this.connected_){this.sendListen_(listenSpec)}};PersistentConnection.prototype.sendListen_=function(listenSpec){var _this=this;var query=listenSpec.query;var pathString=query.path.toString();var queryId=query.queryIdentifier();this.log_("Listen on "+pathString+" for "+queryId);var req={p:pathString};var action="q";if(listenSpec.tag){req["q"]=query.queryObject();req["t"]=listenSpec.tag}req["h"]=listenSpec.hashFn();this.sendRequest(action,req,function(message){var payload=message["d"];var status=message["s"]
;PersistentConnection.warnOnListenWarnings_(payload,query);var currentListenSpec=_this.listens_[pathString]&&_this.listens_[pathString][queryId];if(currentListenSpec===listenSpec){_this.log_("listen response",message);if(status!=="ok"){_this.removeListen_(pathString,queryId)}if(listenSpec.onComplete){listenSpec.onComplete(status,payload)}}})};PersistentConnection.warnOnListenWarnings_=function(payload,query){if(payload&&typeof payload==="object"&&util_1.contains(payload,"w")){var warnings=util_1.safeGet(payload,"w");if(Array.isArray(warnings)&&~warnings.indexOf("no_index")){var indexSpec='".indexOn": "'+query.getQueryParams().getIndex().toString()+'"';var indexPath=query.path.toString();util_4.warn("Using an unspecified index. Your data will be downloaded and "+("filtered on the client. Consider adding "+indexSpec+" at ")+(indexPath+" to your security rules for better performance."))}}};PersistentConnection.prototype.refreshAuthToken=function(token){this.authToken_=token;this.log_("Auth token refreshed");if(this.authToken_){this.tryAuth()}else{if(this.connected_){this.sendRequest("unauth",{},function(){})}}this.reduceReconnectDelayIfAdminCredential_(token)};PersistentConnection.prototype.reduceReconnectDelayIfAdminCredential_=function(credential){var isFirebaseSecret=credential&&credential.length===40;if(isFirebaseSecret||util_5.isAdmin(credential)){this.log_("Admin auth credential detected.  Reducing max reconnect time.");this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS}};PersistentConnection.prototype.tryAuth=function(){var _this=this;if(this.connected_&&this.authToken_){var token_1=this.authToken_;var authMethod=util_5.isValidFormat(token_1)?"auth":"gauth";var requestData={cred:token_1};if(this.authOverride_===null){requestData["noauth"]=true}else if(typeof this.authOverride_==="object"){requestData["authvar"]=this.authOverride_}this.sendRequest(authMethod,requestData,function(res){var status=res["s"];var data=res["d"]||"error";if(_this.authToken_===token_1){if(status==="ok"){_this.invalidAuthTokenCount_=0}else{_this.onAuthRevoked_(status,data)}}})}};PersistentConnection.prototype.unlisten=function(query,tag){var pathString=query.path.toString();var queryId=query.queryIdentifier();this.log_("Unlisten called for "+pathString+" "+queryId);util_3.assert(query.getQueryParams().isDefault()||!query.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query");var listen=this.removeListen_(pathString,queryId);if(listen&&this.connected_){this.sendUnlisten_(pathString,queryId,query.queryObject(),tag)}};PersistentConnection.prototype.sendUnlisten_=function(pathString,queryId,queryObj,tag){this.log_("Unlisten on "+pathString+" for "+queryId);var req={p:pathString};var action="n";if(tag){req["q"]=queryObj;req["t"]=tag}this.sendRequest(action,req)};PersistentConnection.prototype.onDisconnectPut=function(pathString,data,onComplete){if(this.connected_){this.sendOnDisconnect_("o",pathString,data,onComplete)}else{this.onDisconnectRequestQueue_.push({pathString:pathString,action:"o",data:data,onComplete:onComplete})}};PersistentConnection.prototype.onDisconnectMerge=function(pathString,data,onComplete){if(this.connected_){this.sendOnDisconnect_("om",pathString,data,onComplete)}else{this.onDisconnectRequestQueue_.push({pathString:pathString,action:"om",data:data,onComplete:onComplete})}};PersistentConnection.prototype.onDisconnectCancel=function(pathString,onComplete){if(this.connected_){this.sendOnDisconnect_("oc",pathString,null,onComplete)}else{this.onDisconnectRequestQueue_.push({pathString:pathString,action:"oc",data:null,onComplete:onComplete})}};PersistentConnection.prototype.sendOnDisconnect_=function(action,pathString,data,onComplete){var request={p:pathString,d:data};this.log_("onDisconnect "+action,request);this.sendRequest(action,request,function(response){if(onComplete){setTimeout(function(){onComplete(response["s"],response["d"])},Math.floor(0))}})};PersistentConnection.prototype.put=function(pathString,data,onComplete,hash){this.putInternal("p",pathString,data,onComplete,hash)};PersistentConnection.prototype.merge=function(pathString,data,onComplete,hash){this.putInternal("m",pathString,data,onComplete,hash)};PersistentConnection.prototype.putInternal=function(action,pathString,data,onComplete,hash){var request={p:pathString,d:data};if(hash!==undefined)request["h"]=hash;this.outstandingPuts_.push({action:action,request:request,onComplete:onComplete});this.outstandingPutCount_++;var index=this.outstandingPuts_.length-1;if(this.connected_){this.sendPut_(index)}else{this.log_("Buffering put: "+pathString)}};PersistentConnection.prototype.sendPut_=function(index){var _this=this;var action=this.outstandingPuts_[index].action;var request=this.outstandingPuts_[index].request;var onComplete=this.outstandingPuts_[index].onComplete;this.outstandingPuts_[index].queued=this.connected_;this.sendRequest(action,request,function(message){_this.log_(action+" response",message);delete _this.outstandingPuts_[index];_this.outstandingPutCount_--;if(_this.outstandingPutCount_===0){_this.outstandingPuts_=[]}if(onComplete)onComplete(message["s"],message["d"])})};PersistentConnection.prototype.reportStats=function(stats){var _this=this;if(this.connected_){var request={c:stats};this.log_("reportStats",request);this.sendRequest("s",request,function(result){var status=result["s"];if(status!=="ok"){var errorReason=result["d"];_this.log_("reportStats","Error sending stats: "+errorReason)}})}};PersistentConnection.prototype.onDataMessage_=function(message){if("r"in message){this.log_("from server: "+util_2.stringify(message));var reqNum=message["r"];var onResponse=this.requestCBHash_[reqNum];if(onResponse){delete this.requestCBHash_[reqNum];onResponse(message["b"])}}else if("error"in message){throw"A server-side error has occurred: "+message["error"]}else if("a"in message){this.onDataPush_(message["a"],message["b"])}};PersistentConnection.prototype.onDataPush_=function(action,body){this.log_("handleServerMessage",action,body);if(action==="d")this.onDataUpdate_(body["p"],body["d"],false,body["t"]);else if(action==="m")this.onDataUpdate_(body["p"],body["d"],true,body["t"]);else if(action==="c")this.onListenRevoked_(body["p"],body["q"]);else if(action==="ac")this.onAuthRevoked_(body["s"],body["d"]);else if(action==="sd")this.onSecurityDebugPacket_(body);else util_4.error("Unrecognized action received from server: "+util_2.stringify(action)+"\nAre you using the latest client?")};PersistentConnection.prototype.onReady_=function(timestamp,sessionId){this.log_("connection ready");this.connected_=true;this.lastConnectionEstablishedTime_=(new Date).getTime();this.handleTimestamp_(timestamp);this.lastSessionId=sessionId;if(this.firstConnection_){this.sendConnectStats_()}this.restoreState_();this.firstConnection_=false;this.onConnectStatus_(true)};PersistentConnection.prototype.scheduleConnect_=function(timeout){var _this=this;util_3.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?");if(this.establishConnectionTimer_){clearTimeout(this.establishConnectionTimer_)}this.establishConnectionTimer_=setTimeout(function(){_this.establishConnectionTimer_=null;_this.establishConnection_()},Math.floor(timeout))};PersistentConnection.prototype.onVisible_=function(visible){if(visible&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_){this.log_("Window became visible.  Reducing delay.");this.reconnectDelay_=RECONNECT_MIN_DELAY;if(!this.realtime_){this.scheduleConnect_(0)}}this.visible_=visible};PersistentConnection.prototype.onOnline_=function(online){if(online){this.log_("Browser went online.");this.reconnectDelay_=RECONNECT_MIN_DELAY;if(!this.realtime_){this.scheduleConnect_(0)}}else{this.log_("Browser went offline.  Killing connection.");if(this.realtime_){this.realtime_.close()}}};PersistentConnection.prototype.onRealtimeDisconnect_=function(){this.log_("data client disconnected");this.connected_=false;this.realtime_=null;this.cancelSentTransactions_();this.requestCBHash_={};if(this.shouldReconnect_()){if(!this.visible_){this.log_("Window isn't visible.  Delaying reconnect.");this.reconnectDelay_=this.maxReconnectDelay_;this.lastConnectionAttemptTime_=(new Date).getTime()}else if(this.lastConnectionEstablishedTime_){var timeSinceLastConnectSucceeded=(new Date).getTime()-this.lastConnectionEstablishedTime_;if(timeSinceLastConnectSucceeded>RECONNECT_DELAY_RESET_TIMEOUT)this.reconnectDelay_=RECONNECT_MIN_DELAY;this.lastConnectionEstablishedTime_=null}var timeSinceLastConnectAttempt=(new Date).getTime()-this.lastConnectionAttemptTime_;var reconnectDelay=Math.max(0,this.reconnectDelay_-timeSinceLastConnectAttempt);reconnectDelay=Math.random()*reconnectDelay;this.log_("Trying to reconnect in "+reconnectDelay+"ms");this.scheduleConnect_(reconnectDelay);this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(false)};PersistentConnection.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt");this.lastConnectionAttemptTime_=(new Date).getTime();this.lastConnectionEstablishedTime_=null;var onDataMessage_1=this.onDataMessage_.bind(this);var onReady_1=this.onReady_.bind(this);var onDisconnect_1=this.onRealtimeDisconnect_.bind(this);var connId_1=this.id+":"+PersistentConnection.nextConnectionId_++;var self_1=this;var lastSessionId_1=this.lastSessionId;var canceled_1=false;var connection_1=null;var closeFn_1=function(){if(connection_1){connection_1.close()}else{canceled_1=true;onDisconnect_1()}};var sendRequestFn=function(msg){util_3.assert(connection_1,"sendRequest call when we're not connected not allowed.");connection_1.sendRequest(msg)};this.realtime_={close:closeFn_1,sendRequest:sendRequestFn};var forceRefresh=this.forceTokenRefresh_;this.forceTokenRefresh_=false;this.authTokenProvider_.getToken(forceRefresh).then(function(result){if(!canceled_1){util_4.log("getToken() completed. Creating connection.");self_1.authToken_=result&&result.accessToken;connection_1=new Connection_1.Connection(connId_1,self_1.repoInfo_,onDataMessage_1,onReady_1,onDisconnect_1,function(reason){util_4.warn(reason+" ("+self_1.repoInfo_.toString()+")");self_1.interrupt(SERVER_KILL_INTERRUPT_REASON)},lastSessionId_1)}else{util_4.log("getToken() completed but was canceled")}}).then(null,function(error){self_1.log_("Failed to get token: "+error);if(!canceled_1){if(util_6.CONSTANTS.NODE_ADMIN){util_4.warn(error)}closeFn_1()}})}};PersistentConnection.prototype.interrupt=function(reason){util_4.log("Interrupting connection for reason: "+reason);this.interruptReasons_[reason]=true;if(this.realtime_){this.realtime_.close()}else{if(this.establishConnectionTimer_){clearTimeout(this.establishConnectionTimer_);this.establishConnectionTimer_=null}if(this.connected_){this.onRealtimeDisconnect_()}}};PersistentConnection.prototype.resume=function(reason){util_4.log("Resuming connection for reason: "+reason);delete this.interruptReasons_[reason];if(util_1.isEmpty(this.interruptReasons_)){this.reconnectDelay_=RECONNECT_MIN_DELAY;if(!this.realtime_){this.scheduleConnect_(0)}}};PersistentConnection.prototype.handleTimestamp_=function(timestamp){var delta=timestamp-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:delta})};PersistentConnection.prototype.cancelSentTransactions_=function(){for(var i=0;i<this.outstandingPuts_.length;i++){var put=this.outstandingPuts_[i];if(put&&"h"in put.request&&put.queued){if(put.onComplete)put.onComplete("disconnect");delete this.outstandingPuts_[i];this.outstandingPutCount_--}}if(this.outstandingPutCount_===0)this.outstandingPuts_=[]};PersistentConnection.prototype.onListenRevoked_=function(pathString,query){var queryId;if(!query){queryId="default"}else{queryId=query.map(function(q){return util_4.ObjectToUniqueKey(q)}).join("$")}var listen=this.removeListen_(pathString,queryId);if(listen&&listen.onComplete)listen.onComplete("permission_denied")};PersistentConnection.prototype.removeListen_=function(pathString,queryId){var normalizedPathString=new Path_1.Path(pathString).toString();var listen;if(this.listens_[normalizedPathString]!==undefined){listen=this.listens_[normalizedPathString][queryId];delete this.listens_[normalizedPathString][queryId];if(util_1.getCount(this.listens_[normalizedPathString])===0){delete this.listens_[normalizedPathString]}}else{listen=undefined}return listen};PersistentConnection.prototype.onAuthRevoked_=function(statusCode,explanation){util_4.log("Auth token revoked: "+statusCode+"/"+explanation);this.authToken_=null;this.forceTokenRefresh_=true;this.realtime_.close();if(statusCode==="invalid_token"||statusCode==="permission_denied"){this.invalidAuthTokenCount_++;if(this.invalidAuthTokenCount_>=INVALID_AUTH_TOKEN_THRESHOLD){this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS;this.authTokenProvider_.notifyForInvalidToken()}}};PersistentConnection.prototype.onSecurityDebugPacket_=function(body){if(this.securityDebugCallback_){this.securityDebugCallback_(body)}else{if("msg"in body&&typeof console!=="undefined"){console.log("FIREBASE: "+body["msg"].replace("\n","\nFIREBASE: "))}}};PersistentConnection.prototype.restoreState_=function(){var _this=this;this.tryAuth();util_1.forEach(this.listens_,function(pathString,queries){util_1.forEach(queries,function(key,listenSpec){_this.sendListen_(listenSpec)})});for(var i=0;i<this.outstandingPuts_.length;i++){if(this.outstandingPuts_[i])this.sendPut_(i)}while(this.onDisconnectRequestQueue_.length){var request=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(request.action,request.pathString,request.data,request.onComplete)}};PersistentConnection.prototype.sendConnectStats_=function(){var stats={};var clientName="js";if(util_6.CONSTANTS.NODE_ADMIN){clientName="admin_node"}else if(util_6.CONSTANTS.NODE_CLIENT){clientName="node"}stats["sdk."+clientName+"."+app_1.default.SDK_VERSION.replace(/\./g,"-")]=1;if(util_7.isMobileCordova()){stats["framework.cordova"]=1}else if(util_7.isReactNative()){stats["framework.reactnative"]=1}this.reportStats(stats)};PersistentConnection.prototype.shouldReconnect_=function(){var online=OnlineMonitor_1.OnlineMonitor.getInstance().currentlyOnline();return util_1.isEmpty(this.interruptReasons_)&&online};PersistentConnection.nextPersistentConnectionId_=0;PersistentConnection.nextConnectionId_=0;return PersistentConnection}(ServerActions_1.ServerActions);exports.PersistentConnection=PersistentConnection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var EventEmitter=function(){function EventEmitter(allowedEvents_){this.allowedEvents_=allowedEvents_;this.listeners_={};util_1.assert(Array.isArray(allowedEvents_)&&allowedEvents_.length>0,"Requires a non-empty array")}EventEmitter.prototype.trigger=function(eventType){var var_args=[];for(var _i=1;_i<arguments.length;_i++){var_args[_i-1]=arguments[_i]}if(Array.isArray(this.listeners_[eventType])){var listeners=this.listeners_[eventType].slice();for(var i=0;i<listeners.length;i++){listeners[i].callback.apply(listeners[i].context,var_args)}}};EventEmitter.prototype.on=function(eventType,callback,context){this.validateEventType_(eventType);this.listeners_[eventType]=this.listeners_[eventType]||[];this.listeners_[eventType].push({callback:callback,context:context});var eventData=this.getInitialEvent(eventType);if(eventData){callback.apply(context,eventData)}};EventEmitter.prototype.off=function(eventType,callback,context){this.validateEventType_(eventType);var listeners=this.listeners_[eventType]||[];for(var i=0;i<listeners.length;i++){if(listeners[i].callback===callback&&(!context||context===listeners[i].context)){listeners.splice(i,1);return}}};EventEmitter.prototype.validateEventType_=function(eventType){util_1.assert(this.allowedEvents_.find(function(et){return et===eventType}),"Unknown event: "+eventType)};return EventEmitter}();exports.EventEmitter=EventEmitter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var storage_1=__webpack_require__(26);var Constants_1=__webpack_require__(27);var TransportManager_1=__webpack_require__(171);var UPGRADE_TIMEOUT=6e4;var DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3;var BYTES_SENT_HEALTHY_OVERRIDE=10*1024;var BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024;var MESSAGE_TYPE="t";var MESSAGE_DATA="d";var CONTROL_SHUTDOWN="s";var CONTROL_RESET="r";var CONTROL_ERROR="e";var CONTROL_PONG="o";var SWITCH_ACK="a";var END_TRANSMISSION="n";var PING="p";var SERVER_HELLO="h";var Connection=function(){function Connection(id,repoInfo_,onMessage_,onReady_,onDisconnect_,onKill_,lastSessionId){this.id=id;this.repoInfo_=repoInfo_;this.onMessage_=onMessage_;this.onReady_=onReady_;this.onDisconnect_=onDisconnect_;this.onKill_=onKill_;this.lastSessionId=lastSessionId;this.connectionCount=0;this.pendingDataMessages=[];this.state_=0;this.log_=util_1.logWrapper("c:"+this.id+":");this.transportManager_=new TransportManager_1.TransportManager(repoInfo_);this.log_("Connection created");this.start_()}Connection.prototype.start_=function(){var _this=this;var conn=this.transportManager_.initialTransport();this.conn_=new conn(this.nextTransportId_(),this.repoInfo_,undefined,this.lastSessionId);this.primaryResponsesRequired_=conn["responsesRequiredToBeHealthy"]||0;var onMessageReceived=this.connReceiver_(this.conn_);var onConnectionLost=this.disconnReceiver_(this.conn_);this.tx_=this.conn_;this.rx_=this.conn_;this.secondaryConn_=null;this.isHealthy_=false;setTimeout(function(){_this.conn_&&_this.conn_.open(onMessageReceived,onConnectionLost)},Math.floor(0));var healthyTimeout_ms=conn["healthyTimeout"]||0;if(healthyTimeout_ms>0){this.healthyTimeout_=util_1.setTimeoutNonBlocking(function(){_this.healthyTimeout_=null;if(!_this.isHealthy_){if(_this.conn_&&_this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE){_this.log_("Connection exceeded healthy timeout but has received "+_this.conn_.bytesReceived+" bytes.  Marking connection healthy.");_this.isHealthy_=true;_this.conn_.markConnectionHealthy()}else if(_this.conn_&&_this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE){_this.log_("Connection exceeded healthy timeout but has sent "+_this.conn_.bytesSent+" bytes.  Leaving connection alive.")}else{_this.log_("Closing unhealthy connection after timeout.");_this.close()}}},Math.floor(healthyTimeout_ms))}};Connection.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++};Connection.prototype.disconnReceiver_=function(conn){var _this=this;return function(everConnected){if(conn===_this.conn_){_this.onConnectionLost_(everConnected)}else if(conn===_this.secondaryConn_){_this.log_("Secondary connection lost.");_this.onSecondaryConnectionLost_()}else{_this.log_("closing an old connection")}}};Connection.prototype.connReceiver_=function(conn){var _this=this;return function(message){if(_this.state_!=2){if(conn===_this.rx_){_this.onPrimaryMessageReceived_(message)}else if(conn===_this.secondaryConn_){_this.onSecondaryMessageReceived_(message)}else{_this.log_("message on old connection")}}}};Connection.prototype.sendRequest=function(dataMsg){var msg={t:"d",d:dataMsg};this.sendData_(msg)};Connection.prototype.tryCleanupConnection=function(){if(this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_){this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId);this.conn_=this.secondaryConn_;this.secondaryConn_=null}};Connection.prototype.onSecondaryControl_=function(controlData){if(MESSAGE_TYPE in controlData){var cmd=controlData[MESSAGE_TYPE];if(cmd===SWITCH_ACK){this.upgradeIfSecondaryHealthy_()}else if(cmd===CONTROL_RESET){this.log_("Got a reset on secondary, closing it");this.secondaryConn_.close();if(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_){this.close()}}else if(cmd===CONTROL_PONG){this.log_("got pong on secondary.");this.secondaryResponsesRequired_--;this.upgradeIfSecondaryHealthy_()}}};Connection.prototype.onSecondaryMessageReceived_=function(parsedData){var layer=util_1.requireKey("t",parsedData);var data=util_1.requireKey("d",parsedData);if(layer=="c"){this.onSecondaryControl_(data)}else if(layer=="d"){this.pendingDataMessages.push(data)}else{throw new Error("Unknown protocol layer: "+layer)}};Connection.prototype.upgradeIfSecondaryHealthy_=function(){if(this.secondaryResponsesRequired_<=0){this.log_("Secondary connection is healthy.");this.isHealthy_=true;this.secondaryConn_.markConnectionHealthy();this.proceedWithUpgrade_()}else{this.log_("sending ping on secondary.");this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}})}};Connection.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start();this.log_("sending client ack on secondary");this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}});this.log_("Ending transmission on primary");this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}});this.tx_=this.secondaryConn_;this.tryCleanupConnection()};Connection.prototype.onPrimaryMessageReceived_=function(parsedData){var layer=util_1.requireKey("t",parsedData);var data=util_1.requireKey("d",parsedData);if(layer=="c"){this.onControl_(data)}else if(layer=="d"){this.onDataMessage_(data)}};Connection.prototype.onDataMessage_=function(message){this.onPrimaryResponse_();this.onMessage_(message)};Connection.prototype.onPrimaryResponse_=function(){if(!this.isHealthy_){this.primaryResponsesRequired_--;if(this.primaryResponsesRequired_<=0){this.log_("Primary connection is healthy.");this.isHealthy_=true;this.conn_.markConnectionHealthy()}}};Connection.prototype.onControl_=function(controlData){var cmd=util_1.requireKey(MESSAGE_TYPE,controlData);if(MESSAGE_DATA in controlData){var payload=controlData[MESSAGE_DATA];if(cmd===SERVER_HELLO){this.onHandshake_(payload)}else if(cmd===END_TRANSMISSION){this.log_("recvd end transmission on primary");this.rx_=this.secondaryConn_;for(var i=0;i<this.pendingDataMessages.length;++i){this.onDataMessage_(this.pendingDataMessages[i])}this.pendingDataMessages=[];this.tryCleanupConnection()}else if(cmd===CONTROL_SHUTDOWN){this.onConnectionShutdown_(payload)}else if(cmd===CONTROL_RESET){this.onReset_(payload)}else if(cmd===CONTROL_ERROR){util_1.error("Server Error: "+payload)}else if(cmd===CONTROL_PONG){this.log_("got pong on primary.");this.onPrimaryResponse_();this.sendPingOnPrimaryIfNecessary_()}else{util_1.error("Unknown control packet command: "+cmd)}}};Connection.prototype.onHandshake_=function(handshake){var timestamp=handshake.ts;var version=handshake.v;var host=handshake.h;this.sessionId=handshake.s;this.repoInfo_.updateHost(host);if(this.state_==0){this.conn_.start();this.onConnectionEstablished_(this.conn_,timestamp);if(Constants_1.PROTOCOL_VERSION!==version){util_1.warn("Protocol version mismatch detected")}this.tryStartUpgrade_()}};Connection.prototype.tryStartUpgrade_=function(){var conn=this.transportManager_.upgradeTransport();if(conn){this.startUpgrade_(conn)}};Connection.prototype.startUpgrade_=function(conn){var _this=this;this.secondaryConn_=new conn(this.nextTransportId_(),this.repoInfo_,this.sessionId);this.secondaryResponsesRequired_=conn["responsesRequiredToBeHealthy"]||0;var onMessage=this.connReceiver_(this.secondaryConn_);var onDisconnect=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(onMessage,onDisconnect);util_1.setTimeoutNonBlocking(function(){if(_this.secondaryConn_){_this.log_("Timed out trying to upgrade.");_this.secondaryConn_.close()}},Math.floor(UPGRADE_TIMEOUT))};Connection.prototype.onReset_=function(host){this.log_("Reset packet received.  New host: "+host);this.repoInfo_.updateHost(host);if(this.state_===1){this.close()}else{this.closeConnections_();this.start_()}};Connection.prototype.onConnectionEstablished_=function(conn,timestamp){var _this=this;this.log_("Realtime connection established.");this.conn_=conn;this.state_=1;if(this.onReady_){this.onReady_(timestamp,this.sessionId);this.onReady_=null}if(this.primaryResponsesRequired_===0){this.log_("Primary connection is healthy.");this.isHealthy_=true}else{util_1.setTimeoutNonBlocking(function(){_this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}};Connection.prototype.sendPingOnPrimaryIfNecessary_=function(){if(!this.isHealthy_&&this.state_===1){this.log_("sending ping on primary.");this.sendData_({t:"c",d:{t:PING,d:{}}})}};Connection.prototype.onSecondaryConnectionLost_=function(){var conn=this.secondaryConn_;this.secondaryConn_=null;if(this.tx_===conn||this.rx_===conn){this.close()}};Connection.prototype.onConnectionLost_=function(everConnected){this.conn_=null;if(!everConnected&&this.state_===0){this.log_("Realtime connection failed.");if(this.repoInfo_.isCacheableHost()){storage_1.PersistentStorage.remove("host:"+this.repoInfo_.host);this.repoInfo_.internalHost=this.repoInfo_.host}}else if(this.state_===1){this.log_("Realtime connection lost.")}this.close()};Connection.prototype.onConnectionShutdown_=function(reason){this.log_("Connection shutdown command received. Shutting down...");if(this.onKill_){this.onKill_(reason);this.onKill_=null}this.onDisconnect_=null;this.close()};Connection.prototype.sendData_=function(data){if(this.state_!==1){throw"Connection is not connected"}else{this.tx_.send(data)}};Connection.prototype.close=function(){if(this.state_!==2){this.log_("Closing realtime connection.");this.state_=2;this.closeConnections_();if(this.onDisconnect_){this.onDisconnect_();this.onDisconnect_=null}}};Connection.prototype.closeConnections_=function(){this.log_("Shutting down all connections");if(this.conn_){this.conn_.close();this.conn_=null}if(this.secondaryConn_){this.secondaryConn_.close();this.secondaryConn_=null}if(this.healthyTimeout_){clearTimeout(this.healthyTimeout_);this.healthyTimeout_=null}};return Connection}();exports.Connection=Connection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var CountedSet_1=__webpack_require__(78);var StatsManager_1=__webpack_require__(48);var PacketReceiver_1=__webpack_require__(172);var Constants_1=__webpack_require__(27);var util_2=__webpack_require__(0);var util_3=__webpack_require__(0);exports.FIREBASE_LONGPOLL_START_PARAM="start";exports.FIREBASE_LONGPOLL_CLOSE_COMMAND="close";exports.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand";exports.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB";exports.FIREBASE_LONGPOLL_ID_PARAM="id";exports.FIREBASE_LONGPOLL_PW_PARAM="pw";exports.FIREBASE_LONGPOLL_SERIAL_PARAM="ser";exports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb";exports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg";exports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts";exports.FIREBASE_LONGPOLL_DATA_PARAM="d";exports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn";exports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var MAX_URL_DATA_SIZE=1870;var SEG_HEADER_SIZE=30;var MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE;var KEEPALIVE_REQUEST_INTERVAL=25e3;var LP_CONNECT_TIMEOUT=3e4;var BrowserPollConnection=function(){function BrowserPollConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId;this.repoInfo=repoInfo;this.transportSessionId=transportSessionId;this.lastSessionId=lastSessionId;this.bytesSent=0;this.bytesReceived=0;this.everConnected_=false;this.log_=util_1.logWrapper(connId);this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo);this.urlFn=function(params){return repoInfo.connectionURL(Constants_1.LONG_POLLING,params)}}BrowserPollConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.curSegmentNum=0;this.onDisconnect_=onDisconnect;this.myPacketOrderer=new PacketReceiver_1.PacketReceiver(onMessage);this.isClosed_=false;this.connectTimeoutTimer_=setTimeout(function(){_this.log_("Timed out trying to connect.");_this.onClosed_();_this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT));util_1.executeWhenDOMReady(function(){if(_this.isClosed_)return;_this.scriptTagHolder=new FirebaseIFrameScriptHolder(function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var command=args[0],arg1=args[1],arg2=args[2],arg3=args[3],arg4=args[4];_this.incrementIncomingBytes_(args);if(!_this.scriptTagHolder)return;if(_this.connectTimeoutTimer_){clearTimeout(_this.connectTimeoutTimer_);_this.connectTimeoutTimer_=null}_this.everConnected_=true;if(command==exports.FIREBASE_LONGPOLL_START_PARAM){_this.id=arg1;_this.password=arg2}else if(command===exports.FIREBASE_LONGPOLL_CLOSE_COMMAND){if(arg1){_this.scriptTagHolder.sendNewPolls=false;_this.myPacketOrderer.closeAfter(arg1,function(){_this.onClosed_()})}else{_this.onClosed_()}}else{throw new Error("Unrecognized command received: "+command)}},function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var pN=args[0],data=args[1];_this.incrementIncomingBytes_(args);_this.myPacketOrderer.handleResponse(pN,data)},function(){_this.onClosed_()},_this.urlFn);var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_START_PARAM]="t";urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8);if(_this.scriptTagHolder.uniqueCallbackIdentifier)urlParams[exports.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=_this.scriptTagHolder.uniqueCallbackIdentifier;urlParams[Constants_1.VERSION_PARAM]=Constants_1.PROTOCOL_VERSION;if(_this.transportSessionId){urlParams[Constants_1.TRANSPORT_SESSION_PARAM]=_this.transportSessionId}if(_this.lastSessionId){urlParams[Constants_1.LAST_SESSION_PARAM]=_this.lastSessionId}if(!util_3.isNodeSdk()&&typeof location!=="undefined"&&location.href&&location.href.indexOf(Constants_1.FORGE_DOMAIN)!==-1){urlParams[Constants_1.REFERER_PARAM]=Constants_1.FORGE_REF}var connectURL=_this.urlFn(urlParams);_this.log_("Connecting via long-poll to "+connectURL);_this.scriptTagHolder.addTag(connectURL,function(){})})};BrowserPollConnection.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password);this.addDisconnectPingFrame(this.id,this.password)};BrowserPollConnection.forceAllow=function(){BrowserPollConnection.forceAllow_=true};BrowserPollConnection.forceDisallow=function(){BrowserPollConnection.forceDisallow_=true};BrowserPollConnection.isAvailable=function(){return BrowserPollConnection.forceAllow_||!BrowserPollConnection.forceDisallow_&&typeof document!=="undefined"&&document.createElement!=null&&!util_1.isChromeExtensionContentScript()&&!util_1.isWindowsStoreApp()&&!util_3.isNodeSdk()};BrowserPollConnection.prototype.markConnectionHealthy=function(){};BrowserPollConnection.prototype.shutdown_=function(){this.isClosed_=true;if(this.scriptTagHolder){this.scriptTagHolder.close();this.scriptTagHolder=null}if(this.myDisconnFrame){document.body.removeChild(this.myDisconnFrame);this.myDisconnFrame=null}if(this.connectTimeoutTimer_){clearTimeout(this.connectTimeoutTimer_);this.connectTimeoutTimer_=null}};BrowserPollConnection.prototype.onClosed_=function(){if(!this.isClosed_){this.log_("Longpoll is closing itself");this.shutdown_();if(this.onDisconnect_){this.onDisconnect_(this.everConnected_);this.onDisconnect_=null}}};BrowserPollConnection.prototype.close=function(){if(!this.isClosed_){this.log_("Longpoll is being closed.");this.shutdown_()}};BrowserPollConnection.prototype.send=function(data){var dataStr=util_2.stringify(data);this.bytesSent+=dataStr.length;this.stats_.incrementCounter("bytes_sent",dataStr.length);var base64data=util_2.base64Encode(dataStr);var dataSegs=util_1.splitStringBySize(base64data,MAX_PAYLOAD_SIZE);for(var i=0;i<dataSegs.length;i++){this.scriptTagHolder.enqueueSegment(this.curSegmentNum,dataSegs.length,dataSegs[i]);this.curSegmentNum++}};BrowserPollConnection.prototype.addDisconnectPingFrame=function(id,pw){if(util_3.isNodeSdk())return;this.myDisconnFrame=document.createElement("iframe");var urlParams={}
;urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t";urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=id;urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=pw;this.myDisconnFrame.src=this.urlFn(urlParams);this.myDisconnFrame.style.display="none";document.body.appendChild(this.myDisconnFrame)};BrowserPollConnection.prototype.incrementIncomingBytes_=function(args){var bytesReceived=util_2.stringify(args).length;this.bytesReceived+=bytesReceived;this.stats_.incrementCounter("bytes_received",bytesReceived)};return BrowserPollConnection}();exports.BrowserPollConnection=BrowserPollConnection;var FirebaseIFrameScriptHolder=function(){function FirebaseIFrameScriptHolder(commandCB,onMessageCB,onDisconnect,urlFn){this.onDisconnect=onDisconnect;this.urlFn=urlFn;this.outstandingRequests=new CountedSet_1.CountedSet;this.pendingSegs=[];this.currentSerial=Math.floor(Math.random()*1e8);this.sendNewPolls=true;if(!util_3.isNodeSdk()){this.uniqueCallbackIdentifier=util_1.LUIDGenerator();window[exports.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=commandCB;window[exports.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=onMessageCB;this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();var script="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,"javascript:".length)==="javascript:"){var currentDomain=document.domain;script='<script>document.domain="'+currentDomain+'";<\/script>'}var iframeContents="<html><body>"+script+"</body></html>";try{this.myIFrame.doc.open();this.myIFrame.doc.write(iframeContents);this.myIFrame.doc.close()}catch(e){util_1.log("frame writing exception");if(e.stack){util_1.log(e.stack)}util_1.log(e)}}else{this.commandCB=commandCB;this.onMessageCB=onMessageCB}}FirebaseIFrameScriptHolder.createIFrame_=function(){var iframe=document.createElement("iframe");iframe.style.display="none";if(document.body){document.body.appendChild(iframe);try{var a=iframe.contentWindow.document;if(!a){util_1.log("No IE domain setting required")}}catch(e){var domain=document.domain;iframe.src="javascript:void((function(){document.open();document.domain='"+domain+"';document.close();})())"}}else{throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready."}if(iframe.contentDocument){iframe.doc=iframe.contentDocument}else if(iframe.contentWindow){iframe.doc=iframe.contentWindow.document}else if(iframe.document){iframe.doc=iframe.document}return iframe};FirebaseIFrameScriptHolder.prototype.close=function(){var _this=this;this.alive=false;if(this.myIFrame){this.myIFrame.doc.body.innerHTML="";setTimeout(function(){if(_this.myIFrame!==null){document.body.removeChild(_this.myIFrame);_this.myIFrame=null}},Math.floor(0))}if(util_3.isNodeSdk()&&this.myID){var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t";urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=this.myID;urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var theURL=this.urlFn(urlParams);FirebaseIFrameScriptHolder.nodeRestRequest(theURL)}var onDisconnect=this.onDisconnect;if(onDisconnect){this.onDisconnect=null;onDisconnect()}};FirebaseIFrameScriptHolder.prototype.startLongPoll=function(id,pw){this.myID=id;this.myPW=pw;this.alive=true;while(this.newRequest_()){}};FirebaseIFrameScriptHolder.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var urlParams={};urlParams[exports.FIREBASE_LONGPOLL_ID_PARAM]=this.myID;urlParams[exports.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;urlParams[exports.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;var theURL=this.urlFn(urlParams);var curDataString="";var i=0;while(this.pendingSegs.length>0){var nextSeg=this.pendingSegs[0];if(nextSeg.d.length+SEG_HEADER_SIZE+curDataString.length<=MAX_URL_DATA_SIZE){var theSeg=this.pendingSegs.shift();curDataString=curDataString+"&"+exports.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+i+"="+theSeg.seg+"&"+exports.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+i+"="+theSeg.ts+"&"+exports.FIREBASE_LONGPOLL_DATA_PARAM+i+"="+theSeg.d;i++}else{break}}theURL=theURL+curDataString;this.addLongPollTag_(theURL,this.currentSerial);return true}else{return false}};FirebaseIFrameScriptHolder.prototype.enqueueSegment=function(segnum,totalsegs,data){this.pendingSegs.push({seg:segnum,ts:totalsegs,d:data});if(this.alive){this.newRequest_()}};FirebaseIFrameScriptHolder.prototype.addLongPollTag_=function(url,serial){var _this=this;this.outstandingRequests.add(serial,1);var doNewRequest=function(){_this.outstandingRequests.remove(serial);_this.newRequest_()};var keepaliveTimeout=setTimeout(doNewRequest,Math.floor(KEEPALIVE_REQUEST_INTERVAL));var readyStateCB=function(){clearTimeout(keepaliveTimeout);doNewRequest()};this.addTag(url,readyStateCB)};FirebaseIFrameScriptHolder.prototype.addTag=function(url,loadCB){var _this=this;if(util_3.isNodeSdk()){this.doNodeLongPoll(url,loadCB)}else{setTimeout(function(){try{if(!_this.sendNewPolls)return;var newScript_1=_this.myIFrame.doc.createElement("script");newScript_1.type="text/javascript";newScript_1.async=true;newScript_1.src=url;newScript_1.onload=newScript_1.onreadystatechange=function(){var rstate=newScript_1.readyState;if(!rstate||rstate==="loaded"||rstate==="complete"){newScript_1.onload=newScript_1.onreadystatechange=null;if(newScript_1.parentNode){newScript_1.parentNode.removeChild(newScript_1)}loadCB()}};newScript_1.onerror=function(){util_1.log("Long-poll script failed to load: "+url);_this.sendNewPolls=false;_this.close()};_this.myIFrame.doc.body.appendChild(newScript_1)}catch(e){}},Math.floor(1))}};return FirebaseIFrameScriptHolder}();exports.FirebaseIFrameScriptHolder=FirebaseIFrameScriptHolder},function(module,exports,__webpack_require__){"use strict";(function(process){Object.defineProperty(exports,"__esModule",{value:true});var app_1=__webpack_require__(10);var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var StatsManager_1=__webpack_require__(48);var Constants_1=__webpack_require__(27);var util_3=__webpack_require__(0);var storage_1=__webpack_require__(26);var util_4=__webpack_require__(0);var util_5=__webpack_require__(0);var WEBSOCKET_MAX_FRAME_SIZE=16384;var WEBSOCKET_KEEPALIVE_INTERVAL=45e3;var WebSocketImpl=null;if(typeof MozWebSocket!=="undefined"){WebSocketImpl=MozWebSocket}else if(typeof WebSocket!=="undefined"){WebSocketImpl=WebSocket}function setWebSocketImpl(impl){WebSocketImpl=impl}exports.setWebSocketImpl=setWebSocketImpl;var WebSocketConnection=function(){function WebSocketConnection(connId,repoInfo,transportSessionId,lastSessionId){this.connId=connId;this.keepaliveTimer=null;this.frames=null;this.totalFrames=0;this.bytesSent=0;this.bytesReceived=0;this.log_=util_2.logWrapper(this.connId);this.stats_=StatsManager_1.StatsManager.getCollection(repoInfo);this.connURL=WebSocketConnection.connectionURL_(repoInfo,transportSessionId,lastSessionId)}WebSocketConnection.connectionURL_=function(repoInfo,transportSessionId,lastSessionId){var urlParams={};urlParams[Constants_1.VERSION_PARAM]=Constants_1.PROTOCOL_VERSION;if(!util_5.isNodeSdk()&&typeof location!=="undefined"&&location.href&&location.href.indexOf(Constants_1.FORGE_DOMAIN)!==-1){urlParams[Constants_1.REFERER_PARAM]=Constants_1.FORGE_REF}if(transportSessionId){urlParams[Constants_1.TRANSPORT_SESSION_PARAM]=transportSessionId}if(lastSessionId){urlParams[Constants_1.LAST_SESSION_PARAM]=lastSessionId}return repoInfo.connectionURL(Constants_1.WEBSOCKET,urlParams)};WebSocketConnection.prototype.open=function(onMessage,onDisconnect){var _this=this;this.onDisconnect=onDisconnect;this.onMessage=onMessage;this.log_("Websocket connecting to "+this.connURL);this.everConnected_=false;storage_1.PersistentStorage.set("previous_websocket_failure",true);try{if(util_5.isNodeSdk()){var device=util_3.CONSTANTS.NODE_ADMIN?"AdminNode":"Node";var options={headers:{"User-Agent":"Firebase/"+Constants_1.PROTOCOL_VERSION+"/"+app_1.default.SDK_VERSION+"/"+process.platform+"/"+device}};var env=process["env"];var proxy=this.connURL.indexOf("wss://")==0?env["HTTPS_PROXY"]||env["https_proxy"]:env["HTTP_PROXY"]||env["http_proxy"];if(proxy){options["proxy"]={origin:proxy}}this.mySock=new WebSocketImpl(this.connURL,[],options)}else{this.mySock=new WebSocketImpl(this.connURL)}}catch(e){this.log_("Error instantiating WebSocket.");var error=e.message||e.data;if(error){this.log_(error)}this.onClosed_();return}this.mySock.onopen=function(){_this.log_("Websocket connected.");_this.everConnected_=true};this.mySock.onclose=function(){_this.log_("Websocket connection was disconnected.");_this.mySock=null;_this.onClosed_()};this.mySock.onmessage=function(m){_this.handleIncomingFrame(m)};this.mySock.onerror=function(e){_this.log_("WebSocket error.  Closing connection.");var error=e.message||e.data;if(error){_this.log_(error)}_this.onClosed_()}};WebSocketConnection.prototype.start=function(){};WebSocketConnection.forceDisallow=function(){WebSocketConnection.forceDisallow_=true};WebSocketConnection.isAvailable=function(){var isOldAndroid=false;if(typeof navigator!=="undefined"&&navigator.userAgent){var oldAndroidRegex=/Android ([0-9]{0,}\.[0-9]{0,})/;var oldAndroidMatch=navigator.userAgent.match(oldAndroidRegex);if(oldAndroidMatch&&oldAndroidMatch.length>1){if(parseFloat(oldAndroidMatch[1])<4.4){isOldAndroid=true}}}return!isOldAndroid&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_};WebSocketConnection.previouslyFailed=function(){return storage_1.PersistentStorage.isInMemoryStorage||storage_1.PersistentStorage.get("previous_websocket_failure")===true};WebSocketConnection.prototype.markConnectionHealthy=function(){storage_1.PersistentStorage.remove("previous_websocket_failure")};WebSocketConnection.prototype.appendFrame_=function(data){this.frames.push(data);if(this.frames.length==this.totalFrames){var fullMess=this.frames.join("");this.frames=null;var jsonMess=util_4.jsonEval(fullMess);this.onMessage(jsonMess)}};WebSocketConnection.prototype.handleNewFrameCount_=function(frameCount){this.totalFrames=frameCount;this.frames=[]};WebSocketConnection.prototype.extractFrameCount_=function(data){util_1.assert(this.frames===null,"We already have a frame buffer");if(data.length<=6){var frameCount=Number(data);if(!isNaN(frameCount)){this.handleNewFrameCount_(frameCount);return null}}this.handleNewFrameCount_(1);return data};WebSocketConnection.prototype.handleIncomingFrame=function(mess){if(this.mySock===null)return;var data=mess["data"];this.bytesReceived+=data.length;this.stats_.incrementCounter("bytes_received",data.length);this.resetKeepAlive();if(this.frames!==null){this.appendFrame_(data)}else{var remainingData=this.extractFrameCount_(data);if(remainingData!==null){this.appendFrame_(remainingData)}}};WebSocketConnection.prototype.send=function(data){this.resetKeepAlive();var dataStr=util_4.stringify(data);this.bytesSent+=dataStr.length;this.stats_.incrementCounter("bytes_sent",dataStr.length);var dataSegs=util_2.splitStringBySize(dataStr,WEBSOCKET_MAX_FRAME_SIZE);if(dataSegs.length>1){this.sendString_(String(dataSegs.length))}for(var i=0;i<dataSegs.length;i++){this.sendString_(dataSegs[i])}};WebSocketConnection.prototype.shutdown_=function(){this.isClosed_=true;if(this.keepaliveTimer){clearInterval(this.keepaliveTimer);this.keepaliveTimer=null}if(this.mySock){this.mySock.close();this.mySock=null}};WebSocketConnection.prototype.onClosed_=function(){if(!this.isClosed_){this.log_("WebSocket is closing itself");this.shutdown_();if(this.onDisconnect){this.onDisconnect(this.everConnected_);this.onDisconnect=null}}};WebSocketConnection.prototype.close=function(){if(!this.isClosed_){this.log_("WebSocket is being closed");this.shutdown_()}};WebSocketConnection.prototype.resetKeepAlive=function(){var _this=this;clearInterval(this.keepaliveTimer);this.keepaliveTimer=setInterval(function(){if(_this.mySock){_this.sendString_("0")}_this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))};WebSocketConnection.prototype.sendString_=function(str){try{this.mySock.send(str)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection.");setTimeout(this.onClosed_.bind(this),0)}};WebSocketConnection.responsesRequiredToBeHealthy=2;WebSocketConnection.healthyTimeout=3e4;return WebSocketConnection}();exports.WebSocketConnection=WebSocketConnection}).call(exports,__webpack_require__(60))},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ServerActions=function(){function ServerActions(){}ServerActions.prototype.put=function(pathString,data,onComplete,hash){};ServerActions.prototype.merge=function(pathString,data,onComplete,hash){};ServerActions.prototype.refreshAuthToken=function(token){};ServerActions.prototype.onDisconnectPut=function(pathString,data,onComplete){};ServerActions.prototype.onDisconnectMerge=function(pathString,data,onComplete){};ServerActions.prototype.onDisconnectCancel=function(pathString,onComplete){};ServerActions.prototype.reportStats=function(stats){};return ServerActions}();exports.ServerActions=ServerActions},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var IndexedFilter_1=__webpack_require__(47);var PriorityIndex_1=__webpack_require__(4);var Node_1=__webpack_require__(6);var ChildrenNode_1=__webpack_require__(5);var RangedFilter=function(){function RangedFilter(params){this.indexedFilter_=new IndexedFilter_1.IndexedFilter(params.getIndex());this.index_=params.getIndex();this.startPost_=RangedFilter.getStartPost_(params);this.endPost_=RangedFilter.getEndPost_(params)}RangedFilter.prototype.getStartPost=function(){return this.startPost_};RangedFilter.prototype.getEndPost=function(){return this.endPost_};RangedFilter.prototype.matches=function(node){return this.index_.compare(this.getStartPost(),node)<=0&&this.index_.compare(node,this.getEndPost())<=0};RangedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){if(!this.matches(new Node_1.NamedNode(key,newChild))){newChild=ChildrenNode_1.ChildrenNode.EMPTY_NODE}return this.indexedFilter_.updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)};RangedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){if(newSnap.isLeafNode()){newSnap=ChildrenNode_1.ChildrenNode.EMPTY_NODE}var filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);var self=this;newSnap.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){if(!self.matches(new Node_1.NamedNode(key,childNode))){filtered=filtered.updateImmediateChild(key,ChildrenNode_1.ChildrenNode.EMPTY_NODE)}});return this.indexedFilter_.updateFullNode(oldSnap,filtered,optChangeAccumulator)};RangedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap};RangedFilter.prototype.filtersNodes=function(){return true};RangedFilter.prototype.getIndexedFilter=function(){return this.indexedFilter_};RangedFilter.prototype.getIndex=function(){return this.index_};RangedFilter.getStartPost_=function(params){if(params.hasStart()){var startName=params.getIndexStartName();return params.getIndex().makePost(params.getIndexStartValue(),startName)}else{return params.getIndex().minPost()}};RangedFilter.getEndPost_=function(params){if(params.hasEnd()){var endName=params.getIndexEndName();return params.getIndex().makePost(params.getIndexEndValue(),endName)}else{return params.getIndex().maxPost()}};return RangedFilter}();exports.RangedFilter=RangedFilter},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_0__firebase_util___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__);var __WEBPACK_IMPORTED_MODULE_1__models_errors__=__webpack_require__(33);var __WEBPACK_IMPORTED_MODULE_2__models_token_manager__=__webpack_require__(183);var __WEBPACK_IMPORTED_MODULE_3__models_notification_permission__=__webpack_require__(92);var SENDER_ID_OPTION_NAME="messagingSenderId";var ControllerInterface=function(){function ControllerInterface(app){var _this=this;this.errorFactory_=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__["ErrorFactory"]("messaging","Messaging",__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].map);if(!app.options[SENDER_ID_OPTION_NAME]||typeof app.options[SENDER_ID_OPTION_NAME]!=="string"){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.BAD_SENDER_ID)}this.messagingSenderId_=app.options[SENDER_ID_OPTION_NAME];this.tokenManager_=new __WEBPACK_IMPORTED_MODULE_2__models_token_manager__["a"];this.app=app;this.INTERNAL={};this.INTERNAL.delete=function(){return _this.delete}}ControllerInterface.prototype.getToken=function(){var _this=this;var currentPermission=this.getNotificationPermission_();if(currentPermission!==__WEBPACK_IMPORTED_MODULE_3__models_notification_permission__["a"].granted){if(currentPermission===__WEBPACK_IMPORTED_MODULE_3__models_notification_permission__["a"].denied){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.NOTIFICATIONS_BLOCKED))}return Promise.resolve(null)}return this.getSWRegistration_().then(function(registration){return _this.tokenManager_.getSavedToken(_this.messagingSenderId_,registration).then(function(token){if(token){return token}return _this.tokenManager_.createToken(_this.messagingSenderId_,registration)})})};ControllerInterface.prototype.deleteToken=function(token){var _this=this;return this.tokenManager_.deleteToken(token).then(function(){return _this.getSWRegistration_().then(function(registration){if(registration){return registration.pushManager.getSubscription()}}).then(function(subscription){if(subscription){return subscription.unsubscribe()}})})};ControllerInterface.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.SHOULD_BE_INHERITED)};ControllerInterface.prototype.requestPermission=function(){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.AVAILABLE_IN_WINDOW)};ControllerInterface.prototype.useServiceWorker=function(registration){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.AVAILABLE_IN_WINDOW)};ControllerInterface.prototype.onMessage=function(nextOrObserver,optError,optCompleted){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.AVAILABLE_IN_WINDOW)};ControllerInterface.prototype.onTokenRefresh=function(nextOrObserver,optError,optCompleted){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.AVAILABLE_IN_WINDOW)};ControllerInterface.prototype.setBackgroundMessageHandler=function(callback){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.AVAILABLE_IN_SW)};ControllerInterface.prototype.delete=function(){return this.tokenManager_.closeDatabase()};ControllerInterface.prototype.getNotificationPermission_=function(){return Notification.permission};ControllerInterface.prototype.getTokenManager=function(){return this.tokenManager_};return ControllerInterface}();__webpack_exports__["a"]=ControllerInterface},function(module,__webpack_exports__,__webpack_require__){"use strict";var FCM_APPLICATION_SERVER_KEY=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110];var SUBSCRIPTION_DETAILS={userVisibleOnly:true,applicationServerKey:new Uint8Array(FCM_APPLICATION_SERVER_KEY)};__webpack_exports__["a"]={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:FCM_APPLICATION_SERVER_KEY,SUBSCRIPTION_OPTIONS:SUBSCRIPTION_DETAILS}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={granted:"granted",default:"default",denied:"denied"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var PARAMS={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"};var msgType={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"};var createNewMsg=function(msgType,msgData){var message=(_a={},_a[PARAMS.TYPE_OF_MSG]=msgType,_a[PARAMS.DATA]=msgData,_a);return message;var _a};__webpack_exports__["a"]={PARAMS:PARAMS,TYPES_OF_MSG:msgType,createNewMsg:createNewMsg}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return ErrorCode});var ErrorCode;(function(ErrorCode){ErrorCode[ErrorCode["NO_ERROR"]=0]="NO_ERROR";ErrorCode[ErrorCode["NETWORK_ERROR"]=1]="NETWORK_ERROR";ErrorCode[ErrorCode["ABORT"]=2]="ABORT"})(ErrorCode||(ErrorCode={}))},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Reference});var __WEBPACK_IMPORTED_MODULE_0__implementation_args__=__webpack_require__(50);var __WEBPACK_IMPORTED_MODULE_1__implementation_blob__=__webpack_require__(97);var __WEBPACK_IMPORTED_MODULE_2__implementation_error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_3__implementation_location__=__webpack_require__(35);var __WEBPACK_IMPORTED_MODULE_4__implementation_metadata__=__webpack_require__(51);var __WEBPACK_IMPORTED_MODULE_5__implementation_object__=__webpack_require__(17);var __WEBPACK_IMPORTED_MODULE_6__implementation_path__=__webpack_require__(96);var __WEBPACK_IMPORTED_MODULE_7__implementation_requests__=__webpack_require__(98);var __WEBPACK_IMPORTED_MODULE_8__implementation_string__=__webpack_require__(23);var __WEBPACK_IMPORTED_MODULE_9__implementation_type__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_10__task__=__webpack_require__(194);var Reference=function(){function Reference(authWrapper,location){this.authWrapper=authWrapper;if(location instanceof __WEBPACK_IMPORTED_MODULE_3__implementation_location__["a"]){this.location=location}else{this.location=__WEBPACK_IMPORTED_MODULE_3__implementation_location__["a"].makeFromUrl(location)}}Reference.prototype.toString=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("toString",[],arguments);return"gs://"+this.location.bucket+"/"+this.location.path};Reference.prototype.newRef=function(authWrapper,location){return new Reference(authWrapper,location)};Reference.prototype.mappings=function(){return __WEBPACK_IMPORTED_MODULE_4__implementation_metadata__["b"]()};Reference.prototype.child=function(childPath){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("child",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["e"]()],arguments);var newPath=__WEBPACK_IMPORTED_MODULE_6__implementation_path__["a"](this.location.path,childPath);var location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__["a"](this.location.bucket,newPath);return this.newRef(this.authWrapper,location)};Object.defineProperty(Reference.prototype,"parent",{get:function(){var newPath=__WEBPACK_IMPORTED_MODULE_6__implementation_path__["c"](this.location.path);if(newPath===null){return null}var location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__["a"](this.location.bucket,newPath);return this.newRef(this.authWrapper,location)},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"root",{get:function(){var location=new __WEBPACK_IMPORTED_MODULE_3__implementation_location__["a"](this.location.bucket,"");return this.newRef(this.authWrapper,location)},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"fullPath",{get:function(){return this.location.path},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"name",{get:function(){return __WEBPACK_IMPORTED_MODULE_6__implementation_path__["b"](this.location.path)},enumerable:true,configurable:true});Object.defineProperty(Reference.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:true,configurable:true});Reference.prototype.put=function(data,metadata){if(metadata===void 0){metadata=null}__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("put",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["f"](),__WEBPACK_IMPORTED_MODULE_0__implementation_args__["b"](true)],arguments);this.throwIfRoot_("put");return new __WEBPACK_IMPORTED_MODULE_10__task__["a"](this,this.authWrapper,this.location,this.mappings(),new __WEBPACK_IMPORTED_MODULE_1__implementation_blob__["a"](data),metadata)};Reference.prototype.putString=function(string,format,opt_metadata){if(format===void 0){format=__WEBPACK_IMPORTED_MODULE_8__implementation_string__["a"].RAW}__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("putString",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["e"](),__WEBPACK_IMPORTED_MODULE_0__implementation_args__["e"](__WEBPACK_IMPORTED_MODULE_8__implementation_string__["c"],true),__WEBPACK_IMPORTED_MODULE_0__implementation_args__["b"](true)],arguments);this.throwIfRoot_("putString");var data=__WEBPACK_IMPORTED_MODULE_8__implementation_string__["b"](format,string);var metadata=__WEBPACK_IMPORTED_MODULE_5__implementation_object__["a"](opt_metadata);if(!__WEBPACK_IMPORTED_MODULE_9__implementation_type__["a"](metadata["contentType"])&&__WEBPACK_IMPORTED_MODULE_9__implementation_type__["a"](data.contentType)){metadata["contentType"]=data.contentType}return new __WEBPACK_IMPORTED_MODULE_10__task__["a"](this,this.authWrapper,this.location,this.mappings(),new __WEBPACK_IMPORTED_MODULE_1__implementation_blob__["a"](data.data,true),metadata)};Reference.prototype.delete=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("delete",[],arguments);this.throwIfRoot_("delete");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__["d"](self.authWrapper,self.location);return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})};Reference.prototype.getMetadata=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("getMetadata",[],arguments);this.throwIfRoot_("getMetadata");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__["e"](self.authWrapper,self.location,self.mappings());return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})};Reference.prototype.updateMetadata=function(metadata){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("updateMetadata",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["b"]()],arguments);this.throwIfRoot_("updateMetadata");var self=this;return this.authWrapper.getAuthToken().then(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_7__implementation_requests__["i"](self.authWrapper,self.location,metadata,self.mappings());return self.authWrapper.makeRequest(requestInfo,authToken).getPromise()})};Reference.prototype.getDownloadURL=function(){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("getDownloadURL",[],arguments);this.throwIfRoot_("getDownloadURL");return this.getMetadata().then(function(metadata){var url=metadata["downloadURLs"][0];if(__WEBPACK_IMPORTED_MODULE_9__implementation_type__["a"](url)){return url}else{throw __WEBPACK_IMPORTED_MODULE_2__implementation_error__["l"]()}})};Reference.prototype.throwIfRoot_=function(name){if(this.location.path===""){throw __WEBPACK_IMPORTED_MODULE_2__implementation_error__["j"](name)}};return Reference}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["c"]=parent;__webpack_exports__["a"]=child;__webpack_exports__["b"]=lastComponent;function parent(path){if(path.length==0){return null}var index=path.lastIndexOf("/");if(index===-1){return""}var newPath=path.slice(0,index);return newPath}function child(path,childPath){var canonicalChildPath=childPath.split("/").filter(function(component){return component.length>0}).join("/");if(path.length===0){return canonicalChildPath}else{return path+"/"+canonicalChildPath}}function lastComponent(path){var index=path.lastIndexOf("/",path.length-2);if(index===-1){return path}else{return path.slice(index+1)}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return FbsBlob});var __WEBPACK_IMPORTED_MODULE_0__fs__=__webpack_require__(192);var __WEBPACK_IMPORTED_MODULE_1__string__=__webpack_require__(23);var __WEBPACK_IMPORTED_MODULE_2__type__=__webpack_require__(7);var FbsBlob=function(){function FbsBlob(data,opt_elideCopy){var size=0;var blobType="";if(__WEBPACK_IMPORTED_MODULE_2__type__["d"](data)){this.data_=data;size=data.size;blobType=data.type}else if(data instanceof ArrayBuffer){if(opt_elideCopy){this.data_=new Uint8Array(data)}else{this.data_=new Uint8Array(data.byteLength);this.data_.set(new Uint8Array(data))}size=this.data_.length}else if(data instanceof Uint8Array){if(opt_elideCopy){this.data_=data}else{this.data_=new Uint8Array(data.length);this.data_.set(data)}size=data.length}this.size_=size;this.type_=blobType}FbsBlob.prototype.size=function(){return this.size_};FbsBlob.prototype.type=function(){return this.type_};FbsBlob.prototype.slice=function(startByte,endByte){if(__WEBPACK_IMPORTED_MODULE_2__type__["d"](this.data_)){var realBlob=this.data_;var sliced=__WEBPACK_IMPORTED_MODULE_0__fs__["b"](realBlob,startByte,endByte);if(sliced===null){return null}return new FbsBlob(sliced)}else{var slice=new Uint8Array(this.data_.buffer,startByte,endByte-startByte);return new FbsBlob(slice,true)}};FbsBlob.getBlob=function(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}if(__WEBPACK_IMPORTED_MODULE_2__type__["e"]()){var blobby=var_args.map(function(val){if(val instanceof FbsBlob){return val.data_}else{return val}});return new FbsBlob(__WEBPACK_IMPORTED_MODULE_0__fs__["a"].apply(null,blobby))}else{var uint8Arrays=var_args.map(function(val){if(__WEBPACK_IMPORTED_MODULE_2__type__["j"](val)){return __WEBPACK_IMPORTED_MODULE_1__string__["b"](__WEBPACK_IMPORTED_MODULE_1__string__["a"].RAW,val).data}else{return val.data_}});var finalLength_1=0;uint8Arrays.forEach(function(array){finalLength_1+=array.byteLength});var merged_1=new Uint8Array(finalLength_1);var index_1=0;uint8Arrays.forEach(function(array){for(var i=0;i<array.length;i++){merged_1[index_1++]=array[i]}});return new FbsBlob(merged_1,true)}};FbsBlob.prototype.uploadData=function(){return this.data_};return FbsBlob}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["e"]=getMetadata;__webpack_exports__["i"]=updateMetadata;__webpack_exports__["d"]=deleteObject;__webpack_exports__["g"]=multipartUpload;__webpack_require__.d(__webpack_exports__,"a",function(){return ResumableUploadStatus});__webpack_exports__["c"]=createResumableUpload;__webpack_exports__["f"]=getResumableUploadStatus;__webpack_require__.d(__webpack_exports__,"h",function(){return resumableUploadChunkSize});__webpack_exports__["b"]=continueResumableUpload;var __WEBPACK_IMPORTED_MODULE_0__array__=__webpack_require__(53);var __WEBPACK_IMPORTED_MODULE_1__blob__=__webpack_require__(97);var __WEBPACK_IMPORTED_MODULE_2__error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_3__metadata__=__webpack_require__(51);var __WEBPACK_IMPORTED_MODULE_4__object__=__webpack_require__(17);var __WEBPACK_IMPORTED_MODULE_5__requestinfo__=__webpack_require__(193);var __WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_7__url__=__webpack_require__(52);function handlerCheck(cndn){if(!cndn){
throw __WEBPACK_IMPORTED_MODULE_2__error__["s"]()}}function metadataHandler(authWrapper,mappings){function handler(xhr,text){var metadata=__WEBPACK_IMPORTED_MODULE_3__metadata__["a"](authWrapper,text,mappings);handlerCheck(metadata!==null);return metadata}return handler}function sharedErrorHandler(location){function errorHandler(xhr,err){var newErr;if(xhr.getStatus()===401){newErr=__WEBPACK_IMPORTED_MODULE_2__error__["q"]()}else{if(xhr.getStatus()===402){newErr=__WEBPACK_IMPORTED_MODULE_2__error__["n"](location.bucket)}else{if(xhr.getStatus()===403){newErr=__WEBPACK_IMPORTED_MODULE_2__error__["r"](location.path)}else{newErr=err}}}newErr.setServerResponseProp(err.serverResponseProp());return newErr}return errorHandler}function objectErrorHandler(location){var shared=sharedErrorHandler(location);function errorHandler(xhr,err){var newErr=shared(xhr,err);if(xhr.getStatus()===404){newErr=__WEBPACK_IMPORTED_MODULE_2__error__["m"](location.path)}newErr.setServerResponseProp(err.serverResponseProp());return newErr}return errorHandler}function getMetadata(authWrapper,location,mappings){var urlPart=location.fullServerUrl();var url=__WEBPACK_IMPORTED_MODULE_7__url__["b"](urlPart);var method="GET";var timeout=authWrapper.maxOperationRetryTime();var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,metadataHandler(authWrapper,mappings),timeout);requestInfo.errorHandler=objectErrorHandler(location);return requestInfo}function updateMetadata(authWrapper,location,metadata,mappings){var urlPart=location.fullServerUrl();var url=__WEBPACK_IMPORTED_MODULE_7__url__["b"](urlPart);var method="PATCH";var body=__WEBPACK_IMPORTED_MODULE_3__metadata__["d"](metadata,mappings);var headers={"Content-Type":"application/json; charset=utf-8"};var timeout=authWrapper.maxOperationRetryTime();var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,metadataHandler(authWrapper,mappings),timeout);requestInfo.headers=headers;requestInfo.body=body;requestInfo.errorHandler=objectErrorHandler(location);return requestInfo}function deleteObject(authWrapper,location){var urlPart=location.fullServerUrl();var url=__WEBPACK_IMPORTED_MODULE_7__url__["b"](urlPart);var method="DELETE";var timeout=authWrapper.maxOperationRetryTime();function handler(xhr,text){}var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,handler,timeout);requestInfo.successCodes=[200,204];requestInfo.errorHandler=objectErrorHandler(location);return requestInfo}function determineContentType_(metadata,blob){return metadata&&metadata["contentType"]||blob&&blob.type()||"application/octet-stream"}function metadataForUpload_(location,blob,opt_metadata){var metadata=__WEBPACK_IMPORTED_MODULE_4__object__["a"](opt_metadata);metadata["fullPath"]=location.path;metadata["size"]=blob.size();if(!metadata["contentType"]){metadata["contentType"]=determineContentType_(null,blob)}return metadata}function multipartUpload(authWrapper,location,mappings,blob,opt_metadata){var urlPart=location.bucketOnlyServerUrl();var headers={"X-Goog-Upload-Protocol":"multipart"};function genBoundary(){var str="";for(var i=0;i<2;i++){str=str+Math.random().toString().slice(2)}return str}var boundary=genBoundary();headers["Content-Type"]="multipart/related; boundary="+boundary;var metadata=metadataForUpload_(location,blob,opt_metadata);var metadataString=__WEBPACK_IMPORTED_MODULE_3__metadata__["d"](metadata,mappings);var preBlobPart="--"+boundary+"\r\n"+"Content-Type: application/json; charset=utf-8\r\n\r\n"+metadataString+"\r\n--"+boundary+"\r\n"+"Content-Type: "+metadata["contentType"]+"\r\n\r\n";var postBlobPart="\r\n--"+boundary+"--";var body=__WEBPACK_IMPORTED_MODULE_1__blob__["a"].getBlob(preBlobPart,blob,postBlobPart);if(body===null){throw __WEBPACK_IMPORTED_MODULE_2__error__["d"]()}var urlParams={name:metadata["fullPath"]};var url=__WEBPACK_IMPORTED_MODULE_7__url__["d"](urlPart);var method="POST";var timeout=authWrapper.maxUploadRetryTime();var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,metadataHandler(authWrapper,mappings),timeout);requestInfo.urlParams=urlParams;requestInfo.headers=headers;requestInfo.body=body.uploadData();requestInfo.errorHandler=sharedErrorHandler(location);return requestInfo}var ResumableUploadStatus=function(){function ResumableUploadStatus(current,total,finalized,metadata){this.current=current;this.total=total;this.finalized=!!finalized;this.metadata=metadata||null}return ResumableUploadStatus}();function checkResumeHeader_(xhr,opt_allowed){var status;try{status=xhr.getResponseHeader("X-Goog-Upload-Status")}catch(e){handlerCheck(false)}var allowed=opt_allowed||["active"];handlerCheck(__WEBPACK_IMPORTED_MODULE_0__array__["b"](allowed,status));return status}function createResumableUpload(authWrapper,location,mappings,blob,opt_metadata){var urlPart=location.bucketOnlyServerUrl();var metadata=metadataForUpload_(location,blob,opt_metadata);var urlParams={name:metadata["fullPath"]};var url=__WEBPACK_IMPORTED_MODULE_7__url__["d"](urlPart);var method="POST";var headers={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":blob.size(),"X-Goog-Upload-Header-Content-Type":metadata["contentType"],"Content-Type":"application/json; charset=utf-8"};var body=__WEBPACK_IMPORTED_MODULE_3__metadata__["d"](metadata,mappings);var timeout=authWrapper.maxUploadRetryTime();function handler(xhr,text){checkResumeHeader_(xhr);var url;try{url=xhr.getResponseHeader("X-Goog-Upload-URL")}catch(e){handlerCheck(false)}handlerCheck(__WEBPACK_IMPORTED_MODULE_6__type__["j"](url));return url}var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,handler,timeout);requestInfo.urlParams=urlParams;requestInfo.headers=headers;requestInfo.body=body;requestInfo.errorHandler=sharedErrorHandler(location);return requestInfo}function getResumableUploadStatus(authWrapper,location,url,blob){var headers={"X-Goog-Upload-Command":"query"};function handler(xhr,text){var status=checkResumeHeader_(xhr,["active","final"]);var sizeString;try{sizeString=xhr.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){handlerCheck(false)}var size=parseInt(sizeString,10);handlerCheck(!isNaN(size));return new ResumableUploadStatus(size,blob.size(),status==="final")}var method="POST";var timeout=authWrapper.maxUploadRetryTime();var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,handler,timeout);requestInfo.headers=headers;requestInfo.errorHandler=sharedErrorHandler(location);return requestInfo}var resumableUploadChunkSize=256*1024;function continueResumableUpload(location,authWrapper,url,blob,chunkSize,mappings,opt_status,opt_progressCallback){var status=new ResumableUploadStatus(0,0);if(opt_status){status.current=opt_status.current;status.total=opt_status.total}else{status.current=0;status.total=blob.size()}if(blob.size()!==status.total){throw __WEBPACK_IMPORTED_MODULE_2__error__["p"]()}var bytesLeft=status.total-status.current;var bytesToUpload=bytesLeft;if(chunkSize>0){bytesToUpload=Math.min(bytesToUpload,chunkSize)}var startByte=status.current;var endByte=startByte+bytesToUpload;var uploadCommand=bytesToUpload===bytesLeft?"upload, finalize":"upload";var headers={"X-Goog-Upload-Command":uploadCommand,"X-Goog-Upload-Offset":status.current};var body=blob.slice(startByte,endByte);if(body===null){throw __WEBPACK_IMPORTED_MODULE_2__error__["d"]()}function handler(xhr,text){var uploadStatus=checkResumeHeader_(xhr,["active","final"]);var newCurrent=status.current+bytesToUpload;var size=blob.size();var metadata;if(uploadStatus==="final"){metadata=metadataHandler(authWrapper,mappings)(xhr,text)}else{metadata=null}return new ResumableUploadStatus(newCurrent,size,uploadStatus==="final",metadata)}var method="POST";var timeout=authWrapper.maxUploadRetryTime();var requestInfo=new __WEBPACK_IMPORTED_MODULE_5__requestinfo__["a"](url,method,handler,timeout);requestInfo.headers=headers;requestInfo.body=body.uploadData();requestInfo.progressCallback=opt_progressCallback||null;requestInfo.errorHandler=sharedErrorHandler(location);return requestInfo}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _kline=_interopRequireDefault(__webpack_require__(15));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}window.Kline=_kline.default;var _default=_kline.default;exports.default=_default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Chart=void 0;var _chart_manager=__webpack_require__(3);var _control=__webpack_require__(36);var _kline=_interopRequireDefault(__webpack_require__(15));var _templates=__webpack_require__(25);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Chart=function(){function Chart(){_classCallCheck(this,Chart);this._data=null;this._charStyle="CandleStick";this._depthData={array:null,asks_count:0,bids_count:0,asks_si:0,asks_ei:0,bids_si:0,bids_ei:0};this.strIsLine=false;this._range=_kline.default.instance.range;this._symbol=_kline.default.instance.symbol}_createClass(Chart,[{key:"setTitle",value:function setTitle(){var lang=_chart_manager.ChartManager.instance.getLanguage();var title=_kline.default.instance.symbolName;title+=" ";title+=this.strIsLine?Chart.strPeriod[lang]["line"]:Chart.strPeriod[lang][this._range];title+=(this._contract_unit+"/"+this._money_type).toUpperCase();_chart_manager.ChartManager.instance.setTitle("frame0.k0",title)}},{key:"setSymbol",value:function setSymbol(symbol){this._symbol=symbol;this.updateDataAndDisplay()}},{key:"updateDataAndDisplay",value:function updateDataAndDisplay(){_kline.default.instance.symbol=this._symbol;_kline.default.instance.range=this._range;_chart_manager.ChartManager.instance.setCurrentDataSource("frame0.k0",this._symbol+"."+this._range);_chart_manager.ChartManager.instance.setNormalMode();var f=_kline.default.instance.chartMgr.getDataSource("frame0.k0").getLastDate();$(".symbol-title>a").text(_kline.default.instance.symbolName);if(f===-1){_kline.default.instance.requestParam=_control.Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,_kline.default.instance.limit,null);_control.Control.requestData(true)}else{_kline.default.instance.requestParam=_control.Control.setHttpRequestParam(_kline.default.instance.symbol,_kline.default.instance.range,null,f.toString());_control.Control.requestData()}_chart_manager.ChartManager.instance.redraw("All",false)}},{key:"setCurrentContractUnit",value:function setCurrentContractUnit(contractUnit){this._contract_unit=contractUnit;this.updateDataAndDisplay()}},{key:"setCurrentMoneyType",value:function setCurrentMoneyType(moneyType){this._money_type=moneyType;this.updateDataAndDisplay()}},{key:"setCurrentPeriod",value:function setCurrentPeriod(period){this._range=_kline.default.instance.periodMap[period];if(_kline.default.instance.type==="stomp"&&_kline.default.instance.stompClient.ws.readyState===1){_kline.default.instance.subscribed.unsubscribe();_kline.default.instance.subscribed=_kline.default.instance.stompClient.subscribe(_kline.default.instance.subscribePath+"/"+_kline.default.instance.symbol+"/"+this._range,_control.Control.subscribeCallback)}this.updateDataAndDisplay();_kline.default.instance.onRangeChange(this._range)}},{key:"updateDataSource",value:function updateDataSource(data){this._data=data;_chart_manager.ChartManager.instance.updateData("frame0.k0",this._data)}},{key:"updateDepth",value:function updateDepth(array){if(array===null){this._depthData.array=[];_chart_manager.ChartManager.instance.redraw("All",false);return}if(!array.asks||!array.bids||array.asks===""||array.bids==="")return;var _data=this._depthData;_data.array=[];for(var i=0;i<array.asks.length;i++){var data={};data.rate=array.asks[i][0];data.amount=array.asks[i][1];_data.array.push(data)}for(var _i=0;_i<array.bids.length;_i++){var _data2={};_data2.rate=array.bids[_i][0];_data2.amount=array.bids[_i][1];_data.array.push(_data2)}_data.asks_count=array.asks.length;_data.bids_count=array.bids.length;_data.asks_si=_data.asks_count-1;_data.asks_ei=0;_data.bids_si=_data.asks_count-1;_data.bids_ei=_data.asks_count+_data.bids_count-2;for(var _i2=_data.asks_si;_i2>=_data.asks_ei;_i2--){if(_i2===_data.asks_si&&_data.array[_i2]!==undefined){_data.array[_i2].amounts=_data.array[_i2].amount}else if(_data.array[_i2+1]!==undefined){_data.array[_i2].amounts=_data.array[_i2+1].amounts+_data.array[_i2].amount}}for(var _i3=_data.bids_si;_i3<=_data.bids_ei;_i3++){if(_i3===_data.bids_si&&_data.array[_i3]!==undefined){_data.array[_i3].amounts=_data.array[_i3].amount}else if(_data.array[_i3-1]!==undefined){_data.array[_i3].amounts=_data.array[_i3-1].amounts+_data.array[_i3].amount}}_chart_manager.ChartManager.instance.redraw("All",false)}},{key:"setMainIndicator",value:function setMainIndicator(indicName){this._mainIndicator=indicName;if(indicName==="NONE"){_chart_manager.ChartManager.instance.removeMainIndicator("frame0.k0")}else{_chart_manager.ChartManager.instance.setMainIndicator("frame0.k0",indicName)}_chart_manager.ChartManager.instance.redraw("All",true)}},{key:"setIndicator",value:function setIndicator(index,indicName){if(indicName==="NONE"){var _index=2;if(_templates.Template.displayVolume===false)_index=1;var areaName=_chart_manager.ChartManager.instance.getIndicatorAreaName("frame0.k0",_index);if(areaName!=="")_chart_manager.ChartManager.instance.removeIndicator(areaName)}else{var _index2=2;if(_templates.Template.displayVolume===false)_index2=1;var _areaName=_chart_manager.ChartManager.instance.getIndicatorAreaName("frame0.k0",_index2);if(_areaName===""){_templates.Template.createIndicatorChartComps("frame0.k0",indicName)}else{_chart_manager.ChartManager.instance.setIndicator(_areaName,indicName)}}_chart_manager.ChartManager.instance.redraw("All",true)}},{key:"addIndicator",value:function addIndicator(indicName){_chart_manager.ChartManager.instance.addIndicator(indicName);_chart_manager.ChartManager.instance.redraw("All",true)}},{key:"removeIndicator",value:function removeIndicator(indicName){var areaName=_chart_manager.ChartManager.instance.getIndicatorAreaName(2);_chart_manager.ChartManager.instance.removeIndicator(areaName);_chart_manager.ChartManager.instance.redraw("All",true)}}]);return Chart}();exports.Chart=Chart;Chart.strPeriod={"zh-cn":{line:"(分时)","1min":"(1分钟)","5min":"(5分钟)","15min":"(15分钟)","30min":"(30分钟)","1hour":"(1小时)","1day":"(日线)","1week":"(周线)","1M":"(月线)","3min":"(3分钟)","2hour":"(2小时)","4hour":"(4小时)","6hour":"(6小时)","12hour":"(12小时)","3day":"(3天)"},"en-us":{line:"(Line)","1min":"(1m)","5min":"(5m)","15min":"(15m)","30min":"(30m)","1hour":"(1h)","1day":"(1d)","1week":"(1w)","1M":"(1M)","3min":"(3m)","2hour":"(2h)","4hour":"(4h)","6hour":"(6h)","12hour":"(12h)","3day":"(3d)"},"zh-tw":{line:"(分時)","1min":"(1分鐘)","5min":"(5分鐘)","15min":"(15分鐘)","30min":"(30分鐘)","1hour":"(1小時)","1day":"(日線)","1week":"(周線)","1M":"(月線)","3min":"(3分鐘)","2hour":"(2小時)","4hour":"(4小時)","6hour":"(6小時)","12hour":"(12小時)","3day":"(3天)"}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CToolManager=void 0;var _named_object=__webpack_require__(8);var _cpoint=__webpack_require__(37);var ctools=_interopRequireWildcard(__webpack_require__(38));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var CToolManager=function(_NamedObject){_inherits(CToolManager,_NamedObject);function CToolManager(name){var _this;_classCallCheck(this,CToolManager);_this=_possibleConstructorReturn(this,(CToolManager.__proto__||Object.getPrototypeOf(CToolManager)).call(this,name));_this.selectedObject=-1;_this.toolObjects=[];return _this}_createClass(CToolManager,[{key:"getToolObjectCount",value:function getToolObjectCount(){return this.toolObjects.length}},{key:"addToolObject",value:function addToolObject(o){this.toolObjects.push(o)}},{key:"getToolObject",value:function getToolObject(i){if(i<this.toolObjects.length&&i>=0){return this.toolObjects[i]}return null}},{key:"getCurrentObject",value:function getCurrentObject(){return this.getToolObject(this.getToolObjectCount()-1)}},{key:"getSelectedObject",value:function getSelectedObject(){return this.getToolObject(this.selectedObject)}},{key:"delCurrentObject",value:function delCurrentObject(){this.toolObjects.splice(this.getToolObjectCount()-1,1)}},{key:"delSelectedObject",value:function delSelectedObject(){this.toolObjects.splice(this.selectedObject,1);this.selectedObject=-1}},{key:"acceptMouseMoveEvent",value:function acceptMouseMoveEvent(x,y){if(this.selectedObject===-1){var curr=this.toolObjects[this.getToolObjectCount()-1];if(curr!==null&&curr!==undefined&&curr.getState()!==ctools.CToolObject.state.AfterDraw)return curr.acceptMouseMoveEvent(x,y)}else{var sel=this.toolObjects[this.selectedObject];if(sel.getState()===ctools.CToolObject.state.Draw){return sel.acceptMouseMoveEvent(x,y)}sel.unselect();this.selectedObject=-1}for(var index in this.toolObjects){if(this.toolObjects[index].isSelected(x,y)){this.selectedObject=index;return false}}return false}},{key:"acceptMouseDownEvent",value:function acceptMouseDownEvent(x,y){this.mouseDownMove=false;if(this.selectedObject===-1){var curr=this.toolObjects[this.getToolObjectCount()-1];if(curr!==null&&curr!==undefined&&curr.getState()!==ctools.CToolObject.state.AfterDraw)return curr.acceptMouseDownEvent(x,y)}else{var sel=this.toolObjects[this.selectedObject];if(sel.getState()!==ctools.CToolObject.state.BeforeDraw)return sel.acceptMouseDownEvent(x,y)}return false}},{key:"acceptMouseDownMoveEvent",value:function acceptMouseDownMoveEvent(x,y){this.mouseDownMove=true;if(this.selectedObject===-1){var curr=this.toolObjects[this.getToolObjectCount()-1];if(curr!==null&&curr!==undefined&&curr.getState()===ctools.CToolObject.state.Draw)return curr.acceptMouseDownMoveEvent(x,y);return false}else{var sel=this.toolObjects[this.selectedObject];if(sel.getState()!==ctools.CToolObject.state.BeforeDraw){if(sel.acceptMouseDownMoveEvent(x,y)===true){var point=this.toolObjects[this.selectedObject].points;for(var i=0;i<point.length;i++){if(point[i].state===_cpoint.CPoint.state.Highlight||point[i].state===_cpoint.CPoint.state.Show){return true}}}return true}}}},{key:"acceptMouseUpEvent",value:function acceptMouseUpEvent(x,y){if(this.mouseDownMove===true){if(this.selectedObject===-1){var _curr=this.toolObjects[this.getToolObjectCount()-1];if(_curr!==null&&_curr!==undefined&&_curr.getState()===ctools.CToolObject.state.Draw)return _curr.acceptMouseUpEvent(x,y);return true}else{var sel=this.toolObjects[this.selectedObject];if(sel.getState()!==ctools.CToolObject.state.BeforeDraw)return sel.acceptMouseUpEvent(x,y)}}if(this.selectedObject!==-1){return true}var curr=this.toolObjects[this.getToolObjectCount()-1];if(curr!==null&&curr!==undefined){if(curr.getState()===ctools.CToolObject.state.Draw)return true;if(!curr.isValidMouseXY(x,y)){return false}if(curr.isSelected(x,y)){return true}}return false}}]);return CToolManager}(_named_object.NamedObject);exports.CToolManager=CToolManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Timeline=void 0;var _named_object=__webpack_require__(8);var _chart_manager=__webpack_require__(3);var _data_sources=__webpack_require__(11);function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var Timeline=function(_NamedObject){_inherits(Timeline,_NamedObject);function Timeline(name){var _this;_classCallCheck(this,Timeline);_this=_possibleConstructorReturn(this,(Timeline.__proto__||Object.getPrototypeOf(Timeline)).call(this,name));_this._updated=false;_this._innerLeft=0;_this._innerWidth=0;_this._firstColumnLeft=0;_this._scale=3;_this._lastScale=-1;_this._maxItemCount=0;_this._maxIndex=0;_this._firstIndex=-1;_this._selectedIndex=-1;_this._savedFirstIndex=-1;return _this}_createClass(Timeline,[{key:"isLatestShown",value:function isLatestShown(){return this.getLastIndex()===this._maxIndex}},{key:"isUpdated",value:function isUpdated(){return this._updated}},{key:"setUpdated",value:function setUpdated(v){this._updated=v}},{key:"getItemWidth",value:function getItemWidth(){return Timeline.itemWidth[this._scale]}},{key:"getSpaceWidth",value:function getSpaceWidth(){return Timeline.spaceWidth[this._scale]}},{key:"getColumnWidth",value:function getColumnWidth(){return this.getSpaceWidth()+this.getItemWidth()}},{key:"getInnerWidth",value:function getInnerWidth(){return this._innerWidth}},{key:"getItemLeftOffset",value:function getItemLeftOffset(){return this.getSpaceWidth()}},{key:"getItemCenterOffset",value:function getItemCenterOffset(){return this.getSpaceWidth()+(this.getItemWidth()>>1)}},{key:"getFirstColumnLeft",value:function getFirstColumnLeft(){return this._firstColumnLeft}},{key:"getMaxItemCount",value:function getMaxItemCount(){return this._maxItemCount}},{key:"getFirstIndex",value:function getFirstIndex(){return this._firstIndex}},{key:"getLastIndex",value:function getLastIndex(){return Math.min(this._firstIndex+this._maxItemCount,this._maxIndex)}},{key:"getSelectedIndex",value:function getSelectedIndex(){return this._selectedIndex}},{key:"getMaxIndex",value:function getMaxIndex(){return this._maxIndex}},{key:"calcColumnCount",value:function calcColumnCount(w){return Math.floor(w/this.getColumnWidth())<<0}},{key:"calcFirstColumnLeft",value:function calcFirstColumnLeft(maxItemCount){return this._innerLeft+this._innerWidth-this.getColumnWidth()*maxItemCount}},{key:"calcFirstIndexAlignRight",value:function calcFirstIndexAlignRight(oldFirstIndex,oldMaxItemCount,newMaxItemCount){return Math.max(0,oldFirstIndex+Math.max(oldMaxItemCount,1)-Math.max(newMaxItemCount,1))}},{key:"calcFirstIndex",value:function calcFirstIndex(newMaxItemCount){return this.validateFirstIndex(this.calcFirstIndexAlignRight(this._firstIndex,this._maxItemCount,newMaxItemCount),newMaxItemCount)}},{key:"updateMaxItemCount",value:function updateMaxItemCount(){var newMaxItemCount=this.calcColumnCount(this._innerWidth);var newFirstIndex;if(this._maxItemCount<1){newFirstIndex=this.calcFirstIndex(newMaxItemCount)}else if(this._lastScale===this._scale){newFirstIndex=this.validateFirstIndex(this._firstIndex-(newMaxItemCount-this._maxItemCount))}else{var focusedIndex=this._selectedIndex>=0?this._selectedIndex:this.getLastIndex()-1;newFirstIndex=this.validateFirstIndex(focusedIndex-Math.round((focusedIndex-this._firstIndex)*newMaxItemCount/this._maxItemCount))}this._lastScale=this._scale;if(this._firstIndex!==newFirstIndex){if(this._selectedIndex===this._firstIndex)this._selectedIndex=newFirstIndex;this._firstIndex=newFirstIndex;this._updated=true}if(this._maxItemCount!==newMaxItemCount){this._maxItemCount=newMaxItemCount;this._updated=true}this._firstColumnLeft=this.calcFirstColumnLeft(newMaxItemCount)}},{key:"validateFirstIndex",value:function validateFirstIndex(firstIndex,maxItemCount){if(this._maxIndex<1){return-1}if(firstIndex<0){return 0}var lastFirst=Math.max(0,this._maxIndex-1);if(firstIndex>lastFirst){return lastFirst}return firstIndex}},{key:"validateSelectedIndex",value:function validateSelectedIndex(){if(this._selectedIndex<this._firstIndex)this._selectedIndex=-1;else if(this._selectedIndex>=this.getLastIndex())this._selectedIndex=-1}},{key:"onLayout",value:function onLayout(){var mgr=_chart_manager.ChartManager.instance;var area=mgr.getArea(this.getDataSourceName()+".main");if(area!==null){this._innerLeft=area.getLeft()+Timeline.PADDING_LEFT;var w=Math.max(0,area.getWidth()-(Timeline.PADDING_LEFT+Timeline.PADDING_RIGHT));if(this._innerWidth!==w){this._innerWidth=w;this.updateMaxItemCount()}}}},{key:"toIndex",value:function toIndex(x){return this._firstIndex+this.calcColumnCount(x-this._firstColumnLeft)}},{key:"toColumnLeft",value:function toColumnLeft(index){return this._firstColumnLeft+this.getColumnWidth()*(index-this._firstIndex)}},{key:"toItemLeft",value:function toItemLeft(index){return this.toColumnLeft(index)+this.getItemLeftOffset()}},{key:"toItemCenter",value:function toItemCenter(index){return this.toColumnLeft(index)+this.getItemCenterOffset()}},{key:"selectAt",value:function selectAt(x){this._selectedIndex=this.toIndex(x);this.validateSelectedIndex();return this._selectedIndex>=0}},{key:"unselect",value:function unselect(){this._selectedIndex=-1}},{key:"update",value:function update(){var mgr=_chart_manager.ChartManager.instance;var ds=mgr.getDataSource(this.getDataSourceName());var oldMaxIndex=this._maxIndex;this._maxIndex=ds.getDataCount();switch(ds.getUpdateMode()){case _data_sources.DataSource.UpdateMode.Refresh:if(this._maxIndex<1)this._firstIndex=-1;else this._firstIndex=Math.max(this._maxIndex-this._maxItemCount,0);this._selectedIndex=-1;this._updated=true;break;case _data_sources.DataSource.UpdateMode.Append:var lastIndex=this.getLastIndex();var erasedCount=ds.getErasedCount();if(lastIndex<oldMaxIndex){if(erasedCount>0){this._firstIndex=Math.max(this._firstIndex-erasedCount,0);if(this._selectedIndex>=0){this._selectedIndex-=erasedCount;this.validateSelectedIndex()}this._updated=true}}else if(lastIndex===oldMaxIndex){this._firstIndex+=this._maxIndex-oldMaxIndex;if(this._selectedIndex>=0){this._selectedIndex-=erasedCount;this.validateSelectedIndex()}this._updated=true}break}}},{key:"move",value:function move(x){if(this.isLatestShown()){_chart_manager.ChartManager.instance.getArea(this.getDataSourceName()+".mainRange").setChanged(true)}this._firstIndex=this.validateFirstIndex(this._savedFirstIndex-this.calcColumnCount(x),this._maxItemCount);this._updated=true;if(this._selectedIndex>=0)this.validateSelectedIndex()}},{key:"startMove",value:function startMove(){this._savedFirstIndex=this._firstIndex}},{key:"scale",value:function scale(s){this._scale+=s;if(this._scale<0){this._scale=0}else if(this._scale>=Timeline.itemWidth.length){this._scale=Timeline.itemWidth.length-1}this.updateMaxItemCount();if(this._selectedIndex>=0){this.validateSelectedIndex()}}}]);return Timeline}(_named_object.NamedObject);exports.Timeline=Timeline;Timeline.itemWidth=[1,3,3,5,5,7,9,11,13,15,17,19,21,23,25,27,29];Timeline.spaceWidth=[1,1,2,2,3,3,3,3,3,3,5,5,5,5,7,7,7];Timeline.PADDING_LEFT=4;Timeline.PADDING_RIGHT=8},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DockableLayout=exports.TableLayout=void 0;var areas=_interopRequireWildcard(__webpack_require__(41));var _chart_manager=__webpack_require__(3);var themes=_interopRequireWildcard(__webpack_require__(20));var _chart_settings=__webpack_require__(18);function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return _get(parent,property,receiver)}}else if("value"in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}var TableLayout=function(_areas$ChartAreaGroup){_inherits(TableLayout,_areas$ChartAreaGroup);function TableLayout(name){var _this;_classCallCheck(this,TableLayout);_this=_possibleConstructorReturn(this,(TableLayout.__proto__||Object.getPrototypeOf(TableLayout)).call(this,name));_this._nextRowId=0;_this._focusedRowIndex=-1;return _this}_createClass(TableLayout,[{key:"getNextRowId",value:function getNextRowId(){return this._nextRowId++}},{key:"measure",value:function measure(context,width,height){this.setMeasuredDimension(width,height);var rowH,prevH=0,totalH=0;var h,rows;var rh=[];var i,cnt=this._areas.length;for(i=0;i<cnt;i+=2){rowH=this._areas[i].getHeight();if(rowH===0){if(i===0){rows=cnt+1>>1;var n=rows*2+5;var nh=height/n*2<<0;h=height;for(i=rows-1;i>0;i--){rh.unshift(nh);h-=nh}rh.unshift(h);break}else if(i===2){rowH=prevH/3}else{rowH=prevH}}totalH+=rowH;prevH=rowH;rh.push(rowH)}if(totalH>0){var rate=height/totalH;rows=cnt+1>>1;h=height;for(i=rows-1;i>0;i--){rh[i]*=rate;h-=rh[i]}rh[0]=h}var nw=8;var minRW=76;var maxRW=Math.min(240,width>>1);var rw=minRW;var mgr=_chart_manager.ChartManager.instance;var timeline=mgr.getTimeline(this.getDataSourceName());if(timeline.getFirstIndex()>=0){var firstIndexes=[];for(rw=minRW;rw<maxRW;rw+=nw){firstIndexes.push(timeline.calcFirstIndex(timeline.calcColumnCount(width-rw)))}var lastIndex=timeline.getLastIndex();var dpNames=[".main",".secondary"];var minmaxes=new Array(firstIndexes.length);var iArea,iIndex;for(iArea=0,iIndex=0,rw=minRW;iArea<this._areas.length&&iIndex<firstIndexes.length;iArea+=2){var area=this._areas[iArea];var plotter=mgr.getPlotter(area.getName()+"Range.main");for(var iDp in dpNames){var dp=mgr.getDataProvider(area.getName()+dpNames[iDp]);if(dp===undefined){continue}dp.calcRange(firstIndexes,lastIndex,minmaxes,null);while(iIndex<firstIndexes.length){var minW=plotter.getRequiredWidth(context,minmaxes[iIndex].min);var maxW=plotter.getRequiredWidth(context,minmaxes[iIndex].max);if(Math.max(minW,maxW)<rw){break}iIndex++;rw+=nw}}}}for(i=1;i<this._areas.length;i+=2){this._areas[i].measure(context,rw,rh[i>>1])}var lw=width-rw;for(i=0;i<this._areas.length;i+=2){this._areas[i].measure(context,lw,rh[i>>1])}}},{key:"layout",value:function layout(left,top,right,bottom,forceChange){_get(TableLayout.prototype.__proto__||Object.getPrototypeOf(TableLayout.prototype),"layout",this).call(this,left,top,right,bottom,forceChange);if(this._areas.length<1)return;var area;var center=left+this._areas[0].getMeasuredWidth();var t=top,b;if(!forceChange)forceChange=this.isChanged();var i,cnt=this._areas.length;for(i=0;i<cnt;i++){area=this._areas[i];b=t+area.getMeasuredHeight();area.layout(left,t,center,b,forceChange);i++;area=this._areas[i];area.layout(center,t,this.getRight(),b,forceChange);t=b}this.setChanged(false)}},{key:"drawGrid",value:function drawGrid(context){if(this._areas.length<1){return}var mgr=_chart_manager.ChartManager.instance;var theme=mgr.getTheme(this.getFrameName());context.fillStyle=theme.getColor(themes.Theme.Color.Grid1);context.fillRect(this._areas[0].getRight(),this.getTop(),1,this.getHeight());var i,cnt=this._areas.length-2;for(i=0;i<cnt;i+=2){context.fillRect(this.getLeft(),this._areas[i].getBottom(),this.getWidth(),1)}if(!mgr.getCaptureMouseWheelDirectly()){for(i=0,cnt+=2;i<cnt;i+=2){if(this._areas[i].isSelected()){context.strokeStyle=theme.getColor(themes.Theme.Color.Indicator1);context.strokeRect(this.getLeft()+.5,this.getTop()+.5,this.getWidth()-1,this.getHeight()-1);break}}}}},{key:"highlight",value:function highlight(area){this._highlightedArea=null;var e,i,cnt=this._areas.length;for(i=0;i<cnt;i++){e=this._areas[i];if(e===area){i&=~1;e=this._areas[i];e.highlight(e);this._highlightedArea=e;i++;e=this._areas[i];e.highlight(null);e.highlight(e)}else{e.highlight(null)}}return this._highlightedArea!==null?this:null}},{key:"select",value:function select(area){this._selectedArea=null;var e,i,cnt=this._areas.length;for(i=0;i<cnt;i++){e=this._areas[i];if(e===area){i&=~1;e=this._areas[i];e.select(e);this._selectedArea=e;i++;e=this._areas[i];e.select(e)}else{e.select(null)}}return this._selectedArea!==null?this:null}},{key:"onMouseMove",value:function onMouseMove(x,y){if(this._focusedRowIndex>=0){var upper=this._areas[this._focusedRowIndex];var lower=this._areas[this._focusedRowIndex+2];var d=y-this._oldY;if(d===0)return this;var upperBottom=this._oldUpperBottom+d;var lowerTop=this._oldLowerTop+d;if(upperBottom-upper.getTop()>=60&&lower.getBottom()-lowerTop>=60){upper.setBottom(upperBottom);lower.setTop(lowerTop)}return this}var i,cnt=this._areas.length-2;for(i=0;i<cnt;i+=2){var b=this._areas[i].getBottom();if(y>=b-4&&y<b+4){_chart_manager.ChartManager.instance.showCursor("n-resize");return this}}return null}},{key:"onMouseLeave",value:function onMouseLeave(x,y){this._focusedRowIndex=-1}},{key:"onMouseDown",value:function onMouseDown(x,y){var i,cnt=this._areas.length-2;for(i=0;i<cnt;i+=2){var b=this._areas[i].getBottom();if(y>=b-4&&y<b+4){this._focusedRowIndex=i;this._oldY=y;this._oldUpperBottom=b;this._oldLowerTop=this._areas[i+2].getTop();return this}}return null}},{key:"onMouseUp",value:function onMouseUp(x,y){if(this._focusedRowIndex>=0){this._focusedRowIndex=-1;var i,cnt=this._areas.length;var height=[];for(i=0;i<cnt;i+=2){height.push(this._areas[i].getHeight())}_chart_settings.ChartSettings.get().charts.areaHeight=height;_chart_settings.ChartSettings.save()}return this}}]);return TableLayout}(areas.ChartAreaGroup);exports.TableLayout=TableLayout;var DockableLayout=function(_areas$ChartAreaGroup2){_inherits(DockableLayout,_areas$ChartAreaGroup2);function DockableLayout(name){_classCallCheck(this,DockableLayout);return _possibleConstructorReturn(this,(DockableLayout.__proto__||Object.getPrototypeOf(DockableLayout)).call(this,name))}_createClass(DockableLayout,[{key:"measure",value:function measure(context,width,height){_get(DockableLayout.prototype.__proto__||Object.getPrototypeOf(DockableLayout.prototype),"measure",this).call(this,context,width,height);width=this.getMeasuredWidth();height=this.getMeasuredHeight();for(var i in this._areas){var area=this._areas[i];area.measure(context,width,height);switch(area.getDockStyle()){case areas.ChartArea.DockStyle.left:case areas.ChartArea.DockStyle.Right:width-=area.getMeasuredWidth();break;case areas.ChartArea.DockStyle.Top:case areas.ChartArea.DockStyle.Bottom:height-=area.getMeasuredHeight();break;case areas.ChartArea.DockStyle.Fill:width=0;height=0;break}}}},{key:"layout",value:function layout(left,top,right,bottom,forceChange){_get(DockableLayout.prototype.__proto__||Object.getPrototypeOf(DockableLayout.prototype),"layout",this).call(this,left,top,right,bottom,forceChange);left=this.getLeft();top=this.getTop();right=this.getRight();bottom=this.getBottom();var w,h;if(!forceChange){forceChange=this.isChanged()}for(var i in this._areas){var area=this._areas[i];switch(area.getDockStyle()){case areas.ChartArea.DockStyle.left:w=area.getMeasuredWidth();area.layout(left,top,left+w,bottom,forceChange);left+=w;break;case areas.ChartArea.DockStyle.Top:h=area.getMeasuredHeight();area.layout(left,top,right,top+h,forceChange);top+=h;break;case areas.ChartArea.DockStyle.Right:w=area.getMeasuredWidth();area.layout(right-w,top,right,bottom,forceChange);right-=w;break;case areas.ChartArea.DockStyle.Bottom:h=area.getMeasuredHeight();area.layout(left,bottom-h,right,bottom,forceChange);bottom-=h;break;case areas.ChartArea.DockStyle.Fill:area.layout(left,top,right,bottom,forceChange);left=right;top=bottom;break}}this.setChanged(false)}},{key:"drawGrid",value:function drawGrid(context){var mgr=_chart_manager.ChartManager.instance;var theme=mgr.getTheme(this.getFrameName());var left=this.getLeft();var top=this.getTop();var right=this.getRight();var bottom=this.getBottom();context.fillStyle=theme.getColor(this._gridColor);for(var i in this._areas){var area=this._areas[i];switch(area.getDockStyle()){case areas.ChartArea.DockStyle.Left:context.fillRect(area.getRight(),top,1,bottom-top);left+=area.getWidth();break;case areas.ChartArea.DockStyle.Top:context.fillRect(left,area.getBottom(),right-left,1);top+=area.getHeight();break;case areas.ChartArea.DockStyle.Right:context.fillRect(area.getLeft(),top,1,bottom-top);right-=area.getWidth();break;case areas.ChartArea.DockStyle.Bottom:context.fillRect(left,area.getTop(),right-left,1);bottom-=area.getHeight();break}}}}]);return DockableLayout}(areas.ChartAreaGroup);exports.DockableLayout=DockableLayout},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.STOCHRSIIndicator=exports.PSYIndicator=exports.BOLLIndicator=exports.MTMIndicator=exports.ROCIndicator=exports.KDJIndicator=exports.SARIndicator=exports.WRIndicator=exports.RSIIndicator=exports.EMVIndicator=exports.OBVIndicator=exports.VRIndicator=exports.BRARIndicator=exports.TRIXIndicator=exports.DMAIndicator=exports.DMIIndicator=exports.MACDIndicator=exports.VOLUMEIndicator=exports.EMAIndicator=exports.MAIndicator=exports.HLCIndicator=exports.Indicator=void 0;var exprs=_interopRequireWildcard(__webpack_require__(56));var themes=_interopRequireWildcard(__webpack_require__(20));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj}}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}return _typeof(obj)}function _possibleConstructorReturn(self,call){if(call&&(_typeof(call)==="object"||typeof call==="function")){return call}if(self===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return self}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function")}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}var Indicator=function(){function Indicator(){_classCallCheck(this,Indicator);this._exprEnv=new exprs.ExprEnv;this._rid=0;this._params=[];this._assigns=[];this._outputs=[]}_createClass(Indicator,[{key:"addParameter",value:function addParameter(expr){this._params.push(expr)}},{key:"addAssign",value:function addAssign(expr){this._assigns.push(expr)}},{key:"addOutput",value:function addOutput(expr){this._outputs.push(expr)}},{key:"getParameterCount",value:function getParameterCount(){return this._params.length}},{key:"getParameterAt",value:function getParameterAt(index){return this._params[index]}},{key:"getOutputCount",value:function getOutputCount(){return this._outputs.length}},{key:"getOutputAt",value:function getOutputAt(index){return this._outputs[index]}},{key:"clear",value:function clear(){this._exprEnv.setFirstIndex(-1);var i,cnt;cnt=this._assigns.length;for(i=0;i<cnt;i++){this._assigns[i].clear()}cnt=this._outputs.length;for(i=0;i<cnt;i++){this._outputs[i].clear()}}},{key:"reserve",value:function reserve(count){this._rid++;var i,cnt;cnt=this._assigns.length;for(i=0;i<cnt;i++){this._assigns[i].reserve(this._rid,count)}cnt=this._outputs.length;for(i=0;i<cnt;i++){this._outputs[i].reserve(this._rid,count)}}},{key:"execute",value:function execute(ds,index){if(index<0){return}this._exprEnv.setDataSource(ds);exprs.ExprEnv.set(this._exprEnv);try{var i,cnt;cnt=this._assigns.length;for(i=0;i<cnt;i++){this._assigns[i].assign(index)}cnt=this._outputs.length;for(i=0;i<cnt;i++){this._outputs[i].assign(index)}if(this._exprEnv.getFirstIndex()<0){this._exprEnv.setFirstIndex(index)}}catch(e){if(this._exprEnv.getFirstIndex()>=0){alert(e);throw e}}}},{key:"getParameters",value:function getParameters(){var params=[];var i,cnt=this._params.length;for(i=0;i<cnt;i++){params.push(this._params[i].getValue())}return params}},{key:"setParameters",value:function setParameters(params){if(params instanceof Array&&params.length===this._params.length){for(var i in this._params){this._params[i].setValue(params[i])}}}}]);return Indicator}();exports.Indicator=Indicator;var HLCIndicator=function(_Indicator){_inherits(HLCIndicator,_Indicator);function HLCIndicator(){var _this;_classCallCheck(this,HLCIndicator);_this=_possibleConstructorReturn(this,(HLCIndicator.__proto__||Object.getPrototypeOf(HLCIndicator)).call(this));var M1=new exprs.ParameterExpr("M1",2,1e3,60);_this.addParameter(M1);_this.addOutput(new exprs.OutputExpr("HIGH",new exprs.HighExpr,exprs.OutputExpr.outputStyle.None));_this.addOutput(new exprs.OutputExpr("LOW",new exprs.LowExpr,exprs.OutputExpr.outputStyle.None));_this.addOutput(new exprs.OutputExpr("CLOSE",new exprs.CloseExpr,exprs.OutputExpr.outputStyle.Line,themes.Theme.Color.Indicator0));_this.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M1),exprs.OutputExpr.outputStyle.Line,themes.Theme.Color.Indicator1));return _this}_createClass(HLCIndicator,[{key:"getName",value:function getName(){return"CLOSE"}}]);return HLCIndicator}(Indicator);exports.HLCIndicator=HLCIndicator;var MAIndicator=function(_Indicator2){_inherits(MAIndicator,_Indicator2);function MAIndicator(){var _this2;_classCallCheck(this,MAIndicator);_this2=_possibleConstructorReturn(this,(MAIndicator.__proto__||Object.getPrototypeOf(MAIndicator)).call(this));var M1=new exprs.ParameterExpr("M1",2,1e3,7);var M2=new exprs.ParameterExpr("M2",2,1e3,30);var M3=new exprs.ParameterExpr("M3",2,1e3,0);var M4=new exprs.ParameterExpr("M4",2,1e3,0);var M5=new exprs.ParameterExpr("M5",2,1e3,0);var M6=new exprs.ParameterExpr("M6",2,1e3,0);_this2.addParameter(M1);_this2.addParameter(M2);_this2.addParameter(M3);_this2.addParameter(M4);_this2.addParameter(M5);_this2.addParameter(M6);_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M1)));_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M2)));_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M3)));_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M4)));_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M5)));_this2.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(new exprs.CloseExpr,M6)));return _this2}_createClass(MAIndicator,[{key:"getName",value:function getName(){return"MA"}}]);return MAIndicator}(Indicator);exports.MAIndicator=MAIndicator;var EMAIndicator=function(_Indicator3){_inherits(EMAIndicator,_Indicator3);function EMAIndicator(){var _this3;_classCallCheck(this,EMAIndicator);_this3=_possibleConstructorReturn(this,(EMAIndicator.__proto__||Object.getPrototypeOf(EMAIndicator)).call(this));var M1=new exprs.ParameterExpr("M1",2,1e3,7);var M2=new exprs.ParameterExpr("M2",2,1e3,30);var M3=new exprs.ParameterExpr("M3",2,1e3,0);var M4=new exprs.ParameterExpr("M4",2,1e3,0);var M5=new exprs.ParameterExpr("M5",2,1e3,0);var M6=new exprs.ParameterExpr("M6",2,1e3,0);_this3.addParameter(M1);_this3.addParameter(M2);_this3.addParameter(M3);_this3.addParameter(M4);_this3.addParameter(M5);_this3.addParameter(M6);_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M1)));_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M2)));_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M3)));_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M4)));_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M5)));_this3.addOutput(new exprs.RangeOutputExpr("EMA",new exprs.EmaExpr(new exprs.CloseExpr,M6)));return _this3}_createClass(EMAIndicator,[{key:"getName",value:function getName(){return"EMA"}}]);return EMAIndicator}(Indicator);exports.EMAIndicator=EMAIndicator;var VOLUMEIndicator=function(_Indicator4){_inherits(VOLUMEIndicator,_Indicator4);function VOLUMEIndicator(){var _this4;_classCallCheck(this,VOLUMEIndicator);_this4=_possibleConstructorReturn(this,(VOLUMEIndicator.__proto__||Object.getPrototypeOf(VOLUMEIndicator)).call(this));var M1=new exprs.ParameterExpr("M1",2,500,5);var M2=new exprs.ParameterExpr("M2",2,500,10);_this4.addParameter(M1);_this4.addParameter(M2);var VOLUME=new exprs.OutputExpr("VOLUME",new exprs.VolumeExpr,exprs.OutputExpr.outputStyle.VolumeStick,themes.Theme.Color.Text4);_this4.addOutput(VOLUME);_this4.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(VOLUME,M1),exprs.OutputExpr.outputStyle.Line,themes.Theme.Color.Indicator0));_this4.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(VOLUME,M2),exprs.OutputExpr.outputStyle.Line,themes.Theme.Color.Indicator1));return _this4}_createClass(VOLUMEIndicator,[{key:"getName",value:function getName(){return"VOLUME"}}]);return VOLUMEIndicator}(Indicator);exports.VOLUMEIndicator=VOLUMEIndicator;var MACDIndicator=function(_Indicator5){_inherits(MACDIndicator,_Indicator5);function MACDIndicator(){var _this5;_classCallCheck(this,MACDIndicator);_this5=_possibleConstructorReturn(this,(MACDIndicator.__proto__||Object.getPrototypeOf(MACDIndicator)).call(this));var SHORT=new exprs.ParameterExpr("SHORT",2,200,12);var LONG=new exprs.ParameterExpr("LONG",2,200,26);var MID=new exprs.ParameterExpr("MID",2,200,9);_this5.addParameter(SHORT);_this5.addParameter(LONG);_this5.addParameter(MID);var DIF=new exprs.OutputExpr("DIF",new exprs.SubExpr(new exprs.EmaExpr(new exprs.CloseExpr,SHORT),new exprs.EmaExpr(new exprs.CloseExpr,LONG)));_this5.addOutput(DIF);var DEA=new exprs.OutputExpr("DEA",new exprs.EmaExpr(DIF,MID));_this5.addOutput(DEA);var MACD=new exprs.OutputExpr("MACD",new exprs.MulExpr(new exprs.SubExpr(DIF,DEA),new exprs.ConstExpr(2)),exprs.OutputExpr.outputStyle.MACDStick);_this5.addOutput(MACD);return _this5}_createClass(MACDIndicator,[{key:"getName",value:function getName(){return"MACD"}}]);return MACDIndicator}(Indicator);exports.MACDIndicator=MACDIndicator;var DMIIndicator=function(_Indicator6){_inherits(DMIIndicator,_Indicator6);function DMIIndicator(){var _this6;_classCallCheck(this,DMIIndicator);_this6=_possibleConstructorReturn(this,(DMIIndicator.__proto__||Object.getPrototypeOf(DMIIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,90,14);var MM=new exprs.ParameterExpr("MM",2,60,6);_this6.addParameter(N);_this6.addParameter(MM);var MTR=new exprs.AssignExpr("MTR",new exprs.ExpmemaExpr(new exprs.MaxExpr(new exprs.MaxExpr(new exprs.SubExpr(new exprs.HighExpr,new exprs.LowExpr),new exprs.AbsExpr(new exprs.SubExpr(new exprs.HighExpr,new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1))))),new exprs.AbsExpr(new exprs.SubExpr(new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)),new exprs.LowExpr))),N));_this6.addAssign(MTR);var HD=new exprs.AssignExpr("HD",new exprs.SubExpr(new exprs.HighExpr,new exprs.RefExpr(new exprs.HighExpr,new exprs.ConstExpr(1))));_this6.addAssign(HD);var LD=new exprs.AssignExpr("LD",new exprs.SubExpr(new exprs.RefExpr(new exprs.LowExpr,new exprs.ConstExpr(1)),new exprs.LowExpr));_this6.addAssign(LD);var DMP=new exprs.AssignExpr("DMP",new exprs.ExpmemaExpr(new exprs.IfExpr(new exprs.AndExpr(new exprs.GtExpr(HD,new exprs.ConstExpr(0)),new exprs.GtExpr(HD,LD)),HD,new exprs.ConstExpr(0)),N));_this6.addAssign(DMP);var DMM=new exprs.AssignExpr("DMM",new exprs.ExpmemaExpr(new exprs.IfExpr(new exprs.AndExpr(new exprs.GtExpr(LD,new exprs.ConstExpr(0)),new exprs.GtExpr(LD,HD)),LD,new exprs.ConstExpr(0)),N));_this6.addAssign(DMM);var PDI=new exprs.OutputExpr("PDI",new exprs.MulExpr(new exprs.DivExpr(DMP,MTR),new exprs.ConstExpr(100)));_this6.addOutput(PDI);var MDI=new exprs.OutputExpr("MDI",new exprs.MulExpr(new exprs.DivExpr(DMM,MTR),new exprs.ConstExpr(100)));_this6.addOutput(MDI);var ADX=new exprs.OutputExpr("ADX",new exprs.ExpmemaExpr(new exprs.MulExpr(new exprs.DivExpr(new exprs.AbsExpr(new exprs.SubExpr(MDI,PDI)),new exprs.AddExpr(MDI,PDI)),new exprs.ConstExpr(100)),MM));_this6.addOutput(ADX);var ADXR=new exprs.OutputExpr("ADXR",new exprs.ExpmemaExpr(ADX,MM));_this6.addOutput(ADXR);return _this6}_createClass(DMIIndicator,[{key:"getName",value:function getName(){return"DMI"}}]);return DMIIndicator}(Indicator);exports.DMIIndicator=DMIIndicator;var DMAIndicator=function(_Indicator7){_inherits(DMAIndicator,_Indicator7);function DMAIndicator(){var _this7;_classCallCheck(this,DMAIndicator);_this7=_possibleConstructorReturn(this,(DMAIndicator.__proto__||Object.getPrototypeOf(DMAIndicator)).call(this));var N1=new exprs.ParameterExpr("N1",2,60,10);var N2=new exprs.ParameterExpr("N2",2,250,50);var M=new exprs.ParameterExpr("M",2,100,10);_this7.addParameter(N1);_this7.addParameter(N2);_this7.addParameter(M);var DIF=new exprs.OutputExpr("DIF",new exprs.SubExpr(new exprs.MaExpr(new exprs.CloseExpr,N1),new exprs.MaExpr(new exprs.CloseExpr,N2)));_this7.addOutput(DIF);var DIFMA=new exprs.OutputExpr("DIFMA",new exprs.MaExpr(DIF,M));_this7.addOutput(DIFMA);return _this7}_createClass(DMAIndicator,[{key:"getName",value:function getName(){return"DMA"}}]);return DMAIndicator}(Indicator);exports.DMAIndicator=DMAIndicator;var TRIXIndicator=function(_Indicator8){_inherits(TRIXIndicator,_Indicator8);function TRIXIndicator(){var _this8;_classCallCheck(this,TRIXIndicator);_this8=_possibleConstructorReturn(this,(TRIXIndicator.__proto__||Object.getPrototypeOf(TRIXIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,100,12);var M=new exprs.ParameterExpr("M",2,100,9);_this8.addParameter(N);_this8.addParameter(M);var MTR=new exprs.AssignExpr("MTR",new exprs.EmaExpr(new exprs.EmaExpr(new exprs.EmaExpr(new exprs.CloseExpr,N),N),N));_this8.addAssign(MTR);var TRIX=new exprs.OutputExpr("TRIX",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(MTR,new exprs.RefExpr(MTR,new exprs.ConstExpr(1))),new exprs.RefExpr(MTR,new exprs.ConstExpr(1))),new exprs.ConstExpr(100)));_this8.addOutput(TRIX);var MATRIX=new exprs.OutputExpr("MATRIX",new exprs.MaExpr(TRIX,M));_this8.addOutput(MATRIX);return _this8}_createClass(TRIXIndicator,[{key:"getName",value:function getName(){return"TRIX"}}]);return TRIXIndicator}(Indicator);exports.TRIXIndicator=TRIXIndicator;var BRARIndicator=function(_Indicator9){_inherits(BRARIndicator,_Indicator9);function BRARIndicator(){var _this9;_classCallCheck(this,BRARIndicator);_this9=_possibleConstructorReturn(this,(BRARIndicator.__proto__||Object.getPrototypeOf(BRARIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,120,26);_this9.addParameter(N);var REF_CLOSE_1=new exprs.AssignExpr("REF_CLOSE_1",new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)));_this9.addAssign(REF_CLOSE_1);var BR=new exprs.OutputExpr("BR",new exprs.MulExpr(new exprs.DivExpr(new exprs.SumExpr(new exprs.MaxExpr(new exprs.ConstExpr(0),new exprs.SubExpr(new exprs.HighExpr,REF_CLOSE_1)),N),new exprs.SumExpr(new exprs.MaxExpr(new exprs.ConstExpr(0),new exprs.SubExpr(REF_CLOSE_1,new exprs.LowExpr)),N)),new exprs.ConstExpr(100)));_this9.addOutput(BR);var AR=new exprs.OutputExpr("AR",new exprs.MulExpr(new exprs.DivExpr(new exprs.SumExpr(new exprs.SubExpr(new exprs.HighExpr,new exprs.OpenExpr),N),new exprs.SumExpr(new exprs.SubExpr(new exprs.OpenExpr,new exprs.LowExpr),N)),new exprs.ConstExpr(100)));_this9.addOutput(AR);return _this9}_createClass(BRARIndicator,[{key:"getName",value:function getName(){return"BRAR"}}]);return BRARIndicator}(Indicator);exports.BRARIndicator=BRARIndicator;var VRIndicator=function(_Indicator10){_inherits(VRIndicator,_Indicator10);function VRIndicator(){var _this10;_classCallCheck(this,VRIndicator);_this10=_possibleConstructorReturn(this,(VRIndicator.__proto__||Object.getPrototypeOf(VRIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,100,26);var M=new exprs.ParameterExpr("M",2,100,6);_this10.addParameter(N);_this10.addParameter(M);var REF_CLOSE_1=new exprs.AssignExpr("REF_CLOSE_1",new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)));_this10.addAssign(REF_CLOSE_1);var TH=new exprs.AssignExpr("TH",new exprs.SumExpr(new exprs.IfExpr(new exprs.GtExpr(new exprs.CloseExpr,REF_CLOSE_1),new exprs.VolumeExpr,new exprs.ConstExpr(0)),N));_this10.addAssign(TH);var TL=new exprs.AssignExpr("TL",new exprs.SumExpr(new exprs.IfExpr(new exprs.LtExpr(new exprs.CloseExpr,REF_CLOSE_1),new exprs.VolumeExpr,new exprs.ConstExpr(0)),N));_this10.addAssign(TL);var TQ=new exprs.AssignExpr("TQ",new exprs.SumExpr(new exprs.IfExpr(new exprs.EqExpr(new exprs.CloseExpr,REF_CLOSE_1),new exprs.VolumeExpr,new exprs.ConstExpr(0)),N));_this10.addAssign(TQ);var VR=new exprs.OutputExpr("VR",new exprs.MulExpr(new exprs.DivExpr(new exprs.AddExpr(new exprs.MulExpr(TH,new exprs.ConstExpr(2)),TQ),new exprs.AddExpr(new exprs.MulExpr(TL,new exprs.ConstExpr(2)),TQ)),new exprs.ConstExpr(100)));_this10.addOutput(VR);var MAVR=new exprs.OutputExpr("MAVR",new exprs.MaExpr(VR,M));_this10.addOutput(MAVR);return _this10}_createClass(VRIndicator,[{key:"getName",value:function getName(){return"VR"}}]);return VRIndicator}(Indicator);exports.VRIndicator=VRIndicator;var OBVIndicator=function(_Indicator11){_inherits(OBVIndicator,_Indicator11);function OBVIndicator(){var _this11;_classCallCheck(this,OBVIndicator);_this11=_possibleConstructorReturn(this,(OBVIndicator.__proto__||Object.getPrototypeOf(OBVIndicator)).call(this));var M=new exprs.ParameterExpr("M",2,100,30);_this11.addParameter(M);var REF_CLOSE_1=new exprs.AssignExpr("REF_CLOSE_1",new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)));_this11.addAssign(REF_CLOSE_1);var VA=new exprs.AssignExpr("VA",new exprs.IfExpr(new exprs.GtExpr(new exprs.CloseExpr,REF_CLOSE_1),new exprs.VolumeExpr,new exprs.NegExpr(new exprs.VolumeExpr)));_this11.addAssign(VA);var OBV=new exprs.OutputExpr("OBV",new exprs.SumExpr(new exprs.IfExpr(new exprs.EqExpr(new exprs.CloseExpr,REF_CLOSE_1),new exprs.ConstExpr(0),VA),new exprs.ConstExpr(0)));_this11.addOutput(OBV);var MAOBV=new exprs.OutputExpr("MAOBV",new exprs.MaExpr(OBV,M));_this11.addOutput(MAOBV);return _this11}_createClass(OBVIndicator,[{key:"getName",value:function getName(){return"OBV"}}]);return OBVIndicator}(Indicator);exports.OBVIndicator=OBVIndicator;var EMVIndicator=function(_Indicator12){_inherits(EMVIndicator,_Indicator12);function EMVIndicator(){var _this12;_classCallCheck(this,EMVIndicator);_this12=_possibleConstructorReturn(this,(EMVIndicator.__proto__||Object.getPrototypeOf(EMVIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,90,14);var M=new exprs.ParameterExpr("M",2,60,9);_this12.addParameter(N);_this12.addParameter(M);var VOLUME=new exprs.AssignExpr("VOLUME",new exprs.DivExpr(new exprs.MaExpr(new exprs.VolumeExpr,N),new exprs.VolumeExpr));_this12.addAssign(VOLUME);var MID=new exprs.AssignExpr("MID",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(new exprs.AddExpr(new exprs.HighExpr,new exprs.LowExpr),new exprs.RefExpr(new exprs.AddExpr(new exprs.HighExpr,new exprs.LowExpr),new exprs.ConstExpr(1))),new exprs.AddExpr(new exprs.HighExpr,new exprs.LowExpr)),new exprs.ConstExpr(100)));_this12.addAssign(MID);var EMV=new exprs.OutputExpr("EMV",new exprs.MaExpr(new exprs.DivExpr(new exprs.MulExpr(MID,new exprs.MulExpr(VOLUME,new exprs.SubExpr(new exprs.HighExpr,new exprs.LowExpr))),new exprs.MaExpr(new exprs.SubExpr(new exprs.HighExpr,new exprs.LowExpr),N)),N));_this12.addOutput(EMV);var MAEMV=new exprs.OutputExpr("MAEMV",new exprs.MaExpr(EMV,M));_this12.addOutput(MAEMV);return _this12}_createClass(EMVIndicator,[{key:"getName",value:function getName(){return"EMV"}}]);return EMVIndicator}(Indicator);exports.EMVIndicator=EMVIndicator;var RSIIndicator=function(_Indicator13){_inherits(RSIIndicator,_Indicator13);function RSIIndicator(){var _this13;_classCallCheck(this,RSIIndicator);_this13=_possibleConstructorReturn(this,(RSIIndicator.__proto__||Object.getPrototypeOf(RSIIndicator)).call(this));var N1=new exprs.ParameterExpr("N1",2,120,6);var N2=new exprs.ParameterExpr("N2",2,250,12);var N3=new exprs.ParameterExpr("N3",2,500,24);_this13.addParameter(N1);_this13.addParameter(N2);_this13.addParameter(N3);var LC=new exprs.AssignExpr("LC",new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)));_this13.addAssign(LC);var CLOSE_LC=new exprs.AssignExpr("CLOSE_LC",new exprs.SubExpr(new exprs.CloseExpr,LC));_this13.addAssign(CLOSE_LC);_this13.addOutput(new exprs.OutputExpr("RSI1",new exprs.MulExpr(new exprs.DivExpr(new exprs.SmaExpr(new exprs.MaxExpr(CLOSE_LC,new exprs.ConstExpr(0)),N1,new exprs.ConstExpr(1)),new exprs.SmaExpr(new exprs.AbsExpr(CLOSE_LC),N1,new exprs.ConstExpr(1))),new exprs.ConstExpr(100))));_this13.addOutput(new exprs.OutputExpr("RSI2",new exprs.MulExpr(new exprs.DivExpr(new exprs.SmaExpr(new exprs.MaxExpr(CLOSE_LC,new exprs.ConstExpr(0)),N2,new exprs.ConstExpr(1)),new exprs.SmaExpr(new exprs.AbsExpr(CLOSE_LC),N2,new exprs.ConstExpr(1))),new exprs.ConstExpr(100))));_this13.addOutput(new exprs.OutputExpr("RSI3",new exprs.MulExpr(new exprs.DivExpr(new exprs.SmaExpr(new exprs.MaxExpr(CLOSE_LC,new exprs.ConstExpr(0)),N3,new exprs.ConstExpr(1)),new exprs.SmaExpr(new exprs.AbsExpr(CLOSE_LC),N3,new exprs.ConstExpr(1))),new exprs.ConstExpr(100))));return _this13}_createClass(RSIIndicator,[{key:"getName",value:function getName(){return"RSI"}}]);return RSIIndicator}(Indicator);exports.RSIIndicator=RSIIndicator;var WRIndicator=function(_Indicator14){_inherits(WRIndicator,_Indicator14);function WRIndicator(){var _this14;_classCallCheck(this,WRIndicator);_this14=_possibleConstructorReturn(this,(WRIndicator.__proto__||Object.getPrototypeOf(WRIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,100,10)
;var N1=new exprs.ParameterExpr("N1",2,100,6);_this14.addParameter(N);_this14.addParameter(N1);var HHV=new exprs.AssignExpr("HHV",new exprs.HhvExpr(new exprs.HighExpr,N));_this14.addAssign(HHV);var HHV1=new exprs.AssignExpr("HHV1",new exprs.HhvExpr(new exprs.HighExpr,N1));_this14.addAssign(HHV1);var LLV=new exprs.AssignExpr("LLV",new exprs.LlvExpr(new exprs.LowExpr,N));_this14.addAssign(LLV);var LLV1=new exprs.AssignExpr("LLV1",new exprs.LlvExpr(new exprs.LowExpr,N1));_this14.addAssign(LLV1);var WR1=new exprs.OutputExpr("WR1",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(HHV,new exprs.CloseExpr),new exprs.SubExpr(HHV,LLV)),new exprs.ConstExpr(100)));_this14.addOutput(WR1);var WR2=new exprs.OutputExpr("WR2",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(HHV1,new exprs.CloseExpr),new exprs.SubExpr(HHV1,LLV1)),new exprs.ConstExpr(100)));_this14.addOutput(WR2);return _this14}_createClass(WRIndicator,[{key:"getName",value:function getName(){return"WR"}}]);return WRIndicator}(Indicator);exports.WRIndicator=WRIndicator;var SARIndicator=function(_Indicator15){_inherits(SARIndicator,_Indicator15);function SARIndicator(){var _this15;_classCallCheck(this,SARIndicator);_this15=_possibleConstructorReturn(this,(SARIndicator.__proto__||Object.getPrototypeOf(SARIndicator)).call(this));var N=new exprs.ConstExpr(4);var MIN=new exprs.ConstExpr(2);var STEP=new exprs.ConstExpr(2);var MAX=new exprs.ConstExpr(20);_this15.addOutput(new exprs.OutputExpr("SAR",new exprs.SarExpr(N,MIN,STEP,MAX),exprs.OutputExpr.outputStyle.SARPoint));return _this15}_createClass(SARIndicator,[{key:"getName",value:function getName(){return"SAR"}}]);return SARIndicator}(Indicator);exports.SARIndicator=SARIndicator;var KDJIndicator=function(_Indicator16){_inherits(KDJIndicator,_Indicator16);function KDJIndicator(){var _this16;_classCallCheck(this,KDJIndicator);_this16=_possibleConstructorReturn(this,(KDJIndicator.__proto__||Object.getPrototypeOf(KDJIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,90,9);var M1=new exprs.ParameterExpr("M1",2,30,3);var M2=new exprs.ParameterExpr("M2",2,30,3);_this16.addParameter(N);_this16.addParameter(M1);_this16.addParameter(M2);var HHV=new exprs.AssignExpr("HHV",new exprs.HhvExpr(new exprs.HighExpr,N));_this16.addAssign(HHV);var LLV=new exprs.AssignExpr("LLV",new exprs.LlvExpr(new exprs.LowExpr,N));_this16.addAssign(LLV);var RSV=new exprs.AssignExpr("RSV",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(new exprs.CloseExpr,LLV),new exprs.SubExpr(HHV,LLV)),new exprs.ConstExpr(100)));_this16.addAssign(RSV);var K=new exprs.OutputExpr("K",new exprs.SmaExpr(RSV,M1,new exprs.ConstExpr(1)));_this16.addOutput(K);var D=new exprs.OutputExpr("D",new exprs.SmaExpr(K,M2,new exprs.ConstExpr(1)));_this16.addOutput(D);var J=new exprs.OutputExpr("J",new exprs.SubExpr(new exprs.MulExpr(K,new exprs.ConstExpr(3)),new exprs.MulExpr(D,new exprs.ConstExpr(2))));_this16.addOutput(J);return _this16}_createClass(KDJIndicator,[{key:"getName",value:function getName(){return"KDJ"}}]);return KDJIndicator}(Indicator);exports.KDJIndicator=KDJIndicator;var ROCIndicator=function(_Indicator17){_inherits(ROCIndicator,_Indicator17);function ROCIndicator(){var _this17;_classCallCheck(this,ROCIndicator);_this17=_possibleConstructorReturn(this,(ROCIndicator.__proto__||Object.getPrototypeOf(ROCIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,120,12);var M=new exprs.ParameterExpr("M",2,60,6);_this17.addParameter(N);_this17.addParameter(M);var REF_CLOSE_N=new exprs.AssignExpr("REF_CLOSE_N",new exprs.RefExpr(new exprs.CloseExpr,N));_this17.addAssign(REF_CLOSE_N);var ROC=new exprs.OutputExpr("ROC",new exprs.MulExpr(new exprs.DivExpr(new exprs.SubExpr(new exprs.CloseExpr,REF_CLOSE_N),REF_CLOSE_N),new exprs.ConstExpr(100)));_this17.addOutput(ROC);var MAROC=new exprs.OutputExpr("MAROC",new exprs.MaExpr(ROC,M));_this17.addOutput(MAROC);return _this17}_createClass(ROCIndicator,[{key:"getName",value:function getName(){return"ROC"}}]);return ROCIndicator}(Indicator);exports.ROCIndicator=ROCIndicator;var MTMIndicator=function(_Indicator18){_inherits(MTMIndicator,_Indicator18);function MTMIndicator(){var _this18;_classCallCheck(this,MTMIndicator);_this18=_possibleConstructorReturn(this,(MTMIndicator.__proto__||Object.getPrototypeOf(MTMIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,120,12);var M=new exprs.ParameterExpr("M",2,60,6);_this18.addParameter(N);_this18.addParameter(M);var MTM=new exprs.OutputExpr("MTM",new exprs.SubExpr(new exprs.CloseExpr,new exprs.RefExpr(new exprs.CloseExpr,N)));_this18.addOutput(MTM);var MTMMA=new exprs.OutputExpr("MTMMA",new exprs.MaExpr(MTM,M));_this18.addOutput(MTMMA);return _this18}_createClass(MTMIndicator,[{key:"getName",value:function getName(){return"MTM"}}]);return MTMIndicator}(Indicator);exports.MTMIndicator=MTMIndicator;var BOLLIndicator=function(_Indicator19){_inherits(BOLLIndicator,_Indicator19);function BOLLIndicator(){var _this19;_classCallCheck(this,BOLLIndicator);_this19=_possibleConstructorReturn(this,(BOLLIndicator.__proto__||Object.getPrototypeOf(BOLLIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,120,20);_this19.addParameter(N);var STD_CLOSE_N=new exprs.AssignExpr("STD_CLOSE_N",new exprs.StdExpr(new exprs.CloseExpr,N));_this19.addAssign(STD_CLOSE_N);var BOLL=new exprs.OutputExpr("BOLL",new exprs.MaExpr(new exprs.CloseExpr,N));_this19.addOutput(BOLL);var UB=new exprs.OutputExpr("UB",new exprs.AddExpr(BOLL,new exprs.MulExpr(new exprs.ConstExpr(2),STD_CLOSE_N)));_this19.addOutput(UB);var LB=new exprs.OutputExpr("LB",new exprs.SubExpr(BOLL,new exprs.MulExpr(new exprs.ConstExpr(2),STD_CLOSE_N)));_this19.addOutput(LB);return _this19}_createClass(BOLLIndicator,[{key:"getName",value:function getName(){return"BOLL"}}]);return BOLLIndicator}(Indicator);exports.BOLLIndicator=BOLLIndicator;var PSYIndicator=function(_Indicator20){_inherits(PSYIndicator,_Indicator20);function PSYIndicator(){var _this20;_classCallCheck(this,PSYIndicator);_this20=_possibleConstructorReturn(this,(PSYIndicator.__proto__||Object.getPrototypeOf(PSYIndicator)).call(this));var N=new exprs.ParameterExpr("N",2,100,12);var M=new exprs.ParameterExpr("M",2,100,6);_this20.addParameter(N);_this20.addParameter(M);var PSY=new exprs.OutputExpr("PSY",new exprs.MulExpr(new exprs.DivExpr(new exprs.CountExpr(new exprs.GtExpr(new exprs.CloseExpr,new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1))),N),N),new exprs.ConstExpr(100)));_this20.addOutput(PSY);var PSYMA=new exprs.OutputExpr("PSYMA",new exprs.MaExpr(PSY,M));_this20.addOutput(PSYMA);return _this20}_createClass(PSYIndicator,[{key:"getName",value:function getName(){return"PSY"}}]);return PSYIndicator}(Indicator);exports.PSYIndicator=PSYIndicator;var STOCHRSIIndicator=function(_Indicator21){_inherits(STOCHRSIIndicator,_Indicator21);function STOCHRSIIndicator(){var _this21;_classCallCheck(this,STOCHRSIIndicator);_this21=_possibleConstructorReturn(this,(STOCHRSIIndicator.__proto__||Object.getPrototypeOf(STOCHRSIIndicator)).call(this));_this21.getName=function(){return"StochRSI"};var N=new exprs.ParameterExpr("N",3,100,14);var M=new exprs.ParameterExpr("M",3,100,14);var P1=new exprs.ParameterExpr("P1",2,50,3);var P2=new exprs.ParameterExpr("P2",2,50,3);_this21.addParameter(N);_this21.addParameter(M);_this21.addParameter(P1);_this21.addParameter(P2);var LC=new exprs.AssignExpr("LC",new exprs.RefExpr(new exprs.CloseExpr,new exprs.ConstExpr(1)));_this21.addAssign(LC);var CLOSE_LC=new exprs.AssignExpr("CLOSE_LC",new exprs.SubExpr(new exprs.CloseExpr,LC));_this21.addAssign(CLOSE_LC);var RSI=new exprs.AssignExpr("RSI",new exprs.MulExpr(new exprs.DivExpr(new exprs.SmaExpr(new exprs.MaxExpr(CLOSE_LC,new exprs.ConstExpr(0)),N,new exprs.ConstExpr(1)),new exprs.SmaExpr(new exprs.AbsExpr(CLOSE_LC),N,new exprs.ConstExpr(1))),new exprs.ConstExpr(100)));_this21.addAssign(RSI);var STOCHRSI=new exprs.OutputExpr("STOCHRSI",new exprs.MulExpr(new exprs.DivExpr(new exprs.MaExpr(new exprs.SubExpr(RSI,new exprs.LlvExpr(RSI,M)),P1),new exprs.MaExpr(new exprs.SubExpr(new exprs.HhvExpr(RSI,M),new exprs.LlvExpr(RSI,M)),P1)),new exprs.ConstExpr(100)));_this21.addOutput(STOCHRSI);_this21.addOutput(new exprs.RangeOutputExpr("MA",new exprs.MaExpr(STOCHRSI,P2)));return _this21}return STOCHRSIIndicator}(Indicator);exports.STOCHRSIIndicator=STOCHRSIIndicator},function(module,exports,__webpack_require__){var content=__webpack_require__(106);if(typeof content==="string")content=[[module.i,content,""]];var transform;var options={hmr:true};options.transform=transform;var update=__webpack_require__(118)(content,options);if(content.locals)module.exports=content.locals;if(false){if(!content.locals){module.hot.accept("!!../../node_modules/_css-loader@0.28.7@css-loader/index.js!./main.css",function(){var newContent=require("!!../../node_modules/_css-loader@0.28.7@css-loader/index.js!./main.css");if(typeof newContent==="string")newContent=[[module.id,newContent,""]];update(newContent)})}module.hot.dispose(function(){update()})}},function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(107)(undefined)
;exports.push([module.i,"html,\nbody {\n    min-height: 100%;\n    margin: 0;\n    min-width: 100%\n}\n\n.chart_container {\n    cursor: default;\n    font-family: PingFangSC-Light;\n    font-size: 12px;\n    height: 100%;\n    position: relative;\n    width: 100%\n}\n\n.chart_container div,\n.chart_container ul,\n.chart_container form {\n    margin: 0;\n    padding: 0\n}\n\n.chart_container a:hover {\n    text-decoration: none\n}\n\n.chart_container ul {\n    list-style: none;\n    border: 0;\n    margin: 0;\n    padding: 0\n}\n\n.chart_container button {\n    cursor: pointer\n}\n\n#chart_dom_elem_cache {\n    *font-weight: bold;\n    position: absolute;\n    visibility: hidden;\n    z-index: -1\n}\n\n#chart_toolbar {\n    border-bottom: 1px solid;\n    *font-weight: bold;\n    height: 29px;\n    position: absolute;\n    z-index: 3\n}\n\n.chart_container.dark #chart_toolbar {\n    background-color: #0a0a0a;\n    border-bottom-color: #404040\n}\n\n.chart_container.light #chart_toolbar {\n    background-color: #fff;\n    border-bottom-color: #afb1b3\n}\n\n.chart_container .chart_toolbar_sep {\n    float: left;\n    height: 100%;\n    width: 16px\n}\n\n.chart_container .chart_toolbar_minisep {\n    height: 100%;\n    width: 4px\n}\n\n.chart_container .chart_dropdown {\n    display: inline-block;\n        position: relative;\n    z-index: 100\n}\n\n.chart_container .chart_dropdown_t {\n    background-origin: content-box;\n    background-repeat: no-repeat;\n    border: 0;\n    border-bottom-width: 0;\n    margin-top: 3px;\n    padding-right: 10px;\n    z-index: 101;\n    position: relative\n}\n\n.chart_container .chart_dropdown_t a {\n    display: inline-block;\n    padding: 3px 12px 5px 10px\n}\n\n.chart_container .chart_dropdown_data {\n    border: 0;\n    display: none;\n    position: absolute;\n    padding: 6px 8px 6px 8px;\n    margin-top: -1px;\n    z-index: 100\n}\n\n.chart_container .chart_dropdown_data table {\n    border-collapse: collapse;\n    font-weight: normal;\n    white-space: nowrap\n}\n\n.chart_container .chart_dropdown_data td {\n    border-bottom: 1px solid;\n    padding: 8px 6px;\n    vertical-align: top\n}\n\n.market_chooser .chart_dropdown_data {\n    width: 370px\n}\n\n.market_chooser .chart_dropdown_data td {\n    border-bottom: 1px solid;\n    padding: 1px 6px !important;\n    vertical-align: top;\n    line-height: 24px\n}\n\n.market_chooser li {\n    float: left;\n    width: 80px;\n    height: 24px;\n    line-height: 24px\n}\n\n.chart_container .chart_dropdown_data td.marketName_ a.dark {\n    color: #fff\n}\n\n.chart_container .chart_dropdown_data td.marketName_ a.light {\n    color: #000\n}\n\n.chart_container .chart_dropdown_data table tr:last-child td {\n    border-bottom: 0\n}\n\n.chart_container .chart_dropdown_data li {\n    white-space: nowrap;\n    display: inline-block\n}\n\n.chart_container .chart_dropdown_data a {\n    text-decoration: none;\n    cursor: pointer;\n    padding: 5px 6px 5px 6px\n}\n\n.chart_container .chart_dropdown-hover.chart_dropdown_data {\n    display: block\n}\n\n#chart_dropdown_symbols .chart_dropdown_data td {\n    padding: 8px 6px 0 6px\n}\n\n#chart_dropdown_symbols .chart_dropdown_data li {\n    display: block;\n    height: 26px\n}\n\n#chart_dropdown_symbols .chart_dropdown_data a {\n    cursor: pointer\n}\n\n#chart_dropdown_themes .chart_dropdown_data td:first-child {\n    padding: 6px 1px 7px 6px\n}\n\n.chart_container.dark .chart_dropdown_t {\n    background-image: url("+__webpack_require__(108)+");\n    background-position: right 9px;\n    border-color: #0a0a0a;\n    color: #e5e5e5\n}\n\n.chart_container.dark .chart_dropdown-hover.chart_dropdown_t {\n    background-color: #0a0a0a;\n    background-image: url("+__webpack_require__(109)+");\n    background-position: right 8px;\n    border-color: #606060;\n    color: #fff\n}\n\n.chart_container.dark .chart_dropdown_data {\n    background-color: rgba(10, 10, 10, 0.8);\n    border-color: #606060\n}\n\n.chart_container.dark .chart_dropdown_data td {\n    border-bottom-color: #404040;\n    color: #e5e5e5\n}\n\n.chart_container.dark .chart_dropdown_data li a {\n    color: #1987da\n}\n\n.chart_container.dark .chart_dropdown_data li a:hover {\n    background-color: #383838\n}\n\n.chart_container.dark .chart_dropdown_data li a.selected {\n    color: #ffac00\n}\n\n.chart_container.light .chart_dropdown_t {\n    background-image: url("+__webpack_require__(110)+");\n    background-position: right 10px;\n    border-color: #fff;\n    color: #393c40\n}\n\n.chart_container.light .chart_dropdown-hover.chart_dropdown_t {\n    background-color: #fff;\n    background-image: url("+__webpack_require__(111)+");\n    background-position: right 9px;\n    border-color: #4c4f53;\n    color: #393c40\n}\n\n.chart_container.light .chart_dropdown_data {\n    background-color: #fff;\n    border-color: #4c4f53\n}\n\n.chart_container.light .chart_dropdown_data td {\n    border-bottom-color: #e4e5e6;\n    color: #393c40\n}\n\n.chart_container.light .chart_dropdown_data li a {\n    color: #1478c8\n}\n\n.chart_container.light .chart_dropdown_data a:hover {\n    background-color: #f4f4f4\n}\n\n.chart_container.light .chart_dropdown_data a.selected {\n    color: #f27935\n}\n\n.chart_container .chart_toolbar_label {\n    cursor: default;\n    display: inline-block;\n    float: left;\n    padding: 7px 4px\n}\n\n.chart_container.dark .chart_toolbar_label {\n    border-color: #232323;\n    color: #e5e5e5\n}\n\n.chart_container.light .chart_toolbar_label {\n    border-color: #fff;\n    color: #393c40\n}\n\n.chart_container .chart_toolbar_button {\n    border: 1px solid;\n    cursor: pointer;\n        margin: 3px 2px;\n    padding: 3px 10px;\n    position: relative;\n    z-index: 100\n}\n\n.chart_container.dark .chart_toolbar_button {\n    border-color: #404040;\n    color: #e5e5e5\n}\n\n.chart_container.dark .chart_toolbar_button:hover {\n    background-color: #383838;\n    border-color: #606060;\n    color: #fff\n}\n\n.chart_container.dark .chart_toolbar_button.selected {\n    background-color: #383838;\n    border-color: #606060;\n    color: #ffac00\n}\n\n.chart_container.dark .chart_toolbar_button.selected:hover {\n    background-color: #474747;\n    border-color: #808080;\n    color: #ffac00\n}\n\n.chart_container.light .chart_toolbar_button {\n    border-color: #ccc;\n    color: #393c40\n}\n\n.chart_container.light .chart_toolbar_button:hover {\n    background-color: #f4f4f4;\n    color: #393c40\n}\n\n.chart_container.light .chart_toolbar_button.selected {\n    background-color: #f4f4f4;\n    border-color: #f27935;\n    color: #f27935\n}\n\n.chart_container .chart_toolbar_tabgroup {\n    float: left\n}\n\n.chart_container .chart_toolbar_tabgroup li {\n    display: inline-block;\n    padding: 4px 0;\n    margin: 3px 0\n}\n\n.chart_container .chart_toolbar_tabgroup li a {\n    cursor: pointer;\n    padding: 4px 4px\n}\n\n.chart_container .chart_toolbar_tabgroup li a:hover {\n    text-decoration: none\n}\n\n.chart_container.dark .chart_toolbar_tabgroup li a {\n    color: #1987da\n}\n\n.chart_container.dark .chart_toolbar_tabgroup li a:hover {\n    background-color: #383838\n}\n\n.chart_container.dark .chart_toolbar_tabgroup li a.selected {\n    color: #ffac00\n}\n\n.chart_container.light .chart_toolbar_tabgroup li a {\n    color: #1478c8\n}\n\n.chart_container.light .chart_toolbar_tabgroup li a:hover {\n    background-color: #f4f4f4\n}\n\n.chart_container.light .chart_toolbar_tabgroup li a.selected {\n    color: #f27935\n}\n\n#chart_toolbar_periods_horz {\n    display: inline-block;\n     position: relative;\n    z-index: 100\n}\n\n#chart_toolbar_periods_vert {\n   \n}\n\n.chart_container a.chart_icon {\n    border: 1px solid;\n    height: 16px;\n    padding: 0;\n    width: 16px\n}\n\n.chart_container a.chart_icon:hover {\n    border-width: 2px;\n    height: 14px;\n    width: 14px\n}\n\n.chart_container .chart_dropdown_data a.chart_icon {\n    display: inline-block;\n    magin: 0 6px 0 6px\n}\n\n.chart_container a.chart_icon_theme_dark,\n.chart_container .chart_dropdown_data li a.chart_icon_theme_dark:hover {\n    background-color: #000\n}\n\n.chart_container a.chart_icon_theme_light,\n.chart_container .chart_dropdown_data li a.chart_icon_theme_light:hover {\n    background-color: #fff\n}\n\n.chart_container #chart_toolbar_theme {\n    padding: 0 8px\n}\n\n.chart_container #chart_toolbar_theme a.chart_icon {\n    cursor: pointer;\n    float: left;\n    margin: 6px 4px\n}\n\n.chart_container #chart_select_theme td:last-child {\n    padding: 6px 6px 0 8px\n}\n\n.chart_container #chart_select_theme li {\n    padding: 0 4px 0 4px\n}\n\n.chart_container.dark a.chart_icon {\n    border-color: #aaa\n}\n\n.chart_container.dark a.chart_icon:hover {\n    border-color: #1987da\n}\n\n.chart_container.dark a.chart_icon.selected {\n    border-color: #ffac00\n}\n\n.chart_container.light a.chart_icon {\n    border-color: #aaa\n}\n\n.chart_container.light a.chart_icon.selected {\n    border-color: #f27935\n}\n\n.chart_container #chart_updated_time {\n    float: right;\n    margin: 4px 3px;\n    padding: 3px 10px\n}\n\n.chart_container.dark #chart_updated_time {\n    color: #e5e5e5\n}\n\n.chart_container.light #chart_updated_time {\n    color: #393c40\n}\n\n#chart_toolpanel {\n    border-right: 1px solid;\n    display: none;\n    position: absolute;\n    width: 32px;\n    z-index: 2\n}\n\n#chart_toolpanel .chart_toolpanel_separator {\n    position: relative;\n    height: 4px\n}\n\n#chart_toolpanel .chart_toolpanel_button {\n    position: relative;\n    z-index: 100\n}\n\n#chart_toolpanel .chart_toolpanel_icon {\n    background-origin: content-box;\n    background-repeat: no-repeat;\n    border: 1px solid;\n    cursor: pointer;\n    height: 16px;\n    margin: 1px 4px 1px 4px;\n    padding: 3px;\n    position: relative;\n    width: 16px;\n    z-index: 101\n}\n\n#chart_toolpanel .chart_toolpanel_tip {\n    border-radius: 4px;\n    border: 1px solid;\n    display: none;\n    *font-weight: bold;\n    position: absolute;\n    padding: 3px 6px 4px 6px;\n    margin-left: 36px;\n    margin-top: -25px;\n    white-space: nowrap;\n    z-index: 100\n}\n\n#chart_toolpanel .chart_toolpanel_button:hover .chart_toolpanel_tip {\n    display: block\n}\n\n.chart_container.dark #chart_toolpanel {\n    background-color: #0a0a0a;\n    border-right-color: #404040\n}\n\n.chart_container.dark .chart_toolpanel_icon {\n    background-color: #0a0a0a;\n    border-color: #0a0a0a\n}\n\n.chart_container.dark .chart_toolpanel_button:hover .chart_toolpanel_icon {\n    background-color: #404040;\n    border-color: #666\n}\n\n.chart_container.dark .chart_toolpanel_button.selected .chart_toolpanel_icon {\n    background-color: #080808;\n    border-color: #666\n}\n\n.chart_container.dark .chart_toolpanel_tip {\n    background-color: #ffac00;\n    border-color: #ffac00;\n    color: #0a0a0a\n}\n\n.chart_container.light #chart_toolpanel {\n    background-color: #fff;\n    border-right-color: #afb1b3\n}\n\n.chart_container.light .chart_toolpanel_icon {\n    background-color: #fff;\n    border-color: #fff\n}\n\n.chart_container.light .chart_toolpanel_button:hover .chart_toolpanel_icon {\n    background-color: #eee;\n    border-color: #afb1b3\n}\n\n.chart_container.light .chart_toolpanel_button.selected .chart_toolpanel_icon {\n    background-color: #f4f4f4;\n    border-color: #afb1b3\n}\n\n.chart_container.light .chart_toolpanel_tip {\n    background-color: #f27938;\n    border-color: #f27938;\n    color: #eee\n}\n\n.chart_container.dark #chart_toolpanel .chart_toolpanel_button .chart_toolpanel_icon {\n    background-image: url("+__webpack_require__(112)+")\n}\n\n.chart_container.dark #chart_toolpanel .chart_toolpanel_button.selected .chart_toolpanel_icon {\n    background-image: url("+__webpack_require__(113)+")\n}\n\n.chart_container.dark #chart_toolbar .chart_BoxSize {\n    background: url("+__webpack_require__(114)+") no-repeat;\n}\n\n.chart_container.light #chart_toolpanel .chart_toolpanel_button .chart_toolpanel_icon {\n    background-image: url("+__webpack_require__(115)+")\n}\n\n.chart_container.light #chart_toolpanel .chart_toolpanel_button.selected .chart_toolpanel_icon {\n    background-image: url("+__webpack_require__(116)+")\n}\n\n.chart_container.light #chart_toolbar .chart_BoxSize {\n    background: url("+__webpack_require__(117)+") no-repeat;\n}\n\n.chart_container #chart_toolpanel #chart_Cursor {\n    background-position: 0 0\n}\n\n.chart_container #chart_toolpanel #chart_CrossCursor {\n    background-position: 0 -20px\n}\n\n.chart_container #chart_toolpanel #chart_SegLine {\n    background-position: 0 -40px\n}\n\n.chart_container #chart_toolpanel #chart_StraightLine {\n    background-position: 0 -60px\n}\n\n.chart_container #chart_toolpanel #chart_RayLine {\n    background-position: 0 -100px\n}\n\n.chart_container #chart_toolpanel #chart_ArrowLine {\n    background-position: 0 -80px\n}\n\n.chart_container #chart_toolpanel #chart_HoriSegLine {\n    background-position: 0 -160px\n}\n\n.chart_container #chart_toolpanel #chart_HoriStraightLine {\n    background-position: 0 -120px\n}\n\n.chart_container #chart_toolpanel #chart_HoriRayLine {\n    background-position: 0 -140px\n}\n\n.chart_container #chart_toolpanel #chart_VertiStraightLine {\n    background-position: 0 -180px\n}\n\n.chart_container #chart_toolpanel #chart_PriceLine {\n    background-position: 0 -200px\n}\n\n.chart_container #chart_toolpanel #chart_TriParallelLine {\n    background-position: 0 -220px\n}\n\n.chart_container #chart_toolpanel #chart_BiParallelLine {\n    background-position: 0 -240px\n}\n\n.chart_container #chart_toolpanel #chart_BiParallelRayLine {\n    background-position: 0 -260px\n}\n\n.chart_container .chart_toolpanel_button #chart_DrawFibRetrace {\n    background-position: 0 -280px\n}\n\n.chart_container #chart_toolpanel #chart_DrawFibFans {\n    background-position: 0 -300px\n}\n\n#chart_tabbar {\n    border-top: 1px solid;\n    cursor: default;\n    display: none;\n    *font-weight: bold;\n    height: 22px;\n    overflow: hidden;\n    position: absolute;\n    z-index: 1\n}\n\n#chart_tabbar ul {\n    height: 100%;\n    list-style: none;\n    padding: 0 0 0 4px\n}\n\n#chart_tabbar li {\n    display: inline-block;\n    height: 100%;\n    margin: 0\n}\n\n#chart_tabbar a {\n    cursor: pointer;\n    display: inline-block;\n    height: 100%;\n    margin: 0;\n    padding: 3px 4px 0 4px;\n    overflow: hidden\n}\n\n#chart_tabbar a:hover {\n    text-decoration: none\n}\n\n.chart_container.dark #chart_tabbar {\n    background-color: #0a0a0a;\n    border-top-color: #404040\n}\n\n.chart_container.dark #chart_tabbar a {\n    color: #e5e5e5\n}\n\n.chart_container.dark #chart_tabbar a:hover {\n    background-color: #383838;\n    color: #fff\n}\n\n.chart_container.dark #chart_tabbar a.selected {\n    color: #ffac00\n}\n\n.chart_container.light #chart_tabbar {\n    background-color: #fff;\n    border-top-color: #afb1b3\n}\n\n.chart_container.light #chart_tabbar a {\n    color: #393c40\n}\n\n.chart_container.light #chart_tabbar a:hover {\n    background-color: #f4f4f4;\n    color: #393c40\n}\n\n.chart_container.light #chart_tabbar a.selected {\n    color: #f27935\n}\n\n#chart_canvasGroup {\n    position: absolute;\n    z-index: 0\n}\n\n#chart_mainCanvas {\n    overflow: hidden;\n    position: absolute;\n    z-index: 0\n}\n\n#chart_overlayCanvas {\n    overflow: hidden;\n    position: absolute;\n    z-index: 2\n}\n\n#chart_loading {\n    border: 1px solid;\n    border-radius: 4px;\n    font-size: 18px;\n    font-weight: bold;\n    line-height: 48px;\n    overflow: hidden;\n    position: absolute;\n    text-align: center;\n    visibility: hidden;\n    width: 200px;\n    z-index: 200\n}\n\n#chart_loading.activated {\n    visibility: visible\n}\n\n.chart_container.dark #chart_loading {\n    border-color: #aaa;\n    background-color: rgba(0, 0, 0, 0.6);\n    color: #ccc\n}\n\n.chart_container.light #chart_loading {\n    border-color: #afb1b3;\n    background-color: rgba(244, 244, 244, 0.8);\n    color: #393c40\n}\n\n#chart_parameter_settings {\n    border-radius: 4px;\n    border: 1px solid;\n    width: 640px;\n    position: absolute;\n    overflow: hidden;\n    visibility: hidden;\n    z-index: 500\n}\n\n#chart_parameter_settings.clicked {\n    visibility: visible\n}\n\n#chart_parameter_settings h2 {\n    padding: 8px 12px;\n    margin: 0\n}\n\n#chart_parameter_settings table {\n    border-collapse: collapse;\n    width: 100%\n}\n\n#chart_parameter_settings tr {\n    line-height: 32px\n}\n\n#chart_parameter_settings th {\n    text-align: right;\n    padding: 0 4px 0 16px\n}\n\n#chart_parameter_settings input {\n    width: 2em;\n    margin: 0 2px 0 2px\n}\n\n#chart_parameter_settings #close_settings {\n    border-radius: 4px;\n    cursor: pointer;\n    font-weight: bold;\n    text-align: center;\n    margin: 8px auto;\n    padding: 5px 24px 5px 24px;\n    width: 84px\n}\n\n#chart_parameter_settings .chart_str_default {\n    margin-right: 24px\n}\n\n.chart_container.dark #chart_parameter_settings {\n    background-color: rgba(0, 0, 0, 0.9);\n    border-color: rgba(0, 0, 0, 0.9);\n    color: #ccc;\n}\n\n.chart_container.dark #chart_parameter_settings #close_settings {\n    background: #1887da;\n    color: #eee\n}\n\n.chart_container.light #chart_parameter_settings {\n    background-color: rgba(244, 244, 244, 0.8);\n    border-color: #afb1b3;\n    color: #393c40\n}\n\n.chart_container.light #chart_parameter_settings #close_settings {\n    background: #1478c8;\n    color: #eee\n}\n\n.chart_container input,\n.chart_container button {\n    border-radius: 4px;\n    border: 1px solid;\n    padding: 4px\n}\n\n.chart_container input[type=text] {\n    width: 12em\n}\n\n.chart_container input[type=button],\n.chart_container input[type=submit],\n.chart_container button {\n    font-family: PingFangSC-Light;\n    padding: 4px 8px;\n    cursor: pointer\n}\n\n.chart_container.dark input,\n.chart_container.dark button {\n    background-color: #151515;\n    border-color: #333;\n    color: #ccc\n}\n\n.chart_container.light input,\n.chart_container.light button {\n    background-color: #ddd;\n    border-color: #ddd;\n    color: #222\n}\n\n.trade_container {\n    width: 250px;\n    height: 100%;\n    float: right;\n    z-index: 99999;\n    font-size: 12px;\n    overflow: hidden\n}\n\n.trade_container.dark {\n    background: #0a0a0a;\n    color: #f1f1f1\n}\n\n.m_righttop {\n    position: fixed;\n    top: 0;\n    height: 41px;\n    line-height: 41px;\n    width: 230px;\n    text-align: right;\n    padding-right: 20px;\n    font-size: 16px;\n    color: #f78d15;\n    font-family: PingFangSC-Light;\n}\n\n.m_righttop em {\n    width: 123px;\n    height: 28px;\n    background-position: 0 0;\n    display: block;\n    float: right;\n    margin-top: 5px\n}\n\n.dark .m_righttop em {\n    background-position: 0 0\n}\n\n.m_rightbot {\n    height: 22px;\n    line-height: 22px;\n    border-top: 1px solid #404040;\n    width: 230px;\n    text-align: right;\n    padding-right: 20px;\n    background-color: #0a0a0a;\n    border-bottom-color: #404040\n}\n\n.m_guadan {\n    margin-top: 29px;\n    overflow: hidden;\n    border-left: 1px solid #404040;\n    border-top: 1px solid #404040\n}\n\n.m_guadan a {\n    font-weight: bold;\n    color: #FFF;\n    text-decoration: none\n}\n\n.light .m_guadan {\n    margin-top: 29px;\n    overflow: hidden;\n    border-left: 1px solid #afb1b3;\n    border-top: 1px solid #afb1b3\n}\n\n#orderbook #asks,\n#orderbook #gasks,\n#orderbook #bids,\n#orderbook #gbids {\n    height: 195px;\n    position: relative;\n    display: inline-block;\n    overflow: hidden\n}\n\n.symbol-title {\n    font-size: 14px;\n    font-weight: bold;\n    text-align: center;\n    height: 16px;\n    line-height: 16px;\n    font-family: PingFangSC-Light;\n    padding: 5px\n}\n\n.symbol-title .dark {\n    color: #6BF\n}\n\n.symbol-title .infoDepth {\n    margin-left: 8px;\n    color: #f78d15\n}\n\n.symbol-title a:hover {\n    text-decoration: underline\n}\n\n#asks,\n#bids {\n    width: 150px\n}\n\n#orderbook {\n    padding-left: 3px;\n    border-bottom: 1px solid #222;\n    padding-bottom: 2px;\n    margin-left: 5px;\n    margin-bottom: 2px\n}\n\n#orderbook .table {\n    position: absolute;\n    border-collapse: collapse;\n    padding: 0;\n    margin: 0\n}\n\n#gasks .table,\n#asks .table {\n    bottom: 0\n}\n\n#orderbook .table .row {\n    padding: 0;\n    margin: 0;\n    height: 13px;\n    line-height: 13px;\n    font-family: PingFangSC-Light;\n}\n\n#orderbook .table .row {\n    line-height: 13px\n}\n\n#orderbook .table .g {\n    color: #666\n}\n\n#gasks,\n#gbids {\n    width: 80px\n}\n\n#gasks .amount,\n#gbids .amount {\n    float: right\n}\n\n#gasks .price,\n#gbids .price {\n    float: left;\n    text-align: right\n}\n\n.price {\n    margin-right: 10px\n}\n\n.price h {\n    visibility: hidden\n}\n\n.price g,\n.amount g {\n    color: #666\n}\n\n#price {\n    text-align: center;\n    font-size: 16px;\n    font-weight: bold;\n    height: 25px;\n    line-height: 25px\n}\n\n.trade_container .green {\n    color: #0F0\n}\n\n.trade_container .red {\n    color: #F00\n}\n\n.trade_container.dark #orderbook div.table div.remove g,\n.trade_container.dark #orderbook div.table div.remove span {\n    color: #444\n}\n\n.trade_container.light #orderbook div.table div.remove g,\n.trade_container.light #orderbook div.table div.remove span {\n    color: #ddd\n}\n\n.trade_container.dark #orderbook div.table div.add {\n    display: none;\n    background-color: rgba(238, 238, 238, 0.2)\n}\n\n.trade_container.light #orderbook div.table div.add {\n    display: none;\n    background-color: rgba(100, 100, 100, 0.2)\n}\n\n#trades {\n    overflow-y: auto;\n    text-align: left;\n    color: #666;\n    padding-top: 5px\n}\n\n.trade_container.light {\n    background: #fff;\n    border-left: 1px solid #afb1b3;\n    color: #000\n}\n\n.trade_container.light .m_righttop em {\n    background-position: 0 -32px\n}\n\n.trade_container.light .m_righttop {\n    position: fixed;\n    top: 0;\n    height: 40px;\n    line-height: 40px;\n    background: #FFF;\n    width: 230px;\n    border-bottom: 1px solid #afb1b3;\n    text-align: right;\n    padding-right: 20px\n}\n\n.trade_container.light #trades.trades table {\n    color: #333\n}\n\n.trade_container.light #trades.trades .v {\n    color: #333\n}\n\n.trade_container.light #trades.trades .v g {\n    color: #333\n}\n\n.trade_container.light .m_rightbot {\n    background: #fff;\n    border-top: 1px solid #afb1b3\n}\n\n.trade_container.light #orderbook {\n    border-bottom: 1px solid #afb1b3\n}\n\n.trades_list {\n    padding-left: 25px\n}\n\n.trades_list ul {\n    width: 200px;\n    height: 14px;\n    line-height: 14px;\n    text-align: left;\n    list-style: none;\n    clear: both;\n    zoom: 1;\n    margin: 0;\n    padding: 0\n}\n\n.trades_list ul li {\n    height: 14px;\n    line-height: 14px;\n    color: #999;\n    font-size: 12px;\n    list-style: none;\n    float: left;\n    *display: inline;\n    margin: 0;\n    padding: 0;\n    font-family: PingFangSC-Light;\n}\n\n.trades_list ul li.tm {\n    width: 62px;\n    color: #999\n}\n\n.trades_list ul li.pr-green {\n    width: 65px;\n    color: #6c6\n}\n\n.trades_list ul li.pr-red {\n    width: 65px;\n    color: #c66\n}\n\n.trades_list ul li.vl {\n    width: 60px;\n    color: #ccc\n}\n\n.trades_list ul li.vl g {\n    color: #666\n}\n\n.trade_container.dark .trades_list ul.newul {\n    display: none;\n    background-color: rgba(238, 238, 238, 0.2)\n}\n\n.trade_container.light .trades_list ul.newul {\n    display: none;\n    background-color: rgba(100, 100, 100, 0.2)\n}\n\n.light .trades_list ul li.tm {\n    color: #333\n}\n\n.light .trades_list ul li.pr-green {\n    color: #6c6\n}\n\n.light .trades_list ul li.pr-red {\n    color: #c66\n}\n\n.light .trades_list ul li.vl {\n    color: #333\n}\n\n.light .trades_list ul li.vl g {\n    color: #333\n}\n\n.container .nav {\n    margin: 0;\n    list-style: none;\n    padding: 0 0 0 3px;\n    height: 41px\n}\n\n.container .nav li {\n    display: inline-block;\n    margin-right: 9px\n}\n\n.container a {\n    text-decoration: none;\n    color: #6BF;\n    font-family: PingFangSC-Light;\n}\n\n.container a:hover {\n    text-decoration: underline\n}\n\n.container a.active {\n    color: #FC9\n}\n\n.container span {\n    margin-left: 3px;\n    font-family: PingFangSC-Light;\n    color: #ccc\n}\n\n.light .container span {\n    color: #333\n}\n\n.light .container a {\n    text-decoration: none;\n    color: #1478c8;\n    font-family: PingFangSC-Light;\n}\n\n.chart_BoxSize {\n    width: 20px;\n    height: 20px\n}\n",""])},function(module,exports){module.exports=function(useSourceMap){var list=[];list.toString=function toString(){return this.map(function(item){var content=cssWithMappingToString(item,useSourceMap);if(item[2]){return"@media "+item[2]+"{"+content+"}"}else{return content}}).join("")};list.i=function(modules,mediaQuery){if(typeof modules==="string")modules=[[null,modules,""]];var alreadyImportedModules={};for(var i=0;i<this.length;i++){var id=this[i][0];if(typeof id==="number")alreadyImportedModules[id]=true}for(i=0;i<modules.length;i++){var item=modules[i];if(typeof item[0]!=="number"||!alreadyImportedModules[item[0]]){if(mediaQuery&&!item[2]){item[2]=mediaQuery}else if(mediaQuery){item[2]="("+item[2]+") and ("+mediaQuery+")"}list.push(item)}}};return list};function cssWithMappingToString(item,useSourceMap){var content=item[1]||"";var cssMapping=item[3];if(!cssMapping){return content}if(useSourceMap&&typeof btoa==="function"){var sourceMapping=toComment(cssMapping);var sourceURLs=cssMapping.sources.map(function(source){return"/*# sourceURL="+cssMapping.sourceRoot+source+" */"});return[content].concat(sourceURLs).concat([sourceMapping]).join("\n")}return[content].join("\n")}function toComment(sourceMap){var base64=btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));var data="sourceMappingURL=data:application/json;charset=utf-8;base64,"+base64;return"/*# "+data+" */"}},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAFCAYAAABmWJ3mAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAACXBIWXMAAAsTAAALEwEAmpwYAAAJn2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyIKICAgICAgICAgICAgeG1sbnM6ZXhpZj0iaHR0cDovL25zLmFkb2JlLmNvbS9leGlmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWERpbWVuc2lvbj42PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+NTwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDY8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmNoYW5nZWQ+Lzwvc3RFdnQ6Y2hhbmdlZD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNC0xMi0wM1QxNzo1Njo1MiswODowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDozNjIzYmJlYi1iNGU2LWNhNDktOTRjZi05MTIyY2Q1Y2NiZTk8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+c2F2ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjM2MjNiYmViLWI0ZTYtY2E0OS05NGNmLTkxMjJjZDVjY2JlOTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo2QzE5MkVEOTY1N0UxMUU0QUUwMkE5RkYyNDYyQTBBODwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkRlcml2ZWRGcm9tIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgPHN0UmVmOmluc3RhbmNlSUQ+eG1wLmlpZDo4MzE3OTEwZi1kOTE5LTY4NDAtYWVhOS0zNzI5NWE2NGI1NmU8L3N0UmVmOmluc3RhbmNlSUQ+CiAgICAgICAgICAgIDxzdFJlZjpkb2N1bWVudElEPnhtcC5kaWQ6MWYwY2U2ZjQtZTRlNS1jODQ3LWIyOTgtNGNkNjRiYzBkYzA2PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wOk1ldGFkYXRhRGF0ZT4yMDE0LTEyLTAzVDE3OjU2OjUyKzA4OjAwPC94bXA6TWV0YWRhdGFEYXRlPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxNC0xMi0wM1QxNzo1NjoyOCswODowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE0LTEyLTAzVDE3OjU2OjUyKzA4OjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjM8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgqC9xe+AAAAWUlEQVQIHWO8cOHCFgYGBm8gRgZbmRgZGXOBIj+QRH8wMTHlMenr69////9/J0wCxNbT07vHCBK4f/8+x8ePH6+B2Pz8/FqKioo/mEAcEAOoEmRkHogNEgMA0qYfb8X3frQAAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAFCAYAAABmWJ3mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA21pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6M0E5Qjc0ODc3QUQ0MTFFNDhCN0ZBNEVBQTM1QTBFNjgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6M0E5Qjc0ODY3QUQ0MTFFNDhCN0ZBNEVBQTM1QTBFNjgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjM2MjNiYmViLWI0ZTYtY2E0OS05NGNmLTkxMjJjZDVjY2JlOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2QzE5MkVEOTY1N0UxMUU0QUUwMkE5RkYyNDYyQTBBOCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PvrZrC8AAABOSURBVHjaYvz//z8DCFy8eNEbSDHq6+tvAfEZQRJAQQ4g+xoDBGgBJX8wQTkVQKwIxRVgHRcuXFCEquaAKvoBxNogHZORBBmg7EkAAQYAImEV+46peUgAAAAASUVORK5CYII="},function(module,exports){
module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAFCAYAAABmWJ3mAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA3FpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkMxOTJFRDk2NTdFMTFFNEFFMDJBOUZGMjQ2MkEwQTgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkMxOTJFRDg2NTdFMTFFNEFFMDJBOUZGMjQ2MkEwQTgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjgzMTc5MTBmLWQ5MTktNjg0MC1hZWE5LTM3Mjk1YTY0YjU2ZSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5MkIK1AAAAPklEQVR42mJ0CUvewsDA4M2ACrYyAYlcIP6BJAhi54Ek7gNxJ5IEiH2PCcrpgCq4D2UzsCBpBxnJCDMWIMAAVuANgw9cJ2UAAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAFCAYAAABmWJ3mAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADcWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS41LWMwMTQgNzkuMTUxNDgxLCAyMDEzLzAzLzEzLTEyOjA5OjE1ICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjFmMGNlNmY0LWU0ZTUtYzg0Ny1iMjk4LTRjZDY0YmMwZGMwNiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2QzE5MkVEOTY1N0UxMUU0QUUwMkE5RkYyNDYyQTBBOCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2QzE5MkVEODY1N0UxMUU0QUUwMkE5RkYyNDYyQTBBOCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6ODMxNzkxMGYtZDkxOS02ODQwLWFlYTktMzcyOTVhNjRiNTZlIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjFmMGNlNmY0LWU0ZTUtYzg0Ny1iMjk4LTRjZDY0YmMwZGMwNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PkyQgrUAAABCSURBVBhXY3QJS2aAAh8g/g/EW0EcJhABBBxAPAmIJ0PZcIkKIFaEYhAbLKEExOUgDhSA2IogCZARYO1QAGQzTAYAPbkH1E4jJr8AAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAFACAYAAAC1CvwiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6N0EwQTE5MkI4MTFEMTFFNEI4Njg4OEVFQzVGMTEyOTIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6N0EwQTE5MkE4MTFEMTFFNEI4Njg4OEVFQzVGMTEyOTIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjYzNEUzRUIyODExOTExRTRBNkJDQzhDODM5MEQxQTkwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjYzNEUzRUIzODExOTExRTRBNkJDQzhDODM5MEQxQTkwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+VsD84AAABMxJREFUeNrsXEloFEEU7QztBgoKkmgueogajSQRBEEQJ3jITVDUgxL1YoggHlSU6MHlKkEQ3FFREEEviogexJlTDqIxcQl60Is4oujFDVFhfN+p1kqlu7ZZMhN+w6My1f1fVXf9ev2r+6eDfD4fRMhkMpeBaXKdCalg5NYFPMpms0sDy62OWKINhtGPn8ABoC+dTud1BKmE+onAUeAOSBt8CKKtExgESafrKagb1fcB+3FKv1x68K8hYA/Qj0aafAiijUZnACRdUUVoYfQbuA8MAy+BF8BzG4LPwARgCtCLcx9wGYVXwHLgqvjd6zKMGWAZWqRunhF1a3HeC2wITtHYw/gT/UD5AMWQOG6v0Q/iNrTcI4jJvZtA+sZ1GK8AX4V773J1ZTqNLyjOi16ccD4Fp+lcmwRavYM+Zlw10XljghIQ1NFQafa3k6xr5kkH+8H48AOWtDEgGBUGuQSVYoLl5b8r6wfofqu43QcuMZJsfARYAiEZdOqBZHxINrYNMBKNjQQmYy2BjXEiga1xLIGLcVy0HhkfhPGQ7Y1FPYd2W+NCWKr4tuvcKHouhIaVCktaOQlw4etRvE95GpPHngUafVR5xFyxVST1oP+y5iPlJXVlW00cUsK7uirVRO3Vtlmx+IhL6UbBdLW1BD5qLKvyLJSnfYwjTXwHNMD4A0taBQkw7ItQbAXmWhMIo/UCLaK6L3RoeAP5ilJ30TVOpOcoPeLnMHynJeWoxrOlh1PXrZc8irhQDw4D1zhO5DiR48SaeZ5oiJvqqfQV1chjt1cmTtRNNBdZj52lJkUyx0y+EWr5I1XbmIk1kTWRCZig/ASqeyet4HTvWNKRkSDLOt0bbad56Pjkgv2ACZiACewjFJunV6MIrLRPF2AoPejgCIUJmIAJakMTVfEJZSPaCWRMrcrHO2tibA9cNVE+nv2ACaqDgPPSqjqtzHbtXPTStzRPsopZO7MncoIjE5SDALMvJ8SjMfpbEpTYurgZmHOpCzVakLOpS+xBXKtOPVBbjLsGVTSMscPjShAZCbL+omQdZOucCWLHmKdzrROY3vpp8xMtjEfnJ9omtankYdJ6UDbWkVvfXIk8akAmD6VueT1TC5OywZVzTiQPA807VhP53w3q2paguq3ADaBdt98rP1EeSufwVu2ZU4ykzT8wvWvX5h+Y3nhrc/dN+YmmiWWTn6h9F8+ayJrImlikJkbgnG3O2WZNLLUmOhrH5ycmGetmaWg7hZMEN6UTzKIfxtlqYuLOymui7VBqPZHzEz2f6vLb/zHOjCs+sc3mFanoUaYspzBOXlxn2JXZlVnSKkSAEZmB4gKwG6PxWt5ne2vbCdxWjbUxUsztblJ5XNn34qGHZDvZ650r6ueh2AfcSgqyiPgccAkXLqvUbwZWAcew72HSKGwEcorx/KDwr4nTgW1kHDsKOHAOijVAt/hNn/vaAqwUrQ7oojSasseBezjwJn43B4UPbD2h9QHqvpv8YHVQ+DbaXRhTD1YEhe/Gxa0b6LtZzfLSd6a4cPQtrE3AY9HqD7F/KorFAMWS9F+mRDAcLX1HxYrAW6BNGC0EiOgZ8JRKEH8bcQpKpugO4KMwoI+tnVS/FSc/Q4nz8W7T9/LU1bt3sitrYhD8EWAAdoU1AmCjen8AAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAFACAYAAAC1CvwiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjI0MkEyMUI4MTIwMTFFNDgxNjhGRjc0RjJGMjMwQkQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjI0MkEyMUE4MTIwMTFFNDgxNjhGRjc0RjJGMjMwQkQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjZDNzdDQUY4NjU3RTExRTRBRTAyQTlGRjI0NjJBMEE4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjZDNzdDQUY5NjU3RTExRTRBRTAyQTlGRjI0NjJBMEE4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+s3AxtQAABPZJREFUeNrsXE1oHkUYnvkYq0IFC5ImubRI1WolSUEoFIqWHnIr6KqHStWLtaceJFhyUryG4ElKf8RaKELNYkFETyYXPYhNW3+CHtqL+NX+XdoKxQrTZ3bny7ffdv43+Wziu/BssrP7Pjs7M++z7+683zIpJVvEDDsBPNJT5kGL9S57gTMs58+xwKVlKHsC+A4kEwBPIVDLGmAK+Bok61MIOss4cA4k46kEahnUNZkCHkghUItqiwnge5BsSiHoLKp35kGyt1MgAoz+Bb4FFoDfgd+AX0MIbgDqmh8GJlkm52Ma8QKwHfhMb0/G9MIssA1nVNU8rMtewnU/FUJwqOj7TF4vtjL5A9bn9XHvGrtHOYRzyfl+TfwPsAmkf8R240nglh7e79R3+rsxkzdRi481wUfxl5DojauGIOez//s2WBEEHLcyV1eNFbJu95Od7nsfyGPvjdSN/804IElrTCCiLXIum9cgk7xA/8dBzkf07T6hDUrjD4CtqH5XZIKC6hk2ApwGxur7Ghn7CTzGboIAYztBoLGZIML4XoKu8WjoI4+oj+3iZpLJ88HjA2eTlRrImAeuJbmxCJOLkqgutyZ29WEA68utRGMlLkeAYRY7cOq+IlKkvEfWAs9qHe596IWywazDXSRJeY87N9REEdzaVkEJbO1lFpSA1vYpUqe14wRVi+pgrJTXe+ESsB5nvkKa2E9NzPkzWL8JbBSRRq9obNGl0zE1eBV4r1b2SWycqN7m7NdbCxg7W1qRUj5UeTn1eXgjdn3l/UIfcv4X/j8VpsoUJ1KcSHHi/U5QxomsWZyY86HGcWIj4zgCi5f6ojR/zJQaofYhUg2MmURyhGptA9JE0kQioGjdJ6j6Jey9Q9k+x/LColFJNhf77Bzk5rH3BfJGIiACInBoYqD2uUW1qn0BKQNuVVaT0RShEAEREMHK0MTa8WmaWDk+XhONNYjVxMrxpIlEsBIIKD+xPwR2PQjUypZX+zwiu8yTdSFaSRmSlOBIBMvhjTlvax0YXvy/qw3mMoMHtmPKXK8D2yFlwiNpw9ZtTeZTpLazDe4LXxDGxqlfe9A46BgpspzPNJP1TL4cT2Dqd1KkFU+gpgxzfhoYs+wfULf/ltW4mndi3l/kJwpHMLHVYdwhvyRsz4M9xg7y8EasBlwV8mpeWtI7NeGdoPWRO+dYg3JxUo31/l53TunK6JmdWs3ifMEwQsPzE23DO2jG25m778tP9OZkqcaaYQOOgNs5F0+qTJpImthUE43ORDnblLNNmpisicmRifl3LLYzO7xUBLuwRXBbLsFs/jIuwEtFYFjj+B1LQ02knG1G+YmMMuOW5O2+CE4bsRzXeIJiFYwDEZt7syrbgIYySVrfCHK+DvgCeDy1BgeAr9CVF9OHMmMP+h+6ljzd2N0uyvahtDnXnKtPoh0EvhQO9uPAp2i4uVr568Au4EPs+9HWC3uAds34SVb+NPFR4C1lbO6FnG/A+kVgn95Wn/t6A3hen3XePg7KT7xNFNXP5FVsb9ZnXQu8bfpeWL0Gu1n5bbRvYKxqsAOYtjx0qM9ebe7qQc4fw/ooK7+F9RpwtngqyeRtvV/V4llAxc/qV6aKYKEkMMWKjP0JjGqjpwFF9Avwc/E3k393Fal8iKhmyR8DrmmDn5j6yFom79hE1TTG98EgSOvMlxCR7EqiythdAQYAbEvqZUahHBUAAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABC0lEQVQ4T7WTYVEDMRSEv1VAJYCDOmgdgAPAASigKGhx0CoACcUBEsDBVcFj9ibpvF6TDn/IzM0kL9l9t5usImIFvHA6niVtcikinoB1qg3AmyIiSnEslPle0n5CsAT8eZjsChgqwaEUtpIeJ39zsoyILXAPjJhK8Apcl40uSQLvgG9LPxJIWqUDZyQZLOmhemcC6/mqmlskU7A1RYT9mKultwDuLEvSEBE2+MOdp+ebBKXDzOBLhnrvfwiKhFvgJkl4b13xJRN3VXPH2Dmw6F3jEVw9mJLka/RTzg/pDNwiAX7yQ7LbM6ALbpCMGEvwZAwGUBP42QnTIoXJDQ8mcJxrumqjv8TZYdr8Ai/uwaXkPGIcAAAAAElFTkSuQmCC"},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAFACAYAAAC1CvwiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEI1Q0Q4QzI4MTIxMTFFNEFGNzk4NUQxNjVEMjU2RTYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEI1Q0Q4QzE4MTIxMTFFNEFGNzk4NUQxNjVEMjU2RTYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwNTdERDc2N0U4RDExRTRCOUQ1Q0FDNDRFM0JBN0QwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwNTdERDc3N0U4RDExRTRCOUQ1Q0FDNDRFM0JBN0QwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+R+XfywAABNVJREFUeNrsXEloFEEU7QztBgoKkmgueogajSQRBFEMJnjITVDUgxL1YogXDypK9OBylSAI4r6CCOpBEdGDOAEhB9GYuIR40Is4QdGLG6LC+H6mWsua7lq6Z8aZ8Bsela7u/7q669ebX10/7WWzWS/A0uWtl4Apcp0JKe/frQN4vKylbbFnuVURS7DBMNj5AewDevoepLM6glRE/XjgMHAHpDVxCIKtHRgASbvrLagb1fcAe3FLP11a8OdCwC6gDxepi0MQbNQ7/SDpCCp8C6NfwH1gCHgJDAMvbAg+AeOASUA37r3fpRde0TMFroj9bpduTANLcEVq5klRtwb3Pc+G4Dj1PYw/0g7KhygGxXm7jX4QtuHKXYKY3LsOpG9cu/Ey8EW49w5XV6bb+IzirGjFMedbcBrOlUmg1TvoY9pVE503JigAQRV1leZ4M8m6Zpy0sR+MDT9gSUtO4Lsa5IVBLkGlGGBZ+e/S+gGa3yh+7t2fgTA+BCyCkAw4tUAyPiAb2wYYkcZGApOxlsDGOJLA1jiUwMU4LFoPjPfDeND2h0W9h2Zb49FN9W3XsZF4LPiGmQprYjE0UXK6ahTvUjGNyWNPAbV+TONgrIzYKpJ60l9ZiyPlBXVlW00cVMK7qjLVRO3TtpmxxBGXwvWC6WlrCeKosazKM1CeiGMcDOcRoAbG71kTS6iJ6PYFKLYAs61bIIzWCTSI6h6XFqwnX1HqzrvGifQepUvsDsF3GlKOajxTejl1zXrKo4gLteAgcJXjRI4TOU6smPeJhripmspYLZA8dltp4kTdQHOR9dBRalIkc8wUN0ItfqRqGzOxJrImMgETFJ9Ade+oGZxujaU1MBJkvU6/jbbD3Hd8c8F+wARMwAT2EYrN26s8Aivts32HMroYzREKEzABE1SEJqri48tGdBBIm64qn++siaEtcNVE+Xz2AyYoDwLOSyvrtDLbuXPiqW9h3mQlmTuzJ3KCIxMUgwCjLyPEozb4WxKU0LqwEZhxqfM1WpCxqYtsQdhVnVqgXjHsGZRRN4Z2j6sqB0ZEBlxPJOsgW+tMENrHPJwrhEA3nLWrftr8RAvj/PxE26Q2dd3Zj5oPysY6cusfVyIPLiCT+1KzYr1T86OywZV7jiT3Pc0aq4l8dIO6NkWobiNwA2jWHY+Vnyh3pXN4q7bMKUbS5h+Y1tq1+QemFW9t7r4pP9E0sGzyE7Vr8ayJrImsiQk1MQDnbHPONmtioTXR0Tg8PzHKWDdKfdshHCW4KZ1gJn4ZZ6uJkQdLr4m2Xal1Zc5PjDmcefX/P2fGJU9ss1kiFS1KF+UWxsjCdZpdmV2ZJa1EBOiRaSjOATvRG6/lY7Y/bduB26qxKVJVmzahOK4c9+GhhWQ7MdaaK+rnoNgD3PI17BeAi3hwvUr9JmAlcATHHkX1wgYgoxjP9XL/mjgV2ErGob2AE2ehWA10in363NdmYIW4ar8uSqMhexS4hxNvYr/ey31g6ynND1D3zeQHq7zct9Huwpha0OLlvhsXNm+g72bVy1Pf6ShOe7lvYW0EnoirfhfHJ6NYCFAsSf9lSgRDwdQ3L1YE3gJNwmg+QETPgWdUgvirPHdWM0XPAB+EAd3/sPqtOPkdSpiPd5q+l6fO3mMnu7Imet5vAQYAtaODAARZxFkAAAAASUVORK5CYII="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAFACAYAAAC1CvwiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoxZjBjZTZmNC1lNGU1LWM4NDctYjI5OC00Y2Q2NGJjMGRjMDYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEY5QjlCQTA4MTIyMTFFNEIwQUVBMkM3NjgwODE3OTYiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEY5QjlCOUY4MTIyMTFFNEIwQUVBMkM3NjgwODE3OTYiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkMwNTdERDdBN0U4RDExRTRCOUQ1Q0FDNDRFM0JBN0QwIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkMwNTdERDdCN0U4RDExRTRCOUQ1Q0FDNDRFM0JBN0QwIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+2tcnMAAABOxJREFUeNrsXDtoFUEU3SzjDwwoiNE0WsS/aAQ/IIiKRTpBUQvBT+MPxEKDEhs1hU0IVvEHahREUAtBRCu10UI0RtSghTbiE39NoiAqPM9NZnWzmZm9My/vaeIdOGx2svfs7Myds3d37tuoWCxGCbqbFl0AqtN1eYij/mUT8Kjn4OKFEbPEhrppwD2QNAJVIQRURgItwE2Q1IQQJKUB6ARJQygBlUm6JS3AiBACKtQXjcB9kNSFECSFRqcDJJuSCsUw+gncBrqAl8AL4DmHoBugax4DNFUffdDh04mvgKXAJb3f5DMKd4AlOCM185SuW4vrnsEhOEFjD+PPtIPtA2ye6OP2G4eHJoSr4Mw7NfF3oA6kb3yH8SLwRbv3Xm9Hwhl7sDmjW9HmfQmhs3G4EGAI7/zvfTA0CKpwK3MNVT3JumOerHTe94jc994ow/hX/EAkrXQC5WsAnSyW3ALMwipC5f0AzZ+nb/f+faCNm4EFaH6nVx+kjA+njVkELmPOrc1p7CTgGFsJuMZGAh/jAcOYMj4E4yfcG0vWk+q5xn0BMQhSN5KizwPXoNxYlGmKiqiWWRNTTjcRm/dxoDF57GmgNg40TubKO8U0yo71H1njuKvL3cs/Cvqare6uQqR8UDVRsXvbVri9XV5B4fR2niIlHeYnqFqV6SXLSR8pz7bgHVAD4w+iiRXURAz7bGy2AlOVp9F6jTm6utWnBRvIVzJ153zjRHqPslPvdsF35sQexuTuk1Mvp66ExonUgiPAZe6LKIkTJU6UOPGfJtBxYlgnpjx2V8lxYlyCcadXH9hmaV6Ulh8zhUao5Y9UuTGTCo1QRRNFE4VACHwUqZ+LJi9hTdPZtsayIjHSZHdzn1xDnmJ97wsyG4VACISAH6HYtM8pqmnt46QMOFW5dzFaIhQhEAIh+CtxIjcetAVeQZqYPt5bE40t8NXE9PGiiUIwBAgkP7FScaJND7haGedpX57IlnexjqWVkiEpCY5CUIbZiNlX0DpQm/yd0gZjnWkGFnzqXK8DC5w6lSNptbb9hCxPkQquPvg35oIydU722ll+kBgRGXC1JFkH2TpvAlMPiyINSUHJTCTnqp8zP5Fh/Ds/UTmCiQUOY3N+Yvp5MG3sImd3YjrgGrDuHJrUljw7OxdoOfmJ1jVWzuqvYhi7hrK533QOGUrvlR3UzwOuAfXecaLpstj5ic78g7z8RFeH5uYn5o0GJz/RuRYvqiyaKJqoC2bjfI7y2BCkidZnZ8nZlpzt/1gT40BjsybajF2zVHGnsE1wY5dglvwyjquJnLCmQprIHUqnK0t+YvgLCFn9L5MmVubtvuKmjdiOK3mBYhj4gfLNvRmOfSCuLJIWVeq3fRiR8dicBfZhNF6HtGAPcCNr7OXKKKNyH7oGPd04p1/IdnTQmivq6ZNoB4DrysHeDpxHx93N1G8GVgHH8L+HtlHYCBQyxtOjvp8mjgO2kbFxFHDgFGzWANv1Pn3uawuwXJ+1w+oH+hNv9Fmzdhz4Efsz9VnHAjtM3wvLtmB11PdttFswphYsA1otzw303ayZ6UffCVHfT0/b9IPoY32t3/T/qRVzAYol6VemRNDVKyiG4aKPCr0F5mujWQARPQOe0hbEX/tdQiZLfjfwSRvQx9aO4/8/bKJq8vHtMGBpnfESfJJdRVSj6JcAAwDMequ4kXXO2QAAAABJRU5ErkJggg=="},function(module,exports){module.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABKElEQVQ4T7VTwU0DMRCcrYArwby9j3QQOoAOgA5CBYQKCB0kFUAJoQMe9v/o4JD8X7SWfVo5vhMfLJ1krT3jm9kdYuY9gGeYJSJPMcaDrXnvd0T0amoTgDdiZinFXCj7cwjhbAmY+QaAfrp2AK4ATJXgRwsicowxPlpgu/feH4noHkDGVIIXEXF6sEZSwSJyIqJRpc8EIYS9uXDxJxYcY3yo3lEx56tq7pG0YJWlnojIhnp6C+AupeTGcZyYeRKRD325vd8l0EvOuUHBa4bq2f8QFAm3KaVrI+G91+I1E09V84KxGyLaLrVxBlcPWpK5jWWU7SBdgHskRPRtB0ndHnTCeq1qQlVHOWNUgm5yMADUBH4uhGlrwjRoHpRA41zTlc//GGcN0+EXyGXo9iBlz1cAAAAASUVORK5CYII="},function(module,exports,__webpack_require__){var stylesInDom={};var memoize=function(fn){var memo;return function(){if(typeof memo==="undefined")memo=fn.apply(this,arguments);return memo}};var isOldIE=memoize(function(){return window&&document&&document.all&&!window.atob});var getElement=function(fn){var memo={};return function(selector){if(typeof memo[selector]==="undefined"){var styleTarget=fn.call(this,selector);if(styleTarget instanceof window.HTMLIFrameElement){try{styleTarget=styleTarget.contentDocument.head}catch(e){styleTarget=null}}memo[selector]=styleTarget}return memo[selector]}}(function(target){return document.querySelector(target)});var singleton=null;var singletonCounter=0;var stylesInsertedAtTop=[];var fixUrls=__webpack_require__(119);module.exports=function(list,options){if(typeof DEBUG!=="undefined"&&DEBUG){if(typeof document!=="object")throw new Error("The style-loader cannot be used in a non-browser environment")}options=options||{};options.attrs=typeof options.attrs==="object"?options.attrs:{};if(!options.singleton&&typeof options.singleton!=="boolean")options.singleton=isOldIE();if(!options.insertInto)options.insertInto="head";if(!options.insertAt)options.insertAt="bottom";var styles=listToStyles(list,options);addStylesToDom(styles,options);return function update(newList){var mayRemove=[];for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];domStyle.refs--;mayRemove.push(domStyle)}if(newList){var newStyles=listToStyles(newList,options);addStylesToDom(newStyles,options)}for(var i=0;i<mayRemove.length;i++){var domStyle=mayRemove[i];if(domStyle.refs===0){for(var j=0;j<domStyle.parts.length;j++)domStyle.parts[j]();delete stylesInDom[domStyle.id]}}}};function addStylesToDom(styles,options){for(var i=0;i<styles.length;i++){var item=styles[i];var domStyle=stylesInDom[item.id];if(domStyle){domStyle.refs++;for(var j=0;j<domStyle.parts.length;j++){domStyle.parts[j](item.parts[j])}for(;j<item.parts.length;j++){domStyle.parts.push(addStyle(item.parts[j],options))}}else{var parts=[];for(var j=0;j<item.parts.length;j++){parts.push(addStyle(item.parts[j],options))}stylesInDom[item.id]={id:item.id,refs:1,parts:parts}}}}function listToStyles(list,options){var styles=[];var newStyles={};for(var i=0;i<list.length;i++){var item=list[i];var id=options.base?item[0]+options.base:item[0];var css=item[1];var media=item[2];var sourceMap=item[3];var part={css:css,media:media,sourceMap:sourceMap};if(!newStyles[id])styles.push(newStyles[id]={id:id,parts:[part]});else newStyles[id].parts.push(part)}return styles}function insertStyleElement(options,style){var target=getElement(options.insertInto);if(!target){throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.")}var lastStyleElementInsertedAtTop=stylesInsertedAtTop[stylesInsertedAtTop.length-1];if(options.insertAt==="top"){if(!lastStyleElementInsertedAtTop){target.insertBefore(style,target.firstChild)}else if(lastStyleElementInsertedAtTop.nextSibling){target.insertBefore(style,lastStyleElementInsertedAtTop.nextSibling)}else{target.appendChild(style)}stylesInsertedAtTop.push(style)}else if(options.insertAt==="bottom"){target.appendChild(style)}else if(typeof options.insertAt==="object"&&options.insertAt.before){var nextSibling=getElement(options.insertInto+" "+options.insertAt.before);target.insertBefore(style,nextSibling)}else{throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n")}}function removeStyleElement(style){if(style.parentNode===null)return false;style.parentNode.removeChild(style);var idx=stylesInsertedAtTop.indexOf(style);if(idx>=0){stylesInsertedAtTop.splice(idx,1)}}function createStyleElement(options){var style=document.createElement("style");options.attrs.type="text/css";addAttrs(style,options.attrs);insertStyleElement(options,style);return style}function createLinkElement(options){var link=document.createElement("link");options.attrs.type="text/css";options.attrs.rel="stylesheet";addAttrs(link,options.attrs);insertStyleElement(options,link);return link}function addAttrs(el,attrs){Object.keys(attrs).forEach(function(key){el.setAttribute(key,attrs[key])})}function addStyle(obj,options){var style,update,remove,result;if(options.transform&&obj.css){result=options.transform(obj.css);if(result){obj.css=result}else{return function(){}}}if(options.singleton){var styleIndex=singletonCounter++;style=singleton||(singleton=createStyleElement(options));update=applyToSingletonTag.bind(null,style,styleIndex,false);remove=applyToSingletonTag.bind(null,style,styleIndex,true)}else if(obj.sourceMap&&typeof URL==="function"&&typeof URL.createObjectURL==="function"&&typeof URL.revokeObjectURL==="function"&&typeof Blob==="function"&&typeof btoa==="function"){style=createLinkElement(options);update=updateLink.bind(null,style,options);remove=function(){removeStyleElement(style);if(style.href)URL.revokeObjectURL(style.href)}}else{style=createStyleElement(options);update=applyToTag.bind(null,style);remove=function(){removeStyleElement(style)}}update(obj);return function updateStyle(newObj){if(newObj){if(newObj.css===obj.css&&newObj.media===obj.media&&newObj.sourceMap===obj.sourceMap){return}update(obj=newObj)}else{remove()}}}var replaceText=function(){var textStore=[];return function(index,replacement){textStore[index]=replacement;return textStore.filter(Boolean).join("\n")}}();function applyToSingletonTag(style,index,remove,obj){var css=remove?"":obj.css;if(style.styleSheet){style.styleSheet.cssText=replaceText(index,css)}else{var cssNode=document.createTextNode(css);var childNodes=style.childNodes;if(childNodes[index])style.removeChild(childNodes[index]);if(childNodes.length){style.insertBefore(cssNode,childNodes[index])}else{style.appendChild(cssNode)}}}function applyToTag(style,obj){var css=obj.css;var media=obj.media;if(media){style.setAttribute("media",media)}if(style.styleSheet){style.styleSheet.cssText=css}else{while(style.firstChild){style.removeChild(style.firstChild)}style.appendChild(document.createTextNode(css))}}function updateLink(link,options,obj){var css=obj.css;var sourceMap=obj.sourceMap;var autoFixUrls=options.convertToAbsoluteUrls===undefined&&sourceMap;if(options.convertToAbsoluteUrls||autoFixUrls){css=fixUrls(css)}if(sourceMap){css+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))))+" */"}var blob=new Blob([css],{type:"text/css"});var oldSrc=link.href;link.href=URL.createObjectURL(blob);if(oldSrc)URL.revokeObjectURL(oldSrc)}},function(module,exports){module.exports=function(css){var location=typeof window!=="undefined"&&window.location;if(!location){throw new Error("fixUrls requires window.location")}if(!css||typeof css!=="string"){return css}var baseUrl=location.protocol+"//"+location.host;var currentDir=baseUrl+location.pathname.replace(/\/[^\/]*$/,"/");var fixedCss=css.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(fullMatch,origUrl){var unquotedOrigUrl=origUrl.trim().replace(/^"(.*)"$/,function(o,$1){return $1}).replace(/^'(.*)'$/,function(o,$1){return $1});if(/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(unquotedOrigUrl)){return fullMatch}var newUrl;if(unquotedOrigUrl.indexOf("//")===0){newUrl=unquotedOrigUrl}else if(unquotedOrigUrl.indexOf("/")===0){newUrl=baseUrl+unquotedOrigUrl}else{newUrl=currentDir+unquotedOrigUrl.replace(/^\.\//,"")}return"url("+JSON.stringify(newUrl)+")"});return fixedCss}},function(module,exports){
module.exports='<div class="trade_container dark hide">'+'    <div class="m_cent">'+'        <div class="m_guadan">'+'            <div class="symbol-title">'+'                <a class="dark"></a>'+"            </div>"+'            <div id="orderbook">'+'                <div id="asks">'+'                    <div class="table"></div>'+"                </div>"+'                <div id="gasks">'+'                    <div class="table"></div>'+"                </div>"+'                <div id="price" class="green"></div>'+'                <div id="bids">'+'                    <div class="table"></div>'+"                </div>"+'                <div id="gbids">'+'                    <div class="table"></div>'+"                </div>"+"            </div>"+'            <div id="trades" class="trades">'+'                <div class="trades_list"></div>'+"            </div>"+"        </div>"+"    </div>"+"</div>"+'<div class="chart_container dark">'+'    <div id="chart_dom_elem_cache"></div>'+"    \x3c!-- ToolBar --\x3e"+'    <div id="chart_toolbar">'+'        <div class="chart_toolbar_minisep"></div>'+"        \x3c!-- Periods --\x3e"+'        <div id="chart_toolbar_periods_horz">'+'            <ul class="chart_toolbar_tabgroup">'+'                <li id="chart_period_line_h" name="line" style="display: none;">'+'                    <a class="chart_str_period_line">分时</a>'+"                </li>"+"            </ul>"+"        </div>"+'        <div class="chart_dropdown" id="chart_toolbar_periods_vert">'+'            <div class="chart_dropdown_t"><a class="chart_str_period_minute">分钟</a></div>'+'            <div class="chart_dropdown_data">'+"                <table>"+"                    <tbody>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_1m_v" style="display:none;" name="1m">'+'                                    <a class="chart_str_period_1m">1分钟</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_5m_v" style="display:none;" name="5m">'+'                                    <a class="chart_str_period_5m">5分钟</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_15m_v" style="display:none;" name="15m">'+'                                    <a class="chart_str_period_15m">15分钟</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_30m_v" style="display:none;" name="30m">'+'                                    <a class="chart_str_period_30m">30分钟</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    </tbody>"+"                </table>"+"            </div>"+"        </div>"+'        <div class="chart_dropdown" id="chart_toolbar_periods_vert1">'+'            <div class="chart_dropdown_t"><a class="chart_str_period_hour">小时</a></div>'+'            <div class="chart_dropdown_data">'+"                <table>"+"                    <tbody>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_1h_v" style="display:none;" name="1h">'+'                                    <a class="chart_str_period_1h">1小时</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_2h_v" style="display:none;" name="2h">'+'                                    <a class="chart_str_period_2h">2小时</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_4h_v" style="display:none;" name="4h">'+'                                    <a class="chart_str_period_4h">4小时</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_6h_v" style="display:none;" name="6h">'+'                                    <a class="chart_str_period_6h">6小时</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td>"+"                            <ul>"+'                                <li id="chart_period_12h_v" style="display:none;" name="12h">'+'                                    <a class="chart_str_period_12h">12小时</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    </tbody>"+"                </table>"+"            </div>"+"        </div>"+'        <div id="chart_toolbar_periods_horz1">'+'            <ul class="chart_toolbar_tabgroup">'+'                <li id="chart_period_1d_h" name="1d" style="display: none;">'+'                    <a class="chart_str_period_1d">日</a>'+"                </li>"+'                <li id="chart_period_1w_h" name="1w" style="display: none;">'+'                    <a class="chart_str_period_1w">周线</a>'+"                </li>"+'                <li id="chart_period_1M_h" name="1M" style="display: none;">'+'                    <a class="chart_str_period_1M">月线</a>'+"                </li>"+"            </ul>"+"        </div>"+'        <div id="chart_show_indicator" class="chart_toolbar_button chart_str_indicator_cap selected">技术指标</div>'+'        <div id="chart_show_tools" class="chart_toolbar_button chart_str_tools_cap">画线工具</div>'+'        <div id="chart_toolbar_theme">'+'            <div class="chart_toolbar_label chart_str_theme_cap">'+"                主题选择"+"            </div>"+'            <a name="dark" class="chart_icon chart_icon_theme_dark selected"></a>'+'            <a name="light" class="chart_icon chart_icon_theme_light"></a>'+"        </div>"+'        <div class="chart_dropdown" id="chart_dropdown_settings">'+'            <div class="chart_dropdown_t"><a class="chart_str_settings">更多</a></div>'+'            <div class="chart_dropdown_data" style="margin-left: -142px;">'+"                <table>"+"                    <tbody>"+'                    <tr id="chart_select_main_indicator">'+'                        <td class="chart_str_main_indicator">主指标</td>'+"                        <td>"+"                            <ul>"+'                                <li><a name="MA" class="selected">MA</a></li>'+'                                <li><a name="EMA" class="">EMA</a></li>'+'                                <li><a name="BOLL" class="">BOLL</a></li>'+'                                <li><a name="SAR" class="">SAR</a></li>'+'                                <li><a name="NONE" class="">None</a></li>'+"                            </ul>"+"                        </td>"+"                    </tr>"+'                    <tr id="chart_select_chart_style">'+'                        <td class="chart_str_chart_style">主图样式</td>'+"                        <td>"+"                            <ul>"+'                                <li><a class="selected">CandleStick</a></li>'+"                                <li><a>CandleStickHLC</a></li>"+'                                <li><a class="">OHLC</a></li>'+"                            </ul>"+"                        </td>"+"                    </tr>"+'                    <tr id="chart_select_theme" style="display: none;">'+'                        <td class="chart_str_theme">主题选择</td>'+"                        <td>"+"                            <ul>"+"                                <li>"+'                                    <a name="dark" class="chart_icon chart_icon_theme_dark selected"></a>'+"                                </li>"+"                                <li>"+'                                    <a name="light" class="chart_icon chart_icon_theme_light"></a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+'                    <tr id="chart_enable_tools" style="display: none;">'+'                        <td class="chart_str_tools">画线工具</td>'+"                        <td>"+"                            <ul>"+'                                <li><a name="on" class="chart_str_on">开启</a></li>'+'                                <li><a name="off" class="chart_str_off selected">关闭</a></li>'+"                            </ul>"+"                        </td>"+"                    </tr>"+'                    <tr id="chart_enable_indicator" style="display: none;">'+'                        <td class="chart_str_indicator">技术指标</td>'+"                        <td>"+"                            <ul>"+'                                <li><a name="on" class="chart_str_on selected">开启</a></li>'+'                                <li><a name="off" class="chart_str_off">关闭</a></li>'+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    <tr>"+"                        <td></td>"+"                        <td>"+"                            <ul>"+"                                <li>"+'                                    <a id="chart_btn_parameter_settings" class="chart_str_indicator_parameters">指标参数设置</a>'+"                                </li>"+"                            </ul>"+"                        </td>"+"                    </tr>"+"                    </tbody>"+"                </table>"+"            </div>"+"        </div>"+'        <div class="chart_dropdown" id="chart_language_setting_div" style="padding-left: 5px;">'+'            <div class="chart_dropdown_t">'+'                <a class="chart_language_setting">语言(LANG)</a>'+"            </div>"+'            <div class="chart_dropdown_data" style="padding-top: 15px; margin-left: -12px;">'+"                <ul>"+'                    <li style="height: 25px;">'+'                        <a name="zh-cn" class="selected">简体中文(zh-CN)</a>'+"                    </li>"+'                    <li style="height: 25px;">'+'                        <a name="en-us">English(en-US)</a>'+"                    </li>"+'                    <li style="height: 25px;">'+'                        <a name="zh-tw">繁體中文(zh-HK)</a>'+"                    </li>"+"                </ul>"+"            </div>"+"        </div>"+'        <div id="chart_updated_time">'+'            <div id="sizeIcon" class="chart_BoxSize"></div>'+"        </div>"+"    </div>"+"               \x3c!-- ToolPanel --\x3e"+'    <div id="chart_toolpanel">'+'        <div class="chart_toolpanel_separator"></div>'+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_Cursor" name="Cursor"></div>'+'            <div class="chart_toolpanel_tip chart_str_cursor">'+"                光标"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_CrossCursor" name="CrossCursor"></div>'+'            <div class="chart_toolpanel_tip chart_str_cross_cursor">'+"                十字光标"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_SegLine" name="SegLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_seg_line">'+"                线段"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_StraightLine" name="StraightLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_straight_line">'+"                直线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_RayLine" name="RayLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_ray_line">'+"                射线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_ArrowLine" name="ArrowLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_arrow_line">'+"                箭头"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_HoriSegLine" name="HoriSegLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_horz_seg_line">'+"                水平线段"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_HoriStraightLine" name="HoriStraightLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_horz_straight_line">'+"                水平直线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_HoriRayLine" name="HoriRayLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_horz_ray_line">'+"                水平射线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_VertiStraightLine" name="VertiStraightLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_vert_straight_line">'+"                垂直直线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_PriceLine" name="PriceLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_price_line">'+"                价格线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_TriParallelLine" name="TriParallelLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_tri_parallel_line">'+"                价格通道线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_BiParallelLine" name="BiParallelLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_bi_parallel_line">'+"                平行直线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_BiParallelRayLine" name="BiParallelRayLine"></div>'+'            <div class="chart_toolpanel_tip chart_str_bi_parallel_ray">'+"                平行射线"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_DrawFibRetrace" name="DrawFibRetrace"></div>'+'            <div class="chart_toolpanel_tip chart_str_fib_retrace">'+"                斐波纳契回调"+"            </div>"+"        </div>"+'        <div class="chart_toolpanel_button">'+'            <div class="chart_toolpanel_icon" id="chart_DrawFibFans" name="DrawFibFans"></div>'+'            <div class="chart_toolpanel_tip chart_str_fib_fans">'+"                斐波纳契扇形"+"            </div>"+"        </div>"+'        <div style="padding-left: 3px;padding-top: 10px;">'+'            <button style="color: red;" id="clearCanvas" title="Clear All">X</button>'+"        </div>"+"    </div>"+'    <div id="chart_canvasGroup" class="temp">'+'        <canvas class="chart_canvas" id="chart_mainCanvas" style="cursor: default;"></canvas>'+'        <canvas class="chart_canvas" id="chart_overlayCanvas" style="cursor: default;"></canvas>'+"    </div>"+'    <div id="chart_tabbar">'+"        <ul>"+'            <li><a name="MACD" class="">MACD</a></li>'+'            <li><a name="KDJ" class="">KDJ</a></li>'+'            <li><a name="StochRSI" class="">StochRSI</a></li>'+'            <li><a name="RSI" class="">RSI</a></li>'+'            <li><a name="DMI" class="">DMI</a></li>'+'            <li><a name="OBV" class="">OBV</a></li>'+'            <li><a name="BOLL" class="">BOLL</a></li>'+'            <li><a name="SAR" class="">SAR</a></li>'+'            <li><a name="DMA" class="">DMA</a></li>'+'            <li><a name="TRIX" class="">TRIX</a></li>'+'            <li><a name="BRAR" class="">BRAR</a></li>'+'            <li><a name="VR" class="">VR</a></li>'+'            <li><a name="EMV" class="">EMV</a></li>'+'            <li><a name="WR" class="">WR</a></li>'+'            <li><a name="ROC" class="">ROC</a></li>'+'            <li><a name="MTM" class="">MTM</a></li>'+'            <li><a name="PSY">PSY</a></li>'+"        </ul>"+"    </div>"+'    <div id="chart_parameter_settings">'+'        <h2 class="chart_str_indicator_parameters">指标参数设置</h2>'+"        <table>"+"            <tbody>"+"            <tr>"+"                <th>MA</th>"+'                <td><input name="MA"><input name="MA"><input name="MA"><input name="MA"><br><input name="MA"><input name="MA">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>DMA</th>"+'                <td><input name="DMA"><input name="DMA"><input name="DMA"></td>'+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>EMA</th>"+"                <td>"+'                    <input name="EMA"><input name="EMA"><input name="EMA"><input name="EMA"><br>'+'                    <input name="EMA"><input name="EMA">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>TRIX</th>"+'                <td><input name="TRIX"><input name="TRIX"></td>'+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>VOLUME</th>"+'                <td><input name="VOLUME"><input name="VOLUME"></td>'+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>BRAR</th>"+'                <td><input name="BRAR"></td>'+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>MACD</th>"+"                <td>"+'                    <input name="MACD"><input name="MACD"><input name="MACD">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>VR</th>"+'                <td><input name="VR"><input name="VR"></td>'+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>KDJ</th>"+"                <td>"+'                    <input name="KDJ"><input name="KDJ"><input name="KDJ">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>EMV</th>"+"                <td>"+'                    <input name="EMV"><input name="EMV">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>StochRSI</th>"+"                <td>"+'                    <input name="StochRSI"><input name="StochRSI"><input name="StochRSI"><input name="StochRSI">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>WR</th>"+"                <td>"+'                    <input name="WR"><input name="WR">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>RSI</th>"+"                <td>"+'                    <input name="RSI"><input name="RSI"><input name="RSI">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>ROC</th>"+"                <td>"+'                    <input name="ROC"><input name="ROC">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>DMI</th>"+"                <td>"+'                    <input name="DMI"><input name="DMI">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>MTM</th>"+"                <td>"+'                    <input name="MTM"><input name="MTM">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>OBV</th>"+"                <td>"+'                    <input name="OBV">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"                <th>PSY</th>"+"                <td>"+'                    <input name="PSY"><input name="PSY">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            <tr>"+"                <th>BOLL</th>"+"                <td>"+'                    <input name="BOLL">'+"                </td>"+"                <td>"+'                    <button class="chart_str_default">默认值</button>'+"                </td>"+"            </tr>"+"            </tbody>"+"        </table>"+'        <div id="close_settings"><a class="chart_str_close">关闭</a></div>'+"    </div>"+"    \x3c!-- Loading --\x3e"+'    <div id="chart_loading" class="chart_str_loading">正在读取数据...</div>'+"</div>"+'<div style="display: none" id="chart_language_switch_tmp">'+'    <span name="chart_str_period" zh_tw="週期" zh_cn="周期" en_us="TIME"></span>'+'    <span name="chart_str_period_hour" zh_tw="小時" zh_cn="小时" en_us="Hour"></span>'+'    <span name="chart_str_period_minute" zh_tw="分鐘" zh_cn="分钟" en_us="Minute"></span>'+'    <span name="chart_str_period_line" zh_tw="分時" zh_cn="分时" en_us="Line"></span>'+'    <span name="chart_str_period_1m" zh_tw="1分鐘" zh_cn="1分钟" en_us="1m"></span>'+'    <span name="chart_str_period_3m" zh_tw="3分鐘" zh_cn="3分钟" en_us="3m"></span>'+'    <span name="chart_str_period_5m" zh_tw="5分鐘" zh_cn="5分钟" en_us="5m"></span>'+'    <span name="chart_str_period_15m" zh_tw="15分鐘" zh_cn="15分钟" en_us="15m"></span>'+'    <span name="chart_str_period_30m" zh_tw="30分鐘" zh_cn="30分钟" en_us="30m"></span>'+'    <span name="chart_str_period_1h" zh_tw="1小時" zh_cn="1小时" en_us="1h"></span>'+'    <span name="chart_str_period_2h" zh_tw="2小時" zh_cn="2小时" en_us="2h"></span>'+'    <span name="chart_str_period_4h" zh_tw="4小時" zh_cn="4小时" en_us="4h"></span>'+'    <span name="chart_str_period_6h" zh_tw="6小時" zh_cn="6小时" en_us="6h"></span>'+'    <span name="chart_str_period_12h" zh_tw="12小時" zh_cn="12小时" en_us="12h"></span>'+'    <span name="chart_str_period_1d" zh_tw="日線" zh_cn="日线" en_us="1d"></span>'+'    <span name="chart_str_period_3d" zh_tw="3日" zh_cn="3日" en_us="3d"></span>'+'    <span name="chart_str_period_1w" zh_tw="周線" zh_cn="周线" en_us="1w"></span>'+'    <span name="chart_str_period_1M" zh_tw="月線" zh_cn="月线" en_us="1M"></span>'+'    <span name="chart_str_settings" zh_tw="更多" zh_cn="更多" en_us="MORE"></span>'+'    <span name="chart_setting_main_indicator" zh_tw="均線設置" zh_cn="均线设置" en_us="Main Indicator"></span>'+'    <span name="chart_setting_main_indicator_none" zh_tw="關閉均線" zh_cn="关闭均线" en_us="None"></span>'+'    <span name="chart_setting_indicator_parameters" zh_tw="指標參數設置" zh_cn="指标参数设置" en_us="Indicator Parameters"></span>'+'    <span name="chart_str_chart_style" zh_tw="主圖樣式" zh_cn="主图样式" en_us="Chart Style"></span>'+'    <span name="chart_str_main_indicator" zh_tw="主指標" zh_cn="主指标" en_us="Main Indicator"></span>'+'    <span name="chart_str_indicator" zh_tw="技術指標" zh_cn="技术指标" en_us="Indicator"></span>'+'    <span name="chart_str_indicator_cap" zh_tw="技術指標" zh_cn="技术指标" en_us="INDICATOR"></span>'+'    <span name="chart_str_tools" zh_tw="畫線工具" zh_cn="画线工具" en_us="Tools"></span>'+'    <span name="chart_str_tools_cap" zh_tw="畫線工具" zh_cn="画线工具" en_us="TOOLS"></span>'+'    <span name="chart_str_theme" zh_tw="主題選擇" zh_cn="主题选择" en_us="Theme"></span>'+'    <span name="chart_str_theme_cap" zh_tw="主題選擇" zh_cn="主题选择" en_us="THEME"></span>'+'    <span name="chart_language_setting" zh_tw="語言(LANG)" zh_cn="语言(LANG)" en_us="LANGUAGE"></span>'+'    <span name="chart_exchanges_setting" zh_tw="更多市場" zh_cn="更多市场" en_us="MORE MARKETS"></span>'+'    <span name="chart_othercoin_setting" zh_tw="其它市場" zh_cn="其它市场" en_us="OTHER MARKETS"></span>'+'    <span name="chart_str_none" zh_tw="關閉" zh_cn="关闭" en_us="None"></span>'+'    <span name="chart_str_theme_dark" zh_tw="深色主題" zh_cn="深色主题" en_us="Dark"></span>'+'    <span name="chart_str_theme_light" zh_tw="淺色主題" zh_cn="浅色主题" en_us="Light"></span>'+'    <span name="chart_str_on" zh_tw="開啟" zh_cn="开启" en_us="On"></span>'+'    <span name="chart_str_off" zh_tw="關閉" zh_cn="关闭" en_us="Off"></span>'+'    <span name="chart_str_close" zh_tw="關閉" zh_cn="关闭" en_us="CLOSE"></span>'+'    <span name="chart_str_default" zh_tw="默認值" zh_cn="默认值" en_us="default"></span>'+'    <span name="chart_str_loading" zh_tw="正在讀取數據..." zh_cn="正在读取数据..." en_us="Loading..."></span>'+'    <span name="chart_str_indicator_parameters" zh_tw="指標參數設置" zh_cn="指标参数设置" en_us="Indicator Parameters"></span>'+'    <span name="chart_str_cursor" zh_tw="光標" zh_cn="光标" en_us="Cursor"></span>'+'    <span name="chart_str_cross_cursor" zh_tw="十字光標" zh_cn="十字光标" en_us="Cross Cursor"></span>'+'    <span name="chart_str_seg_line" zh_tw="線段" zh_cn="线段" en_us="Trend Line"></span>'+'    <span name="chart_str_straight_line" zh_tw="直線" zh_cn="直线" en_us="Extended"></span>'+'    <span name="chart_str_ray_line" zh_tw="射線" zh_cn="射线" en_us="Ray"></span>'+'    <span name="chart_str_arrow_line" zh_tw="箭頭" zh_cn="箭头" en_us="Arrow"></span>'+'    <span name="chart_str_horz_seg_line" zh_tw="水平線段" zh_cn="水平线段" en_us="Horizontal Line"></span>'+'    <span name="chart_str_horz_straight_line" zh_tw="水平直線" zh_cn="水平直线" en_us="Horizontal Extended"></span>'+'    <span name="chart_str_horz_ray_line" zh_tw="水平射線" zh_cn="水平射线" en_us="Horizontal Ray"></span>'+'    <span name="chart_str_vert_straight_line" zh_tw="垂直直線" zh_cn="垂直直线" en_us="Vertical Extended"></span>'+'    <span name="chart_str_price_line" zh_tw="價格線" zh_cn="价格线" en_us="Price Line"></span>'+'    <span name="chart_str_tri_parallel_line" zh_tw="價格通道線" zh_cn="价格通道线" en_us="Parallel Channel"></span>'+'    <span name="chart_str_bi_parallel_line" zh_tw="平行直線" zh_cn="平行直线" en_us="Parallel Lines"></span>'+'    <span name="chart_str_bi_parallel_ray" zh_tw="平行射線" zh_cn="平行射线" en_us="Parallel Rays"></span>'+'    <span name="chart_str_fib_retrace" zh_tw="斐波納契回調" zh_cn="斐波纳契回调" en_us="Fibonacci Retracements"></span>'+'    <span name="chart_str_fib_fans" zh_tw="斐波納契扇形" zh_cn="斐波纳契扇形" en_us="Fibonacci Fans"></span>'+'    <span name="chart_str_updated" zh_tw="更新於" zh_cn="更新于" en_us="Updated"></span>'+'    <span name="chart_str_ago" zh_tw="前" zh_cn="前" en_us="ago"></span>'+"</div>"},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=fire;var firebase=_interopRequireWildcard(__webpack_require__(122));function _interopRequireWildcard(obj){if(obj&&obj.__esModule){return obj}else{var newObj={};if(obj!=null){for(var key in obj){if(Object.prototype.hasOwnProperty.call(obj,key)){var desc=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):{};if(desc.get||desc.set){Object.defineProperty(newObj,key,desc)}else{newObj[key]=obj[key]}}}}newObj.default=obj;return newObj}}function date(){var d=new Date,year=d.getFullYear(),month=""+(d.getMonth()+1),day=""+d.getDate();if(month.length<2)month="0"+month;if(day.length<2)day="0"+day;return[year,month,day].join("")}function fire(){firebase.initializeApp({databaseURL:"https://kline-1f82d.firebaseio.com"});firebase.database().ref("/domains/"+btoa(document.domain)).transaction(function(data){var d=date();if(data===null){data={domain:document.domain,data:{}}}if(data["data"][d]===undefined){data["data"][d]=1}else{data["data"][d]++}return data})}},function(module,exports,__webpack_require__){var firebase=__webpack_require__(123);__webpack_require__(143);__webpack_require__(145);__webpack_require__(180);__webpack_require__(187);module.exports=firebase},function(module,exports,__webpack_require__){__webpack_require__(124);module.exports=__webpack_require__(10).default},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});var __WEBPACK_IMPORTED_MODULE_0__src_polyfills_promise__=__webpack_require__(125);var __WEBPACK_IMPORTED_MODULE_0__src_polyfills_promise___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__src_polyfills_promise__);var __WEBPACK_IMPORTED_MODULE_1__src_shims_find__=__webpack_require__(129);var __WEBPACK_IMPORTED_MODULE_1__src_shims_find___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__src_shims_find__);var __WEBPACK_IMPORTED_MODULE_2__src_shims_findIndex__=__webpack_require__(130);var __WEBPACK_IMPORTED_MODULE_2__src_shims_findIndex___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2__src_shims_findIndex__)},function(module,exports,__webpack_require__){(function(global){var __global=function(){if(typeof global!=="undefined"){return global}if(typeof window!=="undefined"){return window}if(typeof self!=="undefined"){return self}throw new Error("unable to locate global object")}();if(typeof Promise==="undefined"){__global["Promise"]=Promise=__webpack_require__(126)}}).call(exports,__webpack_require__(42))},function(module,exports,__webpack_require__){(function(setImmediate){(function(root){var setTimeoutFunc=setTimeout;function noop(){}function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if(typeof fn!=="function")throw new TypeError("not a function");this._state=0;this._handled=false;this._value=undefined;this._deferreds=[];doResolve(fn,this)}function handle(self,deferred){while(self._state===3){self=self._value}if(self._state===0){self._deferreds.push(deferred);return}self._handled=true;Promise._immediateFn(function(){var cb=self._state===1?deferred.onFulfilled:deferred.onRejected;if(cb===null){
(self._state===1?resolve:reject)(deferred.promise,self._value);return}var ret;try{ret=cb(self._value)}catch(e){reject(deferred.promise,e);return}resolve(deferred.promise,ret)})}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&(typeof newValue==="object"||typeof newValue==="function")){var then=newValue.then;if(newValue instanceof Promise){self._state=3;self._value=newValue;finale(self);return}else if(typeof then==="function"){doResolve(bind(then,newValue),self);return}}self._state=1;self._value=newValue;finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2;self._value=newValue;finale(self)}function finale(self){if(self._state===2&&self._deferreds.length===0){Promise._immediateFn(function(){if(!self._handled){Promise._unhandledRejectionFn(self._value)}})}for(var i=0,len=self._deferreds.length;i<len;i++){handle(self,self._deferreds[i])}self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled=typeof onFulfilled==="function"?onFulfilled:null;this.onRejected=typeof onRejected==="function"?onRejected:null;this.promise=promise}function doResolve(fn,self){var done=false;try{fn(function(value){if(done)return;done=true;resolve(self,value)},function(reason){if(done)return;done=true;reject(self,reason)})}catch(ex){if(done)return;done=true;reject(self,ex)}}Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)};Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);handle(this,new Handler(onFulfilled,onRejected,prom));return prom};Promise.all=function(arr){return new Promise(function(resolve,reject){if(!arr||typeof arr.length==="undefined")throw new TypeError("Promise.all accepts an array");var args=Array.prototype.slice.call(arr);if(args.length===0)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&(typeof val==="object"||typeof val==="function")){var then=val.then;if(typeof then==="function"){then.call(val,function(val){res(i,val)},reject);return}}args[i]=val;if(--remaining===0){resolve(args)}}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++){res(i,args[i])}})};Promise.resolve=function(value){if(value&&typeof value==="object"&&value.constructor===Promise){return value}return new Promise(function(resolve){resolve(value)})};Promise.reject=function(value){return new Promise(function(resolve,reject){reject(value)})};Promise.race=function(values){return new Promise(function(resolve,reject){for(var i=0,len=values.length;i<len;i++){values[i].then(resolve,reject)}})};Promise._immediateFn=typeof setImmediate==="function"&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)};Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){if(typeof console!=="undefined"&&console){console.warn("Possible Unhandled Promise Rejection:",err)}};Promise._setImmediateFn=function _setImmediateFn(fn){Promise._immediateFn=fn};Promise._setUnhandledRejectionFn=function _setUnhandledRejectionFn(fn){Promise._unhandledRejectionFn=fn};if(typeof module!=="undefined"&&module.exports){module.exports=Promise}else if(!root.Promise){root.Promise=Promise}})(this)}).call(exports,__webpack_require__(127).setImmediate)},function(module,exports,__webpack_require__){var apply=Function.prototype.apply;exports.setTimeout=function(){return new Timeout(apply.call(setTimeout,window,arguments),clearTimeout)};exports.setInterval=function(){return new Timeout(apply.call(setInterval,window,arguments),clearInterval)};exports.clearTimeout=exports.clearInterval=function(timeout){if(timeout){timeout.close()}};function Timeout(id,clearFn){this._id=id;this._clearFn=clearFn}Timeout.prototype.unref=Timeout.prototype.ref=function(){};Timeout.prototype.close=function(){this._clearFn.call(window,this._id)};exports.enroll=function(item,msecs){clearTimeout(item._idleTimeoutId);item._idleTimeout=msecs};exports.unenroll=function(item){clearTimeout(item._idleTimeoutId);item._idleTimeout=-1};exports._unrefActive=exports.active=function(item){clearTimeout(item._idleTimeoutId);var msecs=item._idleTimeout;if(msecs>=0){item._idleTimeoutId=setTimeout(function onTimeout(){if(item._onTimeout)item._onTimeout()},msecs)}};__webpack_require__(128);exports.setImmediate=setImmediate;exports.clearImmediate=clearImmediate},function(module,exports,__webpack_require__){(function(global,process){(function(global,undefined){"use strict";if(global.setImmediate){return}var nextHandle=1;var tasksByHandle={};var currentlyRunningATask=false;var doc=global.document;var registerImmediate;function setImmediate(callback){if(typeof callback!=="function"){callback=new Function(""+callback)}var args=new Array(arguments.length-1);for(var i=0;i<args.length;i++){args[i]=arguments[i+1]}var task={callback:callback,args:args};tasksByHandle[nextHandle]=task;registerImmediate(nextHandle);return nextHandle++}function clearImmediate(handle){delete tasksByHandle[handle]}function run(task){var callback=task.callback;var args=task.args;switch(args.length){case 0:callback();break;case 1:callback(args[0]);break;case 2:callback(args[0],args[1]);break;case 3:callback(args[0],args[1],args[2]);break;default:callback.apply(undefined,args);break}}function runIfPresent(handle){if(currentlyRunningATask){setTimeout(runIfPresent,0,handle)}else{var task=tasksByHandle[handle];if(task){currentlyRunningATask=true;try{run(task)}finally{clearImmediate(handle);currentlyRunningATask=false}}}}function installNextTickImplementation(){registerImmediate=function(handle){process.nextTick(function(){runIfPresent(handle)})}}function canUsePostMessage(){if(global.postMessage&&!global.importScripts){var postMessageIsAsynchronous=true;var oldOnMessage=global.onmessage;global.onmessage=function(){postMessageIsAsynchronous=false};global.postMessage("","*");global.onmessage=oldOnMessage;return postMessageIsAsynchronous}}function installPostMessageImplementation(){var messagePrefix="setImmediate$"+Math.random()+"$";var onGlobalMessage=function(event){if(event.source===global&&typeof event.data==="string"&&event.data.indexOf(messagePrefix)===0){runIfPresent(+event.data.slice(messagePrefix.length))}};if(global.addEventListener){global.addEventListener("message",onGlobalMessage,false)}else{global.attachEvent("onmessage",onGlobalMessage)}registerImmediate=function(handle){global.postMessage(messagePrefix+handle,"*")}}function installMessageChannelImplementation(){var channel=new MessageChannel;channel.port1.onmessage=function(event){var handle=event.data;runIfPresent(handle)};registerImmediate=function(handle){channel.port2.postMessage(handle)}}function installReadyStateChangeImplementation(){var html=doc.documentElement;registerImmediate=function(handle){var script=doc.createElement("script");script.onreadystatechange=function(){runIfPresent(handle);script.onreadystatechange=null;html.removeChild(script);script=null};html.appendChild(script)}}function installSetTimeoutImplementation(){registerImmediate=function(handle){setTimeout(runIfPresent,0,handle)}}var attachTo=Object.getPrototypeOf&&Object.getPrototypeOf(global);attachTo=attachTo&&attachTo.setTimeout?attachTo:global;if({}.toString.call(global.process)==="[object process]"){installNextTickImplementation()}else if(canUsePostMessage()){installPostMessageImplementation()}else if(global.MessageChannel){installMessageChannelImplementation()}else if(doc&&"onreadystatechange"in doc.createElement("script")){installReadyStateChangeImplementation()}else{installSetTimeoutImplementation()}attachTo.setImmediate=setImmediate;attachTo.clearImmediate=clearImmediate})(typeof self==="undefined"?typeof global==="undefined"?this:global:self)}).call(exports,__webpack_require__(42),__webpack_require__(60))},function(module,exports){if(!Array.prototype.find){Object.defineProperty(Array.prototype,"find",{value:function(predicate){if(this==null){throw new TypeError('"this" is null or not defined')}var o=Object(this);var len=o.length>>>0;if(typeof predicate!=="function"){throw new TypeError("predicate must be a function")}var thisArg=arguments[1];var k=0;while(k<len){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return kValue}k++}return undefined}})}},function(module,exports){if(!Array.prototype.findIndex){Object.defineProperty(Array.prototype,"findIndex",{value:function(predicate){if(this==null){throw new TypeError('"this" is null or not defined')}var o=Object(this);var len=o.length>>>0;if(typeof predicate!=="function"){throw new TypeError("predicate must be a function")}var thisArg=arguments[1];var k=0;while(k<len){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o)){return k}k++}return-1}})}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=createFirebaseNamespace;var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_0__firebase_util___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__);var contains=function(obj,key){return Object.prototype.hasOwnProperty.call(obj,key)};var DEFAULT_ENTRY_NAME="[DEFAULT]";var tokenListeners=[];var FirebaseAppImpl=function(){function FirebaseAppImpl(options,name,firebase_){this.firebase_=firebase_;this.isDeleted_=false;this.services_={};this.name_=name;this.options_=Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["deepCopy"])(options);this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(callback){tokenListeners.push(callback);setTimeout(function(){return callback(null)},0)},removeAuthTokenListener:function(callback){tokenListeners=tokenListeners.filter(function(listener){return listener!==callback})}}}Object.defineProperty(FirebaseAppImpl.prototype,"name",{get:function(){this.checkDestroyed_();return this.name_},enumerable:true,configurable:true});Object.defineProperty(FirebaseAppImpl.prototype,"options",{get:function(){this.checkDestroyed_();return this.options_},enumerable:true,configurable:true});FirebaseAppImpl.prototype.delete=function(){var _this=this;return new Promise(function(resolve){_this.checkDestroyed_();resolve()}).then(function(){_this.firebase_.INTERNAL.removeApp(_this.name_);var services=[];Object.keys(_this.services_).forEach(function(serviceKey){Object.keys(_this.services_[serviceKey]).forEach(function(instanceKey){services.push(_this.services_[serviceKey][instanceKey])})});return Promise.all(services.map(function(service){return service.INTERNAL.delete()}))}).then(function(){_this.isDeleted_=true;_this.services_={}})};FirebaseAppImpl.prototype._getService=function(name,instanceIdentifier){if(instanceIdentifier===void 0){instanceIdentifier=DEFAULT_ENTRY_NAME}this.checkDestroyed_();if(!this.services_[name]){this.services_[name]={}}if(!this.services_[name][instanceIdentifier]){var instanceSpecifier=instanceIdentifier!==DEFAULT_ENTRY_NAME?instanceIdentifier:undefined;var service=this.firebase_.INTERNAL.factories[name](this,this.extendApp.bind(this),instanceSpecifier);this.services_[name][instanceIdentifier]=service}return this.services_[name][instanceIdentifier]};FirebaseAppImpl.prototype.extendApp=function(props){var _this=this;Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["deepExtend"])(this,props);if(props.INTERNAL&&props.INTERNAL.addAuthTokenListener){tokenListeners.forEach(function(listener){_this.INTERNAL.addAuthTokenListener(listener)});tokenListeners=[]}};FirebaseAppImpl.prototype.checkDestroyed_=function(){if(this.isDeleted_){error("app-deleted",{name:this.name_})}};return FirebaseAppImpl}();FirebaseAppImpl.prototype.name&&FirebaseAppImpl.prototype.options||FirebaseAppImpl.prototype.delete||console.log("dc");function createFirebaseNamespace(){var apps_={};var factories={};var appHooks={};var namespace={__esModule:true,initializeApp:initializeApp,app:app,apps:null,Promise:Promise,SDK_VERSION:"4.8.1",INTERNAL:{registerService:registerService,createFirebaseNamespace:createFirebaseNamespace,extendNamespace:extendNamespace,createSubscribe:__WEBPACK_IMPORTED_MODULE_0__firebase_util__["createSubscribe"],ErrorFactory:__WEBPACK_IMPORTED_MODULE_0__firebase_util__["ErrorFactory"],removeApp:removeApp,factories:factories,useAsService:useAsService,Promise:Promise,deepExtend:__WEBPACK_IMPORTED_MODULE_0__firebase_util__["deepExtend"]}};Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["patchProperty"])(namespace,"default",namespace);Object.defineProperty(namespace,"apps",{get:getApps});function removeApp(name){var app=apps_[name];callAppHooks(app,"delete");delete apps_[name]}function app(name){name=name||DEFAULT_ENTRY_NAME;if(!contains(apps_,name)){error("no-app",{name:name})}return apps_[name]}Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["patchProperty"])(app,"App",FirebaseAppImpl);function initializeApp(options,name){if(name===undefined){name=DEFAULT_ENTRY_NAME}else{if(typeof name!=="string"||name===""){error("bad-app-name",{name:name+""})}}if(contains(apps_,name)){error("duplicate-app",{name:name})}var app=new FirebaseAppImpl(options,name,namespace);apps_[name]=app;callAppHooks(app,"create");return app}function getApps(){return Object.keys(apps_).map(function(name){return apps_[name]})}function registerService(name,createService,serviceProperties,appHook,allowMultipleInstances){if(factories[name]){error("duplicate-service",{name:name})}factories[name]=createService;if(appHook){appHooks[name]=appHook;getApps().forEach(function(app){appHook("create",app)})}var serviceNamespace=function(appArg){if(appArg===void 0){appArg=app()}if(typeof appArg[name]!=="function"){error("invalid-app-argument",{name:name})}return appArg[name]()};if(serviceProperties!==undefined){Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["deepExtend"])(serviceNamespace,serviceProperties)}namespace[name]=serviceNamespace;FirebaseAppImpl.prototype[name]=function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var serviceFxn=this._getService.bind(this,name);return serviceFxn.apply(this,allowMultipleInstances?args:[])};return serviceNamespace}function extendNamespace(props){Object(__WEBPACK_IMPORTED_MODULE_0__firebase_util__["deepExtend"])(namespace,props)}function callAppHooks(app,eventName){Object.keys(factories).forEach(function(serviceName){var factoryName=useAsService(app,serviceName);if(factoryName===null){return}if(appHooks[factoryName]){appHooks[factoryName](eventName,app)}})}function useAsService(app,name){if(name==="serverAuth"){return null}var useService=name;var options=app.options;return useService}return namespace}function error(code,args){throw appErrors.create(code,args)}var errors={"no-app":"No Firebase App '{$name}' has been created - "+"call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service "+"account is only allowed in a Node.js environment. On client "+"devices, you should instead initialize the SDK with an api key and "+"auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a "+"Firebase App instance."};var appErrors=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__["ErrorFactory"]("app","Firebase",errors)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function deepCopy(value){return deepExtend(undefined,value)}exports.deepCopy=deepCopy;function deepExtend(target,source){if(!(source instanceof Object)){return source}switch(source.constructor){case Date:var dateValue=source;return new Date(dateValue.getTime());case Object:if(target===undefined){target={}}break;case Array:target=[];break;default:return source}for(var prop in source){if(!source.hasOwnProperty(prop)){continue}target[prop]=deepExtend(target[prop],source[prop])}return target}exports.deepExtend=deepExtend;function patchProperty(obj,prop,value){obj[prop]=value}exports.patchProperty=patchProperty},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Deferred=function(){function Deferred(){var _this=this;this.promise=new Promise(function(resolve,reject){_this.resolve=resolve;_this.reject=reject})}Deferred.prototype.wrapCallback=function(callback){var _this=this;return function(error,value){if(error){_this.reject(error)}else{_this.resolve(value)}if(typeof callback==="function"){_this.promise.catch(function(){});if(callback.length===1){callback(error)}else{callback(error,value)}}}};return Deferred}();exports.Deferred=Deferred},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var constants_1=__webpack_require__(43);exports.getUA=function(){if(typeof navigator!=="undefined"&&typeof navigator["userAgent"]==="string"){return navigator["userAgent"]}else{return""}};exports.isMobileCordova=function(){return typeof window!=="undefined"&&!!(window["cordova"]||window["phonegap"]||window["PhoneGap"])&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(exports.getUA())};exports.isReactNative=function(){return typeof navigator==="object"&&navigator["product"]==="ReactNative"};exports.isNodeSdk=function(){return constants_1.CONSTANTS.NODE_CLIENT===true||constants_1.CONSTANTS.NODE_ADMIN===true}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ERROR_NAME="FirebaseError";var captureStackTrace=Error.captureStackTrace;function patchCapture(captureFake){var result=captureStackTrace;captureStackTrace=captureFake;return result}exports.patchCapture=patchCapture;var FirebaseError=function(){function FirebaseError(code,message){this.code=code;this.message=message;var stack;if(captureStackTrace){captureStackTrace(this,ErrorFactory.prototype.create)}else{var err_1=Error.apply(this,arguments);this.name=ERROR_NAME;Object.defineProperty(this,"stack",{get:function(){return err_1.stack}})}}return FirebaseError}();exports.FirebaseError=FirebaseError;FirebaseError.prototype=Object.create(Error.prototype);FirebaseError.prototype.constructor=FirebaseError;FirebaseError.prototype.name=ERROR_NAME;var ErrorFactory=function(){function ErrorFactory(service,serviceName,errors){this.service=service;this.serviceName=serviceName;this.errors=errors;this.pattern=/\{\$([^}]+)}/g}ErrorFactory.prototype.create=function(code,data){if(data===undefined){data={}}var template=this.errors[code];var fullCode=this.service+"/"+code;var message;if(template===undefined){message="Error"}else{message=template.replace(this.pattern,function(match,key){var value=data[key];return value!==undefined?value.toString():"<"+key+"?>"})}message=this.serviceName+": "+message+" ("+fullCode+").";var err=new FirebaseError(fullCode,message);for(var prop in data){if(!data.hasOwnProperty(prop)||prop.slice(-1)==="_"){continue}err[prop]=data[prop]}return err};return ErrorFactory}();exports.ErrorFactory=ErrorFactory},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var crypt_1=__webpack_require__(62);var json_1=__webpack_require__(63);exports.decode=function(token){var header={},claims={},data={},signature="";try{var parts=token.split(".");header=json_1.jsonEval(crypt_1.base64Decode(parts[0])||"");claims=json_1.jsonEval(crypt_1.base64Decode(parts[1])||"");signature=parts[2];data=claims["d"]||{};delete claims["d"]}catch(e){}return{header:header,claims:claims,data:data,signature:signature}};exports.isValidTimestamp=function(token){var claims=exports.decode(token).claims,now=Math.floor((new Date).getTime()/1e3),validSince,validUntil;if(typeof claims==="object"){if(claims.hasOwnProperty("nbf")){validSince=claims["nbf"]}else if(claims.hasOwnProperty("iat")){validSince=claims["iat"]}if(claims.hasOwnProperty("exp")){validUntil=claims["exp"]}else{validUntil=validSince+86400}}return now&&validSince&&validUntil&&now>=validSince&&now<=validUntil};exports.issuedAtTime=function(token){var claims=exports.decode(token).claims;if(typeof claims==="object"&&claims.hasOwnProperty("iat")){return claims["iat"]}return null};exports.isValidFormat=function(token){var decoded=exports.decode(token),claims=decoded.claims;return!!decoded.signature&&!!claims&&typeof claims==="object"&&claims.hasOwnProperty("iat")};exports.isAdmin=function(token){var claims=exports.decode(token).claims;return typeof claims==="object"&&claims["admin"]===true}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var obj_1=__webpack_require__(64);exports.querystring=function(querystringParams){var params=[];obj_1.forEach(querystringParams,function(key,value){if(Array.isArray(value)){value.forEach(function(arrayVal){params.push(encodeURIComponent(key)+"="+encodeURIComponent(arrayVal))})}else{params.push(encodeURIComponent(key)+"="+encodeURIComponent(value))}});return params.length?"&"+params.join("&"):""};exports.querystringDecode=function(querystring){var obj={};var tokens=querystring.replace(/^\?/,"").split("&");tokens.forEach(function(token){if(token){var key=token.split("=");obj[key[0]]=key[1]}});return obj}},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var hash_1=__webpack_require__(139);var Sha1=function(_super){__extends(Sha1,_super);function Sha1(){var _this=_super.call(this)||this;_this.chain_=[];_this.buf_=[];_this.W_=[];_this.pad_=[];_this.inbuf_=0;_this.total_=0;_this.blockSize=512/8;_this.pad_[0]=128;for(var i=1;i<_this.blockSize;++i){_this.pad_[i]=0}_this.reset();return _this}Sha1.prototype.reset=function(){this.chain_[0]=1732584193;this.chain_[1]=4023233417;this.chain_[2]=2562383102;this.chain_[3]=271733878;this.chain_[4]=3285377520;this.inbuf_=0;this.total_=0};Sha1.prototype.compress_=function(buf,opt_offset){if(!opt_offset){opt_offset=0}var W=this.W_;if(typeof buf==="string"){for(var i=0;i<16;i++){W[i]=buf.charCodeAt(opt_offset)<<24|buf.charCodeAt(opt_offset+1)<<16|buf.charCodeAt(opt_offset+2)<<8|buf.charCodeAt(opt_offset+3);opt_offset+=4}}else{for(var i=0;i<16;i++){W[i]=buf[opt_offset]<<24|buf[opt_offset+1]<<16|buf[opt_offset+2]<<8|buf[opt_offset+3];opt_offset+=4}}for(var i=16;i<80;i++){var t=W[i-3]^W[i-8]^W[i-14]^W[i-16];W[i]=(t<<1|t>>>31)&4294967295}var a=this.chain_[0];var b=this.chain_[1];var c=this.chain_[2];var d=this.chain_[3];var e=this.chain_[4];var f,k;for(var i=0;i<80;i++){if(i<40){if(i<20){f=d^b&(c^d);k=1518500249}else{f=b^c^d;k=1859775393}}else{if(i<60){f=b&c|d&(b|c);k=2400959708}else{f=b^c^d;k=3395469782}}var t=(a<<5|a>>>27)+f+e+k+W[i]&4294967295;e=d;d=c;c=(b<<30|b>>>2)&4294967295;b=a;a=t}this.chain_[0]=this.chain_[0]+a&4294967295;this.chain_[1]=this.chain_[1]+b&4294967295;this.chain_[2]=this.chain_[2]+c&4294967295;this.chain_[3]=this.chain_[3]+d&4294967295;this.chain_[4]=this.chain_[4]+e&4294967295};Sha1.prototype.update=function(bytes,opt_length){if(bytes==null){return}if(opt_length===undefined){opt_length=bytes.length}var lengthMinusBlock=opt_length-this.blockSize;var n=0;var buf=this.buf_;var inbuf=this.inbuf_;while(n<opt_length){if(inbuf==0){while(n<=lengthMinusBlock){this.compress_(bytes,n);n+=this.blockSize}}if(typeof bytes==="string"){while(n<opt_length){buf[inbuf]=bytes.charCodeAt(n);++inbuf;++n;if(inbuf==this.blockSize){this.compress_(buf);inbuf=0;break}}}else{while(n<opt_length){buf[inbuf]=bytes[n];++inbuf;++n;if(inbuf==this.blockSize){this.compress_(buf);inbuf=0;break}}}}this.inbuf_=inbuf;this.total_+=opt_length};Sha1.prototype.digest=function(){var digest=[];var totalBits=this.total_*8;if(this.inbuf_<56){this.update(this.pad_,56-this.inbuf_)}else{this.update(this.pad_,this.blockSize-(this.inbuf_-56))}for(var i=this.blockSize-1;i>=56;i--){this.buf_[i]=totalBits&255;totalBits/=256}this.compress_(this.buf_);var n=0;for(var i=0;i<5;i++){for(var j=24;j>=0;j-=8){digest[n]=this.chain_[i]>>j&255;++n}}return digest};return Sha1}(hash_1.Hash);exports.Sha1=Sha1},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Hash=function(){function Hash(){this.blockSize=-1}return Hash}();exports.Hash=Hash},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});function createSubscribe(executor,onNoObservers){var proxy=new ObserverProxy(executor,onNoObservers);return proxy.subscribe.bind(proxy)}exports.createSubscribe=createSubscribe;var ObserverProxy=function(){function ObserverProxy(executor,onNoObservers){var _this=this;this.observers=[];this.unsubscribes=[];this.observerCount=0;this.task=Promise.resolve();this.finalized=false;this.onNoObservers=onNoObservers;this.task.then(function(){executor(_this)}).catch(function(e){_this.error(e)})}ObserverProxy.prototype.next=function(value){this.forEachObserver(function(observer){observer.next(value)})};ObserverProxy.prototype.error=function(error){this.forEachObserver(function(observer){observer.error(error)});this.close(error)};ObserverProxy.prototype.complete=function(){this.forEachObserver(function(observer){observer.complete()});this.close()};ObserverProxy.prototype.subscribe=function(nextOrObserver,error,complete){var _this=this;var observer;if(nextOrObserver===undefined&&error===undefined&&complete===undefined){throw new Error("Missing Observer.")}if(implementsAnyMethods(nextOrObserver,["next","error","complete"])){observer=nextOrObserver}else{observer={next:nextOrObserver,error:error,complete:complete}}if(observer.next===undefined){observer.next=noop}if(observer.error===undefined){observer.error=noop}if(observer.complete===undefined){observer.complete=noop}var unsub=this.unsubscribeOne.bind(this,this.observers.length);if(this.finalized){this.task.then(function(){try{if(_this.finalError){observer.error(_this.finalError)}else{observer.complete()}}catch(e){}return})}this.observers.push(observer);return unsub};ObserverProxy.prototype.unsubscribeOne=function(i){if(this.observers===undefined||this.observers[i]===undefined){return}delete this.observers[i];this.observerCount-=1;if(this.observerCount===0&&this.onNoObservers!==undefined){this.onNoObservers(this)}};ObserverProxy.prototype.forEachObserver=function(fn){if(this.finalized){return}for(var i=0;i<this.observers.length;i++){this.sendOne(i,fn)}};ObserverProxy.prototype.sendOne=function(i,fn){var _this=this;this.task.then(function(){if(_this.observers!==undefined&&_this.observers[i]!==undefined){try{fn(_this.observers[i])}catch(e){if(typeof console!=="undefined"&&console.error){console.error(e)}}}})};ObserverProxy.prototype.close=function(err){var _this=this;if(this.finalized){return}this.finalized=true;if(err!==undefined){this.finalError=err}this.task.then(function(){_this.observers=undefined;_this.onNoObservers=undefined})};return ObserverProxy}();function async(fn,onError){return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}Promise.resolve(true).then(function(){fn.apply(void 0,args)}).catch(function(error){if(onError){onError(error)}})}}exports.async=async;function implementsAnyMethods(obj,methods){if(typeof obj!=="object"||obj===null){return false}for(var _i=0,methods_1=methods;_i<methods_1.length;_i++){var method=methods_1[_i];if(method in obj&&typeof obj[method]==="function"){return true}}return false}function noop(){}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validateArgCount=function(fnName,minCount,maxCount,argCount){var argError;if(argCount<minCount){argError="at least "+minCount}else if(argCount>maxCount){argError=maxCount===0?"none":"no more than "+maxCount}if(argError){var error=fnName+" failed: Was called with "+argCount+(argCount===1?" argument.":" arguments.")+" Expects "+argError+".";throw new Error(error)}};function errorPrefix(fnName,argumentNumber,optional){var argName="";switch(argumentNumber){case 1:argName=optional?"first":"First";break;case 2:argName=optional?"second":"Second";break;case 3:argName=optional?"third":"Third";break;case 4:argName=optional?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var error=fnName+" failed: ";error+=argName+" argument ";return error}exports.errorPrefix=errorPrefix;function validateNamespace(fnName,argumentNumber,namespace,optional){if(optional&&!namespace)return;if(typeof namespace!=="string"){throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid firebase namespace.")}}exports.validateNamespace=validateNamespace;function validateCallback(fnName,argumentNumber,callback,optional){if(optional&&!callback)return;if(typeof callback!=="function")throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid function.")}exports.validateCallback=validateCallback;function validateContextObject(fnName,argumentNumber,context,optional){if(optional&&!context)return;if(typeof context!=="object"||context===null)throw new Error(errorPrefix(fnName,argumentNumber,optional)+"must be a valid context object.")}exports.validateContextObject=validateContextObject},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var assert_1=__webpack_require__(61);exports.stringToByteArray=function(str){var out=[],p=0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c>=55296&&c<=56319){var high=c-55296;i++;assert_1.assert(i<str.length,"Surrogate pair missing trail surrogate.");var low=str.charCodeAt(i)-56320;c=65536+(high<<10)+low}if(c<128){out[p++]=c}else if(c<2048){out[p++]=c>>6|192;out[p++]=c&63|128}else if(c<65536){out[p++]=c>>12|224;out[p++]=c>>6&63|128;out[p++]=c&63|128}else{out[p++]=c>>18|240;out[p++]=c>>12&63|128;out[p++]=c>>6&63|128;out[p++]=c&63|128}}return out};exports.stringLength=function(str){var p=0;for(var i=0;i<str.length;i++){var c=str.charCodeAt(i);if(c<128){p++}else if(c<2048){p+=2}else if(c>=55296&&c<=56319){p+=4;i++}else{p+=3}}return p}},function(module,exports,__webpack_require__){__webpack_require__(144)},function(module,exports,__webpack_require__){(function(global){(function(){var firebase=__webpack_require__(10).default;var h,aa=aa||{},k=this;function m(a){return"string"==typeof a}function ba(a){return"boolean"==typeof a}function ca(){}function da(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ea(a){return null===a}function fa(a){return"array"==da(a)}function ha(a){var b=da(a);return"array"==b||"object"==b&&"number"==typeof a.length}function p(a){return"function"==da(a)}function q(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}var ia="closure_uid_"+(1e9*Math.random()>>>0),ja=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){
var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function r(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?r=ka:r=la;return r.apply(null,arguments)}function ma(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var na=Date.now||function(){return+new Date};function t(a,b){function c(){}c.prototype=b.prototype;a.ib=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Rc=function(a,c,f){for(var d=Array(arguments.length-2),e=2;e<arguments.length;e++)d[e-2]=arguments[e];return b.prototype[c].apply(a,d)}}function u(a){if(Error.captureStackTrace)Error.captureStackTrace(this,u);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a))}t(u,Error);u.prototype.name="CustomError";function oa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}var pa=String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};function qa(a){if(!ra.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(sa,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(ta,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(ua,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(va,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(wa,"&#39;"));-1!=a.indexOf("\0")&&(a=a.replace(xa,"&#0;"));return a}var sa=/&/g,ta=/</g,ua=/>/g,va=/"/g,wa=/'/g,xa=/\x00/g,ra=/[\x00&<>"']/;function v(a,b){return-1!=a.indexOf(b)}function ya(a,b){return a<b?-1:a>b?1:0}function za(a,b){b.unshift(a);u.call(this,oa.apply(null,b));b.shift()}t(za,u);za.prototype.name="AssertionError";function Aa(a,b){throw new za("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1))}var Ba=Array.prototype.indexOf?function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(m(a))return m(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},w=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function Ca(a,b){var c=a.length,d=m(a)?a.split(""):a;for(--c;0<=c;--c)c in d&&b.call(void 0,d[c],c,a)}var Da=Array.prototype.map?function(a,b,c){return Array.prototype.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=m(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ea=Array.prototype.some?function(a,b,c){return Array.prototype.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=m(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};function Fa(a){a:{var b=Ga;for(var c=a.length,d=m(a)?a.split(""):a,e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:m(a)?a.charAt(b):a[b]}function Ha(a,b){return 0<=Ba(a,b)}function Ia(a,b){b=Ba(a,b);var c;(c=0<=b)&&Array.prototype.splice.call(a,b,1);return c}function Ja(a,b){var c=0;Ca(a,function(d,e){b.call(void 0,d,e,a)&&1==Array.prototype.splice.call(a,e,1).length&&c++})}function Ka(a){return Array.prototype.concat.apply([],arguments)}function La(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}var Ma;a:{var Na=k.navigator;if(Na){var Oa=Na.userAgent;if(Oa){Ma=Oa;break a}}Ma=""}function x(a){return v(Ma,a)}function Pa(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function Qa(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function Ra(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function Sa(a){for(var b in a)return!1;return!0}function Ta(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0}function Ua(a){var b={},c;for(c in a)b[c]=a[c];return b}var Va="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Wa(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<Va.length;f++)c=Va[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Xa(a){Xa[" "](a);return a}Xa[" "]=ca;function Ya(a,b){var c=Za;return Object.prototype.hasOwnProperty.call(c,a)?c[a]:c[a]=b(a)}var $a=x("Opera"),y=x("Trident")||x("MSIE"),ab=x("Edge"),bb=ab||y,cb=x("Gecko")&&!(v(Ma.toLowerCase(),"webkit")&&!x("Edge"))&&!(x("Trident")||x("MSIE"))&&!x("Edge"),db=v(Ma.toLowerCase(),"webkit")&&!x("Edge");function eb(){var a=k.document;return a?a.documentMode:void 0}var fb;a:{var gb="",hb=function(){var a=Ma;if(cb)return/rv\:([^\);]+)(\)|;)/.exec(a);if(ab)return/Edge\/([\d\.]+)/.exec(a);if(y)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(db)return/WebKit\/(\S+)/.exec(a);if($a)return/(?:Version)[ \/]?(\S+)/.exec(a)}();hb&&(gb=hb?hb[1]:"");if(y){var ib=eb();if(null!=ib&&ib>parseFloat(gb)){fb=String(ib);break a}}fb=gb}var Za={};function jb(a){return Ya(a,function(){for(var b=0,c=pa(String(fb)).split("."),d=pa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",l=d[f]||"";do{g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""];l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""];if(0==g[0].length&&0==l[0].length)break;b=ya(0==g[1].length?0:parseInt(g[1],10),0==l[1].length?0:parseInt(l[1],10))||ya(0==g[2].length,0==l[2].length)||ya(g[2],l[2]);g=g[3];l=l[3]}while(0==b)}return 0<=b})}var kb;var lb=k.document;kb=lb&&y?eb()||("CSS1Compat"==lb.compatMode?parseInt(fb,10):5):void 0;function mb(a){a.prototype.then=a.prototype.then;a.prototype.$goog_Thenable=!0}function nb(a){if(!a)return!1;try{return!!a.$goog_Thenable}catch(b){return!1}}function ob(a,b,c){this.f=c;this.c=a;this.g=b;this.b=0;this.a=null}ob.prototype.get=function(){if(0<this.b){this.b--;var a=this.a;this.a=a.next;a.next=null}else a=this.c();return a};function pb(a,b){a.g(b);a.b<a.f&&(a.b++,b.next=a.a,a.a=b)}var rb=new ob(function(){return new qb},function(a){a.reset()},100);function sb(){var a=tb,b=null;a.a&&(b=a.a,a.a=a.a.next,a.a||(a.b=null),b.next=null);return b}function qb(){this.next=this.b=this.a=null}qb.prototype.set=function(a,b){this.a=a;this.b=b;this.next=null};qb.prototype.reset=function(){this.next=this.b=this.a=null};function ub(a){k.setTimeout(function(){throw a},0)}var wb;function xb(){var a=k.MessageChannel;"undefined"===typeof a&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!x("Presto")&&(a=function(){var a=document.createElement("IFRAME");a.style.display="none";a.src="";document.documentElement.appendChild(a);var b=a.contentWindow;a=b.document;a.open();a.write("");a.close();var c="callImmediate"+Math.random(),d="file:"==b.location.protocol?"*":b.location.protocol+"//"+b.location.host;a=r(function(a){if(("*"==d||a.origin==d)&&a.data==c)this.port1.onmessage()},this);b.addEventListener("message",a,!1);this.port1={};this.port2={postMessage:function(){b.postMessage(c,d)}}});if("undefined"!==typeof a&&!x("Trident")&&!x("MSIE")){var b=new a,c={},d=c;b.port1.onmessage=function(){if(void 0!==c.next){c=c.next;var a=c.pb;c.pb=null;a()}};return function(a){d.next={pb:a};d=d.next;b.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(a){var b=document.createElement("SCRIPT");b.onreadystatechange=function(){b.onreadystatechange=null;b.parentNode.removeChild(b);b=null;a();a=null};document.documentElement.appendChild(b)}:function(a){k.setTimeout(a,0)}}function yb(a,b){zb||Ab();Bb||(zb(),Bb=!0);var c=tb,d=rb.get();d.set(a,b);c.b?c.b.next=d:c.a=d;c.b=d}var zb;function Ab(){if(-1!=String(k.Promise).indexOf("[native code]")){var a=k.Promise.resolve(void 0);zb=function(){a.then(Cb)}}else zb=function(){var a=Cb;!p(k.setImmediate)||k.Window&&k.Window.prototype&&!x("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(wb||(wb=xb()),wb(a)):k.setImmediate(a)}}var Bb=!1,tb=new function(){this.b=this.a=null};function Cb(){for(var a;a=sb();){try{a.a.call(a.b)}catch(b){ub(b)}pb(rb,a)}Bb=!1}function z(a,b){this.a=Db;this.i=void 0;this.f=this.b=this.c=null;this.g=this.h=!1;if(a!=ca)try{var c=this;a.call(b,function(a){Eb(c,Fb,a)},function(a){if(!(a instanceof Gb))try{if(a instanceof Error)throw a;throw Error("Promise rejected.")}catch(e){}Eb(c,Hb,a)})}catch(d){Eb(this,Hb,d)}}var Db=0,Fb=2,Hb=3;function Ib(){this.next=this.f=this.b=this.g=this.a=null;this.c=!1}Ib.prototype.reset=function(){this.f=this.b=this.g=this.a=null;this.c=!1};var Jb=new ob(function(){return new Ib},function(a){a.reset()},100);function Kb(a,b,c){var d=Jb.get();d.g=a;d.b=b;d.f=c;return d}function A(a){if(a instanceof z)return a;var b=new z(ca);Eb(b,Fb,a);return b}function B(a){return new z(function(b,c){c(a)})}function Lb(a,b,c){Mb(a,b,c,null)||yb(ma(b,a))}function Nb(a){return new z(function(b,c){var d=a.length,e=[];if(d)for(var f=function(a,c){d--;e[a]=c;0==d&&b(e)},g=function(a){c(a)},l=0,n;l<a.length;l++)n=a[l],Lb(n,ma(f,l),g);else b(e)})}function Ob(a){return new z(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{Ub:!0,value:f}:{Ub:!1,reason:f};0==c&&b(d)},f=0,g;f<a.length;f++)g=a[f],Lb(g,ma(e,f,!0),ma(e,f,!1));else b(d)})}z.prototype.then=function(a,b,c){return Pb(this,p(a)?a:null,p(b)?b:null,c)};mb(z);function Qb(a,b){b=Kb(b,b,void 0);b.c=!0;Rb(a,b);return a}h=z.prototype;h.s=function(a,b){return Pb(this,null,a,b)};h.cancel=function(a){this.a==Db&&yb(function(){var b=new Gb(a);Sb(this,b)},this)};function Sb(a,b){if(a.a==Db)if(a.c){var c=a.c;if(c.b){for(var d=0,e=null,f=null,g=c.b;g&&(g.c||(d++,g.a==a&&(e=g),!(e&&1<d)));g=g.next)e||(f=g);e&&(c.a==Db&&1==d?Sb(c,b):(f?(d=f,d.next==c.f&&(c.f=d),d.next=d.next.next):Tb(c),Ub(c,e,Hb,b)))}a.c=null}else Eb(a,Hb,b)}function Rb(a,b){a.b||a.a!=Fb&&a.a!=Hb||Vb(a);a.f?a.f.next=b:a.b=b;a.f=b}function Pb(a,b,c,d){var e=Kb(null,null,null);e.a=new z(function(a,g){e.g=b?function(c){try{var e=b.call(d,c);a(e)}catch(D){g(D)}}:a;e.b=c?function(b){try{var e=c.call(d,b);void 0===e&&b instanceof Gb?g(b):a(e)}catch(D){g(D)}}:g});e.a.c=a;Rb(a,e);return e.a}h.Ac=function(a){this.a=Db;Eb(this,Fb,a)};h.Bc=function(a){this.a=Db;Eb(this,Hb,a)};function Eb(a,b,c){a.a==Db&&(a===c&&(b=Hb,c=new TypeError("Promise cannot resolve to itself")),a.a=1,Mb(c,a.Ac,a.Bc,a)||(a.i=c,a.a=b,a.c=null,Vb(a),b!=Hb||c instanceof Gb||Wb(a,c)))}function Mb(a,b,c,d){if(a instanceof z)return Rb(a,Kb(b||ca,c||null,d)),!0;if(nb(a))return a.then(b,c,d),!0;if(q(a))try{var e=a.then;if(p(e))return Xb(a,e,b,c,d),!0}catch(f){return c.call(d,f),!0}return!1}function Xb(a,b,c,d,e){function f(a){l||(l=!0,d.call(e,a))}function g(a){l||(l=!0,c.call(e,a))}var l=!1;try{b.call(a,g,f)}catch(n){f(n)}}function Vb(a){a.h||(a.h=!0,yb(a.Qb,a))}function Tb(a){var b=null;a.b&&(b=a.b,a.b=b.next,b.next=null);a.b||(a.f=null);return b}h.Qb=function(){for(var a;a=Tb(this);)Ub(this,a,this.a,this.i);this.h=!1};function Ub(a,b,c,d){if(c==Hb&&b.b&&!b.c)for(;a&&a.g;a=a.c)a.g=!1;if(b.a)b.a.c=null,Yb(b,c,d);else try{b.c?b.g.call(b.f):Yb(b,c,d)}catch(e){Zb.call(null,e)}pb(Jb,b)}function Yb(a,b,c){b==Fb?a.g.call(a.f,c):a.b&&a.b.call(a.f,c)}function Wb(a,b){a.g=!0;yb(function(){a.g&&Zb.call(null,b)})}var Zb=ub;function Gb(a){u.call(this,a)}t(Gb,u);Gb.prototype.name="cancel";var $b=!y||9<=Number(kb);function ac(){this.a="";this.b=bc}ac.prototype.la=!0;ac.prototype.ja=function(){return this.a};ac.prototype.toString=function(){return"Const{"+this.a+"}"};function cc(a){if(a instanceof ac&&a.constructor===ac&&a.b===bc)return a.a;Aa("expected object of type Const, got '"+a+"'");return"type_error:Const"}var bc={};function dc(a){var b=new ac;b.a=a;return b}dc("");function ec(){this.a="";this.b=fc}ec.prototype.la=!0;ec.prototype.ja=function(){return this.a};ec.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};function gc(a){if(a instanceof ec&&a.constructor===ec&&a.b===fc)return a.a;Aa("expected object of type TrustedResourceUrl, got '"+a+"' of type "+da(a));return"type_error:TrustedResourceUrl"}function hc(a,b){a=ic(a,b);b=new ec;b.a=a;return b}function ic(a,b){var c=cc(a);if(!jc.test(c))throw Error("Invalid TrustedResourceUrl format: "+c);return c.replace(kc,function(a,e){if(!Object.prototype.hasOwnProperty.call(b,e))throw Error('Found marker, "'+e+'", in format string, "'+c+'", but no valid label mapping found in args: '+JSON.stringify(b));a=b[e];return a instanceof ac?cc(a):encodeURIComponent(String(a))})}var kc=/%{(\w+)}/g,jc=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,fc={};function lc(){this.a="";this.b=mc}lc.prototype.la=!0;lc.prototype.ja=function(){return this.a};lc.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};function nc(a){if(a instanceof lc&&a.constructor===lc&&a.b===mc)return a.a;Aa("expected object of type SafeUrl, got '"+a+"' of type "+da(a));return"type_error:SafeUrl"}var oc=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function pc(a){if(a instanceof lc)return a;a=a.la?a.ja():String(a);oc.test(a)||(a="about:invalid#zClosurez");return qc(a)}var mc={};function qc(a){var b=new lc;b.a=a;return b}qc("about:blank");function rc(){this.a="";this.b=sc}rc.prototype.la=!0;rc.prototype.ja=function(){return this.a};rc.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};function uc(a){if(a instanceof rc&&a.constructor===rc&&a.b===sc)return a.a;Aa("expected object of type SafeHtml, got '"+a+"' of type "+da(a));return"type_error:SafeHtml"}var sc={};function vc(a){var b=new rc;b.a=a;return b}vc("<!DOCTYPE html>");vc("");vc("<br>");function wc(a){var b=document;return m(a)?b.getElementById(a):a}function xc(a,b){Pa(b,function(b,d){b&&b.la&&(b=b.ja());"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:yc.hasOwnProperty(d)?a.setAttribute(yc[d],b):0==d.lastIndexOf("aria-",0)||0==d.lastIndexOf("data-",0)?a.setAttribute(d,b):a[d]=b})}var yc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function zc(a,b,c){var d=arguments,e=document,f=String(d[0]),g=d[1];if(!$b&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',qa(g.name),'"');if(g.type){f.push(' type="',qa(g.type),'"');var l={};Wa(l,g);delete l.type;g=l}f.push(">");f=f.join("")}f=e.createElement(f);g&&(m(g)?f.className=g:fa(g)?f.className=g.join(" "):xc(f,g));2<d.length&&Ac(e,f,d);return f}function Ac(a,b,c){function d(c){c&&b.appendChild(m(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!ha(f)||q(f)&&0<f.nodeType?d(f):w(Bc(f)?La(f):f,d)}}function Bc(a){if(a&&"number"==typeof a.length){if(q(a))return"function"==typeof a.item||"string"==typeof a.item;if(p(a))return"function"==typeof a.item}return!1}function Cc(a){var b=[];Dc(new Ec,a,b);return b.join("")}function Ec(){}function Dc(a,b,c){if(null==b)c.push("null");else{if("object"==typeof b){if(fa(b)){var d=b;b=d.length;c.push("[");for(var e="",f=0;f<b;f++)c.push(e),Dc(a,d[f],c),e=",";c.push("]");return}if(b instanceof String||b instanceof Number||b instanceof Boolean)b=b.valueOf();else{c.push("{");e="";for(d in b)Object.prototype.hasOwnProperty.call(b,d)&&(f=b[d],"function"!=typeof f&&(c.push(e),Fc(d,c),c.push(":"),Dc(a,f,c),e=","));c.push("}");return}}switch(typeof b){case"string":Fc(b,c);break;case"number":c.push(isFinite(b)&&!isNaN(b)?String(b):"null");break;case"boolean":c.push(String(b));break;case"function":c.push("null");break;default:throw Error("Unknown type: "+typeof b)}}}var Gc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Hc=/\uffff/.test("￿")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function Fc(a,b){b.push('"',a.replace(Hc,function(a){var b=Gc[a];b||(b="\\u"+(a.charCodeAt(0)|65536).toString(16).substr(1),Gc[a]=b);return b}),'"')}function Ic(){0!=Jc&&(Kc[this[ia]||(this[ia]=++ja)]=this);this.oa=this.oa;this.Fa=this.Fa}var Jc=0,Kc={};Ic.prototype.oa=!1;function Lc(a){a.oa||(a.oa=!0,a.ta(),0!=Jc&&(a=a[ia]||(a[ia]=++ja),delete Kc[a]))}Ic.prototype.ta=function(){if(this.Fa)for(;this.Fa.length;)this.Fa.shift()()};var Mc=Object.freeze||function(a){return a};var Nc=!y||9<=Number(kb),Oc=y&&!jb("9"),Pc=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});k.addEventListener("test",ca,b);k.removeEventListener("test",ca,b);return a}();function C(a,b){this.type=a;this.b=this.target=b;this.Bb=!0}C.prototype.c=function(){this.Bb=!1};function Qc(a,b){C.call(this,a?a.type:"");this.relatedTarget=this.b=this.target=null;this.button=this.screenY=this.screenX=this.clientY=this.clientX=0;this.key="";this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.pointerId=0;this.pointerType="";this.a=null;if(a){var c=this.type=a.type,d=a.changedTouches?a.changedTouches[0]:null;this.target=a.target||a.srcElement;this.b=b;if(b=a.relatedTarget){if(cb){a:{try{Xa(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b;null===d?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0);this.button=a.button;this.key=a.key||"";this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pointerId=a.pointerId||0;this.pointerType=m(a.pointerType)?a.pointerType:Rc[a.pointerType]||"";this.a=a;a.defaultPrevented&&this.c()}}t(Qc,C);var Rc=Mc({2:"touch",3:"pen",4:"mouse"});Qc.prototype.c=function(){Qc.ib.c.call(this);var a=this.a;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Oc)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};Qc.prototype.g=function(){return this.a};var Sc="closure_listenable_"+(1e6*Math.random()|0),Tc=0;function Uc(a,b,c,d,e){this.listener=a;this.a=null;this.src=b;this.type=c;this.capture=!!d;this.La=e;this.key=++Tc;this.ma=this.Ha=!1}function Vc(a){a.ma=!0;a.listener=null;a.a=null;a.src=null;a.La=null}function Wc(a){this.src=a;this.a={};this.b=0}function Xc(a,b,c,d,e,f){var g=b.toString();b=a.a[g];b||(b=a.a[g]=[],a.b++);var l=Yc(b,c,e,f);-1<l?(a=b[l],d||(a.Ha=!1)):(a=new Uc(c,a.src,g,!!e,f),a.Ha=d,b.push(a));return a}function Zc(a,b){var c=b.type;c in a.a&&Ia(a.a[c],b)&&(Vc(b),0==a.a[c].length&&(delete a.a[c],a.b--))}function Yc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.ma&&f.listener==b&&f.capture==!!c&&f.La==d)return e}return-1}var $c="closure_lm_"+(1e6*Math.random()|0),ad={},bd=0;function cd(a,b,c,d,e){if(d&&d.once)dd(a,b,c,d,e);else if(fa(b))for(var f=0;f<b.length;f++)cd(a,b[f],c,d,e);else c=ed(c),a&&a[Sc]?fd(a,b,c,q(d)?!!d.capture:!!d,e):gd(a,b,c,!1,d,e)}function gd(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=q(e)?!!e.capture:!!e,l=hd(a);l||(a[$c]=l=new Wc(a));c=Xc(l,b,c,d,g,f);if(!c.a){d=id();c.a=d;d.src=a;d.listener=c;if(a.addEventListener)Pc||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(jd(b.toString()),d);else throw Error("addEventListener and attachEvent are unavailable.");bd++}}function id(){var a=kd,b=Nc?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b}function dd(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)dd(a,b[f],c,d,e);else c=ed(c),a&&a[Sc]?ld(a,b,c,q(d)?!!d.capture:!!d,e):gd(a,b,c,!0,d,e)}function E(a,b,c,d,e){if(fa(b))for(var f=0;f<b.length;f++)E(a,b[f],c,d,e);else(d=q(d)?!!d.capture:!!d,c=ed(c),a&&a[Sc])?(a=a.u,b=String(b).toString(),b in a.a&&(f=a.a[b],c=Yc(f,c,d,e),-1<c&&(Vc(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.a[b],a.b--)))):a&&(a=hd(a))&&(b=a.a[b.toString()],a=-1,b&&(a=Yc(b,c,d,e)),(c=-1<a?b[a]:null)&&md(c))}function md(a){if("number"!=typeof a&&a&&!a.ma){var b=a.src;if(b&&b[Sc])Zc(b.u,a);else{var c=a.type,d=a.a;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent&&b.detachEvent(jd(c),d);bd--;(c=hd(b))?(Zc(c,a),0==c.b&&(c.src=null,b[$c]=null)):Vc(a)}}}function jd(a){return a in ad?ad[a]:ad[a]="on"+a}function nd(a,b,c,d){var e=!0;if(a=hd(a))if(b=a.a[b.toString()])for(b=b.concat(),a=0;a<b.length;a++){var f=b[a];f&&f.capture==c&&!f.ma&&(f=od(f,d),e=e&&!1!==f)}return e}function od(a,b){var c=a.listener,d=a.La||a.src;a.Ha&&md(a);return c.call(d,b)}function kd(a,b){if(a.ma)return!0;if(!Nc){if(!b)a:{b=["window","event"];for(var c=k,d=0;d<b.length;d++)if(c=c[b[d]],null==c){b=null;break a}b=c}d=b;b=new Qc(d,this);c=!0;if(!(0>d.keyCode||void 0!=d.returnValue)){a:{var e=!1;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(g){e=!0}if(e||void 0==d.returnValue)d.returnValue=!0}d=[];for(e=b.b;e;e=e.parentNode)d.push(e);a=a.type;for(e=d.length-1;0<=e;e--){b.b=d[e];var f=nd(d[e],a,!0,b);c=c&&f}for(e=0;e<d.length;e++)b.b=d[e],f=nd(d[e],a,!1,b),c=c&&f}return c}return od(a,new Qc(b,this))}function hd(a){a=a[$c];return a instanceof Wc?a:null}var pd="__closure_events_fn_"+(1e9*Math.random()>>>0);function ed(a){if(p(a))return a;a[pd]||(a[pd]=function(b){return a.handleEvent(b)});return a[pd]}function F(){Ic.call(this);this.u=new Wc(this);this.Ib=this;this.Ra=null}t(F,Ic);F.prototype[Sc]=!0;F.prototype.removeEventListener=function(a,b,c,d){E(this,a,b,c,d)};function G(a,b){var c,d=a.Ra;if(d)for(c=[];d;d=d.Ra)c.push(d);a=a.Ib;d=b.type||b;if(m(b))b=new C(b,a);else if(b instanceof C)b.target=b.target||a;else{var e=b;b=new C(d,a);Wa(b,e)}e=!0;if(c)for(var f=c.length-1;0<=f;f--){var g=b.b=c[f];e=qd(g,d,!0,b)&&e}g=b.b=a;e=qd(g,d,!0,b)&&e;e=qd(g,d,!1,b)&&e;if(c)for(f=0;f<c.length;f++)g=b.b=c[f],e=qd(g,d,!1,b)&&e}F.prototype.ta=function(){F.ib.ta.call(this);if(this.u){var a=this.u,b=0,c;for(c in a.a){for(var d=a.a[c],e=0;e<d.length;e++)++b,Vc(d[e]);delete a.a[c];a.b--}}this.Ra=null};function fd(a,b,c,d,e){Xc(a.u,String(b),c,!1,d,e)}function ld(a,b,c,d,e){Xc(a.u,String(b),c,!0,d,e)}function qd(a,b,c,d){b=a.u.a[String(b)];if(!b)return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.ma&&g.capture==c){var l=g.listener,n=g.La||g.src;g.Ha&&Zc(a.u,g);e=!1!==l.call(n,d)&&e}}return e&&0!=d.Bb}function rd(a,b,c){if(p(a))c&&(a=r(a,c));else if(a&&"function"==typeof a.handleEvent)a=r(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:k.setTimeout(a,b||0)}function sd(a){var b=null;return new z(function(c,d){b=rd(function(){c(void 0)},a);-1==b&&d(Error("Failed to schedule timer."))}).s(function(a){k.clearTimeout(b);throw a})}function td(a,b,c,d,e){this.reset(a,b,c,d,e)}td.prototype.a=null;var ud=0;td.prototype.reset=function(a,b,c,d,e){"number"==typeof e||ud++;d||na();this.b=b;delete this.a};function vd(a){this.f=a;this.b=this.c=this.a=null}function wd(a,b){this.name=a;this.value=b}wd.prototype.toString=function(){return this.name};var xd=new wd("SEVERE",1e3),yd=new wd("CONFIG",700),zd=new wd("FINE",500);function Ad(a){if(a.c)return a.c;if(a.a)return Ad(a.a);Aa("Root logger has no level set.");return null}vd.prototype.log=function(a,b,c){if(a.value>=Ad(this).value)for(p(b)&&(b=b()),a=new td(a,String(b),this.f),c&&(a.a=c),c="log:"+a.b,(a=k.console)&&a.timeStamp&&a.timeStamp(c),(a=k.msWriteProfilerMark)&&a(c),c=this;c;)c=c.a};var Bd={},Cd=null;function Dd(a){Cd||(Cd=new vd(""),Bd[""]=Cd,Cd.c=yd);var b;if(!(b=Bd[a])){b=new vd(a);var c=a.lastIndexOf("."),d=a.substr(c+1);c=Dd(a.substr(0,c));c.b||(c.b={});c.b[d]=b;b.a=c;Bd[a]=b}return b}function Ed(a,b){this.b={};this.a=[];this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof Ed?(c=a.S(),d=a.P()):(c=Ra(a),d=Qa(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=Ed.prototype;h.P=function(){Fd(this);for(var a=[],b=0;b<this.a.length;b++)a.push(this.b[this.a[b]]);return a};h.S=function(){Fd(this);return this.a.concat()};h.clear=function(){this.b={};this.c=this.a.length=0};function Fd(a){if(a.c!=a.a.length){for(var b=0,c=0;b<a.a.length;){var d=a.a[b];Gd(a.b,d)&&(a.a[c++]=d);b++}a.a.length=c}if(a.c!=a.a.length){var e={};for(c=b=0;b<a.a.length;)d=a.a[b],Gd(e,d)||(a.a[c++]=d,e[d]=1),b++;a.a.length=c}}h.get=function(a,b){return Gd(this.b,a)?this.b[a]:b};h.set=function(a,b){Gd(this.b,a)||(this.c++,this.a.push(a));this.b[a]=b};h.forEach=function(a,b){for(var c=this.S(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};function Gd(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function H(a,b){a&&a.log(zd,b,void 0)}function Hd(a){return Da(a,function(a){a=a.toString(16);return 1<a.length?a:"0"+a}).join("")}var Id=null,Jd=null;function Kd(a){var b="";Ld(a,function(a){b+=String.fromCharCode(a)});return b}function Ld(a,b){function c(b){for(;d<a.length;){var c=a.charAt(d++),e=Jd[c];if(null!=e)return e;if(!/^[\s\xa0]*$/.test(c))throw Error("Unknown base64 encoding at char: "+c)}return b}Md();for(var d=0;;){var e=c(-1),f=c(0),g=c(64),l=c(64);if(64===l&&-1===e)break;b(e<<2|f>>4);64!=g&&(b(f<<4&240|g>>2),64!=l&&b(g<<6&192|l))}}function Md(){if(!Id){Id={};Jd={};for(var a=0;65>a;a++)Id[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(a),Jd[Id[a]]=a,62<=a&&(Jd["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(a)]=a)}}function Nd(a,b){this.g=[];this.v=a;this.o=b||null;this.f=this.a=!1;this.c=void 0;this.u=this.w=this.i=!1;this.h=0;this.b=null;this.l=0}Nd.prototype.cancel=function(a){if(this.a)this.c instanceof Nd&&this.c.cancel();else{if(this.b){var b=this.b;delete this.b;a?b.cancel(a):(b.l--,0>=b.l&&b.cancel())}this.v?this.v.call(this.o,this):this.u=!0;this.a||(a=new Od,Pd(this),Qd(this,!1,a))}};Nd.prototype.m=function(a,b){this.i=!1;Qd(this,a,b)};function Qd(a,b,c){a.a=!0;a.c=c;a.f=!b;Rd(a)}function Pd(a){if(a.a){if(!a.u)throw new Sd;a.u=!1}}Nd.prototype.A=function(a){Pd(this);Qd(this,!0,a)};function Td(a,b){Ud(a,null,b,void 0)}function Ud(a,b,c,d){a.g.push([b,c,d]);a.a&&Rd(a)}Nd.prototype.then=function(a,b,c){var d,e,f=new z(function(a,b){d=a;e=b});Ud(this,d,function(a){a instanceof Od?f.cancel():e(a)});return f.then(a,b,c)};mb(Nd);function Vd(a){return Ea(a.g,function(a){return p(a[1])})}function Rd(a){if(a.h&&a.a&&Vd(a)){var b=a.h,c=Wd[b];c&&(k.clearTimeout(c.a),delete Wd[b]);a.h=0}a.b&&(a.b.l--,delete a.b);b=a.c;for(var d=c=!1;a.g.length&&!a.i;){var e=a.g.shift(),f=e[0],g=e[1];e=e[2];if(f=a.f?g:f)try{var l=f.call(e||a.o,b);void 0!==l&&(a.f=a.f&&(l==b||l instanceof Error),a.c=b=l);if(nb(b)||"function"===typeof k.Promise&&b instanceof k.Promise)d=!0,a.i=!0}catch(n){b=n,a.f=!0,Vd(a)||(c=!0)}}a.c=b;d&&(l=r(a.m,a,!0),d=r(a.m,a,!1),b instanceof Nd?(Ud(b,l,d),b.w=!0):b.then(l,d));c&&(b=new Xd(b),Wd[b.a]=b,a.h=b.a)}function Sd(){u.call(this)}t(Sd,u);Sd.prototype.message="Deferred has already fired";Sd.prototype.name="AlreadyCalledError";function Od(){u.call(this)}t(Od,u);Od.prototype.message="Deferred was canceled";Od.prototype.name="CanceledError";function Xd(a){this.a=k.setTimeout(r(this.c,this),0);this.b=a}Xd.prototype.c=function(){delete Wd[this.a];throw this.b};var Wd={};function Yd(){this.b=-1}function Zd(a,b){this.b=-1;this.b=$d;this.f=k.Uint8Array?new Uint8Array(this.b):Array(this.b);this.g=this.c=0;this.a=[];this.i=a;this.h=b;this.l=k.Int32Array?new Int32Array(64):Array(64);ae||(k.Int32Array?ae=new Int32Array(be):ae=be);this.reset()}var ae;t(Zd,Yd);for(var $d=64,ce=$d-1,de=[],ee=0;ee<ce;ee++)de[ee]=0;var fe=Ka(128,de);Zd.prototype.reset=function(){this.g=this.c=0;this.a=k.Int32Array?new Int32Array(this.h):La(this.h)};function ge(a){for(var b=a.f,c=a.l,d=0,e=0;e<b.length;)c[d++]=b[e]<<24|b[e+1]<<16|b[e+2]<<8|b[e+3],e=4*d;for(b=16;64>b;b++){e=c[b-15]|0;d=c[b-2]|0;var f=(c[b-16]|0)+((e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3)|0,g=(c[b-7]|0)+((d>>>17|d<<15)^(d>>>19|d<<13)^d>>>10)|0;c[b]=f+g|0}d=a.a[0]|0;e=a.a[1]|0;var l=a.a[2]|0,n=a.a[3]|0,D=a.a[4]|0,vb=a.a[5]|0,tc=a.a[6]|0;f=a.a[7]|0;for(b=0;64>b;b++){var Bj=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&e^d&l^e&l)|0;g=D&vb^~D&tc;f=f+((D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))|0;g=g+(ae[b]|0)|0;g=f+(g+(c[b]|0)|0)|0;f=tc;tc=vb;vb=D;D=n+g|0;n=l;l=e;e=d;d=g+Bj|0}a.a[0]=a.a[0]+d|0;a.a[1]=a.a[1]+e|0;a.a[2]=a.a[2]+l|0;a.a[3]=a.a[3]+n|0;a.a[4]=a.a[4]+D|0;a.a[5]=a.a[5]+vb|0;a.a[6]=a.a[6]+tc|0;a.a[7]=a.a[7]+f|0}function he(a,b,c){void 0===c&&(c=b.length);var d=0,e=a.c;if(m(b))for(;d<c;)a.f[e++]=b.charCodeAt(d++),e==a.b&&(ge(a),e=0);else if(ha(b))for(;d<c;){var f=b[d++];if(!("number"==typeof f&&0<=f&&255>=f&&f==(f|0)))throw Error("message must be a byte array");a.f[e++]=f;e==a.b&&(ge(a),e=0)}else throw Error("message must be string or array");a.c=e;a.g+=c}var be=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ie(){Zd.call(this,8,je)}t(ie,Zd);var je=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function ke(a){if(a.P&&"function"==typeof a.P)return a.P();if(m(a))return a.split("");if(ha(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return Qa(a)}function le(a){if(a.S&&"function"==typeof a.S)return a.S();if(!a.P||"function"!=typeof a.P){if(ha(a)||m(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return Ra(a)}}function me(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(ha(a)||m(a))w(a,b,void 0);else for(var c=le(a),d=ke(a),e=d.length,f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}var ne=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function oe(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}}function pe(a,b){this.b=this.l=this.c="";this.i=null;this.h=this.g="";this.f=!1;if(a instanceof pe){this.f=void 0!==b?b:a.f;qe(this,a.c);this.l=a.l;this.b=a.b;re(this,a.i);this.g=a.g;b=a.a;var c=new se;c.c=b.c;b.a&&(c.a=new Ed(b.a),c.b=b.b);te(this,c);this.h=a.h}else a&&(c=String(a).match(ne))?(this.f=!!b,qe(this,c[1]||"",!0),this.l=ue(c[2]||""),this.b=ue(c[3]||"",!0),re(this,c[4]),this.g=ue(c[5]||"",!0),te(this,c[6]||"",!0),this.h=ue(c[7]||"")):(this.f=!!b,this.a=new se(null,0,this.f))}pe.prototype.toString=function(){var a=[],b=this.c;b&&a.push(ve(b,we,!0),":");var c=this.b;if(c||"file"==b)a.push("//"),(b=this.l)&&a.push(ve(b,we,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.i,null!=c&&a.push(":",String(c));if(c=this.g)this.b&&"/"!=c.charAt(0)&&a.push("/"),a.push(ve(c,"/"==c.charAt(0)?xe:ye,!0));(c=this.a.toString())&&a.push("?",c);(c=this.h)&&a.push("#",ve(c,ze));return a.join("")};function qe(a,b,c){a.c=c?ue(b,!0):b;a.c&&(a.c=a.c.replace(/:$/,""))}function re(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.i=b}else a.i=null}function te(a,b,c){b instanceof se?(a.a=b,Ae(a.a,a.f)):(c||(b=ve(b,Be)),a.a=new se(b,0,a.f))}function I(a,b,c){a.a.set(b,c)}function Ce(a,b){return a.a.get(b)}function De(a){return a instanceof pe?new pe(a):new pe(a,void 0)}function Ee(a,b){var c=new pe(null,void 0);qe(c,"https");a&&(c.b=a);b&&(c.g=b);return c}function ue(a,b){
return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function ve(a,b,c){return m(a)?(a=encodeURI(a).replace(b,Fe),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Fe(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var we=/[#\/\?@]/g,ye=/[\#\?:]/g,xe=/[\#\?]/g,Be=/[\#\?@]/g,ze=/#/g;function se(a,b,c){this.b=this.a=null;this.c=a||null;this.f=!!c}function Ge(a){a.a||(a.a=new Ed,a.b=0,a.c&&oe(a.c,function(b,c){He(a,decodeURIComponent(b.replace(/\+/g," ")),c)}))}function Ie(a){var b=le(a);if("undefined"==typeof b)throw Error("Keys are undefined");var c=new se(null,0,void 0);a=ke(a);for(var d=0;d<b.length;d++){var e=b[d],f=a[d];fa(f)?Je(c,e,f):He(c,e,f)}return c}function He(a,b,c){Ge(a);a.c=null;b=Ke(a,b);var d=a.a.get(b);d||a.a.set(b,d=[]);d.push(c);a.b+=1}function Le(a,b){Ge(a);b=Ke(a,b);Gd(a.a.b,b)&&(a.c=null,a.b-=a.a.get(b).length,a=a.a,Gd(a.b,b)&&(delete a.b[b],a.c--,a.a.length>2*a.c&&Fd(a)))}h=se.prototype;h.clear=function(){this.a=this.c=null;this.b=0};function Me(a,b){Ge(a);b=Ke(a,b);return Gd(a.a.b,b)}h.forEach=function(a,b){Ge(this);this.a.forEach(function(c,d){w(c,function(c){a.call(b,c,d,this)},this)},this)};h.S=function(){Ge(this);for(var a=this.a.P(),b=this.a.S(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};h.P=function(a){Ge(this);var b=[];if(m(a))Me(this,a)&&(b=Ka(b,this.a.get(Ke(this,a))));else{a=this.a.P();for(var c=0;c<a.length;c++)b=Ka(b,a[c])}return b};h.set=function(a,b){Ge(this);this.c=null;a=Ke(this,a);Me(this,a)&&(this.b-=this.a.get(a).length);this.a.set(a,[b]);this.b+=1;return this};h.get=function(a,b){a=a?this.P(a):[];return 0<a.length?String(a[0]):b};function Je(a,b,c){Le(a,b);0<c.length&&(a.c=null,a.a.set(Ke(a,b),La(c)),a.b+=c.length)}h.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var a=[],b=this.a.S(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.P(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}}return this.c=a.join("&")};function Ke(a,b){b=String(b);a.f&&(b=b.toLowerCase());return b}function Ae(a,b){b&&!a.f&&(Ge(a),a.c=null,a.a.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(Le(this,b),Je(this,c,a))},a));a.f=b}function Ne(){}Ne.prototype.c=null;function Oe(a){return a.c||(a.c=a.b())}var Pe;function Qe(){}t(Qe,Ne);Qe.prototype.a=function(){var a=Re(this);return a?new ActiveXObject(a):new XMLHttpRequest};Qe.prototype.b=function(){var a={};Re(this)&&(a[0]=!0,a[1]=!0);return a};function Re(a){if(!a.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.f=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return a.f}Pe=new Qe;function Se(a){F.call(this);this.headers=new Ed;this.w=a||null;this.b=!1;this.v=this.a=null;this.g=this.I=this.i="";this.c=this.G=this.h=this.A=!1;this.f=0;this.m=null;this.l=Te;this.o=this.N=!1}t(Se,F);var Te="",Ue=Se.prototype,Ve=Dd("goog.net.XhrIo");Ue.J=Ve;var We=/^https?$/i,Xe=["POST","PUT"];function Ye(a,b,c,d,e){if(a.a)throw Error("[goog.net.XhrIo] Object is active with another request="+a.i+"; newUri="+b);c=c?c.toUpperCase():"GET";a.i=b;a.g="";a.I=c;a.A=!1;a.b=!0;a.a=a.w?a.w.a():Pe.a();a.v=a.w?Oe(a.w):Oe(Pe);a.a.onreadystatechange=r(a.Ab,a);try{H(a.J,Ze(a,"Opening Xhr")),a.G=!0,a.a.open(c,String(b),!0),a.G=!1}catch(g){H(a.J,Ze(a,"Error opening Xhr: "+g.message));$e(a,g);return}b=d||"";var f=new Ed(a.headers);e&&me(e,function(a,b){f.set(b,a)});e=Fa(f.S());d=k.FormData&&b instanceof k.FormData;!Ha(Xe,c)||e||d||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");f.forEach(function(a,b){this.a.setRequestHeader(b,a)},a);a.l&&(a.a.responseType=a.l);"withCredentials"in a.a&&a.a.withCredentials!==a.N&&(a.a.withCredentials=a.N);try{af(a),0<a.f&&(a.o=bf(a.a),H(a.J,Ze(a,"Will abort after "+a.f+"ms if incomplete, xhr2 "+a.o)),a.o?(a.a.timeout=a.f,a.a.ontimeout=r(a.Ea,a)):a.m=rd(a.Ea,a.f,a)),H(a.J,Ze(a,"Sending request")),a.h=!0,a.a.send(b),a.h=!1}catch(g){H(a.J,Ze(a,"Send error: "+g.message)),$e(a,g)}}function bf(a){return y&&jb(9)&&"number"==typeof a.timeout&&void 0!==a.ontimeout}function Ga(a){return"content-type"==a.toLowerCase()}h=Se.prototype;h.Ea=function(){"undefined"!=typeof aa&&this.a&&(this.g="Timed out after "+this.f+"ms, aborting",H(this.J,Ze(this,this.g)),G(this,"timeout"),this.abort(8))};function $e(a,b){a.b=!1;a.a&&(a.c=!0,a.a.abort(),a.c=!1);a.g=b;cf(a);df(a)}function cf(a){a.A||(a.A=!0,G(a,"complete"),G(a,"error"))}h.abort=function(){this.a&&this.b&&(H(this.J,Ze(this,"Aborting")),this.b=!1,this.c=!0,this.a.abort(),this.c=!1,G(this,"complete"),G(this,"abort"),df(this))};h.ta=function(){this.a&&(this.b&&(this.b=!1,this.c=!0,this.a.abort(),this.c=!1),df(this,!0));Se.ib.ta.call(this)};h.Ab=function(){this.oa||(this.G||this.h||this.c?ef(this):this.jc())};h.jc=function(){ef(this)};function ef(a){if(a.b&&"undefined"!=typeof aa)if(a.v[1]&&4==ff(a)&&2==gf(a))H(a.J,Ze(a,"Local request error detected and ignored"));else if(a.h&&4==ff(a))rd(a.Ab,0,a);else if(G(a,"readystatechange"),4==ff(a)){H(a.J,Ze(a,"Request complete"));a.b=!1;try{var b=gf(a);a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break a;default:c=!1}var d;if(!(d=c)){var e;if(e=0===b){var f=String(a.i).match(ne)[1]||null;if(!f&&k.self&&k.self.location){var g=k.self.location.protocol;f=g.substr(0,g.length-1)}e=!We.test(f?f.toLowerCase():"")}d=e}if(d)G(a,"complete"),G(a,"success");else{try{var l=2<ff(a)?a.a.statusText:""}catch(n){H(a.J,"Can not get status: "+n.message),l=""}a.g=l+" ["+gf(a)+"]";cf(a)}}finally{df(a)}}}function df(a,b){if(a.a){af(a);var c=a.a,d=a.v[0]?ca:null;a.a=null;a.v=null;b||G(a,"ready");try{c.onreadystatechange=d}catch(e){(a=a.J)&&a.log(xd,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function af(a){a.a&&a.o&&(a.a.ontimeout=null);"number"==typeof a.m&&(k.clearTimeout(a.m),a.m=null)}function ff(a){return a.a?a.a.readyState:0}function gf(a){try{return 2<ff(a)?a.a.status:-1}catch(b){return-1}}function hf(a){try{return a.a?a.a.responseText:""}catch(b){return H(a.J,"Can not get responseText: "+b.message),""}}h.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.l){case Te:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var a=this.J;a&&a.log(xd,"Response type "+this.l+" is not supported on this browser",void 0);return null}catch(b){return H(this.J,"Can not get response: "+b.message),null}};function Ze(a,b){return b+" ["+a.I+" "+a.i+" "+gf(a)+"]"}var jf=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;function kf(a){var b={},c=b.document||document,d=gc(a),e=document.createElement("SCRIPT"),f={Cb:e,Ea:void 0},g=new Nd(lf,f),l=null,n=null!=b.timeout?b.timeout:5e3;0<n&&(l=window.setTimeout(function(){mf(e,!0);var a=new nf(of,"Timeout reached for loading script "+d);Pd(g);Qd(g,!1,a)},n),f.Ea=l);e.onload=e.onreadystatechange=function(){e.readyState&&"loaded"!=e.readyState&&"complete"!=e.readyState||(mf(e,b.Sc||!1,l),g.A(null))};e.onerror=function(){mf(e,!0,l);var a=new nf(pf,"Error while loading script "+d);Pd(g);Qd(g,!1,a)};f=b.attributes||{};Wa(f,{type:"text/javascript",charset:"UTF-8"});xc(e,f);e.src=gc(a);qf(c).appendChild(e);return g}function qf(a){var b;return(b=(a||document).getElementsByTagName("HEAD"))&&0!=b.length?b[0]:a.documentElement}function lf(){if(this&&this.Cb){var a=this.Cb;a&&"SCRIPT"==a.tagName&&mf(a,!0,this.Ea)}}function mf(a,b,c){null!=c&&k.clearTimeout(c);a.onload=ca;a.onerror=ca;a.onreadystatechange=ca;b&&window.setTimeout(function(){a&&a.parentNode&&a.parentNode.removeChild(a)},0)}var pf=0,of=1;function nf(a,b){var c="Jsloader error (code #"+a+")";b&&(c+=": "+b);u.call(this,c);this.code=a}t(nf,u);function rf(){}t(rf,Ne);rf.prototype.a=function(){var a=new XMLHttpRequest;if("withCredentials"in a)return a;if("undefined"!=typeof XDomainRequest)return new sf;throw Error("Unsupported browser")};rf.prototype.b=function(){return{}};function sf(){this.a=new XDomainRequest;this.readyState=0;this.onreadystatechange=null;this.responseText="";this.status=-1;this.statusText=this.responseXML=null;this.a.onload=r(this.Wb,this);this.a.onerror=r(this.xb,this);this.a.onprogress=r(this.Xb,this);this.a.ontimeout=r(this.Yb,this)}h=sf.prototype;h.open=function(a,b,c){if(null!=c&&!c)throw Error("Only async requests are supported.");this.a.open(a,b)};h.send=function(a){if(a)if("string"==typeof a)this.a.send(a);else throw Error("Only string data is supported");else this.a.send()};h.abort=function(){this.a.abort()};h.setRequestHeader=function(){};h.getResponseHeader=function(a){return"content-type"==a.toLowerCase()?this.a.contentType:""};h.Wb=function(){this.status=200;this.responseText=this.a.responseText;tf(this,4)};h.xb=function(){this.status=500;this.responseText="";tf(this,4)};h.Yb=function(){this.xb()};h.Xb=function(){this.status=200;tf(this,1)};function tf(a,b){a.readyState=b;if(a.onreadystatechange)a.onreadystatechange()}h.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};function uf(){var a=J();return y&&!!kb&&11==kb||/Edge\/\d+/.test(a)}function vf(){return k.window&&k.window.location.href||""}function wf(a,b){b=b||k.window;var c="about:blank";a&&(c=nc(pc(a)));b.location.href=c}function xf(a,b){var c=[],d;for(d in a)d in b?typeof a[d]!=typeof b[d]?c.push(d):fa(a[d])?Ta(a[d],b[d])||c.push(d):"object"==typeof a[d]&&null!=a[d]&&null!=b[d]?0<xf(a[d],b[d]).length&&c.push(d):a[d]!==b[d]&&c.push(d):c.push(d);for(d in b)d in a||c.push(d);return c}function yf(){var a=J();a=zf(a)!=Af?null:(a=a.match(/\sChrome\/(\d+)/i))&&2==a.length?parseInt(a[1],10):null;return a&&30>a?!1:!y||!kb||9<kb}function Bf(a){a=(a||J()).toLowerCase();return a.match(/android/)||a.match(/webos/)||a.match(/iphone|ipad|ipod/)||a.match(/blackberry/)||a.match(/windows phone/)||a.match(/iemobile/)?!0:!1}function Cf(a){a=a||k.window;try{a.close()}catch(b){}}function Df(a,b,c){var d=Math.floor(1e9*Math.random()).toString();b=b||500;c=c||600;var e=(window.screen.availHeight-c)/2,f=(window.screen.availWidth-b)/2;b={width:b,height:c,top:0<e?e:0,left:0<f?f:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1};c=J().toLowerCase();d&&(b.target=d,v(c,"crios/")&&(b.target="_blank"));zf(J())==Ef&&(a=a||"http://localhost",b.scrollbars=!0);c=a||"";(d=b)||(d={});a=window;b=c instanceof lc?c:pc("undefined"!=typeof c.href?c.href:String(c));c=d.target||c.target;e=[];for(g in d)switch(g){case"width":case"height":case"top":case"left":e.push(g+"="+d[g]);break;case"target":case"noreferrer":break;default:e.push(g+"="+(d[g]?1:0))}var g=e.join(",");(x("iPhone")&&!x("iPod")&&!x("iPad")||x("iPad")||x("iPod"))&&a.navigator&&a.navigator.standalone&&c&&"_self"!=c?(g=a.document.createElement("A"),b instanceof lc||b instanceof lc||(b=b.la?b.ja():String(b),oc.test(b)||(b="about:invalid#zClosurez"),b=qc(b)),g.href=nc(b),g.setAttribute("target",c),d.noreferrer&&g.setAttribute("rel","noreferrer"),d=document.createEvent("MouseEvent"),d.initMouseEvent("click",!0,!0,a,1),g.dispatchEvent(d),g={}):d.noreferrer?(g=a.open("",c,g),a=nc(b),g&&(bb&&v(a,";")&&(a="'"+a.replace(/'/g,"%27")+"'"),g.opener=null,dc("b/12014412, meta tag with sanitized URL"),a='<META HTTP-EQUIV="refresh" content="0; url='+qa(a)+'">',a=vc(a),g.document.write(uc(a)),g.document.close())):g=a.open(nc(b),c,g);if(g)try{g.focus()}catch(l){}return g}function Ff(a){return new z(function(b){function c(){sd(2e3).then(function(){if(!a||a.closed)b();else return c()})}return c()})}var Gf=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/;function Hf(){var a=null;return new z(function(b){"complete"==k.document.readyState?b():(a=function(){b()},dd(window,"load",a))}).s(function(b){E(window,"load",a);throw b})}function If(){return Jf(void 0)?Hf().then(function(){return new z(function(a,b){var c=k.document,d=setTimeout(function(){b(Error("Cordova framework is not ready."))},1e3);c.addEventListener("deviceready",function(){clearTimeout(d);a()},!1)})}):B(Error("Cordova must run in an Android or iOS file scheme."))}function Jf(a){a=a||J();return!("file:"!==Kf()||!a.toLowerCase().match(/iphone|ipad|ipod|android/))}function Lf(){var a=k.window;try{return!(!a||a==a.top)}catch(b){return!1}}function K(){return firebase.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":firebase.INTERNAL.hasOwnProperty("node")?"Node":"Browser"}function Mf(){var a=K();return"ReactNative"===a||"Node"===a}var Ef="Firefox",Af="Chrome";function zf(a){var b=a.toLowerCase();if(v(b,"opera/")||v(b,"opr/")||v(b,"opios/"))return"Opera";if(v(b,"iemobile"))return"IEMobile";if(v(b,"msie")||v(b,"trident/"))return"IE";if(v(b,"edge/"))return"Edge";if(v(b,"firefox/"))return Ef;if(v(b,"silk/"))return"Silk";if(v(b,"blackberry"))return"Blackberry";if(v(b,"webos"))return"Webos";if(!v(b,"safari/")||v(b,"chrome/")||v(b,"crios/")||v(b,"android"))if(!v(b,"chrome/")&&!v(b,"crios/")||v(b,"edge/")){if(v(b,"android"))return"Android";if((a=a.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==a.length)return a[1]}else return Af;else return"Safari";return"Other"}var Nf={Gc:"FirebaseCore-web",Ic:"FirebaseUI-web"};function Of(a,b){b=b||[];var c=[],d={},e;for(e in Nf)d[Nf[e]]=!0;for(e=0;e<b.length;e++)"undefined"!==typeof d[b[e]]&&(delete d[b[e]],c.push(b[e]));c.sort();b=c;b.length||(b=["FirebaseCore-web"]);c=K();d="";"Browser"===c?d=zf(J()):d=c;return d+"/JsCore/"+a+"/"+b.join(",")}function J(){return k.navigator&&k.navigator.userAgent||""}function L(a,b){a=a.split(".");b=b||k;for(var c=0;c<a.length&&"object"==typeof b&&null!=b;c++)b=b[a[c]];c!=a.length&&(b=void 0);return b}function Pf(){try{var a=k.localStorage,b=Qf();if(a)return a.setItem(b,"1"),a.removeItem(b),uf()?!!k.indexedDB:!0}catch(c){}return!1}function Rf(){return(Sf()||"chrome-extension:"===Kf()||Jf())&&!Mf()&&Pf()}function Sf(){return"http:"===Kf()||"https:"===Kf()}function Kf(){return k.location&&k.location.protocol||null}function Tf(a){a=a||J();return Bf(a)||zf(a)==Ef?!1:!0}function Uf(a){return"undefined"===typeof a?null:Cc(a)}function Vf(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&null!==a[c]&&void 0!==a[c]&&(b[c]=a[c]);return b}function Wf(a){if(null!==a)return JSON.parse(a)}function Qf(a){return a?a:""+Math.floor(1e9*Math.random()).toString()}function Xf(a){a=a||J();return"Safari"==zf(a)||a.toLowerCase().match(/iphone|ipad|ipod/)?!1:!0}function Yf(){var a=k.___jsl;if(a&&a.H)for(var b in a.H)if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=a.H[b].L.concat(),a.CP)for(var c=0;c<a.CP.length;c++)a.CP[c]=null}function Zf(){var a=k.navigator;return a&&"boolean"===typeof a.onLine&&(Sf()||"chrome-extension:"===Kf()||"undefined"!==typeof a.connection)?a.onLine:!0}function $f(a,b,c,d){if(a>b)throw Error("Short delay should be less than long delay!");this.c=a;this.b=b;a=c||J();d=d||K();this.a=Bf(a)||"ReactNative"===d}$f.prototype.get=function(){return this.a?this.b:this.c};function ag(){var a=k.document;return a&&"undefined"!==typeof a.visibilityState?"visible"==a.visibilityState:!0}function bg(){var a=k.document,b=null;return ag()||!a?A():new z(function(c){b=function(){ag()&&(a.removeEventListener("visibilitychange",b,!1),c())};a.addEventListener("visibilitychange",b,!1)}).s(function(c){a.removeEventListener("visibilitychange",b,!1);throw c})}function cg(a){try{var b=new Date(parseInt(a,10));if(!isNaN(b.getTime())&&!/[^0-9]/.test(a))return b.toUTCString()}catch(c){}return null}var dg={};var eg;try{var fg={};Object.defineProperty(fg,"abcd",{configurable:!0,enumerable:!0,value:1});Object.defineProperty(fg,"abcd",{configurable:!0,enumerable:!0,value:2});eg=2==fg.abcd}catch(a){eg=!1}function M(a,b,c){eg?Object.defineProperty(a,b,{configurable:!0,enumerable:!0,value:c}):a[b]=c}function gg(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&M(a,c,b[c])}function hg(a){var b={};gg(b,a);return b}function ig(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function jg(a,b){if(!b||!b.length)return!0;if(!a)return!1;for(var c=0;c<b.length;c++){var d=a[b[c]];if(void 0===d||null===d||""===d)return!1}return!0}function kg(a){var b=a;if("object"==typeof a&&null!=a){b="length"in a?[]:{};for(var c in a)M(b,c,kg(a[c]))}return b}function lg(a){var b={},c=a[mg],d=a[ng];a=a[og];if(!c||!a)throw Error("Invalid provider user info!");b[pg]=d||null;b[qg]=c;M(this,rg,a);M(this,sg,kg(b))}var mg="email",ng="newEmail",og="requestType",qg="email",pg="fromEmail",sg="data",rg="operation";function N(a,b){this.code=tg+a;this.message=b||ug[a]||""}t(N,Error);N.prototype.B=function(){return{code:this.code,message:this.message}};N.prototype.toJSON=function(){return this.B()};function vg(a){var b=a&&a.code;return b?new N(b.substring(tg.length),a.message):null}var tg="auth/",ug={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function wg(a){var b=a[xg];if("undefined"===typeof b)throw new N("missing-continue-uri");if("string"!==typeof b||"string"===typeof b&&!b.length)throw new N("invalid-continue-uri");this.h=b;this.c=this.a=null;this.g=!1;var c=a[yg];if(c&&"object"===typeof c){b=c[zg];var d=c[Ag];c=c[Bg];if("string"===typeof b&&b.length){this.a=b;if("undefined"!==typeof d&&"boolean"!==typeof d)throw new N("argument-error",Ag+" property must be a boolean when specified.");this.g=!!d;if("undefined"!==typeof c&&("string"!==typeof c||"string"===typeof c&&!c.length))throw new N("argument-error",Bg+" property must be a non empty string when specified.");this.c=c||null}else{if("undefined"!==typeof b)throw new N("argument-error",zg+" property must be a non empty string when specified.");if("undefined"!==typeof d||"undefined"!==typeof c)throw new N("missing-android-pkg-name")}}else if("undefined"!==typeof c)throw new N("argument-error",yg+" property must be a non null object when specified.");this.b=null;if((b=a[Cg])&&"object"===typeof b)if(b=b[Dg],"string"===typeof b&&b.length)this.b=b;else{if("undefined"!==typeof b)throw new N("argument-error",Dg+" property must be a non empty string when specified.")}else if("undefined"!==typeof b)throw new N("argument-error",Cg+" property must be a non null object when specified.");a=a[Eg];if("undefined"!==typeof a&&"boolean"!==typeof a)throw new N("argument-error",Eg+" property must be a boolean when specified.");if((this.f=!!a)&&!this.b&&!this.a)throw new N("argument-error",Eg+" property can't be true when no mobile application is provided.")}var yg="android",Eg="handleCodeInApp",Cg="iOS",xg="url",Ag="installApp",Bg="minimumVersion",zg="packageName",Dg="bundleId";function Fg(a){var b={};b.continueUrl=a.h;b.canHandleCodeInApp=a.f;if(b.androidPackageName=a.a)b.androidMinimumVersion=a.c,b.androidInstallApp=a.g;b.iOSBundleId=a.b;for(var c in b)null===b[c]&&delete b[c];return b}function Gg(a){this.b=a.sub;na();this.a=a.provider_id||a.firebase&&a.firebase.sign_in_provider||null}function Hg(a){a=a.split(".");if(3!=a.length)return null;a=a[1];for(var b=(4-a.length%4)%4,c=0;c<b;c++)a+=".";try{var d=JSON.parse(Kd(a));if(d.sub&&d.iss&&d.aud&&d.exp)return new Gg(d)}catch(e){}return null}var Ig="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Jg=["client_id","response_type","scope","redirect_uri","state"],Kg={Hc:{Ma:"locale",za:500,ya:600,Na:"facebook.com",$a:Jg},Jc:{Ma:null,za:500,ya:620,Na:"github.com",$a:Jg},Kc:{Ma:"hl",za:515,ya:680,Na:"google.com",$a:Jg},Qc:{Ma:"lang",za:485,ya:705,Na:"twitter.com",$a:Ig}};function Lg(a){for(var b in Kg)if(Kg[b].Na==a)return Kg[b];return null}function Mg(a){var b={};b["facebook.com"]=Ng;b["google.com"]=Og;b["github.com"]=Pg;b["twitter.com"]=Qg;var c=a&&a[Rg];try{if(c)return b[c]?new b[c](a):new Sg(a);if("undefined"!==typeof a[Tg])return new Ug(a)}catch(d){}return null}var Tg="idToken",Rg="providerId";function Ug(a){var b=a[Rg];if(!b&&a[Tg]){var c=Hg(a[Tg]);c&&c.a&&(b=c.a)}if(!b)throw Error("Invalid additional user info!");if("anonymous"==b||"custom"==b)b=null;c=!1;"undefined"!==typeof a.isNewUser?c=!!a.isNewUser:"identitytoolkit#SignupNewUserResponse"===a.kind&&(c=!0);M(this,"providerId",b);M(this,"isNewUser",c)}function Sg(a){Ug.call(this,a);a=Wf(a.rawUserInfo||"{}");M(this,"profile",kg(a||{}))}t(Sg,Ug);function Ng(a){Sg.call(this,a);if("facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}t(Ng,Sg);function Pg(a){Sg.call(this,a);if("github.com"!=this.providerId)throw Error("Invalid provider ID!");M(this,"username",this.profile&&this.profile.login||null)}t(Pg,Sg);function Og(a){Sg.call(this,a);if("google.com"!=this.providerId)throw Error("Invalid provider ID!")}t(Og,Sg);function Qg(a){Sg.call(this,a);if("twitter.com"!=this.providerId)throw Error("Invalid provider ID!");M(this,"username",a.screenName||null)}t(Qg,Sg);function Vg(a,b){return a.then(function(a){if(a[O]){var c=Hg(a[O]);if(!c||b!=c.b)throw new N("user-mismatch");return a}throw new N("user-mismatch")}).s(function(a){throw a&&a.code&&a.code==tg+"user-not-found"?new N("user-mismatch"):a})}function Wg(a,b){if(b.idToken||b.accessToken)b.idToken&&M(this,"idToken",b.idToken),b.accessToken&&M(this,"accessToken",b.accessToken);else if(b.oauthToken&&b.oauthTokenSecret)M(this,"accessToken",b.oauthToken),M(this,"secret",b.oauthTokenSecret);else throw new N("internal-error","failed to construct a credential");M(this,"providerId",a)}Wg.prototype.wa=function(a){return Xg(a,Yg(this))};Wg.prototype.b=function(a,b){var c=Yg(this);c.idToken=b;return Zg(a,c)};Wg.prototype.c=function(a,b){var c=Yg(this);return Vg($g(a,c),b)};function Yg(a){var b={};a.idToken&&(b.id_token=a.idToken);a.accessToken&&(b.access_token=a.accessToken);a.secret&&(b.oauth_token_secret=a.secret);b.providerId=a.providerId;return{postBody:Ie(b).toString(),requestUri:"http://localhost"}}Wg.prototype.B=function(){var a={providerId:this.providerId};this.idToken&&(a.oauthIdToken=this.idToken);this.accessToken&&(a.oauthAccessToken=this.accessToken);this.secret&&(a.oauthTokenSecret=this.secret);return a};function ah(a,b){this.rc=b||[];gg(this,{providerId:a,isOAuthProvider:!0});this.rb={};this.Wa=(Lg(a)||{}).Ma||null;this.Ua=null}ah.prototype.Ba=function(a){this.rb=Ua(a);return this};function P(a){ah.call(this,a,Jg);this.a=[]}t(P,ah);P.prototype.sa=function(a){Ha(this.a,a)||this.a.push(a);return this};P.prototype.wb=function(){return La(this.a)};P.prototype.credential=function(a,b){if(!a&&!b)throw new N("argument-error","credential failed: must provide the ID token and/or the access token.");return new Wg(this.providerId,{idToken:a||null,accessToken:b||null})};function bh(){P.call(this,"facebook.com")}t(bh,P);M(bh,"PROVIDER_ID","facebook.com");function ch(a){if(!a)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var b=a;q(a)&&(b=a.accessToken);return(new bh).credential(null,b)}function dh(){P.call(this,"github.com")}t(dh,P);M(dh,"PROVIDER_ID","github.com");function eh(a){if(!a)throw new N("argument-error","credential failed: expected 1 argument (the OAuth access token).");var b=a;q(a)&&(b=a.accessToken);return(new dh).credential(null,b)}function fh(){P.call(this,"google.com");this.sa("profile")}t(fh,P);M(fh,"PROVIDER_ID","google.com");function gh(a,b){var c=a;q(a)&&(c=a.idToken,b=a.accessToken);return(new fh).credential(c,b)}function hh(){ah.call(this,"twitter.com",Ig)}t(hh,ah);M(hh,"PROVIDER_ID","twitter.com");function ih(a,b){var c=a;q(c)||(c={oauthToken:a,oauthTokenSecret:b});if(!c.oauthToken||!c.oauthTokenSecret)throw new N("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Wg("twitter.com",c)}function jh(a,b){this.a=a;this.f=b;M(this,"providerId","password")}jh.prototype.wa=function(a){return Q(a,kh,{email:this.a,password:this.f})};jh.prototype.b=function(a,b){return Q(a,lh,{idToken:b,email:this.a,password:this.f})};jh.prototype.c=function(a,b){return Vg(this.wa(a),b)};jh.prototype.B=function(){return{email:this.a,password:this.f}};function mh(){gg(this,{
providerId:"password",isOAuthProvider:!1})}gg(mh,{PROVIDER_ID:"password"});function nh(a){if(!(a.Pa&&a.Oa||a.Da&&a.Y))throw new N("internal-error");this.a=a;M(this,"providerId","phone")}nh.prototype.wa=function(a){return a.Qa(oh(this))};nh.prototype.b=function(a,b){var c=oh(this);c.idToken=b;return Q(a,ph,c)};nh.prototype.c=function(a,b){var c=oh(this);c.operation="REAUTH";a=Q(a,qh,c);return Vg(a,b)};nh.prototype.B=function(){var a={providerId:"phone"};this.a.Pa&&(a.verificationId=this.a.Pa);this.a.Oa&&(a.verificationCode=this.a.Oa);this.a.Da&&(a.temporaryProof=this.a.Da);this.a.Y&&(a.phoneNumber=this.a.Y);return a};function oh(a){return a.a.Da&&a.a.Y?{temporaryProof:a.a.Da,phoneNumber:a.a.Y}:{sessionInfo:a.a.Pa,code:a.a.Oa}}function rh(a){try{this.a=a||firebase.auth()}catch(b){throw new N("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}gg(this,{providerId:"phone",isOAuthProvider:!1})}rh.prototype.Qa=function(a,b){var c=this.a.c;return A(b.verify()).then(function(d){if(!m(d))throw new N("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(b.type){case"recaptcha":return sh(c,{phoneNumber:a,recaptchaToken:d}).then(function(a){"function"===typeof b.reset&&b.reset();return a},function(a){"function"===typeof b.reset&&b.reset();throw a});default:throw new N("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};function th(a,b){if(!a)throw new N("missing-verification-id");if(!b)throw new N("missing-verification-code");return new nh({Pa:a,Oa:b})}gg(rh,{PROVIDER_ID:"phone"});function uh(a){if(a.temporaryProof&&a.phoneNumber)return new nh({Da:a.temporaryProof,Y:a.phoneNumber});var b=a&&a.providerId;if(!b||"password"===b)return null;var c=a&&a.oauthAccessToken,d=a&&a.oauthTokenSecret;a=a&&a.oauthIdToken;try{switch(b){case"google.com":return gh(a,c);case"facebook.com":return ch(c);case"github.com":return eh(c);case"twitter.com":return ih(c,d);default:return new P(b).credential(a,c)}}catch(e){return null}}function vh(a){if(!a.isOAuthProvider)throw new N("invalid-oauth-provider")}function wh(a,b,c,d,e){this.b=a;this.c=b||null;this.f=c||null;this.g=d||null;this.a=e||null;if(this.f||this.a){if(this.f&&this.a)throw new N("invalid-auth-event");if(this.f&&!this.g)throw new N("invalid-auth-event")}else throw new N("invalid-auth-event")}wh.prototype.B=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.B()}};function xh(a){a=a||{};return a.type?new wh(a.type,a.eventId,a.urlResponse,a.sessionId,a.error&&vg(a.error)):null}function yh(a){var b="unauthorized-domain",c=void 0,d=De(a);a=d.b;d=d.c;"chrome-extension"==d?c=oa("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",a):"http"==d||"https"==d?c=oa("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",a):b="operation-not-supported-in-this-environment";N.call(this,b,c)}t(yh,N);function zh(a,b,c){N.call(this,a,c);a=b||{};a.sb&&M(this,"email",a.sb);a.Y&&M(this,"phoneNumber",a.Y);a.credential&&M(this,"credential",a.credential)}t(zh,N);zh.prototype.B=function(){var a={code:this.code,message:this.message};this.email&&(a.email=this.email);this.phoneNumber&&(a.phoneNumber=this.phoneNumber);var b=this.credential&&this.credential.B();b&&Wa(a,b);return a};zh.prototype.toJSON=function(){return this.B()};function Ah(a){if(a.code){var b=a.code||"";0==b.indexOf(tg)&&(b=b.substring(tg.length));var c={credential:uh(a)};if(a.email)c.sb=a.email;else if(a.phoneNumber)c.Y=a.phoneNumber;else return new N(b,a.message||void 0);return new zh(b,c,a.message)}return null}function Bh(a){this.f=a}t(Bh,Ne);Bh.prototype.a=function(){return new this.f};Bh.prototype.b=function(){return{}};function Ch(a,b,c){var d="Node"==K();d=k.XMLHttpRequest||d&&firebase.INTERNAL.node&&firebase.INTERNAL.node.XMLHttpRequest;if(!d)throw new N("internal-error","The XMLHttpRequest compatibility library was not found.");this.b=a;a=b||{};this.i=a.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token";this.l=a.secureTokenTimeout||Dh;this.c=Ua(a.secureTokenHeaders||Eh);this.g=a.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/";this.h=a.firebaseTimeout||Fh;this.a=Ua(a.firebaseHeaders||Gh);c&&(this.a["X-Client-Version"]=c,this.c["X-Client-Version"]=c);this.f=new rf;this.o=new Bh(d)}var Hh,O="idToken",Dh=new $f(3e4,6e4),Eh={"Content-Type":"application/x-www-form-urlencoded"},Fh=new $f(3e4,6e4),Gh={"Content-Type":"application/json"};function Ih(a,b){b?a.a["X-Firebase-Locale"]=b:delete a.a["X-Firebase-Locale"]}function Jh(a,b){b?(a.a["X-Client-Version"]=b,a.c["X-Client-Version"]=b):(delete a.a["X-Client-Version"],delete a.c["X-Client-Version"])}function Kh(a,b,c,d,e,f,g){Zf()?(yf()?a=r(a.m,a):(Hh||(Hh=new z(function(a,b){Lh(a,b)})),a=r(a.u,a)),a(b,c,d,e,f,g)):c&&c(null)}Ch.prototype.m=function(a,b,c,d,e,f){var g="Node"==K(),l=Mf()?g?new Se(this.o):new Se:new Se(this.f);if(f){l.f=Math.max(0,f);var n=setTimeout(function(){G(l,"timeout")},f)}fd(l,"complete",function(){n&&clearTimeout(n);var a=null;try{a=JSON.parse(hf(this))||null}catch(vb){a=null}b&&b(a)});ld(l,"ready",function(){n&&clearTimeout(n);Lc(this)});ld(l,"timeout",function(){n&&clearTimeout(n);Lc(this);b&&b(null)});Ye(l,a,c,d,e)};var Mh=dc("https://apis.google.com/js/client.js?onload=%{onload}"),Nh="__fcb"+Math.floor(1e6*Math.random()).toString();function Lh(a,b){if(((window.gapi||{}).client||{}).request)a();else{k[Nh]=function(){((window.gapi||{}).client||{}).request?a():b(Error("CORS_UNSUPPORTED"))};var c=hc(Mh,{onload:Nh});Td(kf(c),function(){b(Error("CORS_UNSUPPORTED"))})}}Ch.prototype.u=function(a,b,c,d,e){var f=this;Hh.then(function(){window.gapi.client.setApiKey(f.b);var g=window.gapi.auth.getToken();window.gapi.auth.setToken(null);window.gapi.client.request({path:a,method:c,body:d,headers:e,authType:"none",callback:function(a){window.gapi.auth.setToken(g);b&&b(a)}})}).s(function(a){b&&b({error:{message:a&&a.message||"CORS_UNSUPPORTED"}})})};function Oh(a,b){return new z(function(c,d){"refresh_token"==b.grant_type&&b.refresh_token||"authorization_code"==b.grant_type&&b.code?Kh(a,a.i+"?key="+encodeURIComponent(a.b),function(a){a?a.error?d(Ph(a)):a.access_token&&a.refresh_token?c(a):d(new N("internal-error")):d(new N("network-request-failed"))},"POST",Ie(b).toString(),a.c,a.l.get()):d(new N("internal-error"))})}function Qh(a,b,c,d,e,f){var g=De(a.g+b);I(g,"key",a.b);f&&I(g,"cb",na().toString());var l="GET"==c;if(l)for(var n in d)d.hasOwnProperty(n)&&I(g,n,d[n]);return new z(function(b,f){Kh(a,g.toString(),function(a){a?a.error?f(Ph(a,e||{})):b(a):f(new N("network-request-failed"))},c,l?void 0:Cc(Vf(d)),a.a,a.h.get())})}function Rh(a){if(!jf.test(a.email))throw new N("invalid-email")}function Sh(a){"email"in a&&Rh(a)}function Th(a,b){return Q(a,Uh,{identifier:b,continueUri:Sf()?vf():"http://localhost"}).then(function(a){return a.allProviders||[]})}function Vh(a){return Q(a,Wh,{}).then(function(a){return a.authorizedDomains||[]})}function Xh(a){if(!a[O])throw new N("internal-error")}function Yh(a){if(a.phoneNumber||a.temporaryProof){if(!a.phoneNumber||!a.temporaryProof)throw new N("internal-error")}else{if(!a.sessionInfo)throw new N("missing-verification-id");if(!a.code)throw new N("missing-verification-code")}}Ch.prototype.gb=function(){return Q(this,Zh,{})};Ch.prototype.kb=function(a,b){return Q(this,$h,{idToken:a,email:b})};Ch.prototype.lb=function(a,b){return Q(this,lh,{idToken:a,password:b})};var ai={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};h=Ch.prototype;h.mb=function(a,b){var c={idToken:a},d=[];Pa(ai,function(a,f){var e=b[f];null===e?d.push(a):f in b&&(c[f]=e)});d.length&&(c.deleteAttribute=d);return Q(this,$h,c)};h.cb=function(a,b){a={requestType:"PASSWORD_RESET",email:a};Wa(a,b);return Q(this,bi,a)};h.bb=function(a,b){a={requestType:"VERIFY_EMAIL",idToken:a};Wa(a,b);return Q(this,ci,a)};function sh(a,b){return Q(a,di,b)}h.Qa=function(a){return Q(this,ei,a)};function fi(a,b,c){return Q(a,gi,{idToken:b,deleteProvider:c})}function hi(a){if(!a.requestUri||!a.sessionId&&!a.postBody)throw new N("internal-error")}function ii(a){var b=null;a.needConfirmation?(a.code="account-exists-with-different-credential",b=Ah(a)):"FEDERATED_USER_ID_ALREADY_LINKED"==a.errorMessage?(a.code="credential-already-in-use",b=Ah(a)):"EMAIL_EXISTS"==a.errorMessage?(a.code="email-already-in-use",b=Ah(a)):a.errorMessage&&(b=ji(a.errorMessage));if(b)throw b;if(!a[O])throw new N("internal-error")}function Xg(a,b){b.returnIdpCredential=!0;return Q(a,ki,b)}function Zg(a,b){b.returnIdpCredential=!0;return Q(a,li,b)}function $g(a,b){b.returnIdpCredential=!0;b.autoCreate=!1;return Q(a,mi,b)}function ni(a){if(!a.oobCode)throw new N("invalid-action-code")}h.Ta=function(a,b){return Q(this,oi,{oobCode:a,newPassword:b})};h.Ia=function(a){return Q(this,pi,{oobCode:a})};h.Sa=function(a){return Q(this,qi,{oobCode:a})};var qi={endpoint:"setAccountInfo",D:ni,ga:"email"},pi={endpoint:"resetPassword",D:ni,O:function(a){if(!a.email||!a.requestType)throw new N("internal-error")}},ri={endpoint:"signupNewUser",D:function(a){Rh(a);if(!a.password)throw new N("weak-password")},O:Xh,T:!0},Uh={endpoint:"createAuthUri"},si={endpoint:"deleteAccount",ea:["idToken"]},gi={endpoint:"setAccountInfo",ea:["idToken","deleteProvider"],D:function(a){if(!fa(a.deleteProvider))throw new N("internal-error")}},ti={endpoint:"getAccountInfo"},ci={endpoint:"getOobConfirmationCode",ea:["idToken","requestType"],D:function(a){if("VERIFY_EMAIL"!=a.requestType)throw new N("internal-error")},ga:"email"},bi={endpoint:"getOobConfirmationCode",ea:["requestType"],D:function(a){if("PASSWORD_RESET"!=a.requestType)throw new N("internal-error");Rh(a)},ga:"email"},Wh={nb:!0,endpoint:"getProjectConfig",zb:"GET"},ui={nb:!0,endpoint:"getRecaptchaParam",zb:"GET",O:function(a){if(!a.recaptchaSiteKey)throw new N("internal-error")}},oi={endpoint:"resetPassword",D:ni,ga:"email"},di={endpoint:"sendVerificationCode",ea:["phoneNumber","recaptchaToken"],ga:"sessionInfo"},$h={endpoint:"setAccountInfo",ea:["idToken"],D:Sh,T:!0},lh={endpoint:"setAccountInfo",ea:["idToken"],D:function(a){Sh(a);if(!a.password)throw new N("weak-password")},O:Xh,T:!0},Zh={endpoint:"signupNewUser",O:Xh,T:!0},ki={endpoint:"verifyAssertion",D:hi,O:ii,T:!0},mi={endpoint:"verifyAssertion",D:hi,O:function(a){if(a.errorMessage&&"USER_NOT_FOUND"==a.errorMessage)throw new N("user-not-found");if(a.errorMessage)throw ji(a.errorMessage);if(!a[O])throw new N("internal-error")},T:!0},li={endpoint:"verifyAssertion",D:function(a){hi(a);if(!a.idToken)throw new N("internal-error")},O:ii,T:!0},vi={endpoint:"verifyCustomToken",D:function(a){if(!a.token)throw new N("invalid-custom-token")},O:Xh,T:!0},kh={endpoint:"verifyPassword",D:function(a){Rh(a);if(!a.password)throw new N("wrong-password")},O:Xh,T:!0},ei={endpoint:"verifyPhoneNumber",D:Yh,O:Xh},ph={endpoint:"verifyPhoneNumber",D:function(a){if(!a.idToken)throw new N("internal-error");Yh(a)},O:function(a){if(a.temporaryProof)throw a.code="credential-already-in-use",Ah(a);Xh(a)}},qh={Pb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Yh,O:Xh};function Q(a,b,c){if(!jg(c,b.ea))return B(new N("internal-error"));var d=b.zb||"POST",e;return A(c).then(b.D).then(function(){b.T&&(c.returnSecureToken=!0);return Qh(a,b.endpoint,d,c,b.Pb,b.nb||!1)}).then(function(a){return e=a}).then(b.O).then(function(){if(!b.ga)return e;if(!(b.ga in e))throw new N("internal-error");return e[b.ga]})}function ji(a){return Ph({error:{errors:[{message:a}],code:400,message:a}})}function Ph(a,b){var c=(a.error&&a.error.errors&&a.error.errors[0]||{}).reason||"";var d={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(c=d[c]?new N(d[c]):null)return c;c=a.error&&a.error.message||"";d={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"};Wa(d,b||{});b=(b=c.match(/^[^\s]+\s*:\s*(.*)$/))&&1<b.length?b[1]:void 0;for(var e in d)if(0===c.indexOf(e))return new N(d[e],b);!b&&a&&(b=Uf(a));return new N("internal-error",b)}var wi={Mc:{Va:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://securetoken.googleapis.com/v1/token",id:"p"},Oc:{Va:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ab:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Pc:{Va:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ab:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function xi(a){for(var b in wi)if(wi[b].id===a)return a=wi[b],{firebaseEndpoint:a.Va,secureTokenEndpoint:a.ab};return null}var yi;yi=xi("__EID__")?"__EID__":void 0;function zi(a){this.b=a;this.a=null;this.Ya=Ai(this)}function Ai(a){return Bi().then(function(){return new z(function(b,c){L("gapi.iframes.getContext")().open({where:document.body,url:a.b,messageHandlersFilter:L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(d){function e(){clearTimeout(f);b()}a.a=d;a.a.restyle({setHideOnLeave:!1});var f=setTimeout(function(){c(Error("Network Error"))},Ci.get());d.ping(e).then(e,function(){c(Error("Network Error"))})})})})}function Di(a,b){return a.Ya.then(function(){return new z(function(c){a.a.send(b.type,b,c,L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function Ei(a,b){a.Ya.then(function(){a.a.register("authEvent",b,L("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}var Fi=dc("https://apis.google.com/js/api.js?onload=%{onload}"),Gi=new $f(3e4,6e4),Ci=new $f(5e3,15e3),Hi=null;function Bi(){return Hi?Hi:Hi=new z(function(a,b){if(Zf()){var c=function(){Yf();L("gapi.load")("gapi.iframes",{callback:a,ontimeout:function(){Yf();b(Error("Network Error"))},timeout:Gi.get()})};if(L("gapi.iframes.Iframe"))a();else if(L("gapi.load"))c();else{var d="__iframefcb"+Math.floor(1e6*Math.random()).toString();k[d]=function(){L("gapi.load")?c():b(Error("Network Error"))};d=hc(Fi,{onload:d});A(kf(d)).s(function(){b(Error("Network Error"))})}}else b(Error("Network Error"))}).s(function(a){Hi=null;throw a})}function Ii(a,b,c){this.i=a;this.g=b;this.h=c;this.f=null;this.a=Ee(this.i,"/__/auth/iframe");I(this.a,"apiKey",this.g);I(this.a,"appName",this.h);this.b=null;this.c=[]}Ii.prototype.toString=function(){this.f?I(this.a,"v",this.f):Le(this.a.a,"v");this.b?I(this.a,"eid",this.b):Le(this.a.a,"eid");this.c.length?I(this.a,"fw",this.c.join(",")):Le(this.a.a,"fw");return this.a.toString()};function Ji(a,b,c,d,e){this.m=a;this.u=b;this.c=c;this.l=d;this.i=this.g=this.h=null;this.a=e;this.f=null}Ji.prototype.toString=function(){var a=Ee(this.m,"/__/auth/handler");I(a,"apiKey",this.u);I(a,"appName",this.c);I(a,"authType",this.l);if(this.a.isOAuthProvider){var b=this.a;try{var c=firebase.app(this.c).auth().$()}catch(l){c=null}b.Ua=c;I(a,"providerId",this.a.providerId);b=this.a;c=Vf(b.rb);for(var d in c)c[d]=c[d].toString();d=b.rc;c=Ua(c);for(var e=0;e<d.length;e++){var f=d[e];f in c&&delete c[f]}b.Wa&&b.Ua&&!c[b.Wa]&&(c[b.Wa]=b.Ua);Sa(c)||I(a,"customParameters",Uf(c))}"function"===typeof this.a.wb&&(b=this.a.wb(),b.length&&I(a,"scopes",b.join(",")));this.h?I(a,"redirectUrl",this.h):Le(a.a,"redirectUrl");this.g?I(a,"eventId",this.g):Le(a.a,"eventId");this.i?I(a,"v",this.i):Le(a.a,"v");if(this.b)for(var g in this.b)this.b.hasOwnProperty(g)&&!Ce(a,g)&&I(a,g,this.b[g]);this.f?I(a,"eid",this.f):Le(a.a,"eid");g=Ki(this.c);g.length&&I(a,"fw",g.join(","));return a.toString()};function Ki(a){try{return firebase.app(a).auth().Ka()}catch(b){return[]}}function Li(a,b,c,d,e){this.u=a;this.f=b;this.b=c;this.c=d||null;this.h=e||null;this.m=this.o=this.v=null;this.g=[];this.l=this.a=null}function Mi(a){var b=vf();return Vh(a).then(function(a){a:{var c=De(b),e=c.c;c=c.b;for(var f=0;f<a.length;f++){var g=a[f];var l=c;var n=e;0==g.indexOf("chrome-extension://")?l=De(g).b==l&&"chrome-extension"==n:"http"!=n&&"https"!=n?l=!1:Gf.test(g)?l=l==g:(g=g.split(".").join("\\."),l=new RegExp("^(.+\\."+g+"|"+g+")$","i").test(l));if(l){a=!0;break a}}a=!1}if(!a)throw new yh(vf())})}function Ni(a){if(a.l)return a.l;a.l=Hf().then(function(){if(!a.o){var b=a.c,c=a.h,d=Ki(a.b),e=new Ii(a.u,a.f,a.b);e.f=b;e.b=c;e.c=La(d||[]);a.o=e.toString()}a.i=new zi(a.o);Oi(a)});return a.l}h=Li.prototype;h.Ca=function(a,b,c){var d=new N("popup-closed-by-user"),e=new N("web-storage-unsupported"),f=this,g=!1;return this.ba().then(function(){Pi(f).then(function(c){c||(a&&Cf(a),b(e),g=!0)})}).s(function(){}).then(function(){if(!g)return Ff(a)}).then(function(){if(!g)return sd(c).then(function(){b(d)})})};h.Db=function(){var a=J();return!Tf(a)&&!Xf(a)};h.yb=function(){return!1};h.vb=function(a,b,c,d,e,f,g){if(!a)return B(new N("popup-blocked"));if(g&&!Tf())return this.ba().s(function(b){Cf(a);e(b)}),d(),A();this.a||(this.a=Mi(Qi(this)));var l=this;return this.a.then(function(){var b=l.ba().s(function(b){Cf(a);e(b);throw b});d();return b}).then(function(){vh(c);if(!g){var d=Ri(l.u,l.f,l.b,b,c,null,f,l.c,void 0,l.h);wf(d,a)}}).s(function(a){"auth/network-request-failed"==a.code&&(l.a=null);throw a})};function Qi(a){a.m||(a.v=a.c?Of(a.c,Ki(a.b)):null,a.m=new Ch(a.f,xi(a.h),a.v));return a.m}h.Aa=function(a,b,c){this.a||(this.a=Mi(Qi(this)));var d=this;return this.a.then(function(){vh(b);var e=Ri(d.u,d.f,d.b,a,b,vf(),c,d.c,void 0,d.h);wf(e)}).s(function(a){"auth/network-request-failed"==a.code&&(d.a=null);throw a})};h.ba=function(){var a=this;return Ni(this).then(function(){return a.i.Ya}).s(function(){a.a=null;throw new N("network-request-failed")})};h.Hb=function(){return!0};function Ri(a,b,c,d,e,f,g,l,n,D){a=new Ji(a,b,c,d,e);a.h=f;a.g=g;a.i=l;a.b=Ua(n||null);a.f=D;return a.toString()}function Oi(a){if(!a.i)throw Error("IfcHandler must be initialized!");Ei(a.i,function(b){var c={};if(b&&b.authEvent){var d=!1;b=xh(b.authEvent);for(c=0;c<a.g.length;c++)d=a.g[c](b)||d;c={};c.status=d?"ACK":"ERROR";return A(c)}c.status="ERROR";return A(c)})}function Pi(a){var b={type:"webStorageSupport"};return Ni(a).then(function(){return Di(a.i,b)}).then(function(a){if(a&&a.length&&"undefined"!==typeof a[0].webStorageSupport)return a[0].webStorageSupport;throw Error()})}h.ua=function(a){this.g.push(a)};h.Ja=function(a){Ja(this.g,function(b){return b==a})};function Si(a){this.a=a||firebase.INTERNAL.reactNative&&firebase.INTERNAL.reactNative.AsyncStorage;if(!this.a)throw new N("internal-error","The React Native compatibility library was not found.")}h=Si.prototype;h.get=function(a){return A(this.a.getItem(a)).then(function(a){return a&&Wf(a)})};h.set=function(a,b){return A(this.a.setItem(a,Uf(b)))};h.X=function(a){return A(this.a.removeItem(a))};h.ia=function(){};h.da=function(){};function Ti(){this.a={}}h=Ti.prototype;h.get=function(a){return A(this.a[a])};h.set=function(a,b){this.a[a]=b;return A()};h.X=function(a){delete this.a[a];return A()};h.ia=function(){};h.da=function(){};function Ui(a,b,c,d,e,f){try{var g=!!k.indexedDB}catch(l){g=!1}if(!g)throw new N("web-storage-unsupported");this.u=a;this.h=b;this.g=c;this.l=d;this.m=e;this.f={};this.c=[];this.a=0;this.o=f||k.indexedDB}var Vi;function Wi(a){return new z(function(b,c){var d=a.o.open(a.u,a.m);d.onerror=function(a){c(Error(a.target.errorCode))};d.onupgradeneeded=function(b){b=b.target.result;try{b.createObjectStore(a.h,{keyPath:a.g})}catch(f){c(f)}};d.onsuccess=function(a){b(a.target.result)}})}function Xi(a){a.i||(a.i=Wi(a));return a.i}function Yi(a,b){return b.objectStore(a.h)}function Zi(a,b,c){return b.transaction([a.h],c?"readwrite":"readonly")}function $i(a){return new z(function(b,c){a.onsuccess=function(a){a&&a.target?b(a.target.result):b()};a.onerror=function(a){c(Error(a.target.errorCode))}})}h=Ui.prototype;h.set=function(a,b){var c=!1,d,e=this;return Qb(Xi(this).then(function(b){d=b;b=Yi(e,Zi(e,d,!0));return $i(b.get(a))}).then(function(f){var g=Yi(e,Zi(e,d,!0));if(f)return f.value=b,$i(g.put(f));e.a++;c=!0;f={};f[e.g]=a;f[e.l]=b;return $i(g.add(f))}).then(function(){e.f[a]=b}),function(){c&&e.a--})};h.get=function(a){var b=this;return Xi(this).then(function(c){return $i(Yi(b,Zi(b,c,!1)).get(a))}).then(function(a){return a&&a.value})};h.X=function(a){var b=!1,c=this;return Qb(Xi(this).then(function(d){b=!0;c.a++;return $i(Yi(c,Zi(c,d,!0))["delete"](a))}).then(function(){delete c.f[a]}),function(){b&&c.a--})};h.zc=function(){var a=this;return Xi(this).then(function(b){var c=Yi(a,Zi(a,b,!1));return c.getAll?$i(c.getAll()):new z(function(a,b){var d=[],e=c.openCursor();e.onsuccess=function(b){(b=b.target.result)?(d.push(b.value),b["continue"]()):a(d)};e.onerror=function(a){b(Error(a.target.errorCode))}})}).then(function(b){var c={},d=[];if(0==a.a){for(d=0;d<b.length;d++)c[b[d][a.g]]=b[d][a.l];d=xf(a.f,c);a.f=c}return d})};h.ia=function(a){0==this.c.length&&aj(this);this.c.push(a)};h.da=function(a){Ja(this.c,function(b){return b==a});0==this.c.length&&this.b&&this.b.cancel("STOP_EVENT")};function aj(a){function b(){a.b=sd(800).then(r(a.zc,a)).then(function(b){0<b.length&&w(a.c,function(a){a(b)})}).then(b).s(function(a){"STOP_EVENT"!=a.message&&b()});return a.b}a.b&&a.b.cancel("STOP_EVENT");b()}function bj(){if(!cj()){if("Node"==K())throw new N("internal-error","The LocalStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=dj()||firebase.INTERNAL.node.localStorage}function dj(){try{var a=k.localStorage,b=Qf();a&&(a.setItem(b,"1"),a.removeItem(b));return a}catch(c){return null}}function cj(){var a="Node"==K();a=dj()||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.localStorage;if(!a)return!1;try{return a.setItem("__sak","1"),a.removeItem("__sak"),!0}catch(b){return!1}}h=bj.prototype;h.get=function(a){var b=this;return A().then(function(){var c=b.a.getItem(a);return Wf(c)})};h.set=function(a,b){var c=this;return A().then(function(){var d=Uf(b);null===d?c.X(a):c.a.setItem(a,d)})};h.X=function(a){var b=this;return A().then(function(){b.a.removeItem(a)})};h.ia=function(a){k.window&&cd(k.window,"storage",a)};h.da=function(a){k.window&&E(k.window,"storage",a)};function ej(){}h=ej.prototype;h.get=function(){return A(null)};h.set=function(){return A()};h.X=function(){return A()};h.ia=function(){};h.da=function(){};function fj(){if(!gj()){if("Node"==K())throw new N("internal-error","The SessionStorage compatibility library was not found.");throw new N("web-storage-unsupported")}this.a=hj()||firebase.INTERNAL.node.sessionStorage}function hj(){try{var a=k.sessionStorage,b=Qf();a&&(a.setItem(b,"1"),a.removeItem(b));return a}catch(c){return null}}function gj(){var a="Node"==K();a=hj()||a&&firebase.INTERNAL.node&&firebase.INTERNAL.node.sessionStorage;if(!a)return!1;try{return a.setItem("__sak","1"),a.removeItem("__sak"),!0}catch(b){return!1}}h=fj.prototype;h.get=function(a){var b=this;return A().then(function(){var c=b.a.getItem(a);return Wf(c)})};h.set=function(a,b){var c=this;return A().then(function(){var d=Uf(b);null===d?c.X(a):c.a.setItem(a,d)})};h.X=function(a){var b=this;return A().then(function(){b.a.removeItem(a)})};h.ia=function(){};h.da=function(){};function ij(){var a={};a.Browser=jj;a.Node=kj;a.ReactNative=lj;this.a=a[K()]}var mj,jj={C:bj,jb:fj},kj={C:bj,jb:fj},lj={C:Si,jb:ej};var nj={Lc:"local",NONE:"none",Nc:"session"};function oj(a){var b=new N("invalid-persistence-type"),c=new N("unsupported-persistence-type");a:{for(d in nj)if(nj[d]==a){var d=!0;break a}d=!1}if(!d||"string"!==typeof a)throw b;switch(K()){case"ReactNative":if("session"===a)throw c;break;case"Node":if("none"!==a)throw c;break;default:if(!Pf()&&"none"!==a)throw c}}function pj(a,b,c,d,e){this.i=a;this.g=b;this.A=c;this.u=d;this.v=e;this.a={};mj||(mj=new ij);a=mj;try{if(uf()){Vi||(Vi=new Ui("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var f=Vi}else f=new a.a.C;this.l=f}catch(g){this.l=new Ti,this.u=!0}try{this.o=new a.a.jb}catch(g){this.o=new Ti}this.w=new Ti;this.h=r(this.m,this);this.b={}}var qj;function rj(){qj||(qj=new pj("firebase",":",!Xf(J())&&Lf()?!0:!1,Tf(),Pf()));return qj}function sj(a,b){switch(b){case"session":return a.o;case"none":return a.w;default:return a.l}}function tj(a,b,c){return a.i+a.g+b.name+(c?a.g+c:"")}pj.prototype.get=function(a,b){return sj(this,a.C).get(tj(this,a,b))};function uj(a,b,c){c=tj(a,b,c);"local"==b.C&&(a.b[c]=null);return sj(a,b.C).X(c)}pj.prototype.set=function(a,b,c){var d=tj(this,a,c),e=this,f=sj(this,a.C);return f.set(d,b).then(function(){return f.get(d)}).then(function(b){"local"==a.C&&(e.b[d]=b)})};function vj(a,b,c,d){b=tj(a,b,c);a.v&&(a.b[b]=k.localStorage.getItem(b));Sa(a.a)&&(sj(a,"local").ia(a.h),a.u||uf()||!a.v||wj(a));a.a[b]||(a.a[b]=[]);a.a[b].push(d)}function xj(a,b,c){b=tj(a,yj("local"),b);a.a[b]&&(Ja(a.a[b],function(a){return a==c}),0==a.a[b].length&&delete a.a[b]);Sa(a.a)&&zj(a)}function wj(a){Aj(a);a.f=setInterval(function(){for(var b in a.a){var c=k.localStorage.getItem(b),d=a.b[b];c!=d&&(a.b[b]=c,c=new Qc({type:"storage",key:b,target:window,oldValue:d,newValue:c,a:!0}),a.m(c))}},1e3)}function Aj(a){a.f&&(clearInterval(a.f),a.f=null)}function zj(a){sj(a,"local").da(a.h);Aj(a)}pj.prototype.m=function(a){if(a&&a.g){var b=a.a.key;if(null==b)for(var c in this.a){var d=this.b[c];"undefined"===typeof d&&(d=null);var e=k.localStorage.getItem(c);e!==d&&(this.b[c]=e,this.c(c))}else if(0==b.indexOf(this.i+this.g)&&this.a[b]){"undefined"!==typeof a.a.a?sj(this,"local").da(this.h):Aj(this);if(this.A)if(c=k.localStorage.getItem(b),d=a.a.newValue,d!==c)null!==d?k.localStorage.setItem(b,d):k.localStorage.removeItem(b);else if(this.b[b]===d&&"undefined"===typeof a.a.a)return;var f=this;c=function(){if("undefined"!==typeof a.a.a||f.b[b]!==k.localStorage.getItem(b))f.b[b]=k.localStorage.getItem(b),f.c(b)};y&&kb&&10==kb&&k.localStorage.getItem(b)!==a.a.newValue&&a.a.newValue!==a.a.oldValue?setTimeout(c,10):c()}}else w(a,r(this.c,this))};pj.prototype.c=function(a){this.a[a]&&w(this.a[a],function(a){a()})};function Cj(a){this.a=a;this.b=rj()}var Dj={name:"authEvent",C:"local"};function Ej(a){return a.b.get(Dj,a.a).then(function(a){return xh(a)})}function Fj(){this.a=rj()}function Gj(a,b,c,d,e,f,g){this.u=a;this.i=b;this.l=c;this.m=d||null;this.o=g||null;this.h=b+":"+c;this.A=new Fj;this.g=new Cj(this.h);this.f=null;this.b=[];this.v=e||500;this.w=f||2e3;this.a=this.c=null}function Hj(a){return new N("invalid-cordova-configuration",a)}h=Gj.prototype;h.ba=function(){return this.xa?this.xa:this.xa=If().then(function(){if("function"!==typeof L("universalLinks.subscribe",k))throw Hj("cordova-universal-links-plugin is not installed");if("undefined"===typeof L("BuildInfo.packageName",k))throw Hj("cordova-plugin-buildinfo is not installed");if("function"!==typeof L("cordova.plugins.browsertab.openUrl",k))throw Hj("cordova-plugin-browsertab is not installed");if("function"!==typeof L("cordova.InAppBrowser.open",k))throw Hj("cordova-plugin-inappbrowser is not installed")},function(){throw new N("cordova-not-ready")})};function Ij(){for(var a=20,b=[];0<a;)b.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),a--;return b.join("")}function Jj(a){var b=new ie;he(b,a);a=[];var c=8*b.g;56>b.c?he(b,fe,56-b.c):he(b,fe,b.b-(b.c-56));for(var d=63;56<=d;d--)b.f[d]=c&255,c/=256;ge(b);for(d=c=0;d<b.i;d++)for(var e=24;0<=e;e-=8)a[c++]=b.a[d]>>e&255;return Hd(a)}h.Ca=function(a,b){b(new N("operation-not-supported-in-this-environment"));return A()};h.vb=function(){return B(new N("operation-not-supported-in-this-environment"))};h.Hb=function(){return!1};h.Db=function(){return!0};h.yb=function(){return!0};h.Aa=function(a,b,c){if(this.c)return B(new N("redirect-operation-pending"));var d=this,e=k.document,f=null,g=null,l=null,n=null;return this.c=Qb(A().then(function(){vh(b);return Kj(d)}).then(function(){return Lj(d,a,b,c)}).then(function(){return new z(function(a,b){g=function(){var b=L("cordova.plugins.browsertab.close",k);a();"function"===typeof b&&b();d.a&&"function"===typeof d.a.close&&(d.a.close(),d.a=null);return!1};d.ua(g);l=function(){f||(f=sd(d.w).then(function(){b(new N("redirect-cancelled-by-user"))}))};n=function(){ag()&&l()};e.addEventListener("resume",l,!1);J().toLowerCase().match(/android/)||e.addEventListener("visibilitychange",n,!1)}).s(function(a){return Mj(d).then(function(){throw a})})}),function(){l&&e.removeEventListener("resume",l,!1);n&&e.removeEventListener("visibilitychange",n,!1);f&&f.cancel();g&&d.Ja(g);d.c=null})};function Lj(a,b,c,d){var e=Ij(),f=new wh(b,d,null,e,new N("no-auth-event")),g=L("BuildInfo.packageName",k);if("string"!==typeof g)throw new N("invalid-cordova-configuration");var l=L("BuildInfo.displayName",k),n={};if(J().toLowerCase().match(/iphone|ipad|ipod/))n.ibi=g;else if(J().toLowerCase().match(/android/))n.apn=g;else return B(new N("operation-not-supported-in-this-environment"));l&&(n.appDisplayName=l);e=Jj(e);n.sessionId=e;var D=Ri(a.u,a.i,a.l,b,c,null,d,a.m,n,a.o);return a.ba().then(function(){var b=a.h;return a.A.a.set(Dj,f.B(),b)}).then(function(){var b=L("cordova.plugins.browsertab.isAvailable",k);if("function"!==typeof b)throw new N("invalid-cordova-configuration");var c=null;b(function(b){if(b){c=L("cordova.plugins.browsertab.openUrl",k);if("function"!==typeof c)throw new N("invalid-cordova-configuration");c(D)}else{c=L("cordova.InAppBrowser.open",k);if("function"!==typeof c)throw new N("invalid-cordova-configuration");b=J();b=!(!b.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!b.match(/(iPad|iPhone|iPod).*OS 8_\d/i));a.a=c(D,b?"_blank":"_system","location=yes")}})})}function Nj(a,b){for(var c=0;c<a.b.length;c++)try{a.b[c](b)}catch(d){}}function Kj(a){
a.f||(a.f=a.ba().then(function(){return new z(function(b){function c(d){b(d);a.Ja(c);return!1}a.ua(c);Oj(a)})}));return a.f}function Mj(a){var b=null;return Ej(a.g).then(function(c){b=c;c=a.g;return uj(c.b,Dj,c.a)}).then(function(){return b})}function Oj(a){function b(b){e=!0;f&&f.cancel();Mj(a).then(function(c){var e=d;if(c&&b&&b.url){e=null;var f=b.url;var g=De(f),l=Ce(g,"link"),n=Ce(De(l),"link");g=Ce(g,"deep_link_id");f=Ce(De(g),"link")||g||n||l||f;-1!=f.indexOf("/__/auth/callback")&&(e=De(f),e=Wf(Ce(e,"firebaseError")||null),e=(e="object"===typeof e?vg(e):null)?new wh(c.b,c.c,null,null,e):new wh(c.b,c.c,f,c.g));e=e||d}Nj(a,e)})}var c=L("universalLinks.subscribe",k);if("function"!==typeof c)throw new N("invalid-cordova-configuration");var d=new wh("unknown",null,null,null,new N("no-auth-event")),e=!1,f=sd(a.v).then(function(){return Mj(a).then(function(){e||Nj(a,d)})}),g=k.handleOpenURL;k.handleOpenURL=function(a){0==a.toLowerCase().indexOf(L("BuildInfo.packageName",k).toLowerCase()+"://")&&b({url:a});if("function"===typeof g)try{g(a)}catch(n){console.error(n)}};c(null,b)}h.ua=function(a){this.b.push(a);Kj(this).s(function(b){"auth/invalid-cordova-configuration"===b.code&&(b=new wh("unknown",null,null,null,new N("no-auth-event")),a(b))})};h.Ja=function(a){Ja(this.b,function(b){return b==a})};function Pj(a){this.a=a;this.b=rj()}var Qj={name:"pendingRedirect",C:"session"};function Rj(a){return a.b.set(Qj,"pending",a.a)}function Sj(a){return uj(a.b,Qj,a.a)}function Tj(a){return a.b.get(Qj,a.a).then(function(a){return"pending"==a})}function Uj(a,b,c){this.v=a;this.l=b;this.u=c;this.h=[];this.f=!1;this.i=r(this.m,this);this.c=new Vj;this.o=new Wj;this.g=new Pj(this.l+":"+this.u);this.b={};this.b.unknown=this.c;this.b.signInViaRedirect=this.c;this.b.linkViaRedirect=this.c;this.b.reauthViaRedirect=this.c;this.b.signInViaPopup=this.o;this.b.linkViaPopup=this.o;this.b.reauthViaPopup=this.o;this.a=Xj(this.v,this.l,this.u,yi)}function Xj(a,b,c,d){var e=firebase.SDK_VERSION||null;return Jf()?new Gj(a,b,c,e,void 0,void 0,d):new Li(a,b,c,e,d)}Uj.prototype.reset=function(){this.f=!1;this.a.Ja(this.i);this.a=Xj(this.v,this.l,this.u)};function Yj(a){a.f||(a.f=!0,a.a.ua(a.i));var b=a.a;return a.a.ba().s(function(c){a.a==b&&a.reset();throw c})}function Zj(a){a.a.Db()&&Yj(a).s(function(b){var c=new wh("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));ak(b)&&a.m(c)});a.a.yb()||bk(a.c)}Uj.prototype.subscribe=function(a){Ha(this.h,a)||this.h.push(a);if(!this.f){var b=this;Tj(this.g).then(function(a){a?Sj(b.g).then(function(){Yj(b).s(function(a){var c=new wh("unknown",null,null,null,new N("operation-not-supported-in-this-environment"));ak(a)&&b.m(c)})}):Zj(b)}).s(function(){Zj(b)})}};Uj.prototype.unsubscribe=function(a){Ja(this.h,function(b){return b==a})};Uj.prototype.m=function(a){if(!a)throw new N("invalid-auth-event");for(var b=!1,c=0;c<this.h.length;c++){var d=this.h[c];if(d.ob(a.b,a.c)){(b=this.b[a.b])&&b.h(a,d);b=!0;break}}bk(this.c);return b};var ck=new $f(2e3,1e4),dk=new $f(3e4,6e4);Uj.prototype.aa=function(){return this.c.aa()};function ek(a,b,c,d,e,f){return a.a.vb(b,c,d,function(){a.f||(a.f=!0,a.a.ua(a.i))},function(){a.reset()},e,f)}function ak(a){return a&&"auth/cordova-not-ready"==a.code?!0:!1}Uj.prototype.Aa=function(a,b,c){var d=this,e;return Rj(this.g).then(function(){return d.a.Aa(a,b,c).s(function(a){if(ak(a))throw new N("operation-not-supported-in-this-environment");e=a;return Sj(d.g).then(function(){throw e})}).then(function(){return d.a.Hb()?new z(function(){}):Sj(d.g).then(function(){return d.aa()}).then(function(){}).s(function(){})})})};Uj.prototype.Ca=function(a,b,c,d){return this.a.Ca(c,function(c){a.fa(b,null,c,d)},ck.get())};var fk={};function gk(a,b,c){var d=b+":"+c;fk[d]||(fk[d]=new Uj(a,b,c));return fk[d]}function Vj(){this.b=null;this.f=[];this.c=[];this.a=null;this.g=!1}Vj.prototype.reset=function(){this.b=null;this.a&&(this.a.cancel(),this.a=null)};Vj.prototype.h=function(a,b){if(!a)return B(new N("invalid-auth-event"));this.reset();this.g=!0;var c=a.b,d=a.c,e=a.a&&"auth/web-storage-unsupported"==a.a.code,f=a.a&&"auth/operation-not-supported-in-this-environment"==a.a.code;"unknown"!=c||e||f?a.a?(hk(this,!0,null,a.a),a=A()):a=b.va(c,d)?ik(this,a,b):B(new N("invalid-auth-event")):(hk(this,!1,null,null),a=A());return a};function bk(a){a.g||(a.g=!0,hk(a,!1,null,null))}function ik(a,b,c){c=c.va(b.b,b.c);var d=b.f,e=b.g,f=!!b.b.match(/Redirect$/);return c(d,e).then(function(b){hk(a,f,b,null)}).s(function(b){hk(a,f,null,b)})}function jk(a,b){a.b=function(){return B(b)};if(a.c.length)for(var c=0;c<a.c.length;c++)a.c[c](b)}function kk(a,b){a.b=function(){return A(b)};if(a.f.length)for(var c=0;c<a.f.length;c++)a.f[c](b)}function hk(a,b,c,d){b?d?jk(a,d):kk(a,c):kk(a,{user:null});a.f=[];a.c=[]}Vj.prototype.aa=function(){var a=this;return new z(function(b,c){a.b?a.b().then(b,c):(a.f.push(b),a.c.push(c),lk(a))})};function lk(a){var b=new N("timeout");a.a&&a.a.cancel();a.a=sd(dk.get()).then(function(){a.b||hk(a,!0,null,b)})}function Wj(){}Wj.prototype.h=function(a,b){if(!a)return B(new N("invalid-auth-event"));var c=a.b,d=a.c;a.a?(b.fa(a.b,null,a.a,a.c),a=A()):a=b.va(c,d)?mk(a,b):B(new N("invalid-auth-event"));return a};function mk(a,b){var c=a.c,d=a.b;return b.va(d,c)(a.f,a.g).then(function(a){b.fa(d,a,null,c)}).s(function(a){b.fa(d,null,a,c)})}function nk(a,b){this.a=b;M(this,"verificationId",a)}nk.prototype.confirm=function(a){a=th(this.verificationId,a);return this.a(a)};function ok(a,b,c,d){return new rh(a).Qa(b,c).then(function(a){return new nk(a,d)})}function pk(a,b,c,d,e,f){this.h=a;this.i=b;this.g=c;this.c=d;this.f=e;this.l=!!f;this.b=null;this.a=this.c;if(this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}pk.prototype.start=function(){this.a=this.c;qk(this,!0)};function rk(a,b){if(b)return a.a=a.c,a.g();b=a.a;a.a*=2;a.a>a.f&&(a.a=a.f);return b}function qk(a,b){sk(a);a.b=sd(rk(a,b)).then(function(){return a.l?A():bg()}).then(function(){return a.h()}).then(function(){qk(a,!0)}).s(function(b){a.i(b)&&qk(a,!1)})}function sk(a){a.b&&(a.b.cancel(),a.b=null)}function tk(a){this.f=a;this.b=this.a=null;this.c=0}tk.prototype.B=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}};function uk(a,b){var c=b[O],d=b.refreshToken;b=vk(b.expiresIn);a.b=c;a.c=b;a.a=d}function vk(a){return na()+1e3*parseInt(a,10)}function wk(a,b){return Oh(a.f,b).then(function(b){a.b=b.access_token;a.c=vk(b.expires_in);a.a=b.refresh_token;return{accessToken:a.b,expirationTime:a.c,refreshToken:a.a}}).s(function(b){"auth/user-token-expired"==b.code&&(a.a=null);throw b})}tk.prototype.getToken=function(a){a=!!a;return this.b&&!this.a?B(new N("user-token-expired")):a||!this.b||na()>this.c-3e4?this.a?wk(this,{grant_type:"refresh_token",refresh_token:this.a}):A(null):A({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})};function xk(a,b){this.a=a||null;this.b=b||null;gg(this,{lastSignInTime:cg(b||null),creationTime:cg(a||null)})}function yk(a){return new xk(a.a,a.b)}xk.prototype.B=function(){return{lastLoginAt:this.b,createdAt:this.a}};function zk(a,b,c,d,e,f){gg(this,{uid:a,displayName:d||null,photoURL:e||null,email:c||null,phoneNumber:f||null,providerId:b})}function Ak(a,b){C.call(this,a);for(var c in b)this[c]=b[c]}t(Ak,C);function Bk(a,b,c){this.A=[];this.G=a.apiKey;this.o=a.appName;this.w=a.authDomain||null;a=firebase.SDK_VERSION?Of(firebase.SDK_VERSION):null;this.c=new Ch(this.G,xi(yi),a);this.h=new tk(this.c);Ck(this,b[O]);uk(this.h,b);M(this,"refreshToken",this.h.a);Dk(this,c||{});F.call(this);this.I=!1;this.w&&Rf()&&(this.a=gk(this.w,this.G,this.o));this.N=[];this.i=null;this.l=Ek(this);this.U=r(this.Ga,this);var d=this;this.ha=null;this.ra=function(a){d.na(a.h)};this.W=null;this.R=[];this.qa=function(a){Fk(d,a.f)};this.V=null}t(Bk,F);Bk.prototype.na=function(a){this.ha=a;Ih(this.c,a)};Bk.prototype.$=function(){return this.ha};function Gk(a,b){a.W&&E(a.W,"languageCodeChanged",a.ra);(a.W=b)&&cd(b,"languageCodeChanged",a.ra)}function Fk(a,b){a.R=b;Jh(a.c,firebase.SDK_VERSION?Of(firebase.SDK_VERSION,a.R):null)}Bk.prototype.Ka=function(){return La(this.R)};function Hk(a,b){a.V&&E(a.V,"frameworkChanged",a.qa);(a.V=b)&&cd(b,"frameworkChanged",a.qa)}Bk.prototype.Ga=function(){this.l.b&&(sk(this.l),this.l.start())};function Ik(a){try{return firebase.app(a.o).auth()}catch(b){throw new N("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+a.o+"'!")}}function Ek(a){return new pk(function(){return a.F(!0)},function(a){return a&&"auth/network-request-failed"==a.code?!0:!1},function(){var b=a.h.c-na()-3e5;return 0<b?b:0},3e4,96e4,!1)}function Jk(a){a.m||a.l.b||(a.l.start(),E(a,"tokenChanged",a.U),cd(a,"tokenChanged",a.U))}function Kk(a){E(a,"tokenChanged",a.U);sk(a.l)}function Ck(a,b){a.pa=b;M(a,"_lat",b)}function Lk(a,b){Ja(a.N,function(a){return a==b})}function Mk(a){for(var b=[],c=0;c<a.N.length;c++)b.push(a.N[c](a));return Ob(b).then(function(){return a})}function Nk(a){a.a&&!a.I&&(a.I=!0,a.a.subscribe(a))}function Dk(a,b){gg(a,{uid:b.uid,displayName:b.displayName||null,photoURL:b.photoURL||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,isAnonymous:b.isAnonymous||!1,metadata:new xk(b.createdAt,b.lastLoginAt),providerData:[]})}M(Bk.prototype,"providerId","firebase");function Ok(){}function Pk(a){return A().then(function(){if(a.m)throw new N("app-deleted")})}function Qk(a){return Da(a.providerData,function(a){return a.providerId})}function Rk(a,b){b&&(Sk(a,b.providerId),a.providerData.push(b))}function Sk(a,b){Ja(a.providerData,function(a){return a.providerId==b})}function Tk(a,b,c){("uid"!=b||c)&&a.hasOwnProperty(b)&&M(a,b,c)}function Uk(a,b){a!=b&&(gg(a,{uid:b.uid,displayName:b.displayName,photoURL:b.photoURL,email:b.email,emailVerified:b.emailVerified,phoneNumber:b.phoneNumber,isAnonymous:b.isAnonymous,providerData:[]}),b.metadata?M(a,"metadata",yk(b.metadata)):M(a,"metadata",new xk),w(b.providerData,function(b){Rk(a,b)}),a.h=b.h,M(a,"refreshToken",a.h.a))}h=Bk.prototype;h.reload=function(){var a=this;return R(this,Pk(this).then(function(){return Vk(a).then(function(){return Mk(a)}).then(Ok)}))};function Vk(a){return a.F().then(function(b){var c=a.isAnonymous;return Wk(a,b).then(function(){c||Tk(a,"isAnonymous",!1);return b})})}h.F=function(a){var b=this;return R(this,Pk(this).then(function(){return b.h.getToken(a)}).then(function(a){if(!a)throw new N("internal-error");a.accessToken!=b.pa&&(Ck(b,a.accessToken),G(b,new Ak("tokenChanged")));Tk(b,"refreshToken",a.refreshToken);return a.accessToken}))};h.getToken=function(a){dg["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(dg["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."));return this.F(a)};function Xk(a,b){b[O]&&a.pa!=b[O]&&(uk(a.h,b),G(a,new Ak("tokenChanged")),Ck(a,b[O]),Tk(a,"refreshToken",a.h.a))}function Wk(a,b){return Q(a.c,ti,{idToken:b}).then(r(a.kc,a))}h.kc=function(a){a=a.users;if(!a||!a.length)throw new N("internal-error");a=a[0];Dk(this,{uid:a.localId,displayName:a.displayName,photoURL:a.photoUrl,email:a.email,emailVerified:!!a.emailVerified,phoneNumber:a.phoneNumber,lastLoginAt:a.lastLoginAt,createdAt:a.createdAt});for(var b=Yk(a),c=0;c<b.length;c++)Rk(this,b[c]);Tk(this,"isAnonymous",!(this.email&&a.passwordHash)&&!(this.providerData&&this.providerData.length))};function Yk(a){return(a=a.providerUserInfo)&&a.length?Da(a,function(a){return new zk(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl,a.phoneNumber)}):[]}h.Za=function(a){var b=this,c=null;return R(this,a.c(this.c,this.uid).then(function(a){Xk(b,a);c=Zk(b,a,"reauthenticate");b.i=null;return b.reload()}).then(function(){return c}),!0)};h.mc=function(a){return this.Za(a).then(function(){})};function $k(a,b){return Vk(a).then(function(){if(Ha(Qk(a),b))return Mk(a).then(function(){throw new N("provider-already-linked")})})}h.Xa=function(a){var b=this,c=null;return R(this,$k(this,a.providerId).then(function(){return b.F()}).then(function(c){return a.b(b.c,c)}).then(function(a){c=Zk(b,a,"link");return al(b,a)}).then(function(){return c}))};h.cc=function(a){return this.Xa(a).then(function(a){return a.user})};h.dc=function(a,b){var c=this;return R(this,$k(this,"phone").then(function(){return ok(Ik(c),a,b,r(c.Xa,c))}))};h.nc=function(a,b){var c=this;return R(this,A().then(function(){return ok(Ik(c),a,b,r(c.Za,c))}),!0)};function Zk(a,b,c){var d=uh(b);b=Mg(b);return hg({user:a,credential:d,additionalUserInfo:b,operationType:c})}function al(a,b){Xk(a,b);return a.reload().then(function(){return a})}h.kb=function(a){var b=this;return R(this,this.F().then(function(c){return b.c.kb(c,a)}).then(function(a){Xk(b,a);return b.reload()}))};h.Dc=function(a){var b=this;return R(this,this.F().then(function(c){return a.b(b.c,c)}).then(function(a){Xk(b,a);return b.reload()}))};h.lb=function(a){var b=this;return R(this,this.F().then(function(c){return b.c.lb(c,a)}).then(function(a){Xk(b,a);return b.reload()}))};h.mb=function(a){if(void 0===a.displayName&&void 0===a.photoURL)return Pk(this);var b=this;return R(this,this.F().then(function(c){return b.c.mb(c,{displayName:a.displayName,photoUrl:a.photoURL})}).then(function(a){Xk(b,a);Tk(b,"displayName",a.displayName||null);Tk(b,"photoURL",a.photoUrl||null);w(b.providerData,function(a){"password"===a.providerId&&(M(a,"displayName",b.displayName),M(a,"photoURL",b.photoURL))});return Mk(b)}).then(Ok))};h.Cc=function(a){var b=this;return R(this,Vk(this).then(function(c){return Ha(Qk(b),a)?fi(b.c,c,[a]).then(function(a){var c={};w(a.providerUserInfo||[],function(a){c[a.providerId]=!0});w(Qk(b),function(a){c[a]||Sk(b,a)});c[rh.PROVIDER_ID]||M(b,"phoneNumber",null);return Mk(b)}):Mk(b).then(function(){throw new N("no-such-provider")})}))};h.delete=function(){var a=this;return R(this,this.F().then(function(b){return Q(a.c,si,{idToken:b})}).then(function(){G(a,new Ak("userDeleted"))})).then(function(){for(var b=0;b<a.A.length;b++)a.A[b].cancel("app-deleted");Gk(a,null);Hk(a,null);a.A=[];a.m=!0;Kk(a);M(a,"refreshToken",null);a.a&&a.a.unsubscribe(a)})};h.ob=function(a,b){return"linkViaPopup"==a&&(this.g||null)==b&&this.f||"reauthViaPopup"==a&&(this.g||null)==b&&this.f||"linkViaRedirect"==a&&(this.Z||null)==b||"reauthViaRedirect"==a&&(this.Z||null)==b?!0:!1};h.fa=function(a,b,c,d){"linkViaPopup"!=a&&"reauthViaPopup"!=a||d!=(this.g||null)||(c&&this.v?this.v(c):b&&!c&&this.f&&this.f(b),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)};h.va=function(a,b){return"linkViaPopup"==a&&b==(this.g||null)?r(this.tb,this):"reauthViaPopup"==a&&b==(this.g||null)?r(this.ub,this):"linkViaRedirect"==a&&(this.Z||null)==b?r(this.tb,this):"reauthViaRedirect"==a&&(this.Z||null)==b?r(this.ub,this):null};h.ec=function(a){var b=this;return bl(this,"linkViaPopup",a,function(){return $k(b,a.providerId).then(function(){return Mk(b)})},!1)};h.oc=function(a){return bl(this,"reauthViaPopup",a,function(){return A()},!0)};function bl(a,b,c,d,e){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));if(a.i&&!e)return B(a.i);var f=Lg(c.providerId),g=Qf(a.uid+":::"),l=null;(!Tf()||Lf())&&a.w&&c.isOAuthProvider&&(l=Ri(a.w,a.G,a.o,b,c,null,g,firebase.SDK_VERSION||null));var n=Df(l,f&&f.za,f&&f.ya);d=d().then(function(){cl(a);if(!e)return a.F().then(function(){})}).then(function(){return ek(a.a,n,b,c,g,!!l)}).then(function(){return new z(function(c,d){a.fa(b,null,new N("cancelled-popup-request"),a.g||null);a.f=c;a.v=d;a.g=g;a.b=a.a.Ca(a,b,n,g)})}).then(function(a){n&&Cf(n);return a?hg(a):null}).s(function(a){n&&Cf(n);throw a});return R(a,d,e)}h.fc=function(a){var b=this;return dl(this,"linkViaRedirect",a,function(){return $k(b,a.providerId)},!1)};h.pc=function(a){return dl(this,"reauthViaRedirect",a,function(){return A()},!0)};function dl(a,b,c,d,e){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));if(a.i&&!e)return B(a.i);var f=null,g=Qf(a.uid+":::");d=d().then(function(){cl(a);if(!e)return a.F().then(function(){})}).then(function(){a.Z=g;return Mk(a)}).then(function(b){a.ca&&(b=a.ca,b=b.b.set(el,a.B(),b.a));return b}).then(function(){return a.a.Aa(b,c,g)}).s(function(b){f=b;if(a.ca)return fl(a.ca);throw f}).then(function(){if(f)throw f});return R(a,d,e)}function cl(a){if(!a.a||!a.I){if(a.a&&!a.I)throw new N("internal-error");throw new N("auth-domain-config-required")}}h.tb=function(a,b){var c=this;this.b&&(this.b.cancel(),this.b=null);var d=null,e=this.F().then(function(d){return Zg(c.c,{requestUri:a,sessionId:b,idToken:d})}).then(function(a){d=Zk(c,a,"link");return al(c,a)}).then(function(){return d});return R(this,e)};h.ub=function(a,b){var c=this;this.b&&(this.b.cancel(),this.b=null);var d=null,e=A().then(function(){return Vg($g(c.c,{requestUri:a,sessionId:b}),c.uid)}).then(function(a){d=Zk(c,a,"reauthenticate");Xk(c,a);c.i=null;return c.reload()}).then(function(){return d});return R(this,e,!0)};h.bb=function(a){var b=this,c=null;return R(this,this.F().then(function(b){c=b;return"undefined"===typeof a||Sa(a)?{}:Fg(new wg(a))}).then(function(a){return b.c.bb(c,a)}).then(function(a){if(b.email!=a)return b.reload()}).then(function(){}))};function R(a,b,c){var d=gl(a,b,c);a.A.push(d);Qb(d,function(){Ia(a.A,d)});return d}function gl(a,b,c){return a.i&&!c?(b.cancel(),B(a.i)):b.s(function(b){!b||"auth/user-disabled"!=b.code&&"auth/user-token-expired"!=b.code||(a.i||G(a,new Ak("userInvalidated")),a.i=b);throw b})}h.toJSON=function(){return this.B()};h.B=function(){var a={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.o,authDomain:this.w,stsTokenManager:this.h.B(),redirectEventId:this.Z||null};this.metadata&&Wa(a,this.metadata.B());w(this.providerData,function(b){a.providerData.push(ig(b))});return a};function hl(a){if(!a.apiKey)return null;var b={apiKey:a.apiKey,authDomain:a.authDomain,appName:a.appName},c={};if(a.stsTokenManager&&a.stsTokenManager.accessToken&&a.stsTokenManager.expirationTime)c[O]=a.stsTokenManager.accessToken,c.refreshToken=a.stsTokenManager.refreshToken||null,c.expiresIn=(a.stsTokenManager.expirationTime-na())/1e3;else return null;var d=new Bk(b,c,a);a.providerData&&w(a.providerData,function(a){a&&Rk(d,hg(a))});a.redirectEventId&&(d.Z=a.redirectEventId);return d}function il(a,b,c,d){var e=new Bk(a,b);c&&(e.ca=c);d&&Fk(e,d);return e.reload().then(function(){return e})}function jl(a){this.a=a;this.b=rj()}var el={name:"redirectUser",C:"session"};function fl(a){return uj(a.b,el,a.a)}function kl(a,b){return a.b.get(el,a.a).then(function(a){a&&b&&(a.authDomain=b);return hl(a||{})})}function ll(a,b){this.a=a;this.b=b||rj();this.c=null;this.f=ml(this);vj(this.b,yj("local"),this.a,r(this.g,this))}ll.prototype.g=function(){var a=this,b=yj("local");nl(this,function(){return A().then(function(){return a.c&&"local"!=a.c.C?a.b.get(b,a.a):null}).then(function(c){if(c)return ol(a,"local").then(function(){a.c=b})})})};function ol(a,b){var c=[],d;for(d in nj)nj[d]!==b&&c.push(uj(a.b,yj(nj[d]),a.a));c.push(uj(a.b,pl,a.a));return Nb(c)}function ml(a){var b=yj("local"),c=yj("session"),d=yj("none");return a.b.get(c,a.a).then(function(e){return e?c:a.b.get(d,a.a).then(function(c){return c?d:a.b.get(b,a.a).then(function(c){return c?b:a.b.get(pl,a.a).then(function(a){return a?yj(a):b})})})}).then(function(b){a.c=b;return ol(a,b.C)}).s(function(){a.c||(a.c=b)})}var pl={name:"persistence",C:"session"};function yj(a){return{name:"authUser",C:a}}ll.prototype.eb=function(a){var b=null,c=this;oj(a);return nl(this,function(){return a!=c.c.C?c.b.get(c.c,c.a).then(function(d){b=d;return ol(c,a)}).then(function(){c.c=yj(a);if(b)return c.b.set(c.c,b,c.a)}):A()})};function ql(a){return nl(a,function(){return a.b.set(pl,a.c.C,a.a)})}function rl(a,b){return nl(a,function(){return a.b.set(a.c,b.B(),a.a)})}function sl(a){return nl(a,function(){return uj(a.b,a.c,a.a)})}function tl(a,b){return nl(a,function(){return a.b.get(a.c,a.a).then(function(a){a&&b&&(a.authDomain=b);return hl(a||{})})})}function nl(a,b){a.f=a.f.then(b,b);return a.f}function ul(a){this.l=!1;M(this,"app",a);if(S(this).options&&S(this).options.apiKey)a=firebase.SDK_VERSION?Of(firebase.SDK_VERSION):null,this.c=new Ch(S(this).options&&S(this).options.apiKey,xi(yi),a);else throw new N("invalid-api-key");this.N=[];this.m=[];this.I=[];this.Kb=firebase.INTERNAL.createSubscribe(r(this.ac,this));this.R=void 0;this.Lb=firebase.INTERNAL.createSubscribe(r(this.bc,this));vl(this,null);this.h=new ll(S(this).options.apiKey+":"+S(this).name);this.G=new jl(S(this).options.apiKey+":"+S(this).name);this.U=T(this,wl(this));this.i=T(this,xl(this));this.W=!1;this.ha=r(this.yc,this);this.Ga=r(this.ka,this);this.pa=r(this.Tb,this);this.qa=r(this.Zb,this);this.ra=r(this.$b,this);yl(this);this.INTERNAL={};this.INTERNAL["delete"]=r(this.delete,this);this.INTERNAL.logFramework=r(this.gc,this);this.o=0;F.call(this);zl(this);this.A=[]}t(ul,F);function Al(a){C.call(this,"languageCodeChanged");this.h=a}t(Al,C);function Bl(a){C.call(this,"frameworkChanged");this.f=a}t(Bl,C);h=ul.prototype;h.eb=function(a){a=this.h.eb(a);return T(this,a)};h.na=function(a){this.V===a||this.l||(this.V=a,Ih(this.c,this.V),G(this,new Al(this.$())))};h.$=function(){return this.V};h.Ec=function(){var a=k.navigator;this.na(a?a.languages&&a.languages[0]||a.language||a.userLanguage||null:null)};h.gc=function(a){this.A.push(a);Jh(this.c,firebase.SDK_VERSION?Of(firebase.SDK_VERSION,this.A):null);G(this,new Bl(this.A))};h.Ka=function(){return La(this.A)};function zl(a){Object.defineProperty(a,"lc",{get:function(){return this.$()},set:function(a){this.na(a)},enumerable:!1});a.V=null}h.toJSON=function(){return{apiKey:S(this).options.apiKey,authDomain:S(this).options.authDomain,appName:S(this).name,currentUser:U(this)&&U(this).B()}};function Cl(a){return a.Jb||B(new N("auth-domain-config-required"))}function yl(a){var b=S(a).options.authDomain,c=S(a).options.apiKey;b&&Rf()&&(a.Jb=a.U.then(function(){if(!a.l){a.a=gk(b,c,S(a).name);a.a.subscribe(a);U(a)&&Nk(U(a));if(a.w){Nk(a.w);var d=a.w;d.na(a.$());Gk(d,a);d=a.w;Fk(d,a.A);Hk(d,a);a.w=null}return a.a}}))}h.ob=function(a,b){switch(a){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==b&&!!this.f;default:return!1}};h.fa=function(a,b,c,d){"signInViaPopup"==a&&this.g==d&&(c&&this.v?this.v(c):b&&!c&&this.f&&this.f(b),this.b&&(this.b.cancel(),this.b=null),delete this.f,delete this.v)};h.va=function(a,b){return"signInViaRedirect"==a||"signInViaPopup"==a&&this.g==b&&this.f?r(this.Sb,this):null};h.Sb=function(a,b){var c=this;a={requestUri:a,sessionId:b};this.b&&(this.b.cancel(),this.b=null);var d=null,e=null,f=Xg(c.c,a).then(function(a){d=uh(a);e=Mg(a);return a});a=c.U.then(function(){return f}).then(function(a){return Dl(c,a)}).then(function(){return hg({user:U(c),credential:d,additionalUserInfo:e,operationType:"signIn"})});return T(this,a)};h.wc=function(a){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var b=this,c=Lg(a.providerId),d=Qf(),e=null;(!Tf()||Lf())&&S(this).options.authDomain&&a.isOAuthProvider&&(e=Ri(S(this).options.authDomain,S(this).options.apiKey,S(this).name,"signInViaPopup",a,null,d,firebase.SDK_VERSION||null));var f=Df(e,c&&c.za,c&&c.ya);c=Cl(this).then(function(b){return ek(b,f,"signInViaPopup",a,d,!!e)}).then(function(){return new z(function(a,c){b.fa("signInViaPopup",null,new N("cancelled-popup-request"),b.g);b.f=a;b.v=c;b.g=d;b.b=b.a.Ca(b,"signInViaPopup",f,d)})}).then(function(a){f&&Cf(f);return a?hg(a):null}).s(function(a){f&&Cf(f);throw a});return T(this,c)};h.xc=function(a){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var b=this,c=Cl(this).then(function(){return ql(b.h)}).then(function(){return b.a.Aa("signInViaRedirect",a)});return T(this,c)};h.aa=function(){if(!Rf())return B(new N("operation-not-supported-in-this-environment"));var a=this,b=Cl(this).then(function(){return a.a.aa()}).then(function(a){return a?hg(a):null});return T(this,b)};function Dl(a,b){var c={};c.apiKey=S(a).options.apiKey;c.authDomain=S(a).options.authDomain;c.appName=S(a).name;return a.U.then(function(){return il(c,b,a.G,a.Ka())}).then(function(b){if(U(a)&&b.uid==U(a).uid)return Uk(U(a),b),a.ka(b);vl(a,b);Nk(b);return a.ka(b)}).then(function(){El(a)})}function vl(a,b){U(a)&&(Lk(U(a),a.Ga),E(U(a),"tokenChanged",a.pa),E(U(a),"userDeleted",a.qa),E(U(a),"userInvalidated",a.ra),Kk(U(a)));b&&(b.N.push(a.Ga),cd(b,"tokenChanged",a.pa),cd(b,"userDeleted",a.qa),cd(b,"userInvalidated",a.ra),0<a.o&&Jk(b));M(a,"currentUser",b);b&&(b.na(a.$()),Gk(b,a),Fk(b,a.A),Hk(b,a))}h.hb=function(){var a=this,b=this.i.then(function(){if(!U(a))return A();vl(a,null);return sl(a.h).then(function(){El(a)})});return T(this,b)};function Fl(a){var b=kl(a.G,S(a).options.authDomain).then(function(b){if(a.w=b)b.ca=a.G;return fl(a.G)});return T(a,b)}function wl(a){var b=S(a).options.authDomain,c=Fl(a).then(function(){return tl(a.h,b)}).then(function(b){return b?(b.ca=a.G,a.w&&(a.w.Z||null)==(b.Z||null)?b:b.reload().then(function(){return rl(a.h,b).then(function(){return b})}).s(function(c){return"auth/network-request-failed"==c.code?b:sl(a.h)})):null}).then(function(b){vl(a,b||null)});return T(a,c)}function xl(a){return a.U.then(function(){return a.aa()}).s(function(){}).then(function(){if(!a.l)return a.ha()}).s(function(){}).then(function(){if(!a.l){a.W=!0;var b=a.h;vj(b.b,yj("local"),b.a,a.ha)}})}h.yc=function(){var a=this;return tl(this.h,S(this).options.authDomain).then(function(b){if(!a.l){var c;if(c=U(a)&&b){c=U(a).uid;var d=b.uid;c=void 0===c||null===c||""===c||void 0===d||null===d||""===d?!1:c==d}if(c)return Uk(U(a),b),U(a).F();if(U(a)||b)vl(a,b),b&&(Nk(b),b.ca=a.G),a.a&&a.a.subscribe(a),El(a)}})};h.ka=function(a){return rl(this.h,a)};h.Tb=function(){El(this);this.ka(U(this))};h.Zb=function(){this.hb()};h.$b=function(){this.hb()};function Gl(a,b){var c=null,d=null;return T(a,b.then(function(b){c=uh(b);d=Mg(b);return Dl(a,b)}).then(function(){return hg({user:U(a),credential:c,additionalUserInfo:d,operationType:"signIn"})}))}h.ac=function(a){var b=this;this.addAuthTokenListener(function(){a.next(U(b))})};h.bc=function(a){var b=this;Hl(this,function(){a.next(U(b))})};h.ic=function(a,b,c){var d=this;this.W&&firebase.Promise.resolve().then(function(){p(a)?a(U(d)):p(a.next)&&a.next(U(d))});return this.Kb(a,b,c)};h.hc=function(a,b,c){var d=this;this.W&&firebase.Promise.resolve().then(function(){d.R=d.getUid();p(a)?a(U(d)):p(a.next)&&a.next(U(d))});return this.Lb(a,b,c)};h.Vb=function(a){var b=this,c=this.i.then(function(){return U(b)?U(b).F(a).then(function(a){return{accessToken:a}}):null});return T(this,c)};h.tc=function(a){return this.Eb(a).then(function(a){return a.user})};h.Eb=function(a){var b=this;return this.i.then(function(){return Gl(b,Q(b.c,vi,{token:a}))}).then(function(a){var c=a.user;Tk(c,"isAnonymous",!1);b.ka(c);return a})};h.Fb=function(a,b){var c=this;return this.i.then(function(){return Gl(c,Q(c.c,kh,{email:a,password:b}))})};h.uc=function(a,b){return this.Fb(a,b).then(function(a){return a.user})};h.Ob=function(a,b){return this.qb(a,b).then(function(a){return a.user})};h.qb=function(a,b){var c=this;return this.i.then(function(){return Gl(c,Q(c.c,ri,{email:a,password:b}))})};h.sc=function(a){return this.fb(a).then(function(a){return a.user})};h.fb=function(a){var b=this;return this.i.then(function(){return Gl(b,a.wa(b.c))})};h.gb=function(){return this.Gb().then(function(a){return a.user})};h.Gb=function(){var a=this;return this.i.then(function(){var b=U(a);if(b&&b.isAnonymous){var c=hg({providerId:null,isNewUser:!1});return hg({user:b,credential:null,additionalUserInfo:c,operationType:"signIn"})}return Gl(a,a.c.gb()).then(function(b){var c=b.user;Tk(c,"isAnonymous",!0);a.ka(c);return b})})};function S(a){return a.app}function U(a){return a.currentUser}h.getUid=function(){return U(this)&&U(this).uid||null};function Il(a){return U(a)&&U(a)._lat||null}function El(a){if(a.W){for(var b=0;b<a.m.length;b++)if(a.m[b])a.m[b](Il(a));if(a.R!==a.getUid()&&a.I.length)for(a.R=a.getUid(),b=0;b<a.I.length;b++)if(a.I[b])a.I[b](Il(a))}}h.Mb=function(a){this.addAuthTokenListener(a);this.o++;0<this.o&&U(this)&&Jk(U(this))};h.qc=function(a){var b=this;w(this.m,function(c){c==a&&b.o--});0>this.o&&(this.o=0);0==this.o&&U(this)&&Kk(U(this));this.removeAuthTokenListener(a)};h.addAuthTokenListener=function(a){var b=this;this.m.push(a);T(this,this.i.then(function(){b.l||Ha(b.m,a)&&a(Il(b))}))};h.removeAuthTokenListener=function(a){Ja(this.m,function(b){return b==a})};function Hl(a,b){a.I.push(b);T(a,a.i.then(function(){!a.l&&Ha(a.I,b)&&a.R!==a.getUid()&&(a.R=a.getUid(),b(Il(a)))}))}h.delete=function(){this.l=!0;for(var a=0;a<this.N.length;a++)this.N[a].cancel("app-deleted");this.N=[];this.h&&(a=this.h,xj(a.b,a.a,this.ha));this.a&&this.a.unsubscribe(this);return firebase.Promise.resolve()};function T(a,b){a.N.push(b);Qb(b,function(){Ia(a.N,b)});return b}h.Rb=function(a){return T(this,Th(this.c,a))};h.Fc=function(a){return this.Ia(a).then(function(a){return a.data.email})};h.Ta=function(a,b){return T(this,this.c.Ta(a,b).then(function(){}))};h.Ia=function(a){return T(this,this.c.Ia(a).then(function(a){return new lg(a)}))};h.Sa=function(a){return T(this,this.c.Sa(a).then(function(){}))};h.cb=function(a,b){var c=this;return T(this,A().then(function(){return"undefined"===typeof b||Sa(b)?{}:Fg(new wg(b))}).then(function(b){return c.c.cb(a,b)}).then(function(){}))};h.vc=function(a,b){return T(this,ok(this,a,b,r(this.fb,this)))};function Jl(a,b,c,d){a:{c=Array.prototype.slice.call(c);var e=0;for(var f=!1,g=0;g<b.length;g++)if(b[g].optional)f=!0;else{if(f)throw new N("internal-error","Argument validator encountered a required argument after an optional argument.");e++}f=b.length;if(c.length<e||f<c.length)d="Expected "+(e==f?1==e?"1 argument":e+" arguments":e+"-"+f+" arguments")+" but got "+c.length+".";else{for(e=0;e<c.length;e++)if(f=b[e].optional&&void 0===c[e],!b[e].M(c[e])&&!f){b=b[e];if(0>e||e>=Kl.length)throw new N("internal-error","Argument validator received an unsupported number of arguments.");c=Kl[e];d=(d?"":c+" argument ")+(b.name?'"'+b.name+'" ':"")+"must be "+b.K+".";break a}d=null}}if(d)throw new N("argument-error",a+" failed: "+d)}var Kl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function V(a,b){return{name:a||"",K:"a valid string",optional:!!b,M:m}}function Ll(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:ba}}function W(a,b){return{name:a||"",K:"a valid object",optional:!!b,M:q}}function Ml(a,b){return{name:a||"",K:"a function",optional:!!b,M:p}}function Nl(a,b){return{name:a||"",K:"null",optional:!!b,M:ea}}function Ol(){return{name:"",K:"an HTML element",optional:!1,M:function(a){return!!(a&&a instanceof Element)}}}function Pl(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(a){return!!(a&&a instanceof ul)}}}function Ql(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(a){return!!(a&&a instanceof firebase.app.App)}}}function Rl(a){return{name:a?a+"Credential":"credential",K:a?"a valid "+a+" credential":"a valid credential",optional:!1,M:function(b){if(!b)return!1;var c=!a||b.providerId===a;return!(!b.wa||!c)}}}function Sl(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(a){return!!(a&&a.providerId&&a.hasOwnProperty&&a.hasOwnProperty("isOAuthProvider"))}}}function Tl(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(a){
return!!(a&&m(a.type)&&p(a.verify))}}}function X(a,b,c,d){return{name:c||"",K:a.K+" or "+b.K,optional:!!d,M:function(c){return a.M(c)||b.M(c)}}}function Ul(a,b,c,d,e,f){M(this,"type","recaptcha");this.b=this.c=null;this.m=!1;this.l=b;this.a=c||{theme:"light",type:"image"};this.g=[];if(this.a[Vl])throw new N("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");this.h="invisible"===this.a[Wl];if(!wc(b)||!this.h&&wc(b).hasChildNodes())throw new N("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new Ch(a,f||null,e||null);this.o=d||function(){return null};var g=this;this.i=[];var l=this.a[Xl];this.a[Xl]=function(a){Yl(g,a);if("function"===typeof l)l(a);else if("string"===typeof l){var b=L(l,k);"function"===typeof b&&b(a)}};var n=this.a[Zl];this.a[Zl]=function(){Yl(g,null);if("function"===typeof n)n();else if("string"===typeof n){var a=L(n,k);"function"===typeof a&&a()}}}var Xl="callback",Zl="expired-callback",Vl="sitekey",Wl="size";function Yl(a,b){for(var c=0;c<a.i.length;c++)try{a.i[c](b)}catch(d){}}function $l(a,b){Ja(a.i,function(a){return a==b})}function am(a,b){a.g.push(b);Qb(b,function(){Ia(a.g,b)});return b}h=Ul.prototype;h.xa=function(){var a=this;return this.c?this.c:this.c=am(this,A().then(function(){if(Sf())return Hf();throw new N("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return bm(cm(),a.o())}).then(function(){return Q(a.u,ui,{})}).then(function(b){a.a[Vl]=b.recaptchaSiteKey}).s(function(b){a.c=null;throw b}))};h.render=function(){dm(this);var a=this;return am(this,this.xa().then(function(){if(null===a.b){var b=a.l;if(!a.h){var c=wc(b);b=zc("DIV");c.appendChild(b)}a.b=grecaptcha.render(b,a.a)}return a.b}))};h.verify=function(){dm(this);var a=this;return am(this,this.render().then(function(b){return new z(function(c){var d=grecaptcha.getResponse(b);if(d)c(d);else{var e=function(b){b&&($l(a,e),c(b))};a.i.push(e);a.h&&grecaptcha.execute(a.b)}})}))};h.reset=function(){dm(this);null!==this.b&&grecaptcha.reset(this.b)};function dm(a){if(a.m)throw new N("internal-error","RecaptchaVerifier instance has been destroyed.")}h.clear=function(){dm(this);this.m=!0;cm().b--;for(var a=0;a<this.g.length;a++)this.g[a].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){a=wc(this.l);for(var b;b=a.firstChild;)a.removeChild(b)}};var em=dc("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}");function fm(){this.b=k.grecaptcha?Infinity:0;this.c=null;this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function bm(a,b){return new z(function(c,d){if(Zf())if(!k.grecaptcha||b!==a.c&&!a.b){k[a.a]=function(){if(k.grecaptcha){a.c=b;var e=k.grecaptcha.render;k.grecaptcha.render=function(b,c){b=e(b,c);a.b++;return b};c()}else d(new N("internal-error"));delete k[a.a]};var e=hc(em,{onload:a.a,hl:b||""});A(kf(e)).s(function(){d(new N("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else c();else d(new N("network-request-failed"))})}var gm=null;function cm(){gm||(gm=new fm);return gm}function hm(a,b,c){try{this.f=c||firebase.app()}catch(f){throw new N("argument-error","No firebase.app.App instance is currently initialized.")}if(this.f.options&&this.f.options.apiKey)c=this.f.options.apiKey;else throw new N("invalid-api-key");var d=this,e=null;try{e=this.f.auth().Ka()}catch(f){}e=firebase.SDK_VERSION?Of(firebase.SDK_VERSION,e):null;Ul.call(this,c,a,b,function(){try{var a=d.f.auth().$()}catch(g){a=null}return a},e,xi(yi))}t(hm,Ul);function Y(a,b){for(var c in b){var d=b[c].name;a[d]=im(d,a[c],b[c].j)}}function Z(a,b,c,d){a[b]=im(b,c,d)}function im(a,b,c){function d(){var a=Array.prototype.slice.call(arguments);Jl(e,c,a);return b.apply(this,a)}if(!c)return b;var e=jm(a),f;for(f in b)d[f]=b[f];for(f in b.prototype)d.prototype[f]=b.prototype[f];return d}function jm(a){a=a.split(".");return a[a.length-1]}Y(ul.prototype,{Sa:{name:"applyActionCode",j:[V("code")]},Ia:{name:"checkActionCode",j:[V("code")]},Ta:{name:"confirmPasswordReset",j:[V("code"),V("newPassword")]},Ob:{name:"createUserWithEmailAndPassword",j:[V("email"),V("password")]},qb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[V("email"),V("password")]},Rb:{name:"fetchProvidersForEmail",j:[V("email")]},aa:{name:"getRedirectResult",j:[]},hc:{name:"onAuthStateChanged",j:[X(W(),Ml(),"nextOrObserver"),Ml("opt_error",!0),Ml("opt_completed",!0)]},ic:{name:"onIdTokenChanged",j:[X(W(),Ml(),"nextOrObserver"),Ml("opt_error",!0),Ml("opt_completed",!0)]},cb:{name:"sendPasswordResetEmail",j:[V("email"),X(W("opt_actionCodeSettings",!0),Nl(null,!0),"opt_actionCodeSettings",!0)]},eb:{name:"setPersistence",j:[V("persistence")]},fb:{name:"signInAndRetrieveDataWithCredential",j:[Rl()]},gb:{name:"signInAnonymously",j:[]},Gb:{name:"signInAnonymouslyAndRetrieveData",j:[]},sc:{name:"signInWithCredential",j:[Rl()]},tc:{name:"signInWithCustomToken",j:[V("token")]},Eb:{name:"signInAndRetrieveDataWithCustomToken",j:[V("token")]},uc:{name:"signInWithEmailAndPassword",j:[V("email"),V("password")]},Fb:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[V("email"),V("password")]},vc:{name:"signInWithPhoneNumber",j:[V("phoneNumber"),Tl()]},wc:{name:"signInWithPopup",j:[Sl()]},xc:{name:"signInWithRedirect",j:[Sl()]},hb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[V(null,!0)]},Ec:{name:"useDeviceLanguage",j:[]},Fc:{name:"verifyPasswordResetCode",j:[V("code")]}});(function(a,b){for(var c in b){var d=b[c].name;if(d!==c){var e=b[c].Nb;Object.defineProperty(a,d,{get:function(){return this[c]},set:function(a){Jl(d,[e],[a],!0);this[c]=a},enumerable:!0})}}})(ul.prototype,{lc:{name:"languageCode",Nb:X(V(),Nl(),"languageCode")}});ul.Persistence=nj;ul.Persistence.LOCAL="local";ul.Persistence.SESSION="session";ul.Persistence.NONE="none";Y(Bk.prototype,{delete:{name:"delete",j:[]},F:{name:"getIdToken",j:[Ll()]},getToken:{name:"getToken",j:[Ll()]},Xa:{name:"linkAndRetrieveDataWithCredential",j:[Rl()]},cc:{name:"linkWithCredential",j:[Rl()]},dc:{name:"linkWithPhoneNumber",j:[V("phoneNumber"),Tl()]},ec:{name:"linkWithPopup",j:[Sl()]},fc:{name:"linkWithRedirect",j:[Sl()]},Za:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Rl()]},mc:{name:"reauthenticateWithCredential",j:[Rl()]},nc:{name:"reauthenticateWithPhoneNumber",j:[V("phoneNumber"),Tl()]},oc:{name:"reauthenticateWithPopup",j:[Sl()]},pc:{name:"reauthenticateWithRedirect",j:[Sl()]},reload:{name:"reload",j:[]},bb:{name:"sendEmailVerification",j:[X(W("opt_actionCodeSettings",!0),Nl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[V(null,!0)]},Cc:{name:"unlink",j:[V("provider")]},kb:{name:"updateEmail",j:[V("email")]},lb:{name:"updatePassword",j:[V("password")]},Dc:{name:"updatePhoneNumber",j:[Rl("phone")]},mb:{name:"updateProfile",j:[W("profile")]}});Y(z.prototype,{s:{name:"catch"},then:{name:"then"}});Y(nk.prototype,{confirm:{name:"confirm",j:[V("verificationCode")]}});Z(mh,"credential",function(a,b){return new jh(a,b)},[V("email"),V("password")]);Y(bh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}});Z(bh,"credential",ch,[X(V(),W(),"token")]);Y(dh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}});Z(dh,"credential",eh,[X(V(),W(),"token")]);Y(fh.prototype,{sa:{name:"addScope",j:[V("scope")]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}});Z(fh,"credential",gh,[X(V(),X(W(),Nl()),"idToken"),X(V(),Nl(),"accessToken",!0)]);Y(hh.prototype,{Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}});Z(hh,"credential",ih,[X(V(),W(),"token"),V("secret",!0)]);Y(P.prototype,{sa:{name:"addScope",j:[V("scope")]},credential:{name:"credential",j:[X(V(),Nl(),"idToken",!0),X(V(),Nl(),"accessToken",!0)]},Ba:{name:"setCustomParameters",j:[W("customOAuthParameters")]}});Z(rh,"credential",th,[V("verificationId"),V("verificationCode")]);Y(rh.prototype,{Qa:{name:"verifyPhoneNumber",j:[V("phoneNumber"),Tl()]}});Y(N.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}});Y(zh.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}});Y(yh.prototype,{toJSON:{name:"toJSON",j:[V(null,!0)]}});Y(hm.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}});(function(){if("undefined"!==typeof firebase&&firebase.INTERNAL&&firebase.INTERNAL.registerService){var a={Auth:ul,Error:N};Z(a,"EmailAuthProvider",mh,[]);Z(a,"FacebookAuthProvider",bh,[]);Z(a,"GithubAuthProvider",dh,[]);Z(a,"GoogleAuthProvider",fh,[]);Z(a,"TwitterAuthProvider",hh,[]);Z(a,"OAuthProvider",P,[V("providerId")]);Z(a,"PhoneAuthProvider",rh,[Pl()]);Z(a,"RecaptchaVerifier",hm,[X(V(),Ol(),"recaptchaContainer"),W("recaptchaParameters",!0),Ql()]);firebase.INTERNAL.registerService("auth",function(a,c){a=new ul(a);c({INTERNAL:{getUid:r(a.getUid,a),getToken:r(a.Vb,a),addAuthTokenListener:r(a.Mb,a),removeAuthTokenListener:r(a.qc,a)}});return a},a,function(a,c){if("create"===a)try{c.auth()}catch(d){}});firebase.INTERNAL.extendNamespace({User:Bk})}else throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.")})()}).call(typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})}).call(exports,__webpack_require__(42))},function(module,exports,__webpack_require__){module.exports=__webpack_require__(146)},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var app_1=__webpack_require__(10);var Database_1=__webpack_require__(65);exports.Database=Database_1.Database;var Query_1=__webpack_require__(69);exports.Query=Query_1.Query;var Reference_1=__webpack_require__(44);exports.Reference=Reference_1.Reference;var util_1=__webpack_require__(1);exports.enableLogging=util_1.enableLogging;var RepoManager_1=__webpack_require__(49);var INTERNAL=__webpack_require__(178);var TEST_ACCESS=__webpack_require__(179);var util_2=__webpack_require__(0);var ServerValue=Database_1.Database.ServerValue;exports.ServerValue=ServerValue;function registerDatabase(instance){var namespace=instance.INTERNAL.registerService("database",function(app,unused,url){return RepoManager_1.RepoManager.getInstance().databaseFromApp(app,url)},{Reference:Reference_1.Reference,Query:Query_1.Query,Database:Database_1.Database,enableLogging:util_1.enableLogging,INTERNAL:INTERNAL,ServerValue:ServerValue,TEST_ACCESS:TEST_ACCESS},null,true);if(util_2.isNodeSdk()){module.exports=namespace}}exports.registerDatabase=registerDatabase;registerDatabase(app_1.default);var DataSnapshot_1=__webpack_require__(45);exports.DataSnapshot=DataSnapshot_1.DataSnapshot;var onDisconnect_1=__webpack_require__(68);exports.OnDisconnect=onDisconnect_1.OnDisconnect},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var DOMStorageWrapper=function(){function DOMStorageWrapper(domStorage_){this.domStorage_=domStorage_;this.prefix_="firebase:"}DOMStorageWrapper.prototype.set=function(key,value){if(value==null){this.domStorage_.removeItem(this.prefixedName_(key))}else{this.domStorage_.setItem(this.prefixedName_(key),util_1.stringify(value))}};DOMStorageWrapper.prototype.get=function(key){var storedVal=this.domStorage_.getItem(this.prefixedName_(key));if(storedVal==null){return null}else{return util_1.jsonEval(storedVal)}};DOMStorageWrapper.prototype.remove=function(key){this.domStorage_.removeItem(this.prefixedName_(key))};DOMStorageWrapper.prototype.prefixedName_=function(name){return this.prefix_+name};DOMStorageWrapper.prototype.toString=function(){return this.domStorage_.toString()};return DOMStorageWrapper}();exports.DOMStorageWrapper=DOMStorageWrapper},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var MemoryStorage=function(){function MemoryStorage(){this.cache_={};this.isInMemoryStorage=true}MemoryStorage.prototype.set=function(key,value){if(value==null){delete this.cache_[key]}else{this.cache_[key]=value}};MemoryStorage.prototype.get=function(key){if(util_1.contains(this.cache_,key)){return this.cache_[key]}return null};MemoryStorage.prototype.remove=function(key){delete this.cache_[key]};return MemoryStorage}();exports.MemoryStorage=MemoryStorage},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var TransactionResult=function(){function TransactionResult(committed,snapshot){this.committed=committed;this.snapshot=snapshot}TransactionResult.prototype.toJSON=function(){util_1.validateArgCount("TransactionResult.toJSON",0,1,arguments.length);return{committed:this.committed,snapshot:this.snapshot.toJSON()}};return TransactionResult}();exports.TransactionResult=TransactionResult},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);exports.nextPushId=function(){var PUSH_CHARS="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz";var lastPushTime=0;var lastRandChars=[];return function(now){var duplicateTime=now===lastPushTime;lastPushTime=now;var i;var timeStampChars=new Array(8);for(i=7;i>=0;i--){timeStampChars[i]=PUSH_CHARS.charAt(now%64);now=Math.floor(now/64)}util_1.assert(now===0,"Cannot push at time == 0");var id=timeStampChars.join("");if(!duplicateTime){for(i=0;i<12;i++){lastRandChars[i]=Math.floor(Math.random()*64)}}else{for(i=11;i>=0&&lastRandChars[i]===63;i--){lastRandChars[i]=0}lastRandChars[i]++}for(i=0;i<12;i++){id+=PUSH_CHARS.charAt(lastRandChars[i])}util_1.assert(id.length===20,"nextPushId: Length should be 20.");return id}}()},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var DataSnapshot_1=__webpack_require__(45);var Event_1=__webpack_require__(152);var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var ValueEventRegistration=function(){function ValueEventRegistration(callback_,cancelCallback_,context_){this.callback_=callback_;this.cancelCallback_=cancelCallback_;this.context_=context_}ValueEventRegistration.prototype.respondsTo=function(eventType){return eventType==="value"};ValueEventRegistration.prototype.createEvent=function(change,query){var index=query.getQueryParams().getIndex();return new Event_1.DataEvent("value",this,new DataSnapshot_1.DataSnapshot(change.snapshotNode,query.getRef(),index))};ValueEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if(eventData.getEventType()==="cancel"){util_2.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_1=this.cancelCallback_;return function(){cancelCB_1.call(ctx,eventData.error)}}else{var cb_1=this.callback_;return function(){cb_1.call(ctx,eventData.snapshot)}}};ValueEventRegistration.prototype.createCancelEvent=function(error,path){if(this.cancelCallback_){return new Event_1.CancelEvent(this,error,path)}else{return null}};ValueEventRegistration.prototype.matches=function(other){if(!(other instanceof ValueEventRegistration)){return false}else if(!other.callback_||!this.callback_){return true}else{return other.callback_===this.callback_&&other.context_===this.context_}};ValueEventRegistration.prototype.hasAnyCallback=function(){return this.callback_!==null};return ValueEventRegistration}();exports.ValueEventRegistration=ValueEventRegistration;var ChildEventRegistration=function(){function ChildEventRegistration(callbacks_,cancelCallback_,context_){this.callbacks_=callbacks_;this.cancelCallback_=cancelCallback_;this.context_=context_}ChildEventRegistration.prototype.respondsTo=function(eventType){var eventToCheck=eventType==="children_added"?"child_added":eventType;eventToCheck=eventToCheck==="children_removed"?"child_removed":eventToCheck;return util_1.contains(this.callbacks_,eventToCheck)};ChildEventRegistration.prototype.createCancelEvent=function(error,path){if(this.cancelCallback_){return new Event_1.CancelEvent(this,error,path)}else{return null}};ChildEventRegistration.prototype.createEvent=function(change,query){util_2.assert(change.childName!=null,"Child events should have a childName.");var ref=query.getRef().child(change.childName);var index=query.getQueryParams().getIndex();return new Event_1.DataEvent(change.type,this,new DataSnapshot_1.DataSnapshot(change.snapshotNode,ref,index),change.prevName)};ChildEventRegistration.prototype.getEventRunner=function(eventData){var ctx=this.context_;if(eventData.getEventType()==="cancel"){util_2.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var cancelCB_2=this.cancelCallback_;return function(){cancelCB_2.call(ctx,eventData.error)}}else{var cb_2=this.callbacks_[eventData.eventType];return function(){cb_2.call(ctx,eventData.snapshot,eventData.prevName)}}};ChildEventRegistration.prototype.matches=function(other){if(other instanceof ChildEventRegistration){if(!this.callbacks_||!other.callbacks_){return true}else if(this.context_===other.context_){var otherCount=util_1.getCount(other.callbacks_);var thisCount=util_1.getCount(this.callbacks_);if(otherCount===thisCount){if(otherCount===1){var otherKey=util_1.getAnyKey(other.callbacks_);var thisKey=util_1.getAnyKey(this.callbacks_);return thisKey===otherKey&&(!other.callbacks_[otherKey]||!this.callbacks_[thisKey]||other.callbacks_[otherKey]===this.callbacks_[thisKey])}else{return util_1.every(this.callbacks_,function(eventType,cb){return other.callbacks_[eventType]===cb})}}}}return false};ChildEventRegistration.prototype.hasAnyCallback=function(){return this.callbacks_!==null};return ChildEventRegistration}();exports.ChildEventRegistration=ChildEventRegistration},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var DataEvent=function(){function DataEvent(eventType,eventRegistration,snapshot,prevName){this.eventType=eventType;this.eventRegistration=eventRegistration;this.snapshot=snapshot;this.prevName=prevName}DataEvent.prototype.getPath=function(){var ref=this.snapshot.getRef();if(this.eventType==="value"){return ref.path}else{return ref.getParent().path}};DataEvent.prototype.getEventType=function(){return this.eventType};DataEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)};DataEvent.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+util_1.stringify(this.snapshot.exportVal())};return DataEvent}();exports.DataEvent=DataEvent;var CancelEvent=function(){function CancelEvent(eventRegistration,error,path){this.eventRegistration=eventRegistration;this.error=error;this.path=path}CancelEvent.prototype.getPath=function(){return this.path};CancelEvent.prototype.getEventType=function(){return"cancel"};CancelEvent.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)};CancelEvent.prototype.toString=function(){return this.path.toString()+":cancel"};return CancelEvent}();exports.CancelEvent=CancelEvent},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var AckUserWrite_1=__webpack_require__(154);var ChildrenNode_1=__webpack_require__(5);var util_3=__webpack_require__(0);var ImmutableTree_1=__webpack_require__(46);var ListenComplete_1=__webpack_require__(155);var Merge_1=__webpack_require__(156);var Operation_1=__webpack_require__(13);var Overwrite_1=__webpack_require__(79);var Path_1=__webpack_require__(2);var SyncPoint_1=__webpack_require__(80);var WriteTree_1=__webpack_require__(162);var SyncTree=function(){function SyncTree(listenProvider_){this.listenProvider_=listenProvider_;this.syncPointTree_=ImmutableTree_1.ImmutableTree.Empty;this.pendingWriteTree_=new WriteTree_1.WriteTree;this.tagToQueryMap_={};this.queryToTagMap_={}}SyncTree.prototype.applyUserOverwrite=function(path,newData,writeId,visible){this.pendingWriteTree_.addOverwrite(path,newData,writeId,visible);if(!visible){return[]}else{return this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.User,path,newData))}};SyncTree.prototype.applyUserMerge=function(path,changedChildren,writeId){this.pendingWriteTree_.addMerge(path,changedChildren,writeId);var changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.User,path,changeTree))};SyncTree.prototype.ackUserWrite=function(writeId,revert){if(revert===void 0){revert=false}var write=this.pendingWriteTree_.getWrite(writeId);var needToReevaluate=this.pendingWriteTree_.removeWrite(writeId);if(!needToReevaluate){return[]}else{var affectedTree_1=ImmutableTree_1.ImmutableTree.Empty;if(write.snap!=null){affectedTree_1=affectedTree_1.set(Path_1.Path.Empty,true)}else{util_3.forEach(write.children,function(pathString,node){affectedTree_1=affectedTree_1.set(new Path_1.Path(pathString),node)})}return this.applyOperationToSyncPoints_(new AckUserWrite_1.AckUserWrite(write.path,affectedTree_1,revert))}};SyncTree.prototype.applyServerOverwrite=function(path,newData){return this.applyOperationToSyncPoints_(new Overwrite_1.Overwrite(Operation_1.OperationSource.Server,path,newData))};SyncTree.prototype.applyServerMerge=function(path,changedChildren){var changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren);return this.applyOperationToSyncPoints_(new Merge_1.Merge(Operation_1.OperationSource.Server,path,changeTree))};SyncTree.prototype.applyListenComplete=function(path){return this.applyOperationToSyncPoints_(new ListenComplete_1.ListenComplete(Operation_1.OperationSource.Server,path))};SyncTree.prototype.applyTaggedQueryOverwrite=function(path,snap,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey!=null){var r=SyncTree.parseQueryKey_(queryKey);var queryPath=r.path,queryId=r.queryId;var relativePath=Path_1.Path.relativePath(queryPath,path);var op=new Overwrite_1.Overwrite(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath,snap);return this.applyTaggedOperation_(queryPath,op)}else{return[]}};SyncTree.prototype.applyTaggedQueryMerge=function(path,changedChildren,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey);var queryPath=r.path,queryId=r.queryId;var relativePath=Path_1.Path.relativePath(queryPath,path);var changeTree=ImmutableTree_1.ImmutableTree.fromObject(changedChildren);var op=new Merge_1.Merge(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath,changeTree);return this.applyTaggedOperation_(queryPath,op)}else{return[]}};SyncTree.prototype.applyTaggedListenComplete=function(path,tag){var queryKey=this.queryKeyForTag_(tag);if(queryKey){var r=SyncTree.parseQueryKey_(queryKey);var queryPath=r.path,queryId=r.queryId;var relativePath=Path_1.Path.relativePath(queryPath,path);var op=new ListenComplete_1.ListenComplete(Operation_1.OperationSource.forServerTaggedQuery(queryId),relativePath);return this.applyTaggedOperation_(queryPath,op)}else{return[]}};SyncTree.prototype.addEventRegistration=function(query,eventRegistration){var path=query.path;var serverCache=null;var foundAncestorDefaultView=false;this.syncPointTree_.foreachOnPath(path,function(pathToSyncPoint,sp){var relativePath=Path_1.Path.relativePath(pathToSyncPoint,path);serverCache=serverCache||sp.getCompleteServerCache(relativePath);foundAncestorDefaultView=foundAncestorDefaultView||sp.hasCompleteView()});var syncPoint=this.syncPointTree_.get(path);if(!syncPoint){syncPoint=new SyncPoint_1.SyncPoint;this.syncPointTree_=this.syncPointTree_.set(path,syncPoint)}else{foundAncestorDefaultView=foundAncestorDefaultView||syncPoint.hasCompleteView();serverCache=serverCache||syncPoint.getCompleteServerCache(Path_1.Path.Empty)}var serverCacheComplete;if(serverCache!=null){serverCacheComplete=true}else{serverCacheComplete=false;serverCache=ChildrenNode_1.ChildrenNode.EMPTY_NODE;var subtree=this.syncPointTree_.subtree(path);subtree.foreachChild(function(childName,childSyncPoint){var completeCache=childSyncPoint.getCompleteServerCache(Path_1.Path.Empty);if(completeCache){serverCache=serverCache.updateImmediateChild(childName,completeCache)}})}var viewAlreadyExists=syncPoint.viewExistsForQuery(query);if(!viewAlreadyExists&&!query.getQueryParams().loadsAllData()){var queryKey=SyncTree.makeQueryKey_(query);util_1.assert(!(queryKey in this.queryToTagMap_),"View does not exist, but we have a tag");var tag=SyncTree.getNextQueryTag_();this.queryToTagMap_[queryKey]=tag;this.tagToQueryMap_["_"+tag]=queryKey}var writesCache=this.pendingWriteTree_.childWrites(path);var events=syncPoint.addEventRegistration(query,eventRegistration,writesCache,serverCache,serverCacheComplete);if(!viewAlreadyExists&&!foundAncestorDefaultView){var view=syncPoint.viewForQuery(query);events=events.concat(this.setupListener_(query,view))}return events};SyncTree.prototype.removeEventRegistration=function(query,eventRegistration,cancelError){var _this=this;var path=query.path;var maybeSyncPoint=this.syncPointTree_.get(path);var cancelEvents=[];if(maybeSyncPoint&&(query.queryIdentifier()==="default"||maybeSyncPoint.viewExistsForQuery(query))){var removedAndEvents=maybeSyncPoint.removeEventRegistration(query,eventRegistration,cancelError);if(maybeSyncPoint.isEmpty()){this.syncPointTree_=this.syncPointTree_.remove(path)}var removed=removedAndEvents.removed;cancelEvents=removedAndEvents.events;var removingDefault=-1!==removed.findIndex(function(query){return query.getQueryParams().loadsAllData()});var covered=this.syncPointTree_.findOnPath(path,function(relativePath,parentSyncPoint){return parentSyncPoint.hasCompleteView()});if(removingDefault&&!covered){var subtree=this.syncPointTree_.subtree(path);if(!subtree.isEmpty()){var newViews=this.collectDistinctViewsForSubTree_(subtree);for(var i=0;i<newViews.length;++i){var view=newViews[i],newQuery=view.getQuery();var listener=this.createListenerForView_(view);this.listenProvider_.startListening(SyncTree.queryForListening_(newQuery),this.tagForQuery_(newQuery),listener.hashFn,listener.onComplete)}}else{}}if(!covered&&removed.length>0&&!cancelError){if(removingDefault){var defaultTag=null;this.listenProvider_.stopListening(SyncTree.queryForListening_(query),defaultTag)}else{removed.forEach(function(queryToRemove){var tagToRemove=_this.queryToTagMap_[SyncTree.makeQueryKey_(queryToRemove)];_this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToRemove),tagToRemove)})}}this.removeTags_(removed)}else{}return cancelEvents};SyncTree.prototype.calcCompleteEventCache=function(path,writeIdsToExclude){var includeHiddenSets=true;var writeTree=this.pendingWriteTree_;var serverCache=this.syncPointTree_.findOnPath(path,function(pathSoFar,syncPoint){var relativePath=Path_1.Path.relativePath(pathSoFar,path);var serverCache=syncPoint.getCompleteServerCache(relativePath);if(serverCache){return serverCache}});return writeTree.calcCompleteEventCache(path,serverCache,writeIdsToExclude,includeHiddenSets)};SyncTree.prototype.collectDistinctViewsForSubTree_=function(subtree){return subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView()){var completeView=maybeChildSyncPoint.getCompleteView();return[completeView]}else{var views_1=[];if(maybeChildSyncPoint){views_1=maybeChildSyncPoint.getQueryViews()}util_3.forEach(childMap,function(key,childViews){views_1=views_1.concat(childViews)});return views_1}})};SyncTree.prototype.removeTags_=function(queries){for(var j=0;j<queries.length;++j){var removedQuery=queries[j];if(!removedQuery.getQueryParams().loadsAllData()){var removedQueryKey=SyncTree.makeQueryKey_(removedQuery);var removedQueryTag=this.queryToTagMap_[removedQueryKey];delete this.queryToTagMap_[removedQueryKey];delete this.tagToQueryMap_["_"+removedQueryTag]}}};SyncTree.queryForListening_=function(query){if(query.getQueryParams().loadsAllData()&&!query.getQueryParams().isDefault()){return query.getRef()}else{return query}};SyncTree.prototype.setupListener_=function(query,view){var path=query.path;var tag=this.tagForQuery_(query);var listener=this.createListenerForView_(view);var events=this.listenProvider_.startListening(SyncTree.queryForListening_(query),tag,listener.hashFn,listener.onComplete);var subtree=this.syncPointTree_.subtree(path);if(tag){util_1.assert(!subtree.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed")}else{var queriesToStop=subtree.fold(function(relativePath,maybeChildSyncPoint,childMap){if(!relativePath.isEmpty()&&maybeChildSyncPoint&&maybeChildSyncPoint.hasCompleteView()){return[maybeChildSyncPoint.getCompleteView().getQuery()]}else{var queries_1=[];if(maybeChildSyncPoint){queries_1=queries_1.concat(maybeChildSyncPoint.getQueryViews().map(function(view){return view.getQuery()}))}util_3.forEach(childMap,function(key,childQueries){queries_1=queries_1.concat(childQueries)});return queries_1}});for(var i=0;i<queriesToStop.length;++i){var queryToStop=queriesToStop[i];this.listenProvider_.stopListening(SyncTree.queryForListening_(queryToStop),this.tagForQuery_(queryToStop))}}return events};SyncTree.prototype.createListenerForView_=function(view){var _this=this;var query=view.getQuery();var tag=this.tagForQuery_(query);return{hashFn:function(){var cache=view.getServerCache()||ChildrenNode_1.ChildrenNode.EMPTY_NODE;return cache.hash()},onComplete:function(status){if(status==="ok"){if(tag){return _this.applyTaggedListenComplete(query.path,tag)}else{return _this.applyListenComplete(query.path)}}else{var error=util_2.errorForServerCode(status,query);return _this.removeEventRegistration(query,null,error)}}}};SyncTree.makeQueryKey_=function(query){return query.path.toString()+"$"+query.queryIdentifier()};SyncTree.parseQueryKey_=function(queryKey){var splitIndex=queryKey.indexOf("$");util_1.assert(splitIndex!==-1&&splitIndex<queryKey.length-1,"Bad queryKey.");return{queryId:queryKey.substr(splitIndex+1),path:new Path_1.Path(queryKey.substr(0,splitIndex))}};SyncTree.prototype.queryKeyForTag_=function(tag){return this.tagToQueryMap_["_"+tag]};SyncTree.prototype.tagForQuery_=function(query){var queryKey=SyncTree.makeQueryKey_(query);return util_3.safeGet(this.queryToTagMap_,queryKey)};SyncTree.getNextQueryTag_=function(){return SyncTree.nextQueryTag_++};SyncTree.prototype.applyTaggedOperation_=function(queryPath,operation){var syncPoint=this.syncPointTree_.get(queryPath);util_1.assert(syncPoint,"Missing sync point for query tag that we're tracking");var writesCache=this.pendingWriteTree_.childWrites(queryPath);return syncPoint.applyOperation(operation,writesCache,null)};SyncTree.prototype.applyOperationToSyncPoints_=function(operation){return this.applyOperationHelper_(operation,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Path_1.Path.Empty))};SyncTree.prototype.applyOperationHelper_=function(operation,syncPointTree,serverCache,writesCache){if(operation.path.isEmpty()){return this.applyOperationDescendantsHelper_(operation,syncPointTree,serverCache,writesCache)}else{var syncPoint=syncPointTree.get(Path_1.Path.Empty);if(serverCache==null&&syncPoint!=null){serverCache=syncPoint.getCompleteServerCache(Path_1.Path.Empty)}var events=[];var childName=operation.path.getFront();var childOperation=operation.operationForChild(childName);var childTree=syncPointTree.children.get(childName);if(childTree&&childOperation){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null;var childWritesCache=writesCache.child(childName)
;events=events.concat(this.applyOperationHelper_(childOperation,childTree,childServerCache,childWritesCache))}if(syncPoint){events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))}return events}};SyncTree.prototype.applyOperationDescendantsHelper_=function(operation,syncPointTree,serverCache,writesCache){var _this=this;var syncPoint=syncPointTree.get(Path_1.Path.Empty);if(serverCache==null&&syncPoint!=null){serverCache=syncPoint.getCompleteServerCache(Path_1.Path.Empty)}var events=[];syncPointTree.children.inorderTraversal(function(childName,childTree){var childServerCache=serverCache?serverCache.getImmediateChild(childName):null;var childWritesCache=writesCache.child(childName);var childOperation=operation.operationForChild(childName);if(childOperation){events=events.concat(_this.applyOperationDescendantsHelper_(childOperation,childTree,childServerCache,childWritesCache))}});if(syncPoint){events=events.concat(syncPoint.applyOperation(operation,writesCache,serverCache))}return events};SyncTree.nextQueryTag_=1;return SyncTree}();exports.SyncTree=SyncTree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Path_1=__webpack_require__(2);var Operation_1=__webpack_require__(13);var AckUserWrite=function(){function AckUserWrite(path,affectedTree,revert){this.path=path;this.affectedTree=affectedTree;this.revert=revert;this.type=Operation_1.OperationType.ACK_USER_WRITE;this.source=Operation_1.OperationSource.User}AckUserWrite.prototype.operationForChild=function(childName){if(!this.path.isEmpty()){util_1.assert(this.path.getFront()===childName,"operationForChild called for unrelated child.");return new AckUserWrite(this.path.popFront(),this.affectedTree,this.revert)}else if(this.affectedTree.value!=null){util_1.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths.");return this}else{var childTree=this.affectedTree.subtree(new Path_1.Path(childName));return new AckUserWrite(Path_1.Path.Empty,childTree,this.revert)}};return AckUserWrite}();exports.AckUserWrite=AckUserWrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Path_1=__webpack_require__(2);var Operation_1=__webpack_require__(13);var ListenComplete=function(){function ListenComplete(source,path){this.source=source;this.path=path;this.type=Operation_1.OperationType.LISTEN_COMPLETE}ListenComplete.prototype.operationForChild=function(childName){if(this.path.isEmpty()){return new ListenComplete(this.source,Path_1.Path.Empty)}else{return new ListenComplete(this.source,this.path.popFront())}};return ListenComplete}();exports.ListenComplete=ListenComplete},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Operation_1=__webpack_require__(13);var Overwrite_1=__webpack_require__(79);var Path_1=__webpack_require__(2);var util_1=__webpack_require__(0);var Merge=function(){function Merge(source,path,children){this.source=source;this.path=path;this.children=children;this.type=Operation_1.OperationType.MERGE}Merge.prototype.operationForChild=function(childName){if(this.path.isEmpty()){var childTree=this.children.subtree(new Path_1.Path(childName));if(childTree.isEmpty()){return null}else if(childTree.value){return new Overwrite_1.Overwrite(this.source,Path_1.Path.Empty,childTree.value)}else{return new Merge(this.source,Path_1.Path.Empty,childTree)}}else{util_1.assert(this.path.getFront()===childName,"Can't get a merge for a child not on the path of the operation");return new Merge(this.source,this.path.popFront(),this.children)}};Merge.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"};return Merge}();exports.Merge=Merge},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var IndexedFilter_1=__webpack_require__(47);var ViewProcessor_1=__webpack_require__(158);var ChildrenNode_1=__webpack_require__(5);var CacheNode_1=__webpack_require__(32);var ViewCache_1=__webpack_require__(81);var EventGenerator_1=__webpack_require__(161);var util_1=__webpack_require__(0);var Operation_1=__webpack_require__(13);var Change_1=__webpack_require__(16);var PriorityIndex_1=__webpack_require__(4);var View=function(){function View(query_,initialViewCache){this.query_=query_;this.eventRegistrations_=[];var params=this.query_.getQueryParams();var indexFilter=new IndexedFilter_1.IndexedFilter(params.getIndex());var filter=params.getNodeFilter();this.processor_=new ViewProcessor_1.ViewProcessor(filter);var initialServerCache=initialViewCache.getServerCache();var initialEventCache=initialViewCache.getEventCache();var serverSnap=indexFilter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,initialServerCache.getNode(),null);var eventSnap=filter.updateFullNode(ChildrenNode_1.ChildrenNode.EMPTY_NODE,initialEventCache.getNode(),null);var newServerCache=new CacheNode_1.CacheNode(serverSnap,initialServerCache.isFullyInitialized(),indexFilter.filtersNodes());var newEventCache=new CacheNode_1.CacheNode(eventSnap,initialEventCache.isFullyInitialized(),filter.filtersNodes());this.viewCache_=new ViewCache_1.ViewCache(newEventCache,newServerCache);this.eventGenerator_=new EventGenerator_1.EventGenerator(this.query_)}View.prototype.getQuery=function(){return this.query_};View.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()};View.prototype.getCompleteServerCache=function(path){var cache=this.viewCache_.getCompleteServerSnap();if(cache){if(this.query_.getQueryParams().loadsAllData()||!path.isEmpty()&&!cache.getImmediateChild(path.getFront()).isEmpty()){return cache.getChild(path)}}return null};View.prototype.isEmpty=function(){return this.eventRegistrations_.length===0};View.prototype.addEventRegistration=function(eventRegistration){this.eventRegistrations_.push(eventRegistration)};View.prototype.removeEventRegistration=function(eventRegistration,cancelError){var cancelEvents=[];if(cancelError){util_1.assert(eventRegistration==null,"A cancel should cancel all event registrations.");var path_1=this.query_.path;this.eventRegistrations_.forEach(function(registration){cancelError=cancelError;var maybeEvent=registration.createCancelEvent(cancelError,path_1);if(maybeEvent){cancelEvents.push(maybeEvent)}})}if(eventRegistration){var remaining=[];for(var i=0;i<this.eventRegistrations_.length;++i){var existing=this.eventRegistrations_[i];if(!existing.matches(eventRegistration)){remaining.push(existing)}else if(eventRegistration.hasAnyCallback()){remaining=remaining.concat(this.eventRegistrations_.slice(i+1));break}}this.eventRegistrations_=remaining}else{this.eventRegistrations_=[]}return cancelEvents};View.prototype.applyOperation=function(operation,writesCache,completeServerCache){if(operation.type===Operation_1.OperationType.MERGE&&operation.source.queryId!==null){util_1.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges");util_1.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache")}var oldViewCache=this.viewCache_;var result=this.processor_.applyOperation(oldViewCache,operation,writesCache,completeServerCache);this.processor_.assertIndexed(result.viewCache);util_1.assert(result.viewCache.getServerCache().isFullyInitialized()||!oldViewCache.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back");this.viewCache_=result.viewCache;return this.generateEventsForChanges_(result.changes,result.viewCache.getEventCache().getNode(),null)};View.prototype.getInitialEvents=function(registration){var eventSnap=this.viewCache_.getEventCache();var initialChanges=[];if(!eventSnap.getNode().isLeafNode()){var eventNode=eventSnap.getNode();eventNode.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(key,childNode){initialChanges.push(Change_1.Change.childAddedChange(key,childNode))})}if(eventSnap.isFullyInitialized()){initialChanges.push(Change_1.Change.valueChange(eventSnap.getNode()))}return this.generateEventsForChanges_(initialChanges,eventSnap.getNode(),registration)};View.prototype.generateEventsForChanges_=function(changes,eventCache,eventRegistration){var registrations=eventRegistration?[eventRegistration]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(changes,eventCache,registrations)};return View}();exports.View=View},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Operation_1=__webpack_require__(13);var util_1=__webpack_require__(0);var ChildChangeAccumulator_1=__webpack_require__(159);var Change_1=__webpack_require__(16);var ChildrenNode_1=__webpack_require__(5);var KeyIndex_1=__webpack_require__(21);var ImmutableTree_1=__webpack_require__(46);var Path_1=__webpack_require__(2);var CompleteChildSource_1=__webpack_require__(160);var ProcessorResult=function(){function ProcessorResult(viewCache,changes){this.viewCache=viewCache;this.changes=changes}return ProcessorResult}();exports.ProcessorResult=ProcessorResult;var ViewProcessor=function(){function ViewProcessor(filter_){this.filter_=filter_}ViewProcessor.prototype.assertIndexed=function(viewCache){util_1.assert(viewCache.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed");util_1.assert(viewCache.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")};ViewProcessor.prototype.applyOperation=function(oldViewCache,operation,writesCache,completeCache){var accumulator=new ChildChangeAccumulator_1.ChildChangeAccumulator;var newViewCache,filterServerNode;if(operation.type===Operation_1.OperationType.OVERWRITE){var overwrite=operation;if(overwrite.source.fromUser){newViewCache=this.applyUserOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,accumulator)}else{util_1.assert(overwrite.source.fromServer,"Unknown source.");filterServerNode=overwrite.source.tagged||oldViewCache.getServerCache().isFiltered()&&!overwrite.path.isEmpty();newViewCache=this.applyServerOverwrite_(oldViewCache,overwrite.path,overwrite.snap,writesCache,completeCache,filterServerNode,accumulator)}}else if(operation.type===Operation_1.OperationType.MERGE){var merge=operation;if(merge.source.fromUser){newViewCache=this.applyUserMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,accumulator)}else{util_1.assert(merge.source.fromServer,"Unknown source.");filterServerNode=merge.source.tagged||oldViewCache.getServerCache().isFiltered();newViewCache=this.applyServerMerge_(oldViewCache,merge.path,merge.children,writesCache,completeCache,filterServerNode,accumulator)}}else if(operation.type===Operation_1.OperationType.ACK_USER_WRITE){var ackUserWrite=operation;if(!ackUserWrite.revert){newViewCache=this.ackUserWrite_(oldViewCache,ackUserWrite.path,ackUserWrite.affectedTree,writesCache,completeCache,accumulator)}else{newViewCache=this.revertUserWrite_(oldViewCache,ackUserWrite.path,writesCache,completeCache,accumulator)}}else if(operation.type===Operation_1.OperationType.LISTEN_COMPLETE){newViewCache=this.listenComplete_(oldViewCache,operation.path,writesCache,accumulator)}else{throw util_1.assertionError("Unknown operation type: "+operation.type)}var changes=accumulator.getChanges();ViewProcessor.maybeAddValueEvent_(oldViewCache,newViewCache,changes);return new ProcessorResult(newViewCache,changes)};ViewProcessor.maybeAddValueEvent_=function(oldViewCache,newViewCache,accumulator){var eventSnap=newViewCache.getEventCache();if(eventSnap.isFullyInitialized()){var isLeafOrEmpty=eventSnap.getNode().isLeafNode()||eventSnap.getNode().isEmpty();var oldCompleteSnap=oldViewCache.getCompleteEventSnap();if(accumulator.length>0||!oldViewCache.getEventCache().isFullyInitialized()||isLeafOrEmpty&&!eventSnap.getNode().equals(oldCompleteSnap)||!eventSnap.getNode().getPriority().equals(oldCompleteSnap.getPriority())){accumulator.push(Change_1.Change.valueChange(newViewCache.getCompleteEventSnap()))}}};ViewProcessor.prototype.generateEventCacheAfterServerEvent_=function(viewCache,changePath,writesCache,source,accumulator){var oldEventSnap=viewCache.getEventCache();if(writesCache.shadowingWrite(changePath)!=null){return viewCache}else{var newEventCache=void 0,serverNode=void 0;if(changePath.isEmpty()){util_1.assert(viewCache.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data");if(viewCache.getServerCache().isFiltered()){var serverCache=viewCache.getCompleteServerSnap();var completeChildren=serverCache instanceof ChildrenNode_1.ChildrenNode?serverCache:ChildrenNode_1.ChildrenNode.EMPTY_NODE;var completeEventChildren=writesCache.calcCompleteEventChildren(completeChildren);newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeEventChildren,accumulator)}else{var completeNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());newEventCache=this.filter_.updateFullNode(viewCache.getEventCache().getNode(),completeNode,accumulator)}}else{var childKey=changePath.getFront();if(childKey==".priority"){util_1.assert(changePath.getLength()==1,"Can't have a priority with additional path components");var oldEventNode=oldEventSnap.getNode();serverNode=viewCache.getServerCache().getNode();var updatedPriority=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventNode,serverNode);if(updatedPriority!=null){newEventCache=this.filter_.updatePriority(oldEventNode,updatedPriority)}else{newEventCache=oldEventSnap.getNode()}}else{var childChangePath=changePath.popFront();var newEventChild=void 0;if(oldEventSnap.isCompleteForChild(childKey)){serverNode=viewCache.getServerCache().getNode();var eventChildUpdate=writesCache.calcEventCacheAfterServerOverwrite(changePath,oldEventSnap.getNode(),serverNode);if(eventChildUpdate!=null){newEventChild=oldEventSnap.getNode().getImmediateChild(childKey).updateChild(childChangePath,eventChildUpdate)}else{newEventChild=oldEventSnap.getNode().getImmediateChild(childKey)}}else{newEventChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache())}if(newEventChild!=null){newEventCache=this.filter_.updateChild(oldEventSnap.getNode(),childKey,newEventChild,childChangePath,source,accumulator)}else{newEventCache=oldEventSnap.getNode()}}}return viewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized()||changePath.isEmpty(),this.filter_.filtersNodes())}};ViewProcessor.prototype.applyServerOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,filterServerNode,accumulator){var oldServerSnap=oldViewCache.getServerCache();var newServerCache;var serverFilter=filterServerNode?this.filter_:this.filter_.getIndexedFilter();if(changePath.isEmpty()){newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),changedSnap,null)}else if(serverFilter.filtersNodes()&&!oldServerSnap.isFiltered()){var newServerNode=oldServerSnap.getNode().updateChild(changePath,changedSnap);newServerCache=serverFilter.updateFullNode(oldServerSnap.getNode(),newServerNode,null)}else{var childKey=changePath.getFront();if(!oldServerSnap.isCompleteForPath(changePath)&&changePath.getLength()>1){return oldViewCache}var childChangePath=changePath.popFront();var childNode=oldServerSnap.getNode().getImmediateChild(childKey);var newChildNode=childNode.updateChild(childChangePath,changedSnap);if(childKey==".priority"){newServerCache=serverFilter.updatePriority(oldServerSnap.getNode(),newChildNode)}else{newServerCache=serverFilter.updateChild(oldServerSnap.getNode(),childKey,newChildNode,childChangePath,CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE,null)}}var newViewCache=oldViewCache.updateServerSnap(newServerCache,oldServerSnap.isFullyInitialized()||changePath.isEmpty(),serverFilter.filtersNodes());var source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,newViewCache,completeCache);return this.generateEventCacheAfterServerEvent_(newViewCache,changePath,writesCache,source,accumulator)};ViewProcessor.prototype.applyUserOverwrite_=function(oldViewCache,changePath,changedSnap,writesCache,completeCache,accumulator){var oldEventSnap=oldViewCache.getEventCache();var newViewCache,newEventCache;var source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,oldViewCache,completeCache);if(changePath.isEmpty()){newEventCache=this.filter_.updateFullNode(oldViewCache.getEventCache().getNode(),changedSnap,accumulator);newViewCache=oldViewCache.updateEventSnap(newEventCache,true,this.filter_.filtersNodes())}else{var childKey=changePath.getFront();if(childKey===".priority"){newEventCache=this.filter_.updatePriority(oldViewCache.getEventCache().getNode(),changedSnap);newViewCache=oldViewCache.updateEventSnap(newEventCache,oldEventSnap.isFullyInitialized(),oldEventSnap.isFiltered())}else{var childChangePath=changePath.popFront();var oldChild=oldEventSnap.getNode().getImmediateChild(childKey);var newChild=void 0;if(childChangePath.isEmpty()){newChild=changedSnap}else{var childNode=source.getCompleteChild(childKey);if(childNode!=null){if(childChangePath.getBack()===".priority"&&childNode.getChild(childChangePath.parent()).isEmpty()){newChild=childNode}else{newChild=childNode.updateChild(childChangePath,changedSnap)}}else{newChild=ChildrenNode_1.ChildrenNode.EMPTY_NODE}}if(!oldChild.equals(newChild)){var newEventSnap=this.filter_.updateChild(oldEventSnap.getNode(),childKey,newChild,childChangePath,source,accumulator);newViewCache=oldViewCache.updateEventSnap(newEventSnap,oldEventSnap.isFullyInitialized(),this.filter_.filtersNodes())}else{newViewCache=oldViewCache}}}return newViewCache};ViewProcessor.cacheHasChild_=function(viewCache,childKey){return viewCache.getEventCache().isCompleteForChild(childKey)};ViewProcessor.prototype.applyUserMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,accumulator){var _this=this;var curViewCache=viewCache;changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);if(ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())){curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator)}});changedChildren.foreach(function(relativePath,childNode){var writePath=path.child(relativePath);if(!ViewProcessor.cacheHasChild_(viewCache,writePath.getFront())){curViewCache=_this.applyUserOverwrite_(curViewCache,writePath,childNode,writesCache,serverCache,accumulator)}});return curViewCache};ViewProcessor.prototype.applyMerge_=function(node,merge){merge.foreach(function(relativePath,childNode){node=node.updateChild(relativePath,childNode)});return node};ViewProcessor.prototype.applyServerMerge_=function(viewCache,path,changedChildren,writesCache,serverCache,filterServerNode,accumulator){var _this=this;if(viewCache.getServerCache().getNode().isEmpty()&&!viewCache.getServerCache().isFullyInitialized()){return viewCache}var curViewCache=viewCache;var viewMergeTree;if(path.isEmpty()){viewMergeTree=changedChildren}else{viewMergeTree=ImmutableTree_1.ImmutableTree.Empty.setTree(path,changedChildren)}var serverNode=viewCache.getServerCache().getNode();viewMergeTree.children.inorderTraversal(function(childKey,childTree){if(serverNode.hasChild(childKey)){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey);var newChild=_this.applyMerge_(serverChild,childTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path_1.Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}});viewMergeTree.children.inorderTraversal(function(childKey,childMergeTree){var isUnknownDeepMerge=!viewCache.getServerCache().isCompleteForChild(childKey)&&childMergeTree.value==null;if(!serverNode.hasChild(childKey)&&!isUnknownDeepMerge){var serverChild=viewCache.getServerCache().getNode().getImmediateChild(childKey);var newChild=_this.applyMerge_(serverChild,childMergeTree);curViewCache=_this.applyServerOverwrite_(curViewCache,new Path_1.Path(childKey),newChild,writesCache,serverCache,filterServerNode,accumulator)}});return curViewCache};ViewProcessor.prototype.ackUserWrite_=function(viewCache,ackPath,affectedTree,writesCache,completeCache,accumulator){if(writesCache.shadowingWrite(ackPath)!=null){return viewCache}var filterServerNode=viewCache.getServerCache().isFiltered();var serverCache=viewCache.getServerCache();if(affectedTree.value!=null){if(ackPath.isEmpty()&&serverCache.isFullyInitialized()||serverCache.isCompleteForPath(ackPath)){return this.applyServerOverwrite_(viewCache,ackPath,serverCache.getNode().getChild(ackPath),writesCache,completeCache,filterServerNode,accumulator)}else if(ackPath.isEmpty()){var changedChildren_1=ImmutableTree_1.ImmutableTree.Empty;serverCache.getNode().forEachChild(KeyIndex_1.KEY_INDEX,function(name,node){changedChildren_1=changedChildren_1.set(new Path_1.Path(name),node)});return this.applyServerMerge_(viewCache,ackPath,changedChildren_1,writesCache,completeCache,filterServerNode,accumulator)}else{return viewCache}}else{var changedChildren_2=ImmutableTree_1.ImmutableTree.Empty;affectedTree.foreach(function(mergePath,value){var serverCachePath=ackPath.child(mergePath);if(serverCache.isCompleteForPath(serverCachePath)){changedChildren_2=changedChildren_2.set(mergePath,serverCache.getNode().getChild(serverCachePath))}});return this.applyServerMerge_(viewCache,ackPath,changedChildren_2,writesCache,completeCache,filterServerNode,accumulator)}};ViewProcessor.prototype.listenComplete_=function(viewCache,path,writesCache,accumulator){var oldServerNode=viewCache.getServerCache();var newViewCache=viewCache.updateServerSnap(oldServerNode.getNode(),oldServerNode.isFullyInitialized()||path.isEmpty(),oldServerNode.isFiltered());return this.generateEventCacheAfterServerEvent_(newViewCache,path,writesCache,CompleteChildSource_1.NO_COMPLETE_CHILD_SOURCE,accumulator)};ViewProcessor.prototype.revertUserWrite_=function(viewCache,path,writesCache,completeServerCache,accumulator){var complete;if(writesCache.shadowingWrite(path)!=null){return viewCache}else{var source=new CompleteChildSource_1.WriteTreeCompleteChildSource(writesCache,viewCache,completeServerCache);var oldEventCache=viewCache.getEventCache().getNode();var newEventCache=void 0;if(path.isEmpty()||path.getFront()===".priority"){var newNode=void 0;if(viewCache.getServerCache().isFullyInitialized()){newNode=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap())}else{var serverChildren=viewCache.getServerCache().getNode();util_1.assert(serverChildren instanceof ChildrenNode_1.ChildrenNode,"serverChildren would be complete if leaf node");newNode=writesCache.calcCompleteEventChildren(serverChildren)}newNode=newNode;newEventCache=this.filter_.updateFullNode(oldEventCache,newNode,accumulator)}else{var childKey=path.getFront();var newChild=writesCache.calcCompleteChild(childKey,viewCache.getServerCache());if(newChild==null&&viewCache.getServerCache().isCompleteForChild(childKey)){newChild=oldEventCache.getImmediateChild(childKey)}if(newChild!=null){newEventCache=this.filter_.updateChild(oldEventCache,childKey,newChild,path.popFront(),source,accumulator)}else if(viewCache.getEventCache().getNode().hasChild(childKey)){newEventCache=this.filter_.updateChild(oldEventCache,childKey,ChildrenNode_1.ChildrenNode.EMPTY_NODE,path.popFront(),source,accumulator)}else{newEventCache=oldEventCache}if(newEventCache.isEmpty()&&viewCache.getServerCache().isFullyInitialized()){complete=writesCache.calcCompleteEventCache(viewCache.getCompleteServerSnap());if(complete.isLeafNode()){newEventCache=this.filter_.updateFullNode(newEventCache,complete,accumulator)}}}complete=viewCache.getServerCache().isFullyInitialized()||writesCache.shadowingWrite(Path_1.Path.Empty)!=null;return viewCache.updateEventSnap(newEventCache,complete,this.filter_.filtersNodes())}};return ViewProcessor}();exports.ViewProcessor=ViewProcessor},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Change_1=__webpack_require__(16);var util_2=__webpack_require__(0);var ChildChangeAccumulator=function(){function ChildChangeAccumulator(){this.changeMap_={}}ChildChangeAccumulator.prototype.trackChildChange=function(change){var type=change.type;var childKey=change.childName;util_2.assert(type==Change_1.Change.CHILD_ADDED||type==Change_1.Change.CHILD_CHANGED||type==Change_1.Change.CHILD_REMOVED,"Only child changes supported for tracking");util_2.assert(childKey!==".priority","Only non-priority child changes can be tracked.");var oldChange=util_1.safeGet(this.changeMap_,childKey);if(oldChange){var oldType=oldChange.type;if(type==Change_1.Change.CHILD_ADDED&&oldType==Change_1.Change.CHILD_REMOVED){this.changeMap_[childKey]=Change_1.Change.childChangedChange(childKey,change.snapshotNode,oldChange.snapshotNode)}else if(type==Change_1.Change.CHILD_REMOVED&&oldType==Change_1.Change.CHILD_ADDED){delete this.changeMap_[childKey]}else if(type==Change_1.Change.CHILD_REMOVED&&oldType==Change_1.Change.CHILD_CHANGED){this.changeMap_[childKey]=Change_1.Change.childRemovedChange(childKey,oldChange.oldSnap)}else if(type==Change_1.Change.CHILD_CHANGED&&oldType==Change_1.Change.CHILD_ADDED){this.changeMap_[childKey]=Change_1.Change.childAddedChange(childKey,change.snapshotNode)}else if(type==Change_1.Change.CHILD_CHANGED&&oldType==Change_1.Change.CHILD_CHANGED){this.changeMap_[childKey]=Change_1.Change.childChangedChange(childKey,change.snapshotNode,oldChange.oldSnap)}else{throw util_2.assertionError("Illegal combination of changes: "+change+" occurred after "+oldChange)}}else{this.changeMap_[childKey]=change}};ChildChangeAccumulator.prototype.getChanges=function(){return util_1.getValues(this.changeMap_)};return ChildChangeAccumulator}();exports.ChildChangeAccumulator=ChildChangeAccumulator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var CacheNode_1=__webpack_require__(32);var NoCompleteChildSource_=function(){function NoCompleteChildSource_(){}NoCompleteChildSource_.prototype.getCompleteChild=function(childKey){return null};NoCompleteChildSource_.prototype.getChildAfterChild=function(index,child,reverse){return null};return NoCompleteChildSource_}();exports.NoCompleteChildSource_=NoCompleteChildSource_;exports.NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;var WriteTreeCompleteChildSource=function(){function WriteTreeCompleteChildSource(writes_,viewCache_,optCompleteServerCache_){if(optCompleteServerCache_===void 0){optCompleteServerCache_=null}this.writes_=writes_;this.viewCache_=viewCache_;this.optCompleteServerCache_=optCompleteServerCache_}WriteTreeCompleteChildSource.prototype.getCompleteChild=function(childKey){var node=this.viewCache_.getEventCache();if(node.isCompleteForChild(childKey)){return node.getNode().getImmediateChild(childKey)}else{var serverNode=this.optCompleteServerCache_!=null?new CacheNode_1.CacheNode(this.optCompleteServerCache_,true,false):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(childKey,serverNode)}};WriteTreeCompleteChildSource.prototype.getChildAfterChild=function(index,child,reverse){var completeServerData=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap();var nodes=this.writes_.calcIndexedSlice(completeServerData,child,1,reverse,index);if(nodes.length===0){return null}else{return nodes[0]}};return WriteTreeCompleteChildSource}();exports.WriteTreeCompleteChildSource=WriteTreeCompleteChildSource},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var Node_1=__webpack_require__(6);var Change_1=__webpack_require__(16);var util_1=__webpack_require__(0);var EventGenerator=function(){function EventGenerator(query_){this.query_=query_;this.index_=this.query_.getQueryParams().getIndex()}EventGenerator.prototype.generateEventsForChanges=function(changes,eventCache,eventRegistrations){var _this=this;var events=[];var moves=[];changes.forEach(function(change){if(change.type===Change_1.Change.CHILD_CHANGED&&_this.index_.indexedValueChanged(change.oldSnap,change.snapshotNode)){moves.push(Change_1.Change.childMovedChange(change.childName,change.snapshotNode))}});this.generateEventsForType_(events,Change_1.Change.CHILD_REMOVED,changes,eventRegistrations,eventCache);this.generateEventsForType_(events,Change_1.Change.CHILD_ADDED,changes,eventRegistrations,eventCache);this.generateEventsForType_(events,Change_1.Change.CHILD_MOVED,moves,eventRegistrations,eventCache);this.generateEventsForType_(events,Change_1.Change.CHILD_CHANGED,changes,eventRegistrations,eventCache);this.generateEventsForType_(events,Change_1.Change.VALUE,changes,eventRegistrations,eventCache);return events};EventGenerator.prototype.generateEventsForType_=function(events,eventType,changes,registrations,eventCache){var _this=this;var filteredChanges=changes.filter(function(change){return change.type===eventType});filteredChanges.sort(this.compareChanges_.bind(this));filteredChanges.forEach(function(change){var materializedChange=_this.materializeSingleChange_(change,eventCache);registrations.forEach(function(registration){if(registration.respondsTo(change.type)){events.push(registration.createEvent(materializedChange,_this.query_))}})})};EventGenerator.prototype.materializeSingleChange_=function(change,eventCache){if(change.type==="value"||change.type==="child_removed"){return change}else{change.prevName=eventCache.getPredecessorChildName(change.childName,change.snapshotNode,this.index_);return change}};EventGenerator.prototype.compareChanges_=function(a,b){if(a.childName==null||b.childName==null){throw util_1.assertionError("Should only compare child_ events.")}var aWrapped=new Node_1.NamedNode(a.childName,a.snapshotNode);var bWrapped=new Node_1.NamedNode(b.childName,b.snapshotNode);return this.index_.compare(aWrapped,bWrapped)};return EventGenerator}();exports.EventGenerator=EventGenerator},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var Path_1=__webpack_require__(2);var CompoundWrite_1=__webpack_require__(163);var PriorityIndex_1=__webpack_require__(4);var ChildrenNode_1=__webpack_require__(5);var WriteTree=function(){function WriteTree(){this.visibleWrites_=CompoundWrite_1.CompoundWrite.Empty;this.allWrites_=[];this.lastWriteId_=-1}WriteTree.prototype.childWrites=function(path){return new WriteTreeRef(path,this)};WriteTree.prototype.addOverwrite=function(path,snap,writeId,visible){util_2.assert(writeId>this.lastWriteId_,"Stacking an older write on top of newer ones");if(visible===undefined){visible=true}this.allWrites_.push({path:path,snap:snap,writeId:writeId,visible:visible});if(visible){this.visibleWrites_=this.visibleWrites_.addWrite(path,snap)}this.lastWriteId_=writeId};WriteTree.prototype.addMerge=function(path,changedChildren,writeId){util_2.assert(writeId>this.lastWriteId_,"Stacking an older merge on top of newer ones");this.allWrites_.push({path:path,children:changedChildren,writeId:writeId,visible:true});this.visibleWrites_=this.visibleWrites_.addWrites(path,changedChildren);this.lastWriteId_=writeId};WriteTree.prototype.getWrite=function(writeId){for(var i=0;i<this.allWrites_.length;i++){var record=this.allWrites_[i];if(record.writeId===writeId){return record}}return null};WriteTree.prototype.removeWrite=function(writeId){var _this=this;var idx=this.allWrites_.findIndex(function(s){return s.writeId===writeId});util_2.assert(idx>=0,"removeWrite called with nonexistent writeId.");var writeToRemove=this.allWrites_[idx]
;this.allWrites_.splice(idx,1);var removedWriteWasVisible=writeToRemove.visible;var removedWriteOverlapsWithOtherWrites=false;var i=this.allWrites_.length-1;while(removedWriteWasVisible&&i>=0){var currentWrite=this.allWrites_[i];if(currentWrite.visible){if(i>=idx&&this.recordContainsPath_(currentWrite,writeToRemove.path)){removedWriteWasVisible=false}else if(writeToRemove.path.contains(currentWrite.path)){removedWriteOverlapsWithOtherWrites=true}}i--}if(!removedWriteWasVisible){return false}else if(removedWriteOverlapsWithOtherWrites){this.resetTree_();return true}else{if(writeToRemove.snap){this.visibleWrites_=this.visibleWrites_.removeWrite(writeToRemove.path)}else{var children=writeToRemove.children;util_1.forEach(children,function(childName){_this.visibleWrites_=_this.visibleWrites_.removeWrite(writeToRemove.path.child(childName))})}return true}};WriteTree.prototype.getCompleteWriteData=function(path){return this.visibleWrites_.getCompleteNode(path)};WriteTree.prototype.calcCompleteEventCache=function(treePath,completeServerCache,writeIdsToExclude,includeHiddenWrites){if(!writeIdsToExclude&&!includeHiddenWrites){var shadowingNode=this.visibleWrites_.getCompleteNode(treePath);if(shadowingNode!=null){return shadowingNode}else{var subMerge=this.visibleWrites_.childCompoundWrite(treePath);if(subMerge.isEmpty()){return completeServerCache}else if(completeServerCache==null&&!subMerge.hasCompleteWrite(Path_1.Path.Empty)){return null}else{var layeredCache=completeServerCache||ChildrenNode_1.ChildrenNode.EMPTY_NODE;return subMerge.apply(layeredCache)}}}else{var merge=this.visibleWrites_.childCompoundWrite(treePath);if(!includeHiddenWrites&&merge.isEmpty()){return completeServerCache}else{if(!includeHiddenWrites&&completeServerCache==null&&!merge.hasCompleteWrite(Path_1.Path.Empty)){return null}else{var filter=function(write){return(write.visible||includeHiddenWrites)&&(!writeIdsToExclude||!~writeIdsToExclude.indexOf(write.writeId))&&(write.path.contains(treePath)||treePath.contains(write.path))};var mergeAtPath=WriteTree.layerTree_(this.allWrites_,filter,treePath);var layeredCache=completeServerCache||ChildrenNode_1.ChildrenNode.EMPTY_NODE;return mergeAtPath.apply(layeredCache)}}}};WriteTree.prototype.calcCompleteEventChildren=function(treePath,completeServerChildren){var completeChildren=ChildrenNode_1.ChildrenNode.EMPTY_NODE;var topLevelSet=this.visibleWrites_.getCompleteNode(treePath);if(topLevelSet){if(!topLevelSet.isLeafNode()){topLevelSet.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childSnap){completeChildren=completeChildren.updateImmediateChild(childName,childSnap)})}return completeChildren}else if(completeServerChildren){var merge_1=this.visibleWrites_.childCompoundWrite(treePath);completeServerChildren.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){var node=merge_1.childCompoundWrite(new Path_1.Path(childName)).apply(childNode);completeChildren=completeChildren.updateImmediateChild(childName,node)});merge_1.getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)});return completeChildren}else{var merge=this.visibleWrites_.childCompoundWrite(treePath);merge.getCompleteChildren().forEach(function(namedNode){completeChildren=completeChildren.updateImmediateChild(namedNode.name,namedNode.node)});return completeChildren}};WriteTree.prototype.calcEventCacheAfterServerOverwrite=function(treePath,childPath,existingEventSnap,existingServerSnap){util_2.assert(existingEventSnap||existingServerSnap,"Either existingEventSnap or existingServerSnap must exist");var path=treePath.child(childPath);if(this.visibleWrites_.hasCompleteWrite(path)){return null}else{var childMerge=this.visibleWrites_.childCompoundWrite(path);if(childMerge.isEmpty()){return existingServerSnap.getChild(childPath)}else{return childMerge.apply(existingServerSnap.getChild(childPath))}}};WriteTree.prototype.calcCompleteChild=function(treePath,childKey,existingServerSnap){var path=treePath.child(childKey);var shadowingNode=this.visibleWrites_.getCompleteNode(path);if(shadowingNode!=null){return shadowingNode}else{if(existingServerSnap.isCompleteForChild(childKey)){var childMerge=this.visibleWrites_.childCompoundWrite(path);return childMerge.apply(existingServerSnap.getNode().getImmediateChild(childKey))}else{return null}}};WriteTree.prototype.shadowingWrite=function(path){return this.visibleWrites_.getCompleteNode(path)};WriteTree.prototype.calcIndexedSlice=function(treePath,completeServerData,startPost,count,reverse,index){var toIterate;var merge=this.visibleWrites_.childCompoundWrite(treePath);var shadowingNode=merge.getCompleteNode(Path_1.Path.Empty);if(shadowingNode!=null){toIterate=shadowingNode}else if(completeServerData!=null){toIterate=merge.apply(completeServerData)}else{return[]}toIterate=toIterate.withIndex(index);if(!toIterate.isEmpty()&&!toIterate.isLeafNode()){var nodes=[];var cmp=index.getCompare();var iter=reverse?toIterate.getReverseIteratorFrom(startPost,index):toIterate.getIteratorFrom(startPost,index);var next=iter.getNext();while(next&&nodes.length<count){if(cmp(next,startPost)!==0){nodes.push(next)}next=iter.getNext()}return nodes}else{return[]}};WriteTree.prototype.recordContainsPath_=function(writeRecord,path){if(writeRecord.snap){return writeRecord.path.contains(path)}else{return!!util_1.findKey(writeRecord.children,function(childSnap,childName){return writeRecord.path.child(childName).contains(path)})}};WriteTree.prototype.resetTree_=function(){this.visibleWrites_=WriteTree.layerTree_(this.allWrites_,WriteTree.DefaultFilter_,Path_1.Path.Empty);if(this.allWrites_.length>0){this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId}else{this.lastWriteId_=-1}};WriteTree.DefaultFilter_=function(write){return write.visible};WriteTree.layerTree_=function(writes,filter,treeRoot){var compoundWrite=CompoundWrite_1.CompoundWrite.Empty;for(var i=0;i<writes.length;++i){var write=writes[i];if(filter(write)){var writePath=write.path;var relativePath=void 0;if(write.snap){if(treeRoot.contains(writePath)){relativePath=Path_1.Path.relativePath(treeRoot,writePath);compoundWrite=compoundWrite.addWrite(relativePath,write.snap)}else if(writePath.contains(treeRoot)){relativePath=Path_1.Path.relativePath(writePath,treeRoot);compoundWrite=compoundWrite.addWrite(Path_1.Path.Empty,write.snap.getChild(relativePath))}else{}}else if(write.children){if(treeRoot.contains(writePath)){relativePath=Path_1.Path.relativePath(treeRoot,writePath);compoundWrite=compoundWrite.addWrites(relativePath,write.children)}else if(writePath.contains(treeRoot)){relativePath=Path_1.Path.relativePath(writePath,treeRoot);if(relativePath.isEmpty()){compoundWrite=compoundWrite.addWrites(Path_1.Path.Empty,write.children)}else{var child=util_1.safeGet(write.children,relativePath.getFront());if(child){var deepNode=child.getChild(relativePath.popFront());compoundWrite=compoundWrite.addWrite(Path_1.Path.Empty,deepNode)}}}else{}}else{throw util_2.assertionError("WriteRecord should have .snap or .children")}}}return compoundWrite};return WriteTree}();exports.WriteTree=WriteTree;var WriteTreeRef=function(){function WriteTreeRef(path,writeTree){this.treePath_=path;this.writeTree_=writeTree}WriteTreeRef.prototype.calcCompleteEventCache=function(completeServerCache,writeIdsToExclude,includeHiddenWrites){return this.writeTree_.calcCompleteEventCache(this.treePath_,completeServerCache,writeIdsToExclude,includeHiddenWrites)};WriteTreeRef.prototype.calcCompleteEventChildren=function(completeServerChildren){return this.writeTree_.calcCompleteEventChildren(this.treePath_,completeServerChildren)};WriteTreeRef.prototype.calcEventCacheAfterServerOverwrite=function(path,existingEventSnap,existingServerSnap){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,path,existingEventSnap,existingServerSnap)};WriteTreeRef.prototype.shadowingWrite=function(path){return this.writeTree_.shadowingWrite(this.treePath_.child(path))};WriteTreeRef.prototype.calcIndexedSlice=function(completeServerData,startPost,count,reverse,index){return this.writeTree_.calcIndexedSlice(this.treePath_,completeServerData,startPost,count,reverse,index)};WriteTreeRef.prototype.calcCompleteChild=function(childKey,existingServerCache){return this.writeTree_.calcCompleteChild(this.treePath_,childKey,existingServerCache)};WriteTreeRef.prototype.child=function(childName){return new WriteTreeRef(this.treePath_.child(childName),this.writeTree_)};return WriteTreeRef}();exports.WriteTreeRef=WriteTreeRef},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ImmutableTree_1=__webpack_require__(46);var Path_1=__webpack_require__(2);var util_1=__webpack_require__(0);var Node_1=__webpack_require__(6);var PriorityIndex_1=__webpack_require__(4);var util_2=__webpack_require__(0);var CompoundWrite=function(){function CompoundWrite(writeTree_){this.writeTree_=writeTree_}CompoundWrite.prototype.addWrite=function(path,node){if(path.isEmpty()){return new CompoundWrite(new ImmutableTree_1.ImmutableTree(node))}else{var rootmost=this.writeTree_.findRootMostValueAndPath(path);if(rootmost!=null){var rootMostPath=rootmost.path;var value=rootmost.value;var relativePath=Path_1.Path.relativePath(rootMostPath,path);value=value.updateChild(relativePath,node);return new CompoundWrite(this.writeTree_.set(rootMostPath,value))}else{var subtree=new ImmutableTree_1.ImmutableTree(node);var newWriteTree=this.writeTree_.setTree(path,subtree);return new CompoundWrite(newWriteTree)}}};CompoundWrite.prototype.addWrites=function(path,updates){var newWrite=this;util_1.forEach(updates,function(childKey,node){newWrite=newWrite.addWrite(path.child(childKey),node)});return newWrite};CompoundWrite.prototype.removeWrite=function(path){if(path.isEmpty()){return CompoundWrite.Empty}else{var newWriteTree=this.writeTree_.setTree(path,ImmutableTree_1.ImmutableTree.Empty);return new CompoundWrite(newWriteTree)}};CompoundWrite.prototype.hasCompleteWrite=function(path){return this.getCompleteNode(path)!=null};CompoundWrite.prototype.getCompleteNode=function(path){var rootmost=this.writeTree_.findRootMostValueAndPath(path);if(rootmost!=null){return this.writeTree_.get(rootmost.path).getChild(Path_1.Path.relativePath(rootmost.path,path))}else{return null}};CompoundWrite.prototype.getCompleteChildren=function(){var children=[];var node=this.writeTree_.value;if(node!=null){if(!node.isLeafNode()){node.forEachChild(PriorityIndex_1.PRIORITY_INDEX,function(childName,childNode){children.push(new Node_1.NamedNode(childName,childNode))})}}else{this.writeTree_.children.inorderTraversal(function(childName,childTree){if(childTree.value!=null){children.push(new Node_1.NamedNode(childName,childTree.value))}})}return children};CompoundWrite.prototype.childCompoundWrite=function(path){if(path.isEmpty()){return this}else{var shadowingNode=this.getCompleteNode(path);if(shadowingNode!=null){return new CompoundWrite(new ImmutableTree_1.ImmutableTree(shadowingNode))}else{return new CompoundWrite(this.writeTree_.subtree(path))}}};CompoundWrite.prototype.isEmpty=function(){return this.writeTree_.isEmpty()};CompoundWrite.prototype.apply=function(node){return CompoundWrite.applySubtreeWrite_(Path_1.Path.Empty,this.writeTree_,node)};CompoundWrite.Empty=new CompoundWrite(new ImmutableTree_1.ImmutableTree(null));CompoundWrite.applySubtreeWrite_=function(relativePath,writeTree,node){if(writeTree.value!=null){return node.updateChild(relativePath,writeTree.value)}else{var priorityWrite_1=null;writeTree.children.inorderTraversal(function(childKey,childTree){if(childKey===".priority"){util_2.assert(childTree.value!==null,"Priority writes must always be leaf nodes");priorityWrite_1=childTree.value}else{node=CompoundWrite.applySubtreeWrite_(relativePath.child(childKey),childTree,node)}});if(!node.getChild(relativePath).isEmpty()&&priorityWrite_1!==null){node=node.updateChild(relativePath.child(".priority"),priorityWrite_1)}return node}};return CompoundWrite}();exports.CompoundWrite=CompoundWrite},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var ChildrenNode_1=__webpack_require__(5);var SnapshotHolder=function(){function SnapshotHolder(){this.rootNode_=ChildrenNode_1.ChildrenNode.EMPTY_NODE}SnapshotHolder.prototype.getNode=function(path){return this.rootNode_.getChild(path)};SnapshotHolder.prototype.updateSnapshot=function(path,newSnapshotNode){this.rootNode_=this.rootNode_.updateChild(path,newSnapshotNode)};return SnapshotHolder}();exports.SnapshotHolder=SnapshotHolder},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var AuthTokenProvider=function(){function AuthTokenProvider(app_){this.app_=app_}AuthTokenProvider.prototype.getToken=function(forceRefresh){return this.app_["INTERNAL"]["getToken"](forceRefresh).then(null,function(error){if(error&&error.code==="auth/token-not-initialized"){util_1.log("Got auth/token-not-initialized error.  Treating as null token.");return null}else{return Promise.reject(error)}})};AuthTokenProvider.prototype.addTokenChangeListener=function(listener){this.app_["INTERNAL"]["addAuthTokenListener"](listener)};AuthTokenProvider.prototype.removeTokenChangeListener=function(listener){this.app_["INTERNAL"]["removeAuthTokenListener"](listener)};AuthTokenProvider.prototype.notifyForInvalidToken=function(){var errorMessage='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not '+"initialized correctly. ";if("credential"in this.app_.options){errorMessage+='Make sure the "credential" property provided to initializeApp() '+'is authorized to access the specified "databaseURL" and is from the correct '+"project."}else if("serviceAccount"in this.app_.options){errorMessage+='Make sure the "serviceAccount" property provided to initializeApp() '+'is authorized to access the specified "databaseURL" and is from the correct '+"project."}else{errorMessage+='Make sure the "apiKey" and "databaseURL" properties provided to '+"initializeApp() match the values provided for your app at "+"https://console.firebase.google.com/."}util_1.warn(errorMessage)};return AuthTokenProvider}();exports.AuthTokenProvider=AuthTokenProvider},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(0);var StatsCollection=function(){function StatsCollection(){this.counters_={}}StatsCollection.prototype.incrementCounter=function(name,amount){if(amount===void 0){amount=1}if(!util_2.contains(this.counters_,name))this.counters_[name]=0;this.counters_[name]+=amount};StatsCollection.prototype.get=function(){return util_1.deepCopy(this.counters_)};return StatsCollection}();exports.StatsCollection=StatsCollection},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var StatsListener_1=__webpack_require__(82);var FIRST_STATS_MIN_TIME=10*1e3;var FIRST_STATS_MAX_TIME=30*1e3;var REPORT_STATS_INTERVAL=5*60*1e3;var StatsReporter=function(){function StatsReporter(collection,server_){this.server_=server_;this.statsToReport_={};this.statsListener_=new StatsListener_1.StatsListener(collection);var timeout=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();util_2.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(timeout))}StatsReporter.prototype.includeStat=function(stat){this.statsToReport_[stat]=true};StatsReporter.prototype.reportStats_=function(){var _this=this;var stats=this.statsListener_.get();var reportedStats={};var haveStatsToReport=false;util_1.forEach(stats,function(stat,value){if(value>0&&util_1.contains(_this.statsToReport_,stat)){reportedStats[stat]=value;haveStatsToReport=true}});if(haveStatsToReport){this.server_.reportStats(reportedStats)}util_2.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))};return StatsReporter}();exports.StatsReporter=StatsReporter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var EventQueue=function(){function EventQueue(){this.eventLists_=[];this.recursionDepth_=0}EventQueue.prototype.queueEvents=function(eventDataList){var currList=null;for(var i=0;i<eventDataList.length;i++){var eventData=eventDataList[i];var eventPath=eventData.getPath();if(currList!==null&&!eventPath.equals(currList.getPath())){this.eventLists_.push(currList);currList=null}if(currList===null){currList=new EventList(eventPath)}currList.add(eventData)}if(currList){this.eventLists_.push(currList)}};EventQueue.prototype.raiseEventsAtPath=function(path,eventDataList){this.queueEvents(eventDataList);this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.equals(path)})};EventQueue.prototype.raiseEventsForChangedPath=function(changedPath,eventDataList){this.queueEvents(eventDataList);this.raiseQueuedEventsMatchingPredicate_(function(eventPath){return eventPath.contains(changedPath)||changedPath.contains(eventPath)})};EventQueue.prototype.raiseQueuedEventsMatchingPredicate_=function(predicate){this.recursionDepth_++;var sentAll=true;for(var i=0;i<this.eventLists_.length;i++){var eventList=this.eventLists_[i];if(eventList){var eventPath=eventList.getPath();if(predicate(eventPath)){this.eventLists_[i].raise();this.eventLists_[i]=null}else{sentAll=false}}}if(sentAll){this.eventLists_=[]}this.recursionDepth_--};return EventQueue}();exports.EventQueue=EventQueue;var EventList=function(){function EventList(path_){this.path_=path_;this.events_=[]}EventList.prototype.add=function(eventData){this.events_.push(eventData)};EventList.prototype.raise=function(){for(var i=0;i<this.events_.length;i++){var eventData=this.events_[i];if(eventData!==null){this.events_[i]=null;var eventFn=eventData.getEventRunner();if(util_1.logger){util_1.log("event: "+eventData.toString())}util_1.exceptionGuard(eventFn)}}};EventList.prototype.getPath=function(){return this.path_};return EventList}();exports.EventList=EventList},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var EventEmitter_1=__webpack_require__(84);var util_1=__webpack_require__(0);var VisibilityMonitor=function(_super){__extends(VisibilityMonitor,_super);function VisibilityMonitor(){var _this=_super.call(this,["visible"])||this;var hidden;var visibilityChange;if(typeof document!=="undefined"&&typeof document.addEventListener!=="undefined"){if(typeof document["hidden"]!=="undefined"){visibilityChange="visibilitychange";hidden="hidden"}else if(typeof document["mozHidden"]!=="undefined"){visibilityChange="mozvisibilitychange";hidden="mozHidden"}else if(typeof document["msHidden"]!=="undefined"){visibilityChange="msvisibilitychange";hidden="msHidden"}else if(typeof document["webkitHidden"]!=="undefined"){visibilityChange="webkitvisibilitychange";hidden="webkitHidden"}}_this.visible_=true;if(visibilityChange){document.addEventListener(visibilityChange,function(){var visible=!document[hidden];if(visible!==_this.visible_){_this.visible_=visible;_this.trigger("visible",visible)}},false)}return _this}VisibilityMonitor.getInstance=function(){return new VisibilityMonitor};VisibilityMonitor.prototype.getInitialEvent=function(eventType){util_1.assert(eventType==="visible","Unknown event type: "+eventType);return[this.visible_]};return VisibilityMonitor}(EventEmitter_1.EventEmitter);exports.VisibilityMonitor=VisibilityMonitor},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var EventEmitter_1=__webpack_require__(84);var util_2=__webpack_require__(0);var OnlineMonitor=function(_super){__extends(OnlineMonitor,_super);function OnlineMonitor(){var _this=_super.call(this,["online"])||this;_this.online_=true;if(typeof window!=="undefined"&&typeof window.addEventListener!=="undefined"&&!util_2.isMobileCordova()){window.addEventListener("online",function(){if(!_this.online_){_this.online_=true;_this.trigger("online",true)}},false);window.addEventListener("offline",function(){if(_this.online_){_this.online_=false;_this.trigger("online",false)}},false)}return _this}OnlineMonitor.getInstance=function(){return new OnlineMonitor};OnlineMonitor.prototype.getInitialEvent=function(eventType){util_1.assert(eventType==="online","Unknown event type: "+eventType);return[this.online_]};OnlineMonitor.prototype.currentlyOnline=function(){return this.online_};return OnlineMonitor}(EventEmitter_1.EventEmitter);exports.OnlineMonitor=OnlineMonitor},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var BrowserPollConnection_1=__webpack_require__(86);var WebSocketConnection_1=__webpack_require__(87);var util_1=__webpack_require__(1);var TransportManager=function(){function TransportManager(repoInfo){this.initTransports_(repoInfo)}Object.defineProperty(TransportManager,"ALL_TRANSPORTS",{get:function(){return[BrowserPollConnection_1.BrowserPollConnection,WebSocketConnection_1.WebSocketConnection]},enumerable:true,configurable:true});TransportManager.prototype.initTransports_=function(repoInfo){var isWebSocketsAvailable=WebSocketConnection_1.WebSocketConnection&&WebSocketConnection_1.WebSocketConnection["isAvailable"]();var isSkipPollConnection=isWebSocketsAvailable&&!WebSocketConnection_1.WebSocketConnection.previouslyFailed();if(repoInfo.webSocketOnly){if(!isWebSocketsAvailable)util_1.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway.");isSkipPollConnection=true}if(isSkipPollConnection){this.transports_=[WebSocketConnection_1.WebSocketConnection]}else{var transports_1=this.transports_=[];util_1.each(TransportManager.ALL_TRANSPORTS,function(i,transport){if(transport&&transport["isAvailable"]()){transports_1.push(transport)}})}};TransportManager.prototype.initialTransport=function(){if(this.transports_.length>0){return this.transports_[0]}else{throw new Error("No transports available")}};TransportManager.prototype.upgradeTransport=function(){if(this.transports_.length>1){return this.transports_[1]}else{return null}};return TransportManager}();exports.TransportManager=TransportManager},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(1);var PacketReceiver=function(){function PacketReceiver(onMessage_){this.onMessage_=onMessage_;this.pendingResponses=[];this.currentResponseNum=0;this.closeAfterResponse=-1;this.onClose=null}PacketReceiver.prototype.closeAfter=function(responseNum,callback){this.closeAfterResponse=responseNum;this.onClose=callback;if(this.closeAfterResponse<this.currentResponseNum){this.onClose();this.onClose=null}};PacketReceiver.prototype.handleResponse=function(requestNum,data){var _this=this;this.pendingResponses[requestNum]=data;var _loop_1=function(){var toProcess=this_1.pendingResponses[this_1.currentResponseNum];delete this_1.pendingResponses[this_1.currentResponseNum];var _loop_2=function(i){if(toProcess[i]){util_1.exceptionGuard(function(){_this.onMessage_(toProcess[i])})}};for(var i=0;i<toProcess.length;++i){_loop_2(i)}if(this_1.currentResponseNum===this_1.closeAfterResponse){if(this_1.onClose){this_1.onClose();this_1.onClose=null}return"break"}this_1.currentResponseNum++};var this_1=this;while(this.pendingResponses[this.currentResponseNum]){var state_1=_loop_1();if(state_1==="break")break}};return PacketReceiver}();exports.PacketReceiver=PacketReceiver},function(module,exports,__webpack_require__){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var util_3=__webpack_require__(0);var util_4=__webpack_require__(0);var util_5=__webpack_require__(0);var ServerActions_1=__webpack_require__(88);var ReadonlyRestClient=function(_super){__extends(ReadonlyRestClient,_super);function ReadonlyRestClient(repoInfo_,onDataUpdate_,authTokenProvider_){var _this=_super.call(this)||this;_this.repoInfo_=repoInfo_;_this.onDataUpdate_=onDataUpdate_;_this.authTokenProvider_=authTokenProvider_;_this.log_=util_2.logWrapper("p:rest:");_this.listens_={};return _this}ReadonlyRestClient.prototype.reportStats=function(stats){throw new Error("Method not implemented.")};ReadonlyRestClient.getListenId_=function(query,tag){if(tag!==undefined){return"tag$"+tag}else{util_1.assert(query.getQueryParams().isDefault(),"should have a tag if it's not a default query.");return query.path.toString()}};ReadonlyRestClient.prototype.listen=function(query,currentHashFn,tag,onComplete){var _this=this;var pathString=query.path.toString();this.log_("Listen called for "+pathString+" "+query.queryIdentifier());var listenId=ReadonlyRestClient.getListenId_(query,tag);var thisListen={};this.listens_[listenId]=thisListen;var queryStringParamaters=query.getQueryParams().toRestQueryStringParameters();this.restRequest_(pathString+".json",queryStringParamaters,function(error,result){var data=result;if(error===404){data=null;error=null}if(error===null){_this.onDataUpdate_(pathString,data,false,tag)}if(util_4.safeGet(_this.listens_,listenId)===thisListen){var status_1;if(!error){status_1="ok"}else if(error==401){status_1="permission_denied"}else{status_1="rest_error:"+error}onComplete(status_1,null)}})};ReadonlyRestClient.prototype.unlisten=function(query,tag){var listenId=ReadonlyRestClient.getListenId_(query,tag);delete this.listens_[listenId]};ReadonlyRestClient.prototype.refreshAuthToken=function(token){};ReadonlyRestClient.prototype.restRequest_=function(pathString,queryStringParameters,callback){var _this=this;if(queryStringParameters===void 0){queryStringParameters={}}queryStringParameters["format"]="export";this.authTokenProvider_.getToken(false).then(function(authTokenData){var authToken=authTokenData&&authTokenData.accessToken;if(authToken){queryStringParameters["auth"]=authToken}var url=(_this.repoInfo_.secure?"https://":"http://")+_this.repoInfo_.host+pathString+"?"+util_5.querystring(queryStringParameters);_this.log_("Sending REST request for "+url);var xhr=new XMLHttpRequest;xhr.onreadystatechange=function(){if(callback&&xhr.readyState===4){_this.log_("REST Response for "+url+" received. status:",xhr.status,"response:",xhr.responseText);var res=null;if(xhr.status>=200&&xhr.status<300){try{res=util_3.jsonEval(xhr.responseText)}catch(e){util_2.warn("Failed to parse JSON response for "+url+": "+xhr.responseText)}callback(null,res)}else{if(xhr.status!==401&&xhr.status!==404){util_2.warn("Got unsuccessful REST response for "+url+" Status: "+xhr.status)}callback(xhr.status)}callback=null}};xhr.open("GET",url,true);xhr.send()})};return ReadonlyRestClient}(ServerActions_1.ServerActions);exports.ReadonlyRestClient=ReadonlyRestClient},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var util_2=__webpack_require__(1);var KeyIndex_1=__webpack_require__(21);var PriorityIndex_1=__webpack_require__(4);var ValueIndex_1=__webpack_require__(71);var PathIndex_1=__webpack_require__(75);var IndexedFilter_1=__webpack_require__(47);var LimitedFilter_1=__webpack_require__(175);var RangedFilter_1=__webpack_require__(89);var util_3=__webpack_require__(0);var QueryParams=function(){function QueryParams(){this.limitSet_=false;this.startSet_=false;this.startNameSet_=false;this.endSet_=false;this.endNameSet_=false;this.limit_=0;this.viewFrom_="";this.indexStartValue_=null;this.indexStartName_="";this.indexEndValue_=null;this.indexEndName_="";this.index_=PriorityIndex_1.PRIORITY_INDEX}QueryParams.prototype.hasStart=function(){return this.startSet_};QueryParams.prototype.isViewFromLeft=function(){if(this.viewFrom_===""){return this.startSet_}else{return this.viewFrom_===QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT}};QueryParams.prototype.getIndexStartValue=function(){util_1.assert(this.startSet_,"Only valid if start has been set");return this.indexStartValue_};QueryParams.prototype.getIndexStartName=function(){util_1.assert(this.startSet_,"Only valid if start has been set");if(this.startNameSet_){return this.indexStartName_}else{return util_2.MIN_NAME}};QueryParams.prototype.hasEnd=function(){return this.endSet_};QueryParams.prototype.getIndexEndValue=function(){util_1.assert(this.endSet_,"Only valid if end has been set");return this.indexEndValue_};QueryParams.prototype.getIndexEndName=function(){util_1.assert(this.endSet_,"Only valid if end has been set");if(this.endNameSet_){return this.indexEndName_}else{return util_2.MAX_NAME}};QueryParams.prototype.hasLimit=function(){return this.limitSet_};QueryParams.prototype.hasAnchoredLimit=function(){return this.limitSet_&&this.viewFrom_!==""};QueryParams.prototype.getLimit=function(){util_1.assert(this.limitSet_,"Only valid if limit has been set");return this.limit_};QueryParams.prototype.getIndex=function(){return this.index_};QueryParams.prototype.copy_=function(){var copy=new QueryParams;copy.limitSet_=this.limitSet_;copy.limit_=this.limit_;copy.startSet_=this.startSet_;copy.indexStartValue_=this.indexStartValue_;copy.startNameSet_=this.startNameSet_;copy.indexStartName_=this.indexStartName_;copy.endSet_=this.endSet_;copy.indexEndValue_=this.indexEndValue_;copy.endNameSet_=this.endNameSet_;copy.indexEndName_=this.indexEndName_;copy.index_=this.index_;copy.viewFrom_=this.viewFrom_;return copy};QueryParams.prototype.limit=function(newLimit){var newParams=this.copy_();newParams.limitSet_=true;newParams.limit_=newLimit;newParams.viewFrom_="";return newParams};QueryParams.prototype.limitToFirst=function(newLimit){var newParams=this.copy_();newParams.limitSet_=true;newParams.limit_=newLimit;newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT;return newParams};QueryParams.prototype.limitToLast=function(newLimit){var newParams=this.copy_();newParams.limitSet_=true;newParams.limit_=newLimit;newParams.viewFrom_=QueryParams.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT;return newParams};QueryParams.prototype.startAt=function(indexValue,key){var newParams=this.copy_();newParams.startSet_=true;if(!(indexValue!==undefined)){indexValue=null}newParams.indexStartValue_=indexValue;if(key!=null){newParams.startNameSet_=true;newParams.indexStartName_=key}else{newParams.startNameSet_=false;newParams.indexStartName_=""}return newParams};QueryParams.prototype.endAt=function(indexValue,key){var newParams=this.copy_()
;newParams.endSet_=true;if(!(indexValue!==undefined)){indexValue=null}newParams.indexEndValue_=indexValue;if(key!==undefined){newParams.endNameSet_=true;newParams.indexEndName_=key}else{newParams.endNameSet_=false;newParams.indexEndName_=""}return newParams};QueryParams.prototype.orderBy=function(index){var newParams=this.copy_();newParams.index_=index;return newParams};QueryParams.prototype.getQueryObject=function(){var WIRE_PROTOCOL_CONSTANTS=QueryParams.WIRE_PROTOCOL_CONSTANTS_;var obj={};if(this.startSet_){obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_VALUE]=this.indexStartValue_;if(this.startNameSet_){obj[WIRE_PROTOCOL_CONSTANTS.INDEX_START_NAME]=this.indexStartName_}}if(this.endSet_){obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_VALUE]=this.indexEndValue_;if(this.endNameSet_){obj[WIRE_PROTOCOL_CONSTANTS.INDEX_END_NAME]=this.indexEndName_}}if(this.limitSet_){obj[WIRE_PROTOCOL_CONSTANTS.LIMIT]=this.limit_;var viewFrom=this.viewFrom_;if(viewFrom===""){if(this.isViewFromLeft()){viewFrom=WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_LEFT}else{viewFrom=WIRE_PROTOCOL_CONSTANTS.VIEW_FROM_RIGHT}}obj[WIRE_PROTOCOL_CONSTANTS.VIEW_FROM]=viewFrom}if(this.index_!==PriorityIndex_1.PRIORITY_INDEX){obj[WIRE_PROTOCOL_CONSTANTS.INDEX]=this.index_.toString()}return obj};QueryParams.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)};QueryParams.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==PriorityIndex_1.PRIORITY_INDEX};QueryParams.prototype.getNodeFilter=function(){if(this.loadsAllData()){return new IndexedFilter_1.IndexedFilter(this.getIndex())}else if(this.hasLimit()){return new LimitedFilter_1.LimitedFilter(this)}else{return new RangedFilter_1.RangedFilter(this)}};QueryParams.prototype.toRestQueryStringParameters=function(){var REST_CONSTANTS=QueryParams.REST_QUERY_CONSTANTS_;var qs={};if(this.isDefault()){return qs}var orderBy;if(this.index_===PriorityIndex_1.PRIORITY_INDEX){orderBy=REST_CONSTANTS.PRIORITY_INDEX}else if(this.index_===ValueIndex_1.VALUE_INDEX){orderBy=REST_CONSTANTS.VALUE_INDEX}else if(this.index_===KeyIndex_1.KEY_INDEX){orderBy=REST_CONSTANTS.KEY_INDEX}else{util_1.assert(this.index_ instanceof PathIndex_1.PathIndex,"Unrecognized index type!");orderBy=this.index_.toString()}qs[REST_CONSTANTS.ORDER_BY]=util_3.stringify(orderBy);if(this.startSet_){qs[REST_CONSTANTS.START_AT]=util_3.stringify(this.indexStartValue_);if(this.startNameSet_){qs[REST_CONSTANTS.START_AT]+=","+util_3.stringify(this.indexStartName_)}}if(this.endSet_){qs[REST_CONSTANTS.END_AT]=util_3.stringify(this.indexEndValue_);if(this.endNameSet_){qs[REST_CONSTANTS.END_AT]+=","+util_3.stringify(this.indexEndName_)}}if(this.limitSet_){if(this.isViewFromLeft()){qs[REST_CONSTANTS.LIMIT_TO_FIRST]=this.limit_}else{qs[REST_CONSTANTS.LIMIT_TO_LAST]=this.limit_}}return qs};QueryParams.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"};QueryParams.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"};QueryParams.DEFAULT=new QueryParams;return QueryParams}();exports.QueryParams=QueryParams},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var RangedFilter_1=__webpack_require__(89);var ChildrenNode_1=__webpack_require__(5);var Node_1=__webpack_require__(6);var util_1=__webpack_require__(0);var Change_1=__webpack_require__(16);var LimitedFilter=function(){function LimitedFilter(params){this.rangedFilter_=new RangedFilter_1.RangedFilter(params);this.index_=params.getIndex();this.limit_=params.getLimit();this.reverse_=!params.isViewFromLeft()}LimitedFilter.prototype.updateChild=function(snap,key,newChild,affectedPath,source,optChangeAccumulator){if(!this.rangedFilter_.matches(new Node_1.NamedNode(key,newChild))){newChild=ChildrenNode_1.ChildrenNode.EMPTY_NODE}if(snap.getImmediateChild(key).equals(newChild)){return snap}else if(snap.numChildren()<this.limit_){return this.rangedFilter_.getIndexedFilter().updateChild(snap,key,newChild,affectedPath,source,optChangeAccumulator)}else{return this.fullLimitUpdateChild_(snap,key,newChild,source,optChangeAccumulator)}};LimitedFilter.prototype.updateFullNode=function(oldSnap,newSnap,optChangeAccumulator){var filtered;if(newSnap.isLeafNode()||newSnap.isEmpty()){filtered=ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_)}else{if(this.limit_*2<newSnap.numChildren()&&newSnap.isIndexed(this.index_)){filtered=ChildrenNode_1.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var iterator=void 0;if(this.reverse_){iterator=newSnap.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_)}else{iterator=newSnap.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_)}var count=0;while(iterator.hasNext()&&count<this.limit_){var next=iterator.getNext();var inRange=void 0;if(this.reverse_){inRange=this.index_.compare(this.rangedFilter_.getStartPost(),next)<=0}else{inRange=this.index_.compare(next,this.rangedFilter_.getEndPost())<=0}if(inRange){filtered=filtered.updateImmediateChild(next.name,next.node);count++}else{break}}}else{filtered=newSnap.withIndex(this.index_);filtered=filtered.updatePriority(ChildrenNode_1.ChildrenNode.EMPTY_NODE);var startPost=void 0;var endPost=void 0;var cmp=void 0;var iterator=void 0;if(this.reverse_){iterator=filtered.getReverseIterator(this.index_);startPost=this.rangedFilter_.getEndPost();endPost=this.rangedFilter_.getStartPost();var indexCompare_1=this.index_.getCompare();cmp=function(a,b){return indexCompare_1(b,a)}}else{iterator=filtered.getIterator(this.index_);startPost=this.rangedFilter_.getStartPost();endPost=this.rangedFilter_.getEndPost();cmp=this.index_.getCompare()}var count=0;var foundStartPost=false;while(iterator.hasNext()){var next=iterator.getNext();if(!foundStartPost&&cmp(startPost,next)<=0){foundStartPost=true}var inRange=foundStartPost&&count<this.limit_&&cmp(next,endPost)<=0;if(inRange){count++}else{filtered=filtered.updateImmediateChild(next.name,ChildrenNode_1.ChildrenNode.EMPTY_NODE)}}}}return this.rangedFilter_.getIndexedFilter().updateFullNode(oldSnap,filtered,optChangeAccumulator)};LimitedFilter.prototype.updatePriority=function(oldSnap,newPriority){return oldSnap};LimitedFilter.prototype.filtersNodes=function(){return true};LimitedFilter.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()};LimitedFilter.prototype.getIndex=function(){return this.index_};LimitedFilter.prototype.fullLimitUpdateChild_=function(snap,childKey,childSnap,source,changeAccumulator){var cmp;if(this.reverse_){var indexCmp_1=this.index_.getCompare();cmp=function(a,b){return indexCmp_1(b,a)}}else{cmp=this.index_.getCompare()}var oldEventCache=snap;util_1.assert(oldEventCache.numChildren()==this.limit_,"");var newChildNamedNode=new Node_1.NamedNode(childKey,childSnap);var windowBoundary=this.reverse_?oldEventCache.getFirstChild(this.index_):oldEventCache.getLastChild(this.index_);var inRange=this.rangedFilter_.matches(newChildNamedNode);if(oldEventCache.hasChild(childKey)){var oldChildSnap=oldEventCache.getImmediateChild(childKey);var nextChild=source.getChildAfterChild(this.index_,windowBoundary,this.reverse_);while(nextChild!=null&&(nextChild.name==childKey||oldEventCache.hasChild(nextChild.name))){nextChild=source.getChildAfterChild(this.index_,nextChild,this.reverse_)}var compareNext=nextChild==null?1:cmp(nextChild,newChildNamedNode);var remainsInWindow=inRange&&!childSnap.isEmpty()&&compareNext>=0;if(remainsInWindow){if(changeAccumulator!=null){changeAccumulator.trackChildChange(Change_1.Change.childChangedChange(childKey,childSnap,oldChildSnap))}return oldEventCache.updateImmediateChild(childKey,childSnap)}else{if(changeAccumulator!=null){changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(childKey,oldChildSnap))}var newEventCache=oldEventCache.updateImmediateChild(childKey,ChildrenNode_1.ChildrenNode.EMPTY_NODE);var nextChildInRange=nextChild!=null&&this.rangedFilter_.matches(nextChild);if(nextChildInRange){if(changeAccumulator!=null){changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(nextChild.name,nextChild.node))}return newEventCache.updateImmediateChild(nextChild.name,nextChild.node)}else{return newEventCache}}}else if(childSnap.isEmpty()){return snap}else if(inRange){if(cmp(windowBoundary,newChildNamedNode)>=0){if(changeAccumulator!=null){changeAccumulator.trackChildChange(Change_1.Change.childRemovedChange(windowBoundary.name,windowBoundary.node));changeAccumulator.trackChildChange(Change_1.Change.childAddedChange(childKey,childSnap))}return oldEventCache.updateImmediateChild(childKey,childSnap).updateImmediateChild(windowBoundary.name,ChildrenNode_1.ChildrenNode.EMPTY_NODE)}else{return snap}}else{return snap}};return LimitedFilter}();exports.LimitedFilter=LimitedFilter},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Reference_1=__webpack_require__(44);var DataSnapshot_1=__webpack_require__(45);var Path_1=__webpack_require__(2);var Tree_1=__webpack_require__(177);var PriorityIndex_1=__webpack_require__(4);var util_2=__webpack_require__(1);var ServerValues_1=__webpack_require__(76);var validation_1=__webpack_require__(12);var util_3=__webpack_require__(0);var nodeFromJSON_1=__webpack_require__(22);var ChildrenNode_1=__webpack_require__(5);var Repo_1=__webpack_require__(31);var TransactionStatus;(function(TransactionStatus){TransactionStatus[TransactionStatus["RUN"]=0]="RUN";TransactionStatus[TransactionStatus["SENT"]=1]="SENT";TransactionStatus[TransactionStatus["COMPLETED"]=2]="COMPLETED";TransactionStatus[TransactionStatus["SENT_NEEDS_ABORT"]=3]="SENT_NEEDS_ABORT";TransactionStatus[TransactionStatus["NEEDS_ABORT"]=4]="NEEDS_ABORT"})(TransactionStatus=exports.TransactionStatus||(exports.TransactionStatus={}));Repo_1.Repo.MAX_TRANSACTION_RETRIES_=25;Repo_1.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new Tree_1.Tree};Repo_1.Repo.prototype.startTransaction=function(path,transactionUpdate,onComplete,applyLocally){this.log_("transaction on "+path);var valueCallback=function(){};var watchRef=new Reference_1.Reference(this,path);watchRef.on("value",valueCallback);var unwatcher=function(){watchRef.off("value",valueCallback)};var transaction={path:path,update:transactionUpdate,onComplete:onComplete,status:null,order:util_2.LUIDGenerator(),applyLocally:applyLocally,retryCount:0,unwatcher:unwatcher,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null};var currentState=this.getLatestState_(path);transaction.currentInputSnapshot=currentState;var newVal=transaction.update(currentState.val());if(newVal===undefined){transaction.unwatcher();transaction.currentOutputSnapshotRaw=null;transaction.currentOutputSnapshotResolved=null;if(transaction.onComplete){var snapshot=new DataSnapshot_1.DataSnapshot(transaction.currentInputSnapshot,new Reference_1.Reference(this,transaction.path),PriorityIndex_1.PRIORITY_INDEX);transaction.onComplete(null,false,snapshot)}}else{validation_1.validateFirebaseData("transaction failed: Data returned ",newVal,transaction.path);transaction.status=TransactionStatus.RUN;var queueNode=this.transactionQueueTree_.subTree(path);var nodeQueue=queueNode.getValue()||[];nodeQueue.push(transaction);queueNode.setValue(nodeQueue);var priorityForNode=void 0;if(typeof newVal==="object"&&newVal!==null&&util_3.contains(newVal,".priority")){priorityForNode=util_3.safeGet(newVal,".priority");util_1.assert(validation_1.isValidPriority(priorityForNode),"Invalid priority returned by transaction. "+"Priority must be a valid string, finite number, server value, or null.")}else{var currentNode=this.serverSyncTree_.calcCompleteEventCache(path)||ChildrenNode_1.ChildrenNode.EMPTY_NODE;priorityForNode=currentNode.getPriority().val()}priorityForNode=priorityForNode;var serverValues=this.generateServerValues();var newNodeUnresolved=nodeFromJSON_1.nodeFromJSON(newVal,priorityForNode);var newNode=ServerValues_1.resolveDeferredValueSnapshot(newNodeUnresolved,serverValues);transaction.currentOutputSnapshotRaw=newNodeUnresolved;transaction.currentOutputSnapshotResolved=newNode;transaction.currentWriteId=this.getNextWriteId_();var events=this.serverSyncTree_.applyUserOverwrite(path,newNode,transaction.currentWriteId,transaction.applyLocally);this.eventQueue_.raiseEventsForChangedPath(path,events);this.sendReadyTransactions_()}};Repo_1.Repo.prototype.getLatestState_=function(path,excludeSets){return this.serverSyncTree_.calcCompleteEventCache(path,excludeSets)||ChildrenNode_1.ChildrenNode.EMPTY_NODE};Repo_1.Repo.prototype.sendReadyTransactions_=function(node){var _this=this;if(node===void 0){node=this.transactionQueueTree_}if(!node){this.pruneCompletedTransactionsBelowNode_(node)}if(node.getValue()!==null){var queue=this.buildTransactionQueue_(node);util_1.assert(queue.length>0,"Sending zero length transaction queue");var allRun=queue.every(function(transaction){return transaction.status===TransactionStatus.RUN});if(allRun){this.sendTransactionQueue_(node.path(),queue)}}else if(node.hasChildren()){node.forEachChild(function(childNode){_this.sendReadyTransactions_(childNode)})}};Repo_1.Repo.prototype.sendTransactionQueue_=function(path,queue){var _this=this;var setsToIgnore=queue.map(function(txn){return txn.currentWriteId});var latestState=this.getLatestState_(path,setsToIgnore);var snapToSend=latestState;var latestHash=latestState.hash();for(var i=0;i<queue.length;i++){var txn=queue[i];util_1.assert(txn.status===TransactionStatus.RUN,"tryToSendTransactionQueue_: items in queue should all be run.");txn.status=TransactionStatus.SENT;txn.retryCount++;var relativePath=Path_1.Path.relativePath(path,txn.path);snapToSend=snapToSend.updateChild(relativePath,txn.currentOutputSnapshotRaw)}var dataToSend=snapToSend.val(true);var pathToSend=path;this.server_.put(pathToSend.toString(),dataToSend,function(status){_this.log_("transaction put response",{path:pathToSend.toString(),status:status});var events=[];if(status==="ok"){var callbacks=[];for(var i=0;i<queue.length;i++){queue[i].status=TransactionStatus.COMPLETED;events=events.concat(_this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId));if(queue[i].onComplete){var node=queue[i].currentOutputSnapshotResolved;var ref=new Reference_1.Reference(_this,queue[i].path);var snapshot=new DataSnapshot_1.DataSnapshot(node,ref,PriorityIndex_1.PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,true,snapshot))}queue[i].unwatcher()}_this.pruneCompletedTransactionsBelowNode_(_this.transactionQueueTree_.subTree(path));_this.sendReadyTransactions_();_this.eventQueue_.raiseEventsForChangedPath(path,events);for(var i=0;i<callbacks.length;i++){util_2.exceptionGuard(callbacks[i])}}else{if(status==="datastale"){for(var i=0;i<queue.length;i++){if(queue[i].status===TransactionStatus.SENT_NEEDS_ABORT)queue[i].status=TransactionStatus.NEEDS_ABORT;else queue[i].status=TransactionStatus.RUN}}else{util_2.warn("transaction at "+pathToSend.toString()+" failed: "+status);for(var i=0;i<queue.length;i++){queue[i].status=TransactionStatus.NEEDS_ABORT;queue[i].abortReason=status}}_this.rerunTransactions_(path)}},latestHash)};Repo_1.Repo.prototype.rerunTransactions_=function(changedPath){var rootMostTransactionNode=this.getAncestorTransactionNode_(changedPath);var path=rootMostTransactionNode.path();var queue=this.buildTransactionQueue_(rootMostTransactionNode);this.rerunTransactionQueue_(queue,path);return path};Repo_1.Repo.prototype.rerunTransactionQueue_=function(queue,path){if(queue.length===0){return}var callbacks=[];var events=[];var txnsToRerun=queue.filter(function(q){return q.status===TransactionStatus.RUN});var setsToIgnore=txnsToRerun.map(function(q){return q.currentWriteId});for(var i=0;i<queue.length;i++){var transaction=queue[i];var relativePath=Path_1.Path.relativePath(path,transaction.path);var abortTransaction=false,abortReason=void 0;util_1.assert(relativePath!==null,"rerunTransactionsUnderNode_: relativePath should not be null.");if(transaction.status===TransactionStatus.NEEDS_ABORT){abortTransaction=true;abortReason=transaction.abortReason;events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,true))}else if(transaction.status===TransactionStatus.RUN){if(transaction.retryCount>=Repo_1.Repo.MAX_TRANSACTION_RETRIES_){abortTransaction=true;abortReason="maxretry";events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,true))}else{var currentNode=this.getLatestState_(transaction.path,setsToIgnore);transaction.currentInputSnapshot=currentNode;var newData=queue[i].update(currentNode.val());if(newData!==undefined){validation_1.validateFirebaseData("transaction failed: Data returned ",newData,transaction.path);var newDataNode=nodeFromJSON_1.nodeFromJSON(newData);var hasExplicitPriority=typeof newData==="object"&&newData!=null&&util_3.contains(newData,".priority");if(!hasExplicitPriority){newDataNode=newDataNode.updatePriority(currentNode.getPriority())}var oldWriteId=transaction.currentWriteId;var serverValues=this.generateServerValues();var newNodeResolved=ServerValues_1.resolveDeferredValueSnapshot(newDataNode,serverValues);transaction.currentOutputSnapshotRaw=newDataNode;transaction.currentOutputSnapshotResolved=newNodeResolved;transaction.currentWriteId=this.getNextWriteId_();setsToIgnore.splice(setsToIgnore.indexOf(oldWriteId),1);events=events.concat(this.serverSyncTree_.applyUserOverwrite(transaction.path,newNodeResolved,transaction.currentWriteId,transaction.applyLocally));events=events.concat(this.serverSyncTree_.ackUserWrite(oldWriteId,true))}else{abortTransaction=true;abortReason="nodata";events=events.concat(this.serverSyncTree_.ackUserWrite(transaction.currentWriteId,true))}}}this.eventQueue_.raiseEventsForChangedPath(path,events);events=[];if(abortTransaction){queue[i].status=TransactionStatus.COMPLETED;(function(unwatcher){setTimeout(unwatcher,Math.floor(0))})(queue[i].unwatcher);if(queue[i].onComplete){if(abortReason==="nodata"){var ref=new Reference_1.Reference(this,queue[i].path);var lastInput=queue[i].currentInputSnapshot;var snapshot=new DataSnapshot_1.DataSnapshot(lastInput,ref,PriorityIndex_1.PRIORITY_INDEX);callbacks.push(queue[i].onComplete.bind(null,null,false,snapshot))}else{callbacks.push(queue[i].onComplete.bind(null,new Error(abortReason),false,null))}}}}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var i=0;i<callbacks.length;i++){util_2.exceptionGuard(callbacks[i])}this.sendReadyTransactions_()};Repo_1.Repo.prototype.getAncestorTransactionNode_=function(path){var front;var transactionNode=this.transactionQueueTree_;while((front=path.getFront())!==null&&transactionNode.getValue()===null){transactionNode=transactionNode.subTree(front);path=path.popFront()}return transactionNode};Repo_1.Repo.prototype.buildTransactionQueue_=function(transactionNode){var transactionQueue=[];this.aggregateTransactionQueuesForNode_(transactionNode,transactionQueue);transactionQueue.sort(function(a,b){return a.order-b.order});return transactionQueue};Repo_1.Repo.prototype.aggregateTransactionQueuesForNode_=function(node,queue){var _this=this;var nodeQueue=node.getValue();if(nodeQueue!==null){for(var i=0;i<nodeQueue.length;i++){queue.push(nodeQueue[i])}}node.forEachChild(function(child){_this.aggregateTransactionQueuesForNode_(child,queue)})};Repo_1.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(node){var _this=this;var queue=node.getValue();if(queue){var to=0;for(var from=0;from<queue.length;from++){if(queue[from].status!==TransactionStatus.COMPLETED){queue[to]=queue[from];to++}}queue.length=to;node.setValue(queue.length>0?queue:null)}node.forEachChild(function(childNode){_this.pruneCompletedTransactionsBelowNode_(childNode)})};Repo_1.Repo.prototype.abortTransactions_=function(path){var _this=this;var affectedPath=this.getAncestorTransactionNode_(path).path();var transactionNode=this.transactionQueueTree_.subTree(path);transactionNode.forEachAncestor(function(node){_this.abortTransactionsOnNode_(node)});this.abortTransactionsOnNode_(transactionNode);transactionNode.forEachDescendant(function(node){_this.abortTransactionsOnNode_(node)});return affectedPath};Repo_1.Repo.prototype.abortTransactionsOnNode_=function(node){var queue=node.getValue();if(queue!==null){var callbacks=[];var events=[];var lastSent=-1;for(var i=0;i<queue.length;i++){if(queue[i].status===TransactionStatus.SENT_NEEDS_ABORT){}else if(queue[i].status===TransactionStatus.SENT){util_1.assert(lastSent===i-1,"All SENT items should be at beginning of queue.");lastSent=i;queue[i].status=TransactionStatus.SENT_NEEDS_ABORT;queue[i].abortReason="set"}else{util_1.assert(queue[i].status===TransactionStatus.RUN,"Unexpected transaction status in abort");queue[i].unwatcher();events=events.concat(this.serverSyncTree_.ackUserWrite(queue[i].currentWriteId,true));if(queue[i].onComplete){var snapshot=null;callbacks.push(queue[i].onComplete.bind(null,new Error("set"),false,snapshot))}}}if(lastSent===-1){node.setValue(null)}else{queue.length=lastSent+1}this.eventQueue_.raiseEventsForChangedPath(node.path(),events);for(var i=0;i<callbacks.length;i++){util_2.exceptionGuard(callbacks[i])}}}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var util_1=__webpack_require__(0);var Path_1=__webpack_require__(2);var util_2=__webpack_require__(0);var TreeNode=function(){function TreeNode(){this.children={};this.childCount=0;this.value=null}return TreeNode}();exports.TreeNode=TreeNode;var Tree=function(){function Tree(name_,parent_,node_){if(name_===void 0){name_=""}if(parent_===void 0){parent_=null}if(node_===void 0){node_=new TreeNode}this.name_=name_;this.parent_=parent_;this.node_=node_}Tree.prototype.subTree=function(pathObj){var path=pathObj instanceof Path_1.Path?pathObj:new Path_1.Path(pathObj);var child=this,next;while((next=path.getFront())!==null){var childNode=util_2.safeGet(child.node_.children,next)||new TreeNode;child=new Tree(next,child,childNode);path=path.popFront()}return child};Tree.prototype.getValue=function(){return this.node_.value};Tree.prototype.setValue=function(value){util_1.assert(typeof value!=="undefined","Cannot set value to undefined");this.node_.value=value;this.updateParents_()};Tree.prototype.clear=function(){this.node_.value=null;this.node_.children={};this.node_.childCount=0;this.updateParents_()};Tree.prototype.hasChildren=function(){return this.node_.childCount>0};Tree.prototype.isEmpty=function(){return this.getValue()===null&&!this.hasChildren()};Tree.prototype.forEachChild=function(action){var _this=this;util_2.forEach(this.node_.children,function(child,childTree){action(new Tree(child,_this,childTree))})};Tree.prototype.forEachDescendant=function(action,includeSelf,childrenFirst){if(includeSelf&&!childrenFirst)action(this);this.forEachChild(function(child){child.forEachDescendant(action,true,childrenFirst)});if(includeSelf&&childrenFirst)action(this)};Tree.prototype.forEachAncestor=function(action,includeSelf){var node=includeSelf?this:this.parent();while(node!==null){if(action(node)){return true}node=node.parent()}return false};Tree.prototype.forEachImmediateDescendantWithValue=function(action){this.forEachChild(function(child){if(child.getValue()!==null)action(child);else child.forEachImmediateDescendantWithValue(action)})};Tree.prototype.path=function(){return new Path_1.Path(this.parent_===null?this.name_:this.parent_.path()+"/"+this.name_)};Tree.prototype.name=function(){return this.name_};Tree.prototype.parent=function(){return this.parent_};Tree.prototype.updateParents_=function(){if(this.parent_!==null)this.parent_.updateChild_(this.name_,this)};Tree.prototype.updateChild_=function(childName,child){var childEmpty=child.isEmpty();var childExists=util_2.contains(this.node_.children,childName);if(childEmpty&&childExists){delete this.node_.children[childName];this.node_.childCount--;this.updateParents_()}else if(!childEmpty&&!childExists){this.node_.children[childName]=child.node_;this.node_.childCount++;this.updateParents_()}};return Tree}();exports.Tree=Tree},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var WebSocketConnection_1=__webpack_require__(87);var BrowserPollConnection_1=__webpack_require__(86);exports.forceLongPolling=function(){WebSocketConnection_1.WebSocketConnection.forceDisallow();BrowserPollConnection_1.BrowserPollConnection.forceAllow()};exports.forceWebSockets=function(){BrowserPollConnection_1.BrowserPollConnection.forceDisallow()};exports.isWebSocketsAvailable=function(){return WebSocketConnection_1.WebSocketConnection["isAvailable"]()};exports.setSecurityDebugCallback=function(ref,callback){ref.repo.persistentConnection_.securityDebugCallback_=callback};exports.stats=function(ref,showDelta){ref.repo.stats(showDelta)};exports.statsIncrementCounter=function(ref,metric){ref.repo.statsIncrementCounter(metric)};exports.dataUpdateCount=function(ref){return ref.repo.dataUpdateCount};exports.interceptServerData=function(ref,callback){return ref.repo.interceptServerData_(callback)}},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var RepoInfo_1=__webpack_require__(67);var PersistentConnection_1=__webpack_require__(83);var RepoManager_1=__webpack_require__(49);var Connection_1=__webpack_require__(85);exports.DataConnection=PersistentConnection_1.PersistentConnection;PersistentConnection_1.PersistentConnection.prototype.simpleListen=function(pathString,onComplete){this.sendRequest("q",{p:pathString},onComplete)};PersistentConnection_1.PersistentConnection.prototype.echo=function(data,onEcho){this.sendRequest("echo",{d:data},onEcho)};exports.RealTimeConnection=Connection_1.Connection;exports.hijackHash=function(newHash){var oldPut=PersistentConnection_1.PersistentConnection.prototype.put;PersistentConnection_1.PersistentConnection.prototype.put=function(pathString,data,opt_onComplete,opt_hash){if(opt_hash!==undefined){opt_hash=newHash()}oldPut.call(this,pathString,data,opt_onComplete,opt_hash)};return function(){PersistentConnection_1.PersistentConnection.prototype.put=oldPut}};exports.ConnectionTarget=RepoInfo_1.RepoInfo;exports.queryIdentifier=function(query){return query.queryIdentifier()};exports.listens=function(firebaseRef){return firebaseRef.repo.persistentConnection_.listens_};exports.forceRestClient=function(forceRestClient){RepoManager_1.RepoManager.getInstance().forceRestClient(forceRestClient)}},function(module,exports,__webpack_require__){__webpack_require__(181)},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});__webpack_exports__["registerMessaging"]=registerMessaging;var __WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__=__webpack_require__(182);var __WEBPACK_IMPORTED_MODULE_1__src_controllers_sw_controller__=__webpack_require__(186);var __WEBPACK_IMPORTED_MODULE_2__firebase_app__=__webpack_require__(10);function registerMessaging(instance){var messagingName="messaging";var factoryMethod=function(app){if(self&&"ServiceWorkerGlobalScope"in self){return new __WEBPACK_IMPORTED_MODULE_1__src_controllers_sw_controller__["a"](app)}return new __WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__["a"](app)};var namespaceExports={Messaging:__WEBPACK_IMPORTED_MODULE_0__src_controllers_window_controller__["a"]};instance.INTERNAL.registerService(messagingName,factoryMethod,namespaceExports)}registerMessaging(__WEBPACK_IMPORTED_MODULE_2__firebase_app__["firebase"])},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__controller_interface__=__webpack_require__(90);var __WEBPACK_IMPORTED_MODULE_1__models_errors__=__webpack_require__(33);var __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__=__webpack_require__(93);var __WEBPACK_IMPORTED_MODULE_3__models_default_sw__=__webpack_require__(185);var __WEBPACK_IMPORTED_MODULE_4__models_notification_permission__=__webpack_require__(92);var __WEBPACK_IMPORTED_MODULE_5__firebase_util__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_5__firebase_util___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__firebase_util__);var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var WindowController=function(_super){__extends(WindowController,_super);function WindowController(app){var _this=_super.call(this,app)||this;_this.messageObserver_=null;_this.onMessage_=Object(__WEBPACK_IMPORTED_MODULE_5__firebase_util__["createSubscribe"])(function(observer){_this.messageObserver_=observer});_this.tokenRefreshObserver_=null;_this.onTokenRefresh_=Object(__WEBPACK_IMPORTED_MODULE_5__firebase_util__["createSubscribe"])(function(observer){_this.tokenRefreshObserver_=observer});_this.setupSWMessageListener_();return _this}WindowController.prototype.getToken=function(){var _this=this;if(!this.isSupported_()){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.UNSUPPORTED_BROWSER))}return this.manifestCheck_().then(function(){return _super.prototype.getToken.call(_this)})};WindowController.prototype.manifestCheck_=function(){var _this=this;if(this.manifestCheckPromise_){return this.manifestCheckPromise_}var manifestTag=document.querySelector('link[rel="manifest"]');if(!manifestTag){this.manifestCheckPromise_=Promise.resolve()}else{this.manifestCheckPromise_=fetch(manifestTag.href).then(function(response){return response.json()}).catch(function(){return Promise.resolve()}).then(function(manifestContent){if(!manifestContent){return}if(!manifestContent["gcm_sender_id"]){return}if(manifestContent["gcm_sender_id"]!=="103953800507"){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.INCORRECT_GCM_SENDER_ID)}})}return this.manifestCheckPromise_};WindowController.prototype.requestPermission=function(){var _this=this;if(Notification.permission===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__["a"].granted){return Promise.resolve()}return new Promise(function(resolve,reject){var managePermissionResult=function(result){if(result===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__["a"].granted){return resolve()}else if(result===__WEBPACK_IMPORTED_MODULE_4__models_notification_permission__["a"].denied){return reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.PERMISSION_BLOCKED))}else{return reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.PERMISSION_DEFAULT))}};var permissionPromise=Notification.requestPermission(function(result){if(permissionPromise){return}managePermissionResult(result)});if(permissionPromise){permissionPromise.then(managePermissionResult)}})};WindowController.prototype.useServiceWorker=function(registration){if(!(registration instanceof ServiceWorkerRegistration)){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.SW_REGISTRATION_EXPECTED)}if(typeof this.registrationToUse_!=="undefined"){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.USE_SW_BEFORE_GET_TOKEN)}this.registrationToUse_=registration}
;WindowController.prototype.onMessage=function(nextOrObserver,optError,optCompleted){return this.onMessage_(nextOrObserver,optError,optCompleted)};WindowController.prototype.onTokenRefresh=function(nextOrObserver,optError,optCompleted){return this.onTokenRefresh_(nextOrObserver,optError,optCompleted)};WindowController.prototype.waitForRegistrationToActivate_=function(registration){var _this=this;var serviceWorker=registration.installing||registration.waiting||registration.active;return new Promise(function(resolve,reject){if(!serviceWorker){reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.NO_SW_IN_REG));return}if(serviceWorker.state==="activated"){resolve(registration);return}if(serviceWorker.state==="redundant"){reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.SW_REG_REDUNDANT));return}var stateChangeListener=function(){if(serviceWorker.state==="activated"){resolve(registration)}else if(serviceWorker.state==="redundant"){reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.SW_REG_REDUNDANT))}else{return}serviceWorker.removeEventListener("statechange",stateChangeListener)};serviceWorker.addEventListener("statechange",stateChangeListener)})};WindowController.prototype.getSWRegistration_=function(){var _this=this;if(this.registrationToUse_){return this.waitForRegistrationToActivate_(this.registrationToUse_)}this.registrationToUse_=null;return navigator.serviceWorker.register(__WEBPACK_IMPORTED_MODULE_3__models_default_sw__["a"].path,{scope:__WEBPACK_IMPORTED_MODULE_3__models_default_sw__["a"].scope}).catch(function(err){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:err.message})}).then(function(registration){return _this.waitForRegistrationToActivate_(registration).then(function(){_this.registrationToUse_=registration;registration.update();return registration})})};WindowController.prototype.setupSWMessageListener_=function(){var _this=this;if(!("serviceWorker"in navigator)){return}navigator.serviceWorker.addEventListener("message",function(event){if(!event.data||!event.data[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].PARAMS.TYPE_OF_MSG]){return}var workerPageMessage=event.data;switch(workerPageMessage[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].PARAMS.TYPE_OF_MSG]){case __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].TYPES_OF_MSG.PUSH_MSG_RECEIVED:case __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].TYPES_OF_MSG.NOTIFICATION_CLICKED:var pushMessage=workerPageMessage[__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].PARAMS.DATA];_this.messageObserver_.next(pushMessage);break;default:break}},false)};WindowController.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")};return WindowController}(__WEBPACK_IMPORTED_MODULE_0__controller_interface__["a"]);__webpack_exports__["a"]=WindowController},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__firebase_util__=__webpack_require__(0);var __WEBPACK_IMPORTED_MODULE_0__firebase_util___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0__firebase_util__);var __WEBPACK_IMPORTED_MODULE_1__errors__=__webpack_require__(33);var __WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__=__webpack_require__(184);var __WEBPACK_IMPORTED_MODULE_3__fcm_details__=__webpack_require__(91);var FCM_TOKEN_OBJ_STORE="fcm_token_object_Store";var FCM_TOKEN_DETAILS_DB_VERSION=1;var TokenManager=function(){function TokenManager(){this.errorFactory_=new __WEBPACK_IMPORTED_MODULE_0__firebase_util__["ErrorFactory"]("messaging","Messaging",__WEBPACK_IMPORTED_MODULE_1__errors__["a"].map);this.openDbPromise_=null}TokenManager.prototype.openDatabase_=function(){if(this.openDbPromise_){return this.openDbPromise_}this.openDbPromise_=new Promise(function(resolve,reject){var request=indexedDB.open(TokenManager.DB_NAME,FCM_TOKEN_DETAILS_DB_VERSION);request.onerror=function(event){reject(event.target.error)};request.onsuccess=function(event){resolve(event.target.result)};request.onupgradeneeded=function(event){var db=event.target.result;var objectStore=db.createObjectStore(FCM_TOKEN_OBJ_STORE,{keyPath:"swScope"});objectStore.createIndex("fcmSenderId","fcmSenderId",{unique:false});objectStore.createIndex("fcmToken","fcmToken",{unique:true})}});return this.openDbPromise_};TokenManager.prototype.closeDatabase=function(){var _this=this;if(this.openDbPromise_){return this.openDbPromise_.then(function(db){db.close();_this.openDbPromise_=null})}return Promise.resolve()};TokenManager.prototype.getTokenDetailsFromToken=function(fcmToken){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]);var objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE);var index=objectStore.index("fcmToken");var request=index.get(fcmToken);request.onerror=function(event){reject(event.target.error)};request.onsuccess=function(event){resolve(event.target.result)}})})};TokenManager.prototype.getTokenDetailsFromSWScope_=function(swScope){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]);var objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE);var scopeRequest=objectStore.get(swScope);scopeRequest.onerror=function(event){reject(event.target.error)};scopeRequest.onsuccess=function(event){resolve(event.target.result)}})})};TokenManager.prototype.getAllTokenDetailsForSenderId_=function(senderId){return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE]);var objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE);var senderIdTokens=[];var cursorRequest=objectStore.openCursor();cursorRequest.onerror=function(event){reject(event.target.error)};cursorRequest.onsuccess=function(event){var cursor=event.target.result;if(cursor){if(cursor.value["fcmSenderId"]===senderId){senderIdTokens.push(cursor.value)}cursor.continue()}else{resolve(senderIdTokens)}}})})};TokenManager.prototype.subscribeToFCM=function(senderId,subscription,pushSet){var _this=this;var p256dh=Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("p256dh"));var auth=Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("auth"));var fcmSubscribeBody="authorized_entity="+senderId+"&"+("endpoint="+subscription.endpoint+"&")+("encryption_key="+p256dh+"&")+("encryption_auth="+auth);if(pushSet){fcmSubscribeBody+="&pushSet="+pushSet}var headers=new Headers;headers.append("Content-Type","application/x-www-form-urlencoded");var subscribeOptions={method:"POST",headers:headers,body:fcmSubscribeBody};return fetch(__WEBPACK_IMPORTED_MODULE_3__fcm_details__["a"].ENDPOINT+"/fcm/connect/subscribe",subscribeOptions).then(function(response){return response.json()}).then(function(response){var fcmTokenResponse=response;if(fcmTokenResponse["error"]){var message=fcmTokenResponse["error"]["message"];throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.TOKEN_SUBSCRIBE_FAILED,{message:message})}if(!fcmTokenResponse["token"]){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.TOKEN_SUBSCRIBE_NO_TOKEN)}if(!fcmTokenResponse["pushSet"]){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.TOKEN_SUBSCRIBE_NO_PUSH_SET)}return{token:fcmTokenResponse["token"],pushSet:fcmTokenResponse["pushSet"]}})};TokenManager.prototype.isSameSubscription_=function(subscription,masterTokenDetails){return subscription.endpoint===masterTokenDetails["endpoint"]&&Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("auth"))===masterTokenDetails["auth"]&&Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("p256dh"))===masterTokenDetails["p256dh"]};TokenManager.prototype.saveTokenDetails_=function(senderId,swRegistration,subscription,fcmToken,fcmPushSet){var details={swScope:swRegistration.scope,endpoint:subscription.endpoint,auth:Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("auth")),p256dh:Object(__WEBPACK_IMPORTED_MODULE_2__helpers_array_buffer_to_base64__["a"])(subscription["getKey"]("p256dh")),fcmToken:fcmToken,fcmPushSet:fcmPushSet,fcmSenderId:senderId};return this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE],"readwrite");var objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE);var request=objectStore.put(details);request.onerror=function(event){reject(event.target.error)};request.onsuccess=function(event){resolve()}})})};TokenManager.prototype.getSavedToken=function(senderId,swRegistration){var _this=this;if(!(swRegistration instanceof ServiceWorkerRegistration)){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.SW_REGISTRATION_EXPECTED))}if(typeof senderId!=="string"||senderId.length===0){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.BAD_SENDER_ID))}return this.getAllTokenDetailsForSenderId_(senderId).then(function(allTokenDetails){if(allTokenDetails.length===0){return}var index=allTokenDetails.findIndex(function(tokenDetails){return swRegistration.scope===tokenDetails["swScope"]&&senderId===tokenDetails["fcmSenderId"]});if(index===-1){return}return allTokenDetails[index]}).then(function(tokenDetails){if(!tokenDetails){return}return swRegistration.pushManager.getSubscription().catch(function(err){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.GET_SUBSCRIPTION_FAILED)}).then(function(subscription){if(subscription&&_this.isSameSubscription_(subscription,tokenDetails)){return tokenDetails["fcmToken"]}})})};TokenManager.prototype.createToken=function(senderId,swRegistration){var _this=this;if(typeof senderId!=="string"||senderId.length===0){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.BAD_SENDER_ID))}if(!(swRegistration instanceof ServiceWorkerRegistration)){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.SW_REGISTRATION_EXPECTED))}var subscription;var fcmTokenDetails;return swRegistration.pushManager.getSubscription().then(function(subscription){if(subscription){return subscription}return swRegistration.pushManager.subscribe(__WEBPACK_IMPORTED_MODULE_3__fcm_details__["a"].SUBSCRIPTION_OPTIONS)}).then(function(sub){subscription=sub;return _this.subscribeToFCM(senderId,subscription)}).then(function(tokenDetails){fcmTokenDetails=tokenDetails;return _this.saveTokenDetails_(senderId,swRegistration,subscription,fcmTokenDetails["token"],fcmTokenDetails["pushSet"])}).then(function(){return fcmTokenDetails["token"]})};TokenManager.prototype.deleteToken=function(token){var _this=this;if(typeof token!=="string"||token.length===0){return Promise.reject(this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.INVALID_DELETE_TOKEN))}return this.getTokenDetailsFromToken(token).then(function(details){if(!details){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.DELETE_TOKEN_NOT_FOUND)}return _this.openDatabase_().then(function(db){return new Promise(function(resolve,reject){var transaction=db.transaction([FCM_TOKEN_OBJ_STORE],"readwrite");var objectStore=transaction.objectStore(FCM_TOKEN_OBJ_STORE);var request=objectStore.delete(details["swScope"]);request.onerror=function(event){reject(event.target.error)};request.onsuccess=function(event){if(event.target.result===0){reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__errors__["a"].codes.FAILED_TO_DELETE_TOKEN));return}resolve(details)}})})})};return TokenManager}();__webpack_exports__["a"]=TokenManager},function(module,__webpack_exports__,__webpack_require__){"use strict";function toBase64(arrayBuffer){var uint8Version=new Uint8Array(arrayBuffer);return window.btoa(String.fromCharCode.apply(null,uint8Version))}__webpack_exports__["a"]=function(arrayBuffer){var base64String=toBase64(arrayBuffer);return base64String.replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"}},function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__controller_interface__=__webpack_require__(90);var __WEBPACK_IMPORTED_MODULE_1__models_errors__=__webpack_require__(33);var __WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__=__webpack_require__(93);var __WEBPACK_IMPORTED_MODULE_3__models_fcm_details__=__webpack_require__(91);var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var FCM_MSG="FCM_MSG";var SWController=function(_super){__extends(SWController,_super);function SWController(app){var _this=_super.call(this,app)||this;self.addEventListener("push",function(e){return _this.onPush_(e)},false);self.addEventListener("pushsubscriptionchange",function(e){return _this.onSubChange_(e)},false);self.addEventListener("notificationclick",function(e){return _this.onNotificationClick_(e)},false);_this.bgMessageHandler_=null;return _this}SWController.prototype.onPush_=function(event){var _this=this;var msgPayload;try{msgPayload=event.data.json()}catch(err){return}var handleMsgPromise=this.hasVisibleClients_().then(function(hasVisibleClients){if(hasVisibleClients){if(msgPayload.notification||_this.bgMessageHandler_){return _this.sendMessageToWindowClients_(msgPayload)}return}var notificationDetails=_this.getNotificationData_(msgPayload);if(notificationDetails){var notificationTitle=notificationDetails.title||"";return self.registration.showNotification(notificationTitle,notificationDetails)}else if(_this.bgMessageHandler_){return _this.bgMessageHandler_(msgPayload)}});event.waitUntil(handleMsgPromise)};SWController.prototype.onSubChange_=function(event){var _this=this;var promiseChain=this.getToken().then(function(token){if(!token){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE)}var tokenDetails=null;var tokenManager=_this.getTokenManager();return tokenManager.getTokenDetailsFromToken(token).then(function(details){tokenDetails=details;if(!tokenDetails){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.INVALID_SAVED_TOKEN)}return self.registration.pushManager.subscribe(__WEBPACK_IMPORTED_MODULE_3__models_fcm_details__["a"].SUBSCRIPTION_OPTIONS)}).then(function(newSubscription){return tokenManager.subscribeToFCM(tokenDetails.fcmSenderId,newSubscription,tokenDetails.fcmPushSet)}).catch(function(err){return tokenManager.deleteToken(tokenDetails.fcmToken).then(function(){throw _this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.UNABLE_TO_RESUBSCRIBE,{message:err})})})});event.waitUntil(promiseChain)};SWController.prototype.onNotificationClick_=function(event){var _this=this;if(!(event.notification&&event.notification.data&&event.notification.data[FCM_MSG])){return}event.stopImmediatePropagation();event.notification.close();var msgPayload=event.notification.data[FCM_MSG];var clickAction=msgPayload["notification"]["click_action"];if(!clickAction){return}var promiseChain=this.getWindowClient_(clickAction).then(function(windowClient){if(!windowClient){return self.clients.openWindow(clickAction)}return windowClient}).then(function(windowClient){if(!windowClient){return}var notificationData=msgPayload["notification"];delete msgPayload["notification"];var internalMsg=__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].createNewMsg(__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].TYPES_OF_MSG.NOTIFICATION_CLICKED,msgPayload);return _this.attemptToMessageClient_(windowClient,internalMsg)});event.waitUntil(promiseChain)};SWController.prototype.getNotificationData_=function(msgPayload){if(!msgPayload){return}if(typeof msgPayload.notification!=="object"){return}var notificationInformation=Object.assign({},msgPayload.notification);notificationInformation["data"]=(_a={},_a[FCM_MSG]=msgPayload,_a);return notificationInformation;var _a};SWController.prototype.setBackgroundMessageHandler=function(callback){if(callback&&typeof callback!=="function"){throw this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.BG_HANDLER_FUNCTION_EXPECTED)}this.bgMessageHandler_=callback};SWController.prototype.getWindowClient_=function(url){var parsedURL=new URL(url).href;return self.clients.matchAll({type:"window",includeUncontrolled:true}).then(function(clientList){var suitableClient=null;for(var i=0;i<clientList.length;i++){var parsedClientUrl=new URL(clientList[i].url).href;if(parsedClientUrl===parsedURL){suitableClient=clientList[i];break}}if(suitableClient){suitableClient.focus();return suitableClient}})};SWController.prototype.attemptToMessageClient_=function(client,message){var _this=this;return new Promise(function(resolve,reject){if(!client){return reject(_this.errorFactory_.create(__WEBPACK_IMPORTED_MODULE_1__models_errors__["a"].codes.NO_WINDOW_CLIENT_TO_MSG))}client.postMessage(message);resolve()})};SWController.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:true}).then(function(clientList){return clientList.some(function(client){return client.visibilityState==="visible"})})};SWController.prototype.sendMessageToWindowClients_=function(msgPayload){var _this=this;return self.clients.matchAll({type:"window",includeUncontrolled:true}).then(function(clientList){var internalMsg=__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].createNewMsg(__WEBPACK_IMPORTED_MODULE_2__models_worker_page_message__["a"].TYPES_OF_MSG.PUSH_MSG_RECEIVED,msgPayload);return Promise.all(clientList.map(function(client){return _this.attemptToMessageClient_(client,internalMsg)}))})};SWController.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)};return SWController}(__WEBPACK_IMPORTED_MODULE_0__controller_interface__["a"]);__webpack_exports__["a"]=SWController},function(module,exports,__webpack_require__){__webpack_require__(188)},function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:true});__webpack_exports__["registerStorage"]=registerStorage;var __WEBPACK_IMPORTED_MODULE_0__firebase_app__=__webpack_require__(10);var __WEBPACK_IMPORTED_MODULE_1__src_implementation_string__=__webpack_require__(23);var __WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__=__webpack_require__(24);var __WEBPACK_IMPORTED_MODULE_3__src_implementation_xhriopool__=__webpack_require__(189);var __WEBPACK_IMPORTED_MODULE_4__src_reference__=__webpack_require__(95);var __WEBPACK_IMPORTED_MODULE_5__src_service__=__webpack_require__(198);var STORAGE_TYPE="storage";function factory(app,unused,opt_url){return new __WEBPACK_IMPORTED_MODULE_5__src_service__["a"](app,new __WEBPACK_IMPORTED_MODULE_3__src_implementation_xhriopool__["a"],opt_url)}function registerStorage(instance){var namespaceExports={TaskState:__WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__["c"],TaskEvent:__WEBPACK_IMPORTED_MODULE_2__src_implementation_taskenums__["b"],StringFormat:__WEBPACK_IMPORTED_MODULE_1__src_implementation_string__["a"],Storage:__WEBPACK_IMPORTED_MODULE_5__src_service__["a"],Reference:__WEBPACK_IMPORTED_MODULE_4__src_reference__["a"]};instance.INTERNAL.registerService(STORAGE_TYPE,factory,namespaceExports,undefined,true)}registerStorage(__WEBPACK_IMPORTED_MODULE_0__firebase_app__["default"])},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return XhrIoPool});var __WEBPACK_IMPORTED_MODULE_0__xhrio_network__=__webpack_require__(190);var XhrIoPool=function(){function XhrIoPool(){}XhrIoPool.prototype.createXhrIo=function(){return new __WEBPACK_IMPORTED_MODULE_0__xhrio_network__["a"]};return XhrIoPool}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return NetworkXhrIo});var __WEBPACK_IMPORTED_MODULE_0__error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_1__object__=__webpack_require__(17);var __WEBPACK_IMPORTED_MODULE_2__promise_external__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_3__type__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_4__xhrio__=__webpack_require__(94);var NetworkXhrIo=function(){function NetworkXhrIo(){var _this=this;this.sent_=false;this.xhr_=new XMLHttpRequest;this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__["a"].NO_ERROR;this.sendPromise_=__WEBPACK_IMPORTED_MODULE_2__promise_external__["a"](function(resolve,reject){_this.xhr_.addEventListener("abort",function(event){_this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__["a"].ABORT;resolve(_this)});_this.xhr_.addEventListener("error",function(event){_this.errorCode_=__WEBPACK_IMPORTED_MODULE_4__xhrio__["a"].NETWORK_ERROR;resolve(_this)});_this.xhr_.addEventListener("load",function(event){resolve(_this)})})}NetworkXhrIo.prototype.send=function(url,method,opt_body,opt_headers){var _this=this;if(this.sent_){throw __WEBPACK_IMPORTED_MODULE_0__error__["e"]("cannot .send() more than once")}this.sent_=true;this.xhr_.open(method,url,true);if(__WEBPACK_IMPORTED_MODULE_3__type__["a"](opt_headers)){var headers=opt_headers;__WEBPACK_IMPORTED_MODULE_1__object__["b"](headers,function(key,val){_this.xhr_.setRequestHeader(key,val.toString())})}if(__WEBPACK_IMPORTED_MODULE_3__type__["a"](opt_body)){this.xhr_.send(opt_body)}else{this.xhr_.send()}return this.sendPromise_};NetworkXhrIo.prototype.getErrorCode=function(){if(!this.sent_){throw __WEBPACK_IMPORTED_MODULE_0__error__["e"]("cannot .getErrorCode() before sending")}return this.errorCode_};NetworkXhrIo.prototype.getStatus=function(){if(!this.sent_){throw __WEBPACK_IMPORTED_MODULE_0__error__["e"]("cannot .getStatus() before sending")}try{return this.xhr_.status}catch(e){return-1}};NetworkXhrIo.prototype.getResponseText=function(){if(!this.sent_){throw __WEBPACK_IMPORTED_MODULE_0__error__["e"]("cannot .getResponseText() before sending")}return this.xhr_.responseText};NetworkXhrIo.prototype.abort=function(){this.xhr_.abort()};NetworkXhrIo.prototype.getResponseHeader=function(header){return this.xhr_.getResponseHeader(header)};NetworkXhrIo.prototype.addUploadProgressListener=function(listener){if(__WEBPACK_IMPORTED_MODULE_3__type__["a"](this.xhr_.upload)){this.xhr_.upload.addEventListener("progress",listener)}};NetworkXhrIo.prototype.removeUploadProgressListener=function(listener){if(__WEBPACK_IMPORTED_MODULE_3__type__["a"](this.xhr_.upload)){this.xhr_.upload.removeEventListener("progress",listener)}};return NetworkXhrIo}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=jsonObjectOrNull;var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(7);function jsonObjectOrNull(s){var obj;try{obj=JSON.parse(s)}catch(e){return null}if(__WEBPACK_IMPORTED_MODULE_0__type__["f"](obj)){return obj}else{return null}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=getBlob;__webpack_exports__["b"]=sliceBlob;var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(7);function getBlobBuilder(){if(typeof BlobBuilder!=="undefined"){return BlobBuilder}else if(typeof WebKitBlobBuilder!=="undefined"){return WebKitBlobBuilder}else{return undefined}}function getBlob(){var var_args=[];for(var _i=0;_i<arguments.length;_i++){var_args[_i]=arguments[_i]}var BlobBuilder=getBlobBuilder();if(BlobBuilder!==undefined){var bb=new BlobBuilder;for(var i=0;i<var_args.length;i++){bb.append(var_args[i])}return bb.getBlob()}else{if(__WEBPACK_IMPORTED_MODULE_0__type__["e"]()){return new Blob(var_args)}else{throw Error("This browser doesn't seem to support creating Blobs")}}}function sliceBlob(blob,start,end){if(blob.webkitSlice){return blob.webkitSlice(start,end)}else if(blob.mozSlice){return blob.mozSlice(start,end)}else if(blob.slice){return blob.slice(start,end)}return null}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return RequestInfo});var RequestInfo=function(){function RequestInfo(url,method,handler,timeout){this.url=url;this.method=method;this.handler=handler;this.timeout=timeout;this.urlParams={};this.headers={};this.body=null;this.errorHandler=null;this.progressCallback=null;this.successCodes=[200];this.additionalRetryCodes=[]}return RequestInfo}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return UploadTask});var __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__=__webpack_require__(24);var __WEBPACK_IMPORTED_MODULE_1__implementation_observer__=__webpack_require__(195);var __WEBPACK_IMPORTED_MODULE_2__tasksnapshot__=__webpack_require__(196);var __WEBPACK_IMPORTED_MODULE_3__implementation_args__=__webpack_require__(50);var __WEBPACK_IMPORTED_MODULE_4__implementation_array__=__webpack_require__(53);var __WEBPACK_IMPORTED_MODULE_5__implementation_async__=__webpack_require__(197);var __WEBPACK_IMPORTED_MODULE_6__implementation_error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_7__implementation_promise_external__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_8__implementation_requests__=__webpack_require__(98);var __WEBPACK_IMPORTED_MODULE_9__implementation_type__=__webpack_require__(7);var UploadTask=function(){function UploadTask(ref,authWrapper,location,mappings,blob,metadata){if(metadata===void 0){metadata=null}var _this=this;this.transferred_=0;this.needToFetchStatus_=false;this.needToFetchMetadata_=false;this.observers_=[];this.error_=null;this.uploadUrl_=null;this.request_=null;this.chunkMultiplier_=1;this.resolve_=null;this.reject_=null;this.ref_=ref;this.authWrapper_=authWrapper;this.location_=location;this.blob_=blob;this.metadata_=metadata;this.mappings_=mappings;this.resumable_=this.shouldDoResumable_(this.blob_);this.state_=__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING;this.errorHandler_=function(error){_this.request_=null;_this.chunkMultiplier_=1;if(error.codeEquals(__WEBPACK_IMPORTED_MODULE_6__implementation_error__["a"].CANCELED)){_this.needToFetchStatus_=true;_this.completeTransitions_()}else{_this.error_=error;_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].ERROR)}};this.metadataErrorHandler_=function(error){_this.request_=null;if(error.codeEquals(__WEBPACK_IMPORTED_MODULE_6__implementation_error__["a"].CANCELED)){_this.completeTransitions_()}else{_this.error_=error;_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].ERROR)}};this.promise_=__WEBPACK_IMPORTED_MODULE_7__implementation_promise_external__["a"](function(resolve,reject){_this.resolve_=resolve;_this.reject_=reject;_this.start_()});this.promise_.then(null,function(){})}UploadTask.prototype.makeProgressCallback_=function(){var _this=this;var sizeBefore=this.transferred_;return function(loaded,total){_this.updateProgress_(sizeBefore+loaded)}};UploadTask.prototype.shouldDoResumable_=function(blob){return blob.size()>256*1024};UploadTask.prototype.start_=function(){if(this.state_!==__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING){return}if(this.request_!==null){return}if(this.resumable_){if(this.uploadUrl_===null){this.createResumable_()}else{if(this.needToFetchStatus_){this.fetchStatus_()}else{if(this.needToFetchMetadata_){this.fetchMetadata_()}else{this.continueUpload_()}}}}else{this.oneShotUpload_()}};UploadTask.prototype.resolveToken_=function(callback){var _this=this;this.authWrapper_.getAuthToken().then(function(authToken){switch(_this.state_){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING:callback(authToken);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELING:_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING:_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSED);break;default:}})};UploadTask.prototype.createResumable_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["c"](_this.authWrapper_,_this.location_,_this.mappings_,_this.blob_,_this.metadata_);var createRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=createRequest;createRequest.getPromise().then(function(url){_this.request_=null;_this.uploadUrl_=url;_this.needToFetchStatus_=false;_this.completeTransitions_()},_this.errorHandler_)})};UploadTask.prototype.fetchStatus_=function(){var _this=this;var url=this.uploadUrl_;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["f"](_this.authWrapper_,_this.location_,url,_this.blob_);var statusRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=statusRequest;statusRequest.getPromise().then(function(status){status=status;_this.request_=null;_this.updateProgress_(status.current);_this.needToFetchStatus_=false;if(status.finalized){_this.needToFetchMetadata_=true}_this.completeTransitions_()},_this.errorHandler_)})};UploadTask.prototype.continueUpload_=function(){var _this=this;var chunkSize=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["h"]*this.chunkMultiplier_;var status=new __WEBPACK_IMPORTED_MODULE_8__implementation_requests__["a"](this.transferred_,this.blob_.size());var url=this.uploadUrl_;this.resolveToken_(function(authToken){var requestInfo;try{requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["b"](_this.location_,_this.authWrapper_,url,_this.blob_,chunkSize,_this.mappings_,status,_this.makeProgressCallback_())}catch(e){_this.error_=e;_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].ERROR);return}var uploadRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=uploadRequest;uploadRequest.getPromise().then(function(newStatus){_this.increaseMultiplier_();_this.request_=null;_this.updateProgress_(newStatus.current);if(newStatus.finalized){_this.metadata_=newStatus.metadata;_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].SUCCESS)}else{_this.completeTransitions_()}},_this.errorHandler_)})};UploadTask.prototype.increaseMultiplier_=function(){var currentSize=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["h"]*this.chunkMultiplier_;if(currentSize<32*1024*1024){this.chunkMultiplier_*=2}};UploadTask.prototype.fetchMetadata_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["e"](_this.authWrapper_,_this.location_,_this.mappings_)
;var metadataRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=metadataRequest;metadataRequest.getPromise().then(function(metadata){_this.request_=null;_this.metadata_=metadata;_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].SUCCESS)},_this.metadataErrorHandler_)})};UploadTask.prototype.oneShotUpload_=function(){var _this=this;this.resolveToken_(function(authToken){var requestInfo=__WEBPACK_IMPORTED_MODULE_8__implementation_requests__["g"](_this.authWrapper_,_this.location_,_this.mappings_,_this.blob_,_this.metadata_);var multipartRequest=_this.authWrapper_.makeRequest(requestInfo,authToken);_this.request_=multipartRequest;multipartRequest.getPromise().then(function(metadata){_this.request_=null;_this.metadata_=metadata;_this.updateProgress_(_this.blob_.size());_this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].SUCCESS)},_this.errorHandler_)})};UploadTask.prototype.updateProgress_=function(transferred){var old=this.transferred_;this.transferred_=transferred;if(this.transferred_!==old){this.notifyObservers_()}};UploadTask.prototype.transition_=function(state){if(this.state_===state){return}switch(state){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELING:this.state_=state;if(this.request_!==null){this.request_.cancel()}break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING:this.state_=state;if(this.request_!==null){this.request_.cancel()}break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING:var wasPaused=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSED;this.state_=state;if(wasPaused){this.notifyObservers_();this.start_()}break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSED:this.state_=state;this.notifyObservers_();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELED:this.error_=__WEBPACK_IMPORTED_MODULE_6__implementation_error__["c"]();this.state_=state;this.notifyObservers_();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].ERROR:this.state_=state;this.notifyObservers_();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].SUCCESS:this.state_=state;this.notifyObservers_();break}};UploadTask.prototype.completeTransitions_=function(){switch(this.state_){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING:this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELING:this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELED);break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING:this.start_();break;default:break}};Object.defineProperty(UploadTask.prototype,"snapshot",{get:function(){var externalState=__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["d"](this.state_);return new __WEBPACK_IMPORTED_MODULE_2__tasksnapshot__["a"](this.transferred_,this.blob_.size(),externalState,this.metadata_,this,this.ref_)},enumerable:true,configurable:true});UploadTask.prototype.on=function(type,nextOrObserver,error,completed){if(nextOrObserver===void 0){nextOrObserver=undefined}if(error===void 0){error=undefined}if(completed===void 0){completed=undefined}function typeValidator(_p){if(type!==__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["b"].STATE_CHANGED){throw"Expected one of the event types: ["+__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["b"].STATE_CHANGED+"]."}}var nextOrObserverMessage="Expected a function or an Object with one of "+"`next`, `error`, `complete` properties.";var nextValidator=__WEBPACK_IMPORTED_MODULE_3__implementation_args__["d"](true).validator;var observerValidator=__WEBPACK_IMPORTED_MODULE_3__implementation_args__["a"](null,true).validator;function nextOrObserverValidator(p){try{nextValidator(p);return}catch(e){}try{observerValidator(p);var anyDefined=__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](p["next"])||__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](p["error"])||__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](p["complete"]);if(!anyDefined){throw""}return}catch(e){throw nextOrObserverMessage}}var specs=[__WEBPACK_IMPORTED_MODULE_3__implementation_args__["e"](typeValidator),__WEBPACK_IMPORTED_MODULE_3__implementation_args__["a"](nextOrObserverValidator,true),__WEBPACK_IMPORTED_MODULE_3__implementation_args__["d"](true),__WEBPACK_IMPORTED_MODULE_3__implementation_args__["d"](true)];__WEBPACK_IMPORTED_MODULE_3__implementation_args__["g"]("on",specs,arguments);var self=this;function makeBinder(specs){function binder(nextOrObserver,error,opt_complete){if(specs!==null){__WEBPACK_IMPORTED_MODULE_3__implementation_args__["g"]("on",specs,arguments)}var observer=new __WEBPACK_IMPORTED_MODULE_1__implementation_observer__["a"](nextOrObserver,error,completed);self.addObserver_(observer);return function(){self.removeObserver_(observer)}}return binder}function binderNextOrObserverValidator(p){if(p===null){throw nextOrObserverMessage}nextOrObserverValidator(p)}var binderSpecs=[__WEBPACK_IMPORTED_MODULE_3__implementation_args__["a"](binderNextOrObserverValidator),__WEBPACK_IMPORTED_MODULE_3__implementation_args__["d"](true),__WEBPACK_IMPORTED_MODULE_3__implementation_args__["d"](true)];var typeOnly=!(__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](nextOrObserver)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](error)||__WEBPACK_IMPORTED_MODULE_9__implementation_type__["c"](completed));if(typeOnly){return makeBinder(binderSpecs)}else{return makeBinder(null)(nextOrObserver,error,completed)}};UploadTask.prototype.then=function(onFulfilled,onRejected){return this.promise_.then(onFulfilled,onRejected)};UploadTask.prototype.catch=function(onRejected){return this.then(null,onRejected)};UploadTask.prototype.addObserver_=function(observer){this.observers_.push(observer);this.notifyObserver_(observer)};UploadTask.prototype.removeObserver_=function(observer){__WEBPACK_IMPORTED_MODULE_4__implementation_array__["c"](this.observers_,observer)};UploadTask.prototype.notifyObservers_=function(){var _this=this;this.finishPromise_();var observers=__WEBPACK_IMPORTED_MODULE_4__implementation_array__["a"](this.observers_);observers.forEach(function(observer){_this.notifyObserver_(observer)})};UploadTask.prototype.finishPromise_=function(){if(this.resolve_!==null){var triggered=true;switch(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["d"](this.state_)){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].SUCCESS:Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(this.resolve_.bind(null,this.snapshot))();break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].CANCELED:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].ERROR:var toCall=this.reject_;Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(toCall.bind(null,this.error_))();break;default:triggered=false;break}if(triggered){this.resolve_=null;this.reject_=null}}};UploadTask.prototype.notifyObserver_=function(observer){var externalState=__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["d"](this.state_);switch(externalState){case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].RUNNING:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].PAUSED:if(observer.next!==null){Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(observer.next.bind(observer,this.snapshot))()}break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].SUCCESS:if(observer.complete!==null){Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(observer.complete.bind(observer))()}break;case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].CANCELED:case __WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["c"].ERROR:if(observer.error!==null){Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(observer.error.bind(observer,this.error_))()}break;default:if(observer.error!==null){Object(__WEBPACK_IMPORTED_MODULE_5__implementation_async__["a"])(observer.error.bind(observer,this.error_))()}}};UploadTask.prototype.resume=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__["g"]("resume",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSED||this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING;if(valid){this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING)}return valid};UploadTask.prototype.pause=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__["g"]("pause",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING;if(valid){this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING)}return valid};UploadTask.prototype.cancel=function(){__WEBPACK_IMPORTED_MODULE_3__implementation_args__["g"]("cancel",[],arguments);var valid=this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].RUNNING||this.state_===__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].PAUSING;if(valid){this.transition_(__WEBPACK_IMPORTED_MODULE_0__implementation_taskenums__["a"].CANCELING)}return valid};return UploadTask}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Observer});var __WEBPACK_IMPORTED_MODULE_0__type__=__webpack_require__(7);var Observer=function(){function Observer(nextOrObserver,opt_error,opt_complete){var asFunctions=__WEBPACK_IMPORTED_MODULE_0__type__["b"](nextOrObserver)||__WEBPACK_IMPORTED_MODULE_0__type__["a"](opt_error)||__WEBPACK_IMPORTED_MODULE_0__type__["a"](opt_complete);if(asFunctions){this.next=nextOrObserver;this.error=opt_error||null;this.complete=opt_complete||null}else{var observer=nextOrObserver;this.next=observer.next||null;this.error=observer.error||null;this.complete=observer.complete||null}}return Observer}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return UploadTaskSnapshot});var UploadTaskSnapshot=function(){function UploadTaskSnapshot(bytesTransferred,totalBytes,state,metadata,task,ref){this.bytesTransferred=bytesTransferred;this.totalBytes=totalBytes;this.state=state;this.metadata=metadata;this.task=task;this.ref=ref}Object.defineProperty(UploadTaskSnapshot.prototype,"downloadURL",{get:function(){if(this.metadata!==null){var urls=this.metadata["downloadURLs"];if(urls!=null&&urls[0]!=null){return urls[0]}else{return null}}else{return null}},enumerable:true,configurable:true});return UploadTaskSnapshot}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=async;var __WEBPACK_IMPORTED_MODULE_0__promise_external__=__webpack_require__(14);function async(f){return function(){var argsToForward=[];for(var _i=0;_i<arguments.length;_i++){argsToForward[_i]=arguments[_i]}__WEBPACK_IMPORTED_MODULE_0__promise_external__["c"](true).then(function(){f.apply(null,argsToForward)})}}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Service});var __WEBPACK_IMPORTED_MODULE_0__implementation_args__=__webpack_require__(50);var __WEBPACK_IMPORTED_MODULE_1__implementation_authwrapper__=__webpack_require__(199);var __WEBPACK_IMPORTED_MODULE_2__implementation_location__=__webpack_require__(35);var __WEBPACK_IMPORTED_MODULE_3__implementation_promise_external__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_4__implementation_request__=__webpack_require__(202);var __WEBPACK_IMPORTED_MODULE_5__reference__=__webpack_require__(95);var Service=function(){function Service(app,pool,url){this.bucket_=null;function maker(authWrapper,loc){return new __WEBPACK_IMPORTED_MODULE_5__reference__["a"](authWrapper,loc)}this.authWrapper_=new __WEBPACK_IMPORTED_MODULE_1__implementation_authwrapper__["a"](app,maker,__WEBPACK_IMPORTED_MODULE_4__implementation_request__["a"],this,pool);this.app_=app;if(url!=null){this.bucket_=__WEBPACK_IMPORTED_MODULE_2__implementation_location__["a"].makeFromBucketSpec(url)}else{var authWrapperBucket=this.authWrapper_.bucket();if(authWrapperBucket!=null){this.bucket_=new __WEBPACK_IMPORTED_MODULE_2__implementation_location__["a"](authWrapperBucket,"")}}this.internals_=new ServiceInternals(this)}Service.prototype.ref=function(path){function validator(path){if(/^[A-Za-z]+:\/\//.test(path)){throw"Expected child path but got a URL, use refFromURL instead."}}__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("ref",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["e"](validator,true)],arguments);if(this.bucket_==null){throw new Error("No Storage Bucket defined in Firebase Options.")}var ref=new __WEBPACK_IMPORTED_MODULE_5__reference__["a"](this.authWrapper_,this.bucket_);if(path!=null){return ref.child(path)}else{return ref}};Service.prototype.refFromURL=function(url){function validator(p){if(!/^[A-Za-z]+:\/\//.test(p)){throw"Expected full URL but got a child path, use ref instead."}try{__WEBPACK_IMPORTED_MODULE_2__implementation_location__["a"].makeFromUrl(p)}catch(e){throw"Expected valid full URL but got an invalid one."}}__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("refFromURL",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["e"](validator,false)],arguments);return new __WEBPACK_IMPORTED_MODULE_5__reference__["a"](this.authWrapper_,url)};Object.defineProperty(Service.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:true,configurable:true});Service.prototype.setMaxUploadRetryTime=function(time){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("setMaxUploadRetryTime",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["c"]()],arguments);this.authWrapper_.setMaxUploadRetryTime(time)};Object.defineProperty(Service.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:true,configurable:true});Service.prototype.setMaxOperationRetryTime=function(time){__WEBPACK_IMPORTED_MODULE_0__implementation_args__["g"]("setMaxOperationRetryTime",[__WEBPACK_IMPORTED_MODULE_0__implementation_args__["c"]()],arguments);this.authWrapper_.setMaxOperationRetryTime(time)};Object.defineProperty(Service.prototype,"app",{get:function(){return this.app_},enumerable:true,configurable:true});Object.defineProperty(Service.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:true,configurable:true});return Service}();var ServiceInternals=function(){function ServiceInternals(service){this.service_=service}ServiceInternals.prototype.delete=function(){this.service_.authWrapper_.deleteApp();return __WEBPACK_IMPORTED_MODULE_3__implementation_promise_external__["c"](undefined)};return ServiceInternals}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AuthWrapper});var __WEBPACK_IMPORTED_MODULE_0__constants__=__webpack_require__(34);var __WEBPACK_IMPORTED_MODULE_1__error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_2__failrequest__=__webpack_require__(200);var __WEBPACK_IMPORTED_MODULE_3__location__=__webpack_require__(35);var __WEBPACK_IMPORTED_MODULE_4__promise_external__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_5__requestmap__=__webpack_require__(201);var __WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(7);var AuthWrapper=function(){function AuthWrapper(app,maker,requestMaker,service,pool){this.bucket_=null;this.deleted_=false;this.app_=app;if(this.app_!==null){var options=this.app_.options;if(__WEBPACK_IMPORTED_MODULE_6__type__["a"](options)){this.bucket_=AuthWrapper.extractBucket_(options)}}this.storageRefMaker_=maker;this.requestMaker_=requestMaker;this.pool_=pool;this.service_=service;this.maxOperationRetryTime_=__WEBPACK_IMPORTED_MODULE_0__constants__["d"];this.maxUploadRetryTime_=__WEBPACK_IMPORTED_MODULE_0__constants__["e"];this.requestMap_=new __WEBPACK_IMPORTED_MODULE_5__requestmap__["a"]}AuthWrapper.extractBucket_=function(config){var bucketString=config[__WEBPACK_IMPORTED_MODULE_0__constants__["c"]]||null;if(bucketString==null){return null}var loc=__WEBPACK_IMPORTED_MODULE_3__location__["a"].makeFromBucketSpec(bucketString);return loc.bucket};AuthWrapper.prototype.getAuthToken=function(){if(this.app_!==null&&__WEBPACK_IMPORTED_MODULE_6__type__["a"](this.app_.INTERNAL)&&__WEBPACK_IMPORTED_MODULE_6__type__["a"](this.app_.INTERNAL.getToken)){return this.app_.INTERNAL.getToken().then(function(response){if(response!==null){return response.accessToken}else{return null}},function(_error){return null})}else{return __WEBPACK_IMPORTED_MODULE_4__promise_external__["c"](null)}};AuthWrapper.prototype.bucket=function(){if(this.deleted_){throw __WEBPACK_IMPORTED_MODULE_1__error__["b"]()}else{return this.bucket_}};AuthWrapper.prototype.service=function(){return this.service_};AuthWrapper.prototype.makeStorageReference=function(loc){return this.storageRefMaker_(this,loc)};AuthWrapper.prototype.makeRequest=function(requestInfo,authToken){if(!this.deleted_){var request=this.requestMaker_(requestInfo,authToken,this.pool_);this.requestMap_.addRequest(request);return request}else{return new __WEBPACK_IMPORTED_MODULE_2__failrequest__["a"](__WEBPACK_IMPORTED_MODULE_1__error__["b"]())}};AuthWrapper.prototype.deleteApp=function(){this.deleted_=true;this.app_=null;this.requestMap_.clear()};AuthWrapper.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_};AuthWrapper.prototype.setMaxUploadRetryTime=function(time){this.maxUploadRetryTime_=time};AuthWrapper.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_};AuthWrapper.prototype.setMaxOperationRetryTime=function(time){this.maxOperationRetryTime_=time};return AuthWrapper}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return FailRequest});var __WEBPACK_IMPORTED_MODULE_0__promise_external__=__webpack_require__(14);var FailRequest=function(){function FailRequest(error){this.promise_=__WEBPACK_IMPORTED_MODULE_0__promise_external__["b"](error)}FailRequest.prototype.getPromise=function(){return this.promise_};FailRequest.prototype.cancel=function(appDelete){if(appDelete===void 0){appDelete=false}};return FailRequest}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return RequestMap});var __WEBPACK_IMPORTED_MODULE_0__object__=__webpack_require__(17);var __WEBPACK_IMPORTED_MODULE_1__constants__=__webpack_require__(34);var RequestMap=function(){function RequestMap(){this.map_={};this.id_=__WEBPACK_IMPORTED_MODULE_1__constants__["h"]}RequestMap.prototype.addRequest=function(r){var id=this.id_;this.id_++;this.map_[id]=r;var self=this;function unmap(){delete self.map_[id]}r.getPromise().then(unmap,unmap)};RequestMap.prototype.clear=function(){__WEBPACK_IMPORTED_MODULE_0__object__["b"](this.map_,function(key,val){if(val){val.cancel(true)}});this.map_={}};return RequestMap}()},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=makeRequest;var __WEBPACK_IMPORTED_MODULE_0__firebase_app__=__webpack_require__(10);var __WEBPACK_IMPORTED_MODULE_1__array__=__webpack_require__(53);var __WEBPACK_IMPORTED_MODULE_2__backoff__=__webpack_require__(203);var __WEBPACK_IMPORTED_MODULE_3__error__=__webpack_require__(9);var __WEBPACK_IMPORTED_MODULE_4__object__=__webpack_require__(17);var __WEBPACK_IMPORTED_MODULE_5__promise_external__=__webpack_require__(14);var __WEBPACK_IMPORTED_MODULE_6__type__=__webpack_require__(7);var __WEBPACK_IMPORTED_MODULE_7__url__=__webpack_require__(52);var __WEBPACK_IMPORTED_MODULE_8__xhrio__=__webpack_require__(94);var NetworkRequest=function(){function NetworkRequest(url,method,headers,body,successCodes,additionalRetryCodes,callback,errorCallback,timeout,progressCallback,pool){this.pendingXhr_=null;this.backoffId_=null;this.resolve_=null;this.reject_=null;this.canceled_=false;this.appDelete_=false;this.url_=url;this.method_=method;this.headers_=headers;this.body_=body;this.successCodes_=successCodes.slice();this.additionalRetryCodes_=additionalRetryCodes.slice();this.callback_=callback;this.errorCallback_=errorCallback;this.progressCallback_=progressCallback;this.timeout_=timeout;this.pool_=pool;var self=this;this.promise_=__WEBPACK_IMPORTED_MODULE_5__promise_external__["a"](function(resolve,reject){self.resolve_=resolve;self.reject_=reject;self.start_()})}NetworkRequest.prototype.start_=function(){var self=this;function doTheRequest(backoffCallback,canceled){if(canceled){backoffCallback(false,new RequestEndStatus(false,null,true));return}var xhr=self.pool_.createXhrIo();self.pendingXhr_=xhr;function progressListener(progressEvent){var loaded=progressEvent.loaded;var total=progressEvent.lengthComputable?progressEvent.total:-1;if(self.progressCallback_!==null){self.progressCallback_(loaded,total)}}if(self.progressCallback_!==null){xhr.addUploadProgressListener(progressListener)}xhr.send(self.url_,self.method_,self.body_,self.headers_).then(function(xhr){if(self.progressCallback_!==null){xhr.removeUploadProgressListener(progressListener)}self.pendingXhr_=null;xhr=xhr;var hitServer=xhr.getErrorCode()===__WEBPACK_IMPORTED_MODULE_8__xhrio__["a"].NO_ERROR;var status=xhr.getStatus();if(!hitServer||self.isRetryStatusCode_(status)){var wasCanceled=xhr.getErrorCode()===__WEBPACK_IMPORTED_MODULE_8__xhrio__["a"].ABORT;backoffCallback(false,new RequestEndStatus(false,null,wasCanceled));return}var successCode=__WEBPACK_IMPORTED_MODULE_1__array__["b"](self.successCodes_,status);backoffCallback(true,new RequestEndStatus(successCode,xhr))})}function backoffDone(requestWentThrough,status){var resolve=self.resolve_;var reject=self.reject_;var xhr=status.xhr;if(status.wasSuccessCode){try{var result=self.callback_(xhr,xhr.getResponseText());if(__WEBPACK_IMPORTED_MODULE_6__type__["c"](result)){resolve(result)}else{resolve()}}catch(e){reject(e)}}else{if(xhr!==null){var err=__WEBPACK_IMPORTED_MODULE_3__error__["s"]();err.setServerResponseProp(xhr.getResponseText());if(self.errorCallback_){reject(self.errorCallback_(xhr,err))}else{reject(err)}}else{if(status.canceled){var err=self.appDelete_?__WEBPACK_IMPORTED_MODULE_3__error__["b"]():__WEBPACK_IMPORTED_MODULE_3__error__["c"]();reject(err)}else{var err=__WEBPACK_IMPORTED_MODULE_3__error__["o"]();reject(err)}}}}if(this.canceled_){backoffDone(false,new RequestEndStatus(false,null,true))}else{this.backoffId_=__WEBPACK_IMPORTED_MODULE_2__backoff__["a"](doTheRequest,backoffDone,this.timeout_)}};NetworkRequest.prototype.getPromise=function(){return this.promise_};NetworkRequest.prototype.cancel=function(appDelete){this.canceled_=true;this.appDelete_=appDelete||false;if(this.backoffId_!==null){__WEBPACK_IMPORTED_MODULE_2__backoff__["b"](this.backoffId_)}if(this.pendingXhr_!==null){this.pendingXhr_.abort()}};NetworkRequest.prototype.isRetryStatusCode_=function(status){var isFiveHundredCode=status>=500&&status<600;var extraRetryCodes=[408,429];var isExtraRetryCode=__WEBPACK_IMPORTED_MODULE_1__array__["b"](extraRetryCodes,status);var isRequestSpecificRetryCode=__WEBPACK_IMPORTED_MODULE_1__array__["b"](this.additionalRetryCodes_,status);return isFiveHundredCode||isExtraRetryCode||isRequestSpecificRetryCode};return NetworkRequest}();var RequestEndStatus=function(){function RequestEndStatus(wasSuccessCode,xhr,opt_canceled){this.wasSuccessCode=wasSuccessCode;this.xhr=xhr;this.canceled=!!opt_canceled}return RequestEndStatus}();function addAuthHeader_(headers,authToken){if(authToken!==null&&authToken.length>0){headers["Authorization"]="Firebase "+authToken}}function addVersionHeader_(headers){var number=typeof __WEBPACK_IMPORTED_MODULE_0__firebase_app__["default"]!=="undefined"?__WEBPACK_IMPORTED_MODULE_0__firebase_app__["default"].SDK_VERSION:"AppManager";headers["X-Firebase-Storage-Version"]="webjs/"+number}function makeRequest(requestInfo,authToken,pool){var queryPart=__WEBPACK_IMPORTED_MODULE_7__url__["c"](requestInfo.urlParams);var url=requestInfo.url+queryPart;var headers=__WEBPACK_IMPORTED_MODULE_4__object__["a"](requestInfo.headers);addAuthHeader_(headers,authToken);addVersionHeader_(headers);return new NetworkRequest(url,requestInfo.method,headers,requestInfo.body,requestInfo.successCodes,requestInfo.additionalRetryCodes,requestInfo.handler,requestInfo.errorHandler,requestInfo.timeout,requestInfo.progressCallback,pool)}},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__["a"]=start;__webpack_exports__["b"]=stop;function start(f,callback,timeout){var waitSeconds=1;var timeoutId=null;var hitTimeout=false;var cancelState=0;function canceled(){return cancelState===2}var triggeredCallback=false;function triggerCallback(){if(!triggeredCallback){triggeredCallback=true;callback.apply(null,arguments)}}function callWithDelay(millis){timeoutId=setTimeout(function(){timeoutId=null;f(handler,canceled())},millis)}function handler(success){var var_args=[];for(var _i=1;_i<arguments.length;_i++){var_args[_i-1]=arguments[_i]}if(triggeredCallback){return}if(success){triggerCallback.apply(null,arguments);return}var mustStop=canceled()||hitTimeout;if(mustStop){triggerCallback.apply(null,arguments);return}if(waitSeconds<64){waitSeconds*=2}var waitMillis;if(cancelState===1){cancelState=2;waitMillis=0}else{waitMillis=(waitSeconds+Math.random())*1e3}callWithDelay(waitMillis)}var stopped=false;function stop(wasTimeout){if(stopped){return}stopped=true;if(triggeredCallback){return}if(timeoutId!==null){if(!wasTimeout){cancelState=2}clearTimeout(timeoutId);callWithDelay(0)}else{if(!wasTimeout){cancelState=1}}}callWithDelay(0);setTimeout(function(){hitTimeout=true;stop(true)},timeout);return stop}function stop(id){id(false)}}])});